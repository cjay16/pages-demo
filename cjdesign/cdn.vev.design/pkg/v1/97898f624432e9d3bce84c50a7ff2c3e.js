(()=>{(window.vevr||(window.vevr=[])).push(function(eC,Ud,Ji){Ud.register("DFkMApDq9I",["react","vev"],function(Ls){"use strict";var Hr,An,qn,jr,hr,Ga,Pn;return{setters:[function(fi){Hr=fi.useRef,An=fi.useState,qn=fi.useEffect,jr=fi.useCallback,hr=fi.Fragment},function(fi){Ga=fi.useEditorState,Pn=fi.useSize}],execute:function(){Ls("threeModel",pA);var fi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ls(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function Ki(r,i){return i={exports:{}},r(i,i.exports),i.exports}var za=Ki(function(r,i){(function(n,l){l(i)})(fi,function(n){function l(ae,v){ae.prototype=Object.create(v.prototype),ae.prototype.constructor=ae,ae.__proto__=v}function u(ae){if(ae===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ae}/*!
 * GSAP 3.8.0
 * https://greensock.com
 *
 * @license Copyright 2008-2021, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var h={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},p={duration:.5,overwrite:!1,delay:0},g,_=1e8,b=1/_,A=Math.PI*2,S=A/4,R=0,E=Math.sqrt,N=Math.cos,W=Math.sin,V=function(v){return typeof v=="string"},B=function(v){return typeof v=="function"},O=function(v){return typeof v=="number"},pe=function(v){return typeof v>"u"},ge=function(v){return typeof v=="object"},ye=function(v){return v!==!1},Q=function(){return typeof window<"u"},Ie=function(v){return B(v)||V(v)},tt=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},qe=Array.isArray,ht=/(?:-?\.?\d|\.)+/gi,Ye=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Ne=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,Ue=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,Le=/[+-]=-?[.\d]+/,Te=/[^,'"\[\]\s]+/gi,Ve=/[\d.+\-=]+(?:e[-+]\d*)*/i,We,rt,Tt,nt,Et={},$t={},Yt,K=function(v){return($t=cn(v,Et))&&Ia},H=function(v,x){return console.warn("Invalid property",v,"set to",x,"Missing plugin? gsap.registerPlugin()")},xe=function(v,x){return!x&&console.warn(v)},te=function(v,x){return v&&(Et[v]=x)&&$t&&($t[v]=x)||Et},de=function(){return 0},be={},Re=[],we={},Se,Pe={},ze={},Ze=30,Xe=[],$="",j=function(v){var x=v[0],T,L;if(ge(x)||B(x)||(v=[v]),!(T=(x._gsap||{}).harness)){for(L=Xe.length;L--&&!Xe[L].targetTest(x););T=Xe[L]}for(L=v.length;L--;)v[L]&&(v[L]._gsap||(v[L]._gsap=new Qc(v[L],T)))||v.splice(L,1);return v},He=function(v){return v._gsap||j(_r(v))[0]._gsap},Ge=function(v,x,T){return(T=v[x])&&B(T)?v[x]():pe(T)&&v.getAttribute&&v.getAttribute(x)||T},ue=function(v,x){return(v=v.split(",")).forEach(x)||v},Je=function(v){return Math.round(v*1e5)/1e5||0},lt=function(v){return Math.round(v*1e7)/1e7||0},Nt=function(v,x){for(var T=x.length,L=0;v.indexOf(x[L])<0&&++L<T;);return L<T},ct=function(){var v=Re.length,x=Re.slice(0),T,L;for(we={},Re.length=0,T=0;T<v;T++)L=x[T],L&&L._lazy&&(L.render(L._lazy[0],L._lazy[1],!0)._lazy=0)},me=function(v,x,T,L){Re.length&&ct(),v.render(x,T,L),Re.length&&ct()},it=function(v){var x=parseFloat(v);return(x||x===0)&&(v+"").match(Te).length<2?x:V(v)?v.trim():v},Lt=function(v){return v},pt=function(v,x){for(var T in x)T in v||(v[T]=x[T]);return v},Dt=function(v,x){for(var T in x)T in v||T==="duration"||T==="ease"||(v[T]=x[T])},cn=function(v,x){for(var T in x)v[T]=x[T];return v},pi=function ae(v,x){for(var T in x)T!=="__proto__"&&T!=="constructor"&&T!=="prototype"&&(v[T]=ge(x[T])?ae(v[T]||(v[T]={}),x[T]):x[T]);return v},Rr=function(v,x){var T={},L;for(L in v)L in x||(T[L]=v[L]);return T},$i=function(v){var x=v.parent||We,T=v.keyframes?Dt:pt;if(ye(v.inherit))for(;x;)T(v,x.vars.defaults),x=x.parent||x._dp;return v},Br=function(v,x){for(var T=v.length,L=T===x.length;L&&T--&&v[T]===x[T];);return T<0},Vs=function(v,x,T,L,U){T===void 0&&(T="_first"),L===void 0&&(L="_last");var z=v[L],k;if(U)for(k=x[U];z&&z[U]>k;)z=z._prev;return z?(x._next=z._next,z._next=x):(x._next=v[T],v[T]=x),x._next?x._next._prev=x:v[L]=x,x._prev=z,x.parent=x._dp=v,x},ua=function(v,x,T,L){T===void 0&&(T="_first"),L===void 0&&(L="_last");var U=x._prev,z=x._next;U?U._next=z:v[T]===x&&(v[T]=z),z?z._prev=U:v[L]===x&&(v[L]=U),x._next=x._prev=x.parent=null},qi=function(v,x){v.parent&&(!x||v.parent.autoRemoveChildren)&&v.parent.remove(v),v._act=0},Ri=function(v,x){if(v&&(!x||x._end>v._dur||x._start<0))for(var T=v;T;)T._dirty=1,T=T.parent;return v},Ja=function(v){for(var x=v.parent;x&&x.parent;)x._dirty=1,x.totalDuration(),x=x.parent;return v},ha=function ae(v){return!v||v._ts&&ae(v.parent)},gs=function(v){return v._repeat?dr(v._tTime,v=v.duration()+v._rDelay)*v:0},dr=function(v,x){var T=Math.floor(v/=x);return v&&T===v?T-1:T},fa=function(v,x){return(v-x._start)*x._ts+(x._ts>=0?0:x._dirty?x.totalDuration():x._tDur)},ba=function(v){return v._end=lt(v._start+(v._tDur/Math.abs(v._ts||v._rts||b)||0))},Ka=function(v,x){var T=v._dp;return T&&T.smoothChildTiming&&v._ts&&(v._start=lt(T._time-(v._ts>0?x/v._ts:((v._dirty?v.totalDuration():v._tDur)-x)/-v._ts)),ba(v),T._dirty||Ri(T,v)),v},re=function(v,x){var T;if((x._time||x._initted&&!x._dur)&&(T=fa(v.rawTime(),x),(!x._dur||ii(0,x.totalDuration(),T)-x._tTime>b)&&x.render(T,!0)),Ri(v,x)._dp&&v._initted&&v._time>=v._dur&&v._ts){if(v._dur<v.duration())for(T=v;T._dp;)T.rawTime()>=0&&T.totalTime(T._tTime),T=T._dp;v._zTime=-b}},Qe=function(v,x,T,L){return x.parent&&qi(x),x._start=lt((O(T)?T:T||v!==We?nn(v,T,x):v._time)+x._delay),x._end=lt(x._start+(x.totalDuration()/Math.abs(x.timeScale())||0)),Vs(v,x,"_first","_last",v._sort?"_start":0),Tn(x)||(v._recent=x),L||re(v,x),v},Ke=function(v,x){return(Et.ScrollTrigger||H("scrollTrigger",x))&&Et.ScrollTrigger.create(x,v)},ut=function(v,x,T,L){if(ml(v,x),!v._initted)return 1;if(!T&&v._pt&&(v._dur&&v.vars.lazy!==!1||!v._dur&&v.vars.lazy)&&Se!==Ma.frame)return Re.push(v),v._lazy=[x,L],1},Ft=function ae(v){var x=v.parent;return x&&x._ts&&x._initted&&!x._lock&&(x.rawTime()<0||ae(x))},Tn=function(v){var x=v.data;return x==="isFromStart"||x==="isStart"},Ln=function(v,x,T,L){var U=v.ratio,z=x<0||!x&&(!v._start&&Ft(v)&&!(!v._initted&&Tn(v))||(v._ts<0||v._dp._ts<0)&&!Tn(v))?0:1,k=v._rDelay,le=0,ve,fe,je;if(k&&v._repeat&&(le=ii(0,v._tDur,x),fe=dr(le,k),je=dr(v._tTime,k),v._yoyo&&fe&1&&(z=1-z),fe!==je&&(U=1-z,v.vars.repeatRefresh&&v._initted&&v.invalidate())),z!==U||L||v._zTime===b||!x&&v._zTime){if(!v._initted&&ut(v,x,L,T))return;for(je=v._zTime,v._zTime=x||(T?b:0),T||(T=x&&!je),v.ratio=z,v._from&&(z=1-z),v._time=0,v._tTime=le,ve=v._pt;ve;)ve.r(z,ve.d),ve=ve._next;v._startAt&&x<0&&v._startAt.render(x,!0,!0),v._onUpdate&&!T&&wa(v,"onUpdate"),le&&v._repeat&&!T&&v.parent&&wa(v,"onRepeat"),(x>=v._tDur||x<0)&&v.ratio===z&&(z&&qi(v,1),T||(wa(v,z?"onComplete":"onReverseComplete",!0),v._prom&&v._prom()))}else v._zTime||(v._zTime=x)},Vn=function(v,x,T){var L;if(T>x)for(L=v._first;L&&L._start<=T;){if(!L._dur&&L.data==="isPause"&&L._start>x)return L;L=L._next}else for(L=v._last;L&&L._start>=T;){if(!L._dur&&L.data==="isPause"&&L._start<x)return L;L=L._prev}},wn=function(v,x,T,L){var U=v._repeat,z=lt(x)||0,k=v._tTime/v._tDur;return k&&!L&&(v._time*=z/v._dur),v._dur=z,v._tDur=U?U<0?1e10:lt(z*(U+1)+v._rDelay*U):z,k&&!L?Ka(v,v._tTime=v._tDur*k):v.parent&&ba(v),T||Ri(v.parent,v),v},Xi=function(v){return v instanceof Gr?Ri(v):wn(v,v._dur)},Yi={_start:0,endTime:de,totalDuration:de},nn=function ae(v,x,T){var L=v.labels,U=v._recent||Yi,z=v.duration()>=_?U.endTime(!1):v._dur,k,le,ve;return V(x)&&(isNaN(x)||x in L)?(le=x.charAt(0),ve=x.substr(-1)==="%",k=x.indexOf("="),le==="<"||le===">"?(k>=0&&(x=x.replace(/=/,"")),(le==="<"?U._start:U.endTime(U._repeat>=0))+(parseFloat(x.substr(1))||0)*(ve?(k<0?U:T).totalDuration()/100:1)):k<0?(x in L||(L[x]=z),L[x]):(le=parseFloat(x.charAt(k-1)+x.substr(k+1)),ve&&T&&(le=le/100*(qe(T)?T[0]:T).totalDuration()),k>1?ae(v,x.substr(0,k-1),T)+le:z+le)):x==null?z:+x},ni=function(v,x,T){var L=O(x[1]),U=(L?2:1)+(v<2?0:1),z=x[U],k,le;if(L&&(z.duration=x[1]),z.parent=T,v){for(k=z,le=T;le&&!("immediateRender"in k);)k=le.vars.defaults||{},le=ye(le.vars.inherit)&&le.parent;z.immediateRender=ye(k.immediateRender),v<2?z.runBackwards=1:z.startAt=x[U-1]}return new zi(x[0],z,x[U+1])},yr=function(v,x){return v||v===0?x(v):x},ii=function(v,x,T){return T<v?v:T>x?x:T},er=function(v){if(typeof v!="string")return"";var x=Ve.exec(v);return x?v.substr(x.index+x[0].length):""},or=function(v,x,T){return yr(T,function(L){return ii(v,x,L)})},Ws=[].slice,Sr=function(v,x){return v&&ge(v)&&"length"in v&&(!x&&!v.length||v.length-1 in v&&ge(v[0]))&&!v.nodeType&&v!==rt},qs=function(v,x,T){return T===void 0&&(T=[]),v.forEach(function(L){var U;return V(L)&&!x||Sr(L,1)?(U=T).push.apply(U,_r(L)):T.push(L)})||T},_r=function(v,x,T){return V(v)&&!T&&(Tt||!fl())?Ws.call((x||nt).querySelectorAll(v),0):qe(v)?qs(v,T):Sr(v)?Ws.call(v,0):v?[v]:[]},Xs=function(v){return v=_r(v)[0]||xe("Invalid scope")||{},function(x){var T=v.current||v.nativeElement||v;return _r(x,T.querySelectorAll?T:T===v?xe("Invalid scope")||nt.createElement("div"):v)}},gh=function(v){return v.sort(function(){return .5-Math.random()})},zf=function(v){if(B(v))return v;var x=ge(v)?v:{each:v},T=js(x.ease),L=x.from||0,U=parseFloat(x.base)||0,z={},k=L>0&&L<1,le=isNaN(L)||k,ve=x.axis,fe=L,je=L;return V(L)?fe=je={center:.5,edges:.5,end:1}[L]||0:!k&&le&&(fe=L[0],je=L[1]),function(ke,Ae,vt){var Fe=(vt||x).length,yt=z[Fe],wt,Ut,Pt,Xt,Ct,It,kt,jt,Gt;if(!yt){if(Gt=x.grid==="auto"?0:(x.grid||[1,_])[1],!Gt){for(kt=-_;kt<(kt=vt[Gt++].getBoundingClientRect().left)&&Gt<Fe;);Gt--}for(yt=z[Fe]=[],wt=le?Math.min(Gt,Fe)*fe-.5:L%Gt,Ut=le?Fe*je/Gt-.5:L/Gt|0,kt=0,jt=_,It=0;It<Fe;It++)Pt=It%Gt-wt,Xt=Ut-(It/Gt|0),yt[It]=Ct=ve?Math.abs(ve==="y"?Xt:Pt):E(Pt*Pt+Xt*Xt),Ct>kt&&(kt=Ct),Ct<jt&&(jt=Ct);L==="random"&&gh(yt),yt.max=kt-jt,yt.min=jt,yt.v=Fe=(parseFloat(x.amount)||parseFloat(x.each)*(Gt>Fe?Fe-1:ve?ve==="y"?Fe/Gt:Gt:Math.max(Gt,Fe/Gt))||0)*(L==="edges"?-1:1),yt.b=Fe<0?U-Fe:U,yt.u=er(x.amount||x.each)||0,T=T&&Fe<0?Lo(T):T}return Fe=(yt[ke]-yt.min)/yt.max||0,lt(yt.b+(T?T(Fe):Fe)*yt.v)+yt.u}},vh=function(v){var x=Math.pow(10,((v+"").split(".")[1]||"").length);return function(T){var L=Math.round(parseFloat(T)/v)*v*x;return(L-L%1)/x+(O(T)?0:er(T))}},Hf=function(v,x){var T=qe(v),L,U;return!T&&ge(v)&&(L=T=v.radius||_,v.values?(v=_r(v.values),(U=!O(v[0]))&&(L*=L)):v=vh(v.increment)),yr(x,T?B(v)?function(z){return U=v(z),Math.abs(U-z)<=L?U:z}:function(z){for(var k=parseFloat(U?z.x:z),le=parseFloat(U?z.y:0),ve=_,fe=0,je=v.length,ke,Ae;je--;)U?(ke=v[je].x-k,Ae=v[je].y-le,ke=ke*ke+Ae*Ae):ke=Math.abs(v[je]-k),ke<ve&&(ve=ke,fe=je);return fe=!L||ve<=L?v[fe]:z,U||fe===z||O(z)?fe:fe+er(z)}:vh(v))},kf=function(v,x,T,L){return yr(qe(v)?!x:T===!0?!!(T=0):!L,function(){return qe(v)?v[~~(Math.random()*v.length)]:(T=T||1e-5)&&(L=T<1?Math.pow(10,(T+"").length-2):1)&&Math.floor(Math.round((v-T/2+Math.random()*(x-v+T*.99))/T)*T*L)/L})},Up=function(){for(var v=arguments.length,x=new Array(v),T=0;T<v;T++)x[T]=arguments[T];return function(L){return x.reduce(function(U,z){return z(U)},L)}},Gp=function(v,x){return function(T){return v(parseFloat(T))+(x||er(T))}},zp=function(v,x,T){return Wf(v,x,0,1,T)},Vf=function(v,x,T){return yr(T,function(L){return v[~~x(L)]})},Hp=function ae(v,x,T){var L=x-v;return qe(v)?Vf(v,ae(0,v.length),x):yr(T,function(U){return(L+(U-v)%L)%L+v})},kp=function ae(v,x,T){var L=x-v,U=L*2;return qe(v)?Vf(v,ae(0,v.length-1),x):yr(T,function(z){return z=(U+(z-v)%U)%U||0,v+(z>L?U-z:z)})},ac=function(v){for(var x=0,T="",L,U,z,k;~(L=v.indexOf("random(",x));)z=v.indexOf(")",L),k=v.charAt(L+7)==="[",U=v.substr(L+7,z-L-7).match(k?Te:ht),T+=v.substr(x,L-x)+kf(k?U:+U[0],k?0:+U[1],+U[2]||1e-5),x=z+1;return T+v.substr(x,v.length-x)},Wf=function(v,x,T,L,U){var z=x-v,k=L-T;return yr(U,function(le){return T+((le-v)/z*k||0)})},Vp=function ae(v,x,T,L){var U=isNaN(v+x)?0:function(Ae){return(1-Ae)*v+Ae*x};if(!U){var z=V(v),k={},le,ve,fe,je,ke;if(T===!0&&(L=1)&&(T=null),z)v={p:v},x={p:x};else if(qe(v)&&!qe(x)){for(fe=[],je=v.length,ke=je-2,ve=1;ve<je;ve++)fe.push(ae(v[ve-1],v[ve]));je--,U=function(vt){vt*=je;var Fe=Math.min(ke,~~vt);return fe[Fe](vt-Fe)},T=x}else L||(v=cn(qe(v)?[]:{},v));if(!fe){for(le in x)$c.call(k,v,le,"get",x[le]);U=function(vt){return Qt(vt,k)||(z?v.p:v)}}}return yr(T,U)},qf=function(v,x,T){var L=v.labels,U=_,z,k,le;for(z in L)k=L[z]-x,k<0==!!T&&k&&U>(k=Math.abs(k))&&(le=z,U=k);return le},wa=function(v,x,T){var L=v.vars,U=L[x],z,k;if(!!U)return z=L[x+"Params"],k=L.callbackScope||v,T&&Re.length&&ct(),z?U.apply(k,z):U.call(k)},sc=function(v){return qi(v),v.scrollTrigger&&v.scrollTrigger.kill(!1),v.progress()<1&&wa(v,"onInterrupt"),v},hl,Wp=function(v){v=!v.name&&v.default||v;var x=v.name,T=B(v),L=x&&!T&&v.init?function(){this._props=[]}:v,U={init:de,render:Qt,add:$c,kill:_t,modifier:uc,rawVars:0},z={targetTest:0,get:0,getSetter:cc,aliases:{},register:0};if(fl(),v!==L){if(Pe[x])return;pt(L,pt(Rr(v,U),z)),cn(L.prototype,cn(U,Rr(v,z))),Pe[L.prop=x]=L,v.targetTest&&(Xe.push(L),be[x]=1),x=(x==="css"?"CSS":x.charAt(0).toUpperCase()+x.substr(1))+"Plugin"}te(x,L),v.register&&v.register(Ia,L,pr)},Si=255,oc={aqua:[0,Si,Si],lime:[0,Si,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Si],navy:[0,0,128],white:[Si,Si,Si],olive:[128,128,0],yellow:[Si,Si,0],orange:[Si,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Si,0,0],pink:[Si,192,203],cyan:[0,Si,Si],transparent:[Si,Si,Si,0]},yh=function(v,x,T){return v=v<0?v+1:v>1?v-1:v,(v*6<1?x+(T-x)*v*6:v<.5?T:v*3<2?x+(T-x)*(2/3-v)*6:x)*Si+.5|0},Xf=function(v,x,T){var L=v?O(v)?[v>>16,v>>8&Si,v&Si]:0:oc.black,U,z,k,le,ve,fe,je,ke,Ae,vt;if(!L){if(v.substr(-1)===","&&(v=v.substr(0,v.length-1)),oc[v])L=oc[v];else if(v.charAt(0)==="#"){if(v.length<6&&(U=v.charAt(1),z=v.charAt(2),k=v.charAt(3),v="#"+U+U+z+z+k+k+(v.length===5?v.charAt(4)+v.charAt(4):"")),v.length===9)return L=parseInt(v.substr(1,6),16),[L>>16,L>>8&Si,L&Si,parseInt(v.substr(7),16)/255];v=parseInt(v.substr(1),16),L=[v>>16,v>>8&Si,v&Si]}else if(v.substr(0,3)==="hsl"){if(L=vt=v.match(ht),!x)le=+L[0]%360/360,ve=+L[1]/100,fe=+L[2]/100,z=fe<=.5?fe*(ve+1):fe+ve-fe*ve,U=fe*2-z,L.length>3&&(L[3]*=1),L[0]=yh(le+1/3,U,z),L[1]=yh(le,U,z),L[2]=yh(le-1/3,U,z);else if(~v.indexOf("="))return L=v.match(Ye),T&&L.length<4&&(L[3]=1),L}else L=v.match(ht)||oc.transparent;L=L.map(Number)}return x&&!vt&&(U=L[0]/Si,z=L[1]/Si,k=L[2]/Si,je=Math.max(U,z,k),ke=Math.min(U,z,k),fe=(je+ke)/2,je===ke?le=ve=0:(Ae=je-ke,ve=fe>.5?Ae/(2-je-ke):Ae/(je+ke),le=je===U?(z-k)/Ae+(z<k?6:0):je===z?(k-U)/Ae+2:(U-z)/Ae+4,le*=60),L[0]=~~(le+.5),L[1]=~~(ve*100+.5),L[2]=~~(fe*100+.5)),T&&L.length<4&&(L[3]=1),L},Yf=function(v){var x=[],T=[],L=-1;return v.split(Ys).forEach(function(U){var z=U.match(Ne)||[];x.push.apply(x,z),T.push(L+=z.length+1)}),x.c=T,x},jf=function(v,x,T){var L="",U=(v+L).match(Ys),z=x?"hsla(":"rgba(",k=0,le,ve,fe,je;if(!U)return v;if(U=U.map(function(ke){return(ke=Xf(ke,x,1))&&z+(x?ke[0]+","+ke[1]+"%,"+ke[2]+"%,"+ke[3]:ke.join(","))+")"}),T&&(fe=Yf(v),le=T.c,le.join(L)!==fe.c.join(L)))for(ve=v.replace(Ys,"1").split(Ne),je=ve.length-1;k<je;k++)L+=ve[k]+(~le.indexOf(k)?U.shift()||z+"0,0,0,0)":(fe.length?fe:U.length?U:T).shift());if(!ve)for(ve=v.split(Ys),je=ve.length-1;k<je;k++)L+=ve[k]+U[k];return L+ve[je]},Ys=function(){var ae="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",v;for(v in oc)ae+="|"+v+"\\b";return new RegExp(ae+")","gi")}(),qp=/hsl[a]?\(/,Zf=function(v){var x=v.join(" "),T;if(Ys.lastIndex=0,Ys.test(x))return T=qp.test(x),v[1]=jf(v[1],T),v[0]=jf(v[0],T,Yf(v[1])),!0},Zc,Ma=function(){var ae=Date.now,v=500,x=33,T=ae(),L=T,U=1e3/240,z=U,k=[],le,ve,fe,je,ke,Ae,vt=function Fe(yt){var wt=ae()-L,Ut=yt===!0,Pt,Xt,Ct,It;if(wt>v&&(T+=wt-x),L+=wt,Ct=L-T,Pt=Ct-z,(Pt>0||Ut)&&(It=++je.frame,ke=Ct-je.time*1e3,je.time=Ct=Ct/1e3,z+=Pt+(Pt>=U?4:U-Pt),Xt=1),Ut||(le=ve(Fe)),Xt)for(Ae=0;Ae<k.length;Ae++)k[Ae](Ct,ke,It,yt)};return je={time:0,frame:0,tick:function(){vt(!0)},deltaRatio:function(yt){return ke/(1e3/(yt||60))},wake:function(){Yt&&(!Tt&&Q()&&(rt=Tt=window,nt=rt.document||{},Et.gsap=Ia,(rt.gsapVersions||(rt.gsapVersions=[])).push(Ia.version),K($t||rt.GreenSockGlobals||!rt.gsap&&rt||{}),fe=rt.requestAnimationFrame),le&&je.sleep(),ve=fe||function(yt){return setTimeout(yt,z-je.time*1e3+1|0)},Zc=1,vt(2))},sleep:function(){(fe?rt.cancelAnimationFrame:clearTimeout)(le),Zc=0,ve=de},lagSmoothing:function(yt,wt){v=yt||1/b,x=Math.min(wt,v,0)},fps:function(yt){U=1e3/(yt||240),z=je.time*1e3+U},add:function(yt){k.indexOf(yt)<0&&k.push(yt),fl()},remove:function(yt){var wt;~(wt=k.indexOf(yt))&&k.splice(wt,1)&&Ae>=wt&&Ae--},_listeners:k},je}(),fl=function(){return!Zc&&Ma.wake()},$n={},Xp=/^[\d.\-M][\d.\-,\s]/,Jc=/["']/g,Kc=function(v){for(var x={},T=v.substr(1,v.length-3).split(":"),L=T[0],U=1,z=T.length,k,le,ve;U<z;U++)le=T[U],k=U!==z-1?le.lastIndexOf(","):le.length,ve=le.substr(0,k),x[L]=isNaN(ve)?ve.replace(Jc,"").trim():+ve,L=le.substr(k+1).trim();return x},_h=function(v){var x=v.indexOf("(")+1,T=v.indexOf(")"),L=v.indexOf("(",x);return v.substring(x,~L&&L<T?v.indexOf(")",T+1):T)},dl=function(v){var x=(v+"").split("("),T=$n[x[0]];return T&&x.length>1&&T.config?T.config.apply(null,~v.indexOf("{")?[Kc(x[1])]:_h(v).split(",").map(it)):$n._CE&&Xp.test(v)?$n._CE("",v):T},Lo=function(v){return function(x){return 1-v(1-x)}},lc=function ae(v,x){for(var T=v._first,L;T;)T instanceof Gr?ae(T,x):T.vars.yoyoEase&&(!T._yoyo||!T._repeat)&&T._yoyo!==x&&(T.timeline?ae(T.timeline,x):(L=T._ease,T._ease=T._yEase,T._yEase=L,T._yoyo=x)),T=T._next},js=function(v,x){return v&&(B(v)?v:$n[v]||dl(v))||x},Zs=function(v,x,T,L){T===void 0&&(T=function(le){return 1-x(1-le)}),L===void 0&&(L=function(le){return le<.5?x(le*2)/2:1-x((1-le)*2)/2});var U={easeIn:x,easeOut:T,easeInOut:L},z;return ue(v,function(k){$n[k]=Et[k]=U,$n[z=k.toLowerCase()]=T;for(var le in U)$n[z+(le==="easeIn"?".in":le==="easeOut"?".out":".inOut")]=$n[k+"."+le]=U[le]}),U},Jf=function(v){return function(x){return x<.5?(1-v(1-x*2))/2:.5+v((x-.5)*2)/2}},Ur=function ae(v,x,T){var L=x>=1?x:1,U=(T||(v?.3:.45))/(x<1?x:1),z=U/A*(Math.asin(1/L)||0),k=function(fe){return fe===1?1:L*Math.pow(2,-10*fe)*W((fe-z)*U)+1},le=v==="out"?k:v==="in"?function(ve){return 1-k(1-ve)}:Jf(k);return U=A/U,le.config=function(ve,fe){return ae(v,ve,fe)},le},pl=function ae(v,x){x===void 0&&(x=1.70158);var T=function(z){return z?--z*z*((x+1)*z+x)+1:0},L=v==="out"?T:v==="in"?function(U){return 1-T(1-U)}:Jf(T);return L.config=function(U){return ae(v,U)},L};ue("Linear,Quad,Cubic,Quart,Quint,Strong",function(ae,v){var x=v<5?v+1:v;Zs(ae+",Power"+(x-1),v?function(T){return Math.pow(T,x)}:function(T){return T},function(T){return 1-Math.pow(1-T,x)},function(T){return T<.5?Math.pow(T*2,x)/2:1-Math.pow((1-T)*2,x)/2})}),$n.Linear.easeNone=$n.none=$n.Linear.easeIn,Zs("Elastic",Ur("in"),Ur("out"),Ur()),function(ae,v){var x=1/v,T=2*x,L=2.5*x,U=function(k){return k<x?ae*k*k:k<T?ae*Math.pow(k-1.5/v,2)+.75:k<L?ae*(k-=2.25/v)*k+.9375:ae*Math.pow(k-2.625/v,2)+.984375};Zs("Bounce",function(z){return 1-U(1-z)},U)}(7.5625,2.75),Zs("Expo",function(ae){return ae?Math.pow(2,10*(ae-1)):0}),Zs("Circ",function(ae){return-(E(1-ae*ae)-1)}),Zs("Sine",function(ae){return ae===1?1:-N(ae*S)+1}),Zs("Back",pl("in"),pl("out"),pl()),$n.SteppedEase=$n.steps=Et.SteppedEase={config:function(v,x){v===void 0&&(v=1);var T=1/v,L=v+(x?0:1),U=x?1:0,z=1-b;return function(k){return((L*ii(0,z,k)|0)+U)*T}}},p.ease=$n["quad.out"],ue("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(ae){return $+=ae+","+ae+"Params,"});var Qc=function(v,x){this.id=R++,v._gsap=this,this.target=v,this.harness=x,this.get=x?x.get:Ge,this.set=x?x.getSetter:cc},Ro=function(){function ae(x){this.vars=x,this._delay=+x.delay||0,(this._repeat=x.repeat===1/0?-2:x.repeat||0)&&(this._rDelay=x.repeatDelay||0,this._yoyo=!!x.yoyo||!!x.yoyoEase),this._ts=1,wn(this,+x.duration,1,1),this.data=x.data,Zc||Ma.wake()}var v=ae.prototype;return v.delay=function(T){return T||T===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+T-this._delay),this._delay=T,this):this._delay},v.duration=function(T){return arguments.length?this.totalDuration(this._repeat>0?T+(T+this._rDelay)*this._repeat:T):this.totalDuration()&&this._dur},v.totalDuration=function(T){return arguments.length?(this._dirty=0,wn(this,this._repeat<0?T:(T-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},v.totalTime=function(T,L){if(fl(),!arguments.length)return this._tTime;var U=this._dp;if(U&&U.smoothChildTiming&&this._ts){for(Ka(this,T),!U._dp||U.parent||re(U,this);U&&U.parent;)U.parent._time!==U._start+(U._ts>=0?U._tTime/U._ts:(U.totalDuration()-U._tTime)/-U._ts)&&U.totalTime(U._tTime,!0),U=U.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&T<this._tDur||this._ts<0&&T>0||!this._tDur&&!T)&&Qe(this._dp,this,this._start-this._delay)}return(this._tTime!==T||!this._dur&&!L||this._initted&&Math.abs(this._zTime)===b||!T&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=T),me(this,T,L)),this},v.time=function(T,L){return arguments.length?this.totalTime(Math.min(this.totalDuration(),T+gs(this))%(this._dur+this._rDelay)||(T?this._dur:0),L):this._time},v.totalProgress=function(T,L){return arguments.length?this.totalTime(this.totalDuration()*T,L):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.ratio},v.progress=function(T,L){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-T:T)+gs(this),L):this.duration()?Math.min(1,this._time/this._dur):this.ratio},v.iteration=function(T,L){var U=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(T-1)*U,L):this._repeat?dr(this._tTime,U)+1:1},v.timeScale=function(T){if(!arguments.length)return this._rts===-b?0:this._rts;if(this._rts===T)return this;var L=this.parent&&this._ts?fa(this.parent._time,this):this._tTime;return this._rts=+T||0,this._ts=this._ps||T===-b?0:this._rts,Ja(this.totalTime(ii(-this._delay,this._tDur,L),!0)),ba(this),this},v.paused=function(T){return arguments.length?(this._ps!==T&&(this._ps=T,T?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(fl(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==b&&(this._tTime-=b)))),this):this._ps},v.startTime=function(T){if(arguments.length){this._start=T;var L=this.parent||this._dp;return L&&(L._sort||!this.parent)&&Qe(L,this,T-this._delay),this}return this._start},v.endTime=function(T){return this._start+(ye(T)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},v.rawTime=function(T){var L=this.parent||this._dp;return L?T&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?fa(L.rawTime(T),this):this._tTime:this._tTime},v.globalTime=function(T){for(var L=this,U=arguments.length?T:L.rawTime();L;)U=L._start+U/(L._ts||1),L=L._dp;return U},v.repeat=function(T){return arguments.length?(this._repeat=T===1/0?-2:T,Xi(this)):this._repeat===-2?1/0:this._repeat},v.repeatDelay=function(T){if(arguments.length){var L=this._time;return this._rDelay=T,Xi(this),L?this.time(L):this}return this._rDelay},v.yoyo=function(T){return arguments.length?(this._yoyo=T,this):this._yoyo},v.seek=function(T,L){return this.totalTime(nn(this,T),ye(L))},v.restart=function(T,L){return this.play().totalTime(T?-this._delay:0,ye(L))},v.play=function(T,L){return T!=null&&this.seek(T,L),this.reversed(!1).paused(!1)},v.reverse=function(T,L){return T!=null&&this.seek(T||this.totalDuration(),L),this.reversed(!0).paused(!1)},v.pause=function(T,L){return T!=null&&this.seek(T,L),this.paused(!0)},v.resume=function(){return this.paused(!1)},v.reversed=function(T){return arguments.length?(!!T!==this.reversed()&&this.timeScale(-this._rts||(T?-b:0)),this):this._rts<0},v.invalidate=function(){return this._initted=this._act=0,this._zTime=-b,this},v.isActive=function(){var T=this.parent||this._dp,L=this._start,U;return!!(!T||this._ts&&this._initted&&T.isActive()&&(U=T.rawTime(!0))>=L&&U<this.endTime(!0)-b)},v.eventCallback=function(T,L,U){var z=this.vars;return arguments.length>1?(L?(z[T]=L,U&&(z[T+"Params"]=U),T==="onUpdate"&&(this._onUpdate=L)):delete z[T],this):z[T]},v.then=function(T){var L=this;return new Promise(function(U){var z=B(T)?T:Lt,k=function(){var ve=L.then;L.then=null,B(z)&&(z=z(L))&&(z.then||z===L)&&(L.then=ve),U(z),L.then=ve};L._initted&&L.totalProgress()===1&&L._ts>=0||!L._tTime&&L._ts<0?k():L._prom=k})},v.kill=function(){sc(this)},ae}();pt(Ro.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-b,_prom:0,_ps:!1,_rts:1});var Gr=function(ae){l(v,ae);function v(T,L){var U;return T===void 0&&(T={}),U=ae.call(this,T)||this,U.labels={},U.smoothChildTiming=!!T.smoothChildTiming,U.autoRemoveChildren=!!T.autoRemoveChildren,U._sort=ye(T.sortChildren),We&&Qe(T.parent||We,u(U),L),T.reversed&&U.reverse(),T.paused&&U.paused(!0),T.scrollTrigger&&Ke(u(U),T.scrollTrigger),U}var x=v.prototype;return x.to=function(L,U,z){return ni(0,arguments,this),this},x.from=function(L,U,z){return ni(1,arguments,this),this},x.fromTo=function(L,U,z,k){return ni(2,arguments,this),this},x.set=function(L,U,z){return U.duration=0,U.parent=this,$i(U).repeatDelay||(U.repeat=0),U.immediateRender=!!U.immediateRender,new zi(L,U,nn(this,z),1),this},x.call=function(L,U,z){return Qe(this,zi.delayedCall(0,L,U),z)},x.staggerTo=function(L,U,z,k,le,ve,fe){return z.duration=U,z.stagger=z.stagger||k,z.onComplete=ve,z.onCompleteParams=fe,z.parent=this,new zi(L,z,nn(this,le)),this},x.staggerFrom=function(L,U,z,k,le,ve,fe){return z.runBackwards=1,$i(z).immediateRender=ye(z.immediateRender),this.staggerTo(L,U,z,k,le,ve,fe)},x.staggerFromTo=function(L,U,z,k,le,ve,fe,je){return k.startAt=z,$i(k).immediateRender=ye(k.immediateRender),this.staggerTo(L,U,k,le,ve,fe,je)},x.render=function(L,U,z){var k=this._time,le=this._dirty?this.totalDuration():this._tDur,ve=this._dur,fe=L<=0?0:lt(L),je=this._zTime<0!=L<0&&(this._initted||!ve),ke,Ae,vt,Fe,yt,wt,Ut,Pt,Xt,Ct,It,kt;if(this!==We&&fe>le&&L>=0&&(fe=le),fe!==this._tTime||z||je){if(k!==this._time&&ve&&(fe+=this._time-k,L+=this._time-k),ke=fe,Xt=this._start,Pt=this._ts,wt=!Pt,je&&(ve||(k=this._zTime),(L||!U)&&(this._zTime=L)),this._repeat){if(It=this._yoyo,yt=ve+this._rDelay,this._repeat<-1&&L<0)return this.totalTime(yt*100+L,U,z);if(ke=lt(fe%yt),fe===le?(Fe=this._repeat,ke=ve):(Fe=~~(fe/yt),Fe&&Fe===fe/yt&&(ke=ve,Fe--),ke>ve&&(ke=ve)),Ct=dr(this._tTime,yt),!k&&this._tTime&&Ct!==Fe&&(Ct=Fe),It&&Fe&1&&(ke=ve-ke,kt=1),Fe!==Ct&&!this._lock){var jt=It&&Ct&1,Gt=jt===(It&&Fe&1);if(Fe<Ct&&(jt=!jt),k=jt?0:ve,this._lock=1,this.render(k||(kt?0:lt(Fe*yt)),U,!ve)._lock=0,this._tTime=fe,!U&&this.parent&&wa(this,"onRepeat"),this.vars.repeatRefresh&&!kt&&(this.invalidate()._lock=1),k&&k!==this._time||wt!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(ve=this._dur,le=this._tDur,Gt&&(this._lock=2,k=jt?ve:-1e-4,this.render(k,!0),this.vars.repeatRefresh&&!kt&&this.invalidate()),this._lock=0,!this._ts&&!wt)return this;lc(this,kt)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(Ut=Vn(this,lt(k),lt(ke)),Ut&&(fe-=ke-(ke=Ut._start))),this._tTime=fe,this._time=ke,this._act=!Pt,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=L,k=0),!k&&ke&&!U&&(wa(this,"onStart"),this._tTime!==fe))return this;if(ke>=k&&L>=0)for(Ae=this._first;Ae;){if(vt=Ae._next,(Ae._act||ke>=Ae._start)&&Ae._ts&&Ut!==Ae){if(Ae.parent!==this)return this.render(L,U,z);if(Ae.render(Ae._ts>0?(ke-Ae._start)*Ae._ts:(Ae._dirty?Ae.totalDuration():Ae._tDur)+(ke-Ae._start)*Ae._ts,U,z),ke!==this._time||!this._ts&&!wt){Ut=0,vt&&(fe+=this._zTime=-b);break}}Ae=vt}else{Ae=this._last;for(var Yn=L<0?L:ke;Ae;){if(vt=Ae._prev,(Ae._act||Yn<=Ae._end)&&Ae._ts&&Ut!==Ae){if(Ae.parent!==this)return this.render(L,U,z);if(Ae.render(Ae._ts>0?(Yn-Ae._start)*Ae._ts:(Ae._dirty?Ae.totalDuration():Ae._tDur)+(Yn-Ae._start)*Ae._ts,U,z),ke!==this._time||!this._ts&&!wt){Ut=0,vt&&(fe+=this._zTime=Yn?-b:b);break}}Ae=vt}}if(Ut&&!U&&(this.pause(),Ut.render(ke>=k?0:-b)._zTime=ke>=k?1:-1,this._ts))return this._start=Xt,ba(this),this.render(L,U,z);this._onUpdate&&!U&&wa(this,"onUpdate",!0),(fe===le&&le>=this.totalDuration()||!fe&&k)&&(Xt===this._start||Math.abs(Pt)!==Math.abs(this._ts))&&(this._lock||((L||!ve)&&(fe===le&&this._ts>0||!fe&&this._ts<0)&&qi(this,1),!U&&!(L<0&&!k)&&(fe||k||!le)&&(wa(this,fe===le&&L>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(fe<le&&this.timeScale()>0)&&this._prom())))}return this},x.add=function(L,U){var z=this;if(O(U)||(U=nn(this,U,L)),!(L instanceof Ro)){if(qe(L))return L.forEach(function(k){return z.add(k,U)}),this;if(V(L))return this.addLabel(L,U);if(B(L))L=zi.delayedCall(0,L);else return this}return this!==L?Qe(this,L,U):this},x.getChildren=function(L,U,z,k){L===void 0&&(L=!0),U===void 0&&(U=!0),z===void 0&&(z=!0),k===void 0&&(k=-_);for(var le=[],ve=this._first;ve;)ve._start>=k&&(ve instanceof zi?U&&le.push(ve):(z&&le.push(ve),L&&le.push.apply(le,ve.getChildren(!0,U,z)))),ve=ve._next;return le},x.getById=function(L){for(var U=this.getChildren(1,1,1),z=U.length;z--;)if(U[z].vars.id===L)return U[z]},x.remove=function(L){return V(L)?this.removeLabel(L):B(L)?this.killTweensOf(L):(ua(this,L),L===this._recent&&(this._recent=this._last),Ri(this))},x.totalTime=function(L,U){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=lt(Ma.time-(this._ts>0?L/this._ts:(this.totalDuration()-L)/-this._ts))),ae.prototype.totalTime.call(this,L,U),this._forcing=0,this):this._tTime},x.addLabel=function(L,U){return this.labels[L]=nn(this,U),this},x.removeLabel=function(L){return delete this.labels[L],this},x.addPause=function(L,U,z){var k=zi.delayedCall(0,U||de,z);return k.data="isPause",this._hasPause=1,Qe(this,k,nn(this,L))},x.removePause=function(L){var U=this._first;for(L=nn(this,L);U;)U._start===L&&U.data==="isPause"&&qi(U),U=U._next},x.killTweensOf=function(L,U,z){for(var k=this.getTweensOf(L,z),le=k.length;le--;)Js!==k[le]&&k[le].kill(L,U);return this},x.getTweensOf=function(L,U){for(var z=[],k=_r(L),le=this._first,ve=O(U),fe;le;)le instanceof zi?Nt(le._targets,k)&&(ve?(!Js||le._initted&&le._ts)&&le.globalTime(0)<=U&&le.globalTime(le.totalDuration())>U:!U||le.isActive())&&z.push(le):(fe=le.getTweensOf(k,U)).length&&z.push.apply(z,fe),le=le._next;return z},x.tweenTo=function(L,U){U=U||{};var z=this,k=nn(z,L),le=U,ve=le.startAt,fe=le.onStart,je=le.onStartParams,ke=le.immediateRender,Ae,vt=zi.to(z,pt({ease:U.ease||"none",lazy:!1,immediateRender:!1,time:k,overwrite:"auto",duration:U.duration||Math.abs((k-(ve&&"time"in ve?ve.time:z._time))/z.timeScale())||b,onStart:function(){if(z.pause(),!Ae){var yt=U.duration||Math.abs((k-(ve&&"time"in ve?ve.time:z._time))/z.timeScale());vt._dur!==yt&&wn(vt,yt,0,1).render(vt._time,!0,!0),Ae=1}fe&&fe.apply(vt,je||[])}},U));return ke?vt.render(0):vt},x.tweenFromTo=function(L,U,z){return this.tweenTo(U,pt({startAt:{time:nn(this,L)}},z))},x.recent=function(){return this._recent},x.nextLabel=function(L){return L===void 0&&(L=this._time),qf(this,nn(this,L))},x.previousLabel=function(L){return L===void 0&&(L=this._time),qf(this,nn(this,L),1)},x.currentLabel=function(L){return arguments.length?this.seek(L,!0):this.previousLabel(this._time+b)},x.shiftChildren=function(L,U,z){z===void 0&&(z=0);for(var k=this._first,le=this.labels,ve;k;)k._start>=z&&(k._start+=L,k._end+=L),k=k._next;if(U)for(ve in le)le[ve]>=z&&(le[ve]+=L);return Ri(this)},x.invalidate=function(){var L=this._first;for(this._lock=0;L;)L.invalidate(),L=L._next;return ae.prototype.invalidate.call(this)},x.clear=function(L){L===void 0&&(L=!0);for(var U=this._first,z;U;)z=U._next,this.remove(U),U=z;return this._dp&&(this._time=this._tTime=this._pTime=0),L&&(this.labels={}),Ri(this)},x.totalDuration=function(L){var U=0,z=this,k=z._last,le=_,ve,fe,je;if(arguments.length)return z.timeScale((z._repeat<0?z.duration():z.totalDuration())/(z.reversed()?-L:L));if(z._dirty){for(je=z.parent;k;)ve=k._prev,k._dirty&&k.totalDuration(),fe=k._start,fe>le&&z._sort&&k._ts&&!z._lock?(z._lock=1,Qe(z,k,fe-k._delay,1)._lock=0):le=fe,fe<0&&k._ts&&(U-=fe,(!je&&!z._dp||je&&je.smoothChildTiming)&&(z._start+=fe/z._ts,z._time-=fe,z._tTime-=fe),z.shiftChildren(-fe,!1,-1/0),le=0),k._end>U&&k._ts&&(U=k._end),k=ve;wn(z,z===We&&z._time>U?z._time:U,1,1),z._dirty=0}return z._tDur},v.updateRoot=function(L){if(We._ts&&(me(We,fa(L,We)),Se=Ma.frame),Ma.frame>=Ze){Ze+=h.autoSleep||120;var U=We._first;if((!U||!U._ts)&&h.autoSleep&&Ma._listeners.length<2){for(;U&&!U._ts;)U=U._next;U||Ma.sleep()}}},v}(Ro);pt(Gr.prototype,{_lock:0,_hasPause:0,_forcing:0});var Kf=function(v,x,T,L,U,z,k){var le=new pr(this._pt,v,x,0,1,iu,null,U),ve=0,fe=0,je,ke,Ae,vt,Fe,yt,wt,Ut;for(le.b=T,le.e=L,T+="",L+="",(wt=~L.indexOf("random("))&&(L=ac(L)),z&&(Ut=[T,L],z(Ut,v,x),T=Ut[0],L=Ut[1]),ke=T.match(Ue)||[];je=Ue.exec(L);)vt=je[0],Fe=L.substring(ve,je.index),Ae?Ae=(Ae+1)%5:Fe.substr(-5)==="rgba("&&(Ae=1),vt!==ke[fe++]&&(yt=parseFloat(ke[fe-1])||0,le._pt={_next:le._pt,p:Fe||fe===1?Fe:",",s:yt,c:vt.charAt(1)==="="?parseFloat(vt.substr(2))*(vt.charAt(0)==="-"?-1:1):parseFloat(vt)-yt,m:Ae&&Ae<4?Math.round:0},ve=Ue.lastIndex);return le.c=ve<L.length?L.substring(ve,L.length):"",le.fp=k,(Le.test(L)||wt)&&(le.e=0),this._pt=le,le},$c=function(v,x,T,L,U,z,k,le,ve){B(L)&&(L=L(U||0,v,z));var fe=v[x],je=T!=="get"?T:B(fe)?ve?v[x.indexOf("set")||!B(v["get"+x.substr(3)])?x:"get"+x.substr(3)](ve):v[x]():fe,ke=B(fe)?ve?zr:Qa:tu,Ae;if(V(L)&&(~L.indexOf("random(")&&(L=ac(L)),L.charAt(1)==="="&&(Ae=parseFloat(je)+parseFloat(L.substr(2))*(L.charAt(0)==="-"?-1:1)+(er(je)||0),(Ae||Ae===0)&&(L=Ae))),je!==L)return!isNaN(je*L)&&L!==""?(Ae=new pr(this._pt,v,x,+je||0,L-(je||0),typeof fe=="boolean"?jp:Mn,0,ke),ve&&(Ae.fp=ve),k&&Ae.modifier(k,this,v),this._pt=Ae):(!fe&&!(x in v)&&H(x,L),Kf.call(this,v,x,je,L,ke,le||h.stringFilter,ve))},Qf=function(v,x,T,L,U){if(B(v)&&(v=Co(v,U,x,T,L)),!ge(v)||v.style&&v.nodeType||qe(v)||tt(v))return V(v)?Co(v,U,x,T,L):v;var z={},k;for(k in v)z[k]=Co(v[k],U,x,T,L);return z},$f=function(v,x,T,L,U,z){var k,le,ve,fe;if(Pe[v]&&(k=new Pe[v]).init(U,k.rawVars?x[v]:Qf(x[v],L,U,z,T),T,L,z)!==!1&&(T._pt=le=new pr(T._pt,U,v,0,1,k.render,k,0,k.priority),T!==hl))for(ve=T._ptLookup[T._targets.indexOf(U)],fe=k._props.length;fe--;)ve[k._props[fe]]=le;return k},Js,ml=function ae(v,x){var T=v.vars,L=T.ease,U=T.startAt,z=T.immediateRender,k=T.lazy,le=T.onUpdate,ve=T.onUpdateParams,fe=T.callbackScope,je=T.runBackwards,ke=T.yoyoEase,Ae=T.keyframes,vt=T.autoRevert,Fe=v._dur,yt=v._startAt,wt=v._targets,Ut=v.parent,Pt=Ut&&Ut.data==="nested"?Ut.parent._targets:wt,Xt=v._overwrite==="auto"&&!g,Ct=v.timeline,It,kt,jt,Gt,Yn,xi,ji,gr,tr,Fn,Ir,ia,ns;if(Ct&&(!Ae||!L)&&(L="none"),v._ease=js(L,p.ease),v._yEase=ke?Lo(js(ke===!0?L:ke,p.ease)):0,ke&&v._yoyo&&!v._repeat&&(ke=v._yEase,v._yEase=v._ease,v._ease=ke),v._from=!Ct&&!!T.runBackwards,!Ct){if(gr=wt[0]?He(wt[0]).harness:0,ia=gr&&T[gr.prop],It=Rr(T,be),yt&&yt.render(-1,!0).kill(),U)if(qi(v._startAt=zi.set(wt,pt({data:"isStart",overwrite:!1,parent:Ut,immediateRender:!0,lazy:ye(k),startAt:null,delay:0,onUpdate:le,onUpdateParams:ve,callbackScope:fe,stagger:0},U))),x<0&&!z&&!vt&&v._startAt.render(-1,!0),z){if(x>0&&!vt&&(v._startAt=0),Fe&&x<=0){x&&(v._zTime=x);return}}else vt===!1&&(v._startAt=0);else if(je&&Fe){if(yt)!vt&&(v._startAt=0);else if(x&&(z=!1),jt=pt({overwrite:!1,data:"isFromStart",lazy:z&&ye(k),immediateRender:z,stagger:0,parent:Ut},It),ia&&(jt[gr.prop]=ia),qi(v._startAt=zi.set(wt,jt)),x<0&&v._startAt.render(-1,!0),!z)ae(v._startAt,b);else if(!x)return}for(v._pt=0,k=Fe&&ye(k)||k&&!Fe,kt=0;kt<wt.length;kt++){if(Yn=wt[kt],ji=Yn._gsap||j(wt)[kt]._gsap,v._ptLookup[kt]=Fn={},we[ji.id]&&Re.length&&ct(),Ir=Pt===wt?kt:Pt.indexOf(Yn),gr&&(tr=new gr).init(Yn,ia||It,v,Ir,Pt)!==!1&&(v._pt=Gt=new pr(v._pt,Yn,tr.name,0,1,tr.render,tr,0,tr.priority),tr._props.forEach(function(Na){Fn[Na]=Gt}),tr.priority&&(xi=1)),!gr||ia)for(jt in It)Pe[jt]&&(tr=$f(jt,It,v,Ir,Yn,Pt))?tr.priority&&(xi=1):Fn[jt]=Gt=$c.call(v,Yn,jt,"get",It[jt],Ir,Pt,0,T.stringFilter);v._op&&v._op[kt]&&v.kill(Yn,v._op[kt]),Xt&&v._pt&&(Js=v,We.killTweensOf(Yn,Fn,v.globalTime(x)),ns=!v.parent,Js=0),v._pt&&k&&(we[ji.id]=1)}xi&&gl(v),v._onInit&&v._onInit(v)}v._onUpdate=le,v._initted=(!v._op||v._pt)&&!ns},Yp=function(v,x){var T=v[0]?He(v[0]).harness:0,L=T&&T.aliases,U,z,k,le;if(!L)return x;U=cn({},x);for(z in L)if(z in U)for(le=L[z].split(","),k=le.length;k--;)U[le[k]]=U[z];return U},Co=function(v,x,T,L,U){return B(v)?v.call(x,T,L,U):V(v)&&~v.indexOf("random(")?ac(v):v},ed=$+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase",eu=(ed+",id,stagger,delay,duration,paused,scrollTrigger").split(","),zi=function(ae){l(v,ae);function v(T,L,U,z){var k;typeof L=="number"&&(U.duration=L,L=U,U=null),k=ae.call(this,z?L:$i(L))||this;var le=k.vars,ve=le.duration,fe=le.delay,je=le.immediateRender,ke=le.stagger,Ae=le.overwrite,vt=le.keyframes,Fe=le.defaults,yt=le.scrollTrigger,wt=le.yoyoEase,Ut=L.parent||We,Pt=(qe(T)||tt(T)?O(T[0]):"length"in L)?[T]:_r(T),Xt,Ct,It,kt,jt,Gt,Yn,xi;if(k._targets=Pt.length?j(Pt):xe("GSAP target "+T+" not found. https://greensock.com",!h.nullTargetWarn)||[],k._ptLookup=[],k._overwrite=Ae,vt||ke||Ie(ve)||Ie(fe)){if(L=k.vars,Xt=k.timeline=new Gr({data:"nested",defaults:Fe||{}}),Xt.kill(),Xt.parent=Xt._dp=u(k),Xt._start=0,vt)$i(pt(Xt.vars.defaults,{ease:"none"})),ke?Pt.forEach(function(ji,gr){return vt.forEach(function(tr,Fn){return Xt.to(ji,tr,Fn?">":gr*ke)})}):vt.forEach(function(ji){return Xt.to(Pt,ji,">")});else{if(kt=Pt.length,Yn=ke?zf(ke):de,ge(ke))for(jt in ke)~ed.indexOf(jt)&&(xi||(xi={}),xi[jt]=ke[jt]);for(Ct=0;Ct<kt;Ct++){It={};for(jt in L)eu.indexOf(jt)<0&&(It[jt]=L[jt]);It.stagger=0,wt&&(It.yoyoEase=wt),xi&&cn(It,xi),Gt=Pt[Ct],It.duration=+Co(ve,u(k),Ct,Gt,Pt),It.delay=(+Co(fe,u(k),Ct,Gt,Pt)||0)-k._delay,!ke&&kt===1&&It.delay&&(k._delay=fe=It.delay,k._start+=fe,It.delay=0),Xt.to(Gt,It,Yn(Ct,Gt,Pt))}Xt.duration()?ve=fe=0:k.timeline=0}ve||k.duration(ve=Xt.duration())}else k.timeline=0;return Ae===!0&&!g&&(Js=u(k),We.killTweensOf(Pt),Js=0),Qe(Ut,u(k),U),L.reversed&&k.reverse(),L.paused&&k.paused(!0),(je||!ve&&!vt&&k._start===lt(Ut._time)&&ye(je)&&ha(u(k))&&Ut.data!=="nested")&&(k._tTime=-b,k.render(Math.max(0,-fe))),yt&&Ke(u(k),yt),k}var x=v.prototype;return x.render=function(L,U,z){var k=this._time,le=this._tDur,ve=this._dur,fe=L>le-b&&L>=0?le:L<b?0:L,je,ke,Ae,vt,Fe,yt,wt,Ut,Pt;if(!ve)Ln(this,L,U,z);else if(fe!==this._tTime||!L||z||!this._initted&&this._tTime||this._startAt&&this._zTime<0!=L<0){if(je=fe,Ut=this.timeline,this._repeat){if(vt=ve+this._rDelay,this._repeat<-1&&L<0)return this.totalTime(vt*100+L,U,z);if(je=lt(fe%vt),fe===le?(Ae=this._repeat,je=ve):(Ae=~~(fe/vt),Ae&&Ae===fe/vt&&(je=ve,Ae--),je>ve&&(je=ve)),yt=this._yoyo&&Ae&1,yt&&(Pt=this._yEase,je=ve-je),Fe=dr(this._tTime,vt),je===k&&!z&&this._initted)return this;Ae!==Fe&&(Ut&&this._yEase&&lc(Ut,yt),this.vars.repeatRefresh&&!yt&&!this._lock&&(this._lock=z=1,this.render(lt(vt*Ae),!0).invalidate()._lock=0))}if(!this._initted){if(ut(this,L<0?L:je,z,U))return this._tTime=0,this;if(ve!==this._dur)return this.render(L,U,z)}if(this._tTime=fe,this._time=je,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=wt=(Pt||this._ease)(je/ve),this._from&&(this.ratio=wt=1-wt),je&&!k&&!U&&(wa(this,"onStart"),this._tTime!==fe))return this;for(ke=this._pt;ke;)ke.r(wt,ke.d),ke=ke._next;Ut&&Ut.render(L<0?L:!je&&yt?-b:Ut._dur*wt,U,z)||this._startAt&&(this._zTime=L),this._onUpdate&&!U&&(L<0&&this._startAt&&this._startAt.render(L,!0,z),wa(this,"onUpdate")),this._repeat&&Ae!==Fe&&this.vars.onRepeat&&!U&&this.parent&&wa(this,"onRepeat"),(fe===this._tDur||!fe)&&this._tTime===fe&&(L<0&&this._startAt&&!this._onUpdate&&this._startAt.render(L,!0,!0),(L||!ve)&&(fe===this._tDur&&this._ts>0||!fe&&this._ts<0)&&qi(this,1),!U&&!(L<0&&!k)&&(fe||k)&&(wa(this,fe===le?"onComplete":"onReverseComplete",!0),this._prom&&!(fe<le&&this.timeScale()>0)&&this._prom()))}return this},x.targets=function(){return this._targets},x.invalidate=function(){return this._pt=this._op=this._startAt=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(),ae.prototype.invalidate.call(this)},x.kill=function(L,U){if(U===void 0&&(U="all"),!L&&(!U||U==="all"))return this._lazy=this._pt=0,this.parent?sc(this):this;if(this.timeline){var z=this.timeline.totalDuration();return this.timeline.killTweensOf(L,U,Js&&Js.vars.overwrite!==!0)._first||sc(this),this.parent&&z!==this.timeline.totalDuration()&&wn(this,this._dur*this.timeline._tDur/z,0,1),this}var k=this._targets,le=L?_r(L):k,ve=this._ptLookup,fe=this._pt,je,ke,Ae,vt,Fe,yt,wt;if((!U||U==="all")&&Br(k,le))return U==="all"&&(this._pt=0),sc(this);for(je=this._op=this._op||[],U!=="all"&&(V(U)&&(Fe={},ue(U,function(Ut){return Fe[Ut]=1}),U=Fe),U=Yp(k,U)),wt=k.length;wt--;)if(~le.indexOf(k[wt])){ke=ve[wt],U==="all"?(je[wt]=U,vt=ke,Ae={}):(Ae=je[wt]=je[wt]||{},vt=U);for(Fe in vt)yt=ke&&ke[Fe],yt&&((!("kill"in yt.d)||yt.d.kill(Fe)===!0)&&ua(this,yt,"_pt"),delete ke[Fe]),Ae!=="all"&&(Ae[Fe]=1)}return this._initted&&!this._pt&&fe&&sc(this),this},v.to=function(L,U){return new v(L,U,arguments[2])},v.from=function(L,U){return ni(1,arguments)},v.delayedCall=function(L,U,z,k){return new v(U,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:L,onComplete:U,onReverseComplete:U,onCompleteParams:z,onReverseCompleteParams:z,callbackScope:k})},v.fromTo=function(L,U,z){return ni(2,arguments)},v.set=function(L,U){return U.duration=0,U.repeatDelay||(U.repeat=0),new v(L,U)},v.killTweensOf=function(L,U,z){return We.killTweensOf(L,U,z)},v}(Ro);pt(zi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),ue("staggerTo,staggerFrom,staggerFromTo",function(ae){zi[ae]=function(){var v=new Gr,x=Ws.call(arguments,0);return x.splice(ae==="staggerFromTo"?5:4,0,0),v[ae].apply(v,x)}});var tu=function(v,x,T){return v[x]=T},Qa=function(v,x,T){return v[x](T)},zr=function(v,x,T,L){return v[x](L.fp,T)},nu=function(v,x,T){return v.setAttribute(x,T)},cc=function(v,x){return B(v[x])?Qa:pe(v[x])&&v.setAttribute?nu:tu},Mn=function(v,x){return x.set(x.t,x.p,Math.round((x.s+x.c*v)*1e6)/1e6,x)},jp=function(v,x){return x.set(x.t,x.p,!!(x.s+x.c*v),x)},iu=function(v,x){var T=x._pt,L="";if(!v&&x.b)L=x.b;else if(v===1&&x.e)L=x.e;else{for(;T;)L=T.p+(T.m?T.m(T.s+T.c*v):Math.round((T.s+T.c*v)*1e4)/1e4)+L,T=T._next;L+=x.c}x.set(x.t,x.p,L,x)},Qt=function(v,x){for(var T=x._pt;T;)T.r(v,T.d),T=T._next},uc=function(v,x,T,L){for(var U=this._pt,z;U;)z=U._next,U.p===L&&U.modifier(v,x,T),U=z},_t=function(v){for(var x=this._pt,T,L;x;)L=x._next,x.p===v&&!x.op||x.op===v?ua(this,x,"_pt"):x.dep||(T=1),x=L;return!T},ta=function(v,x,T,L){L.mSet(v,x,L.m.call(L.tween,T,L.mt),L)},gl=function(v){for(var x=v._pt,T,L,U,z;x;){for(T=x._next,L=U;L&&L.pr>x.pr;)L=L._next;(x._prev=L?L._prev:z)?x._prev._next=x:U=x,(x._next=L)?L._prev=x:z=x,x=T}v._pt=U},pr=function(){function ae(x,T,L,U,z,k,le,ve,fe){this.t=T,this.s=U,this.c=z,this.p=L,this.r=k||Mn,this.d=le||this,this.set=ve||tu,this.pr=fe||0,this._next=x,x&&(x._prev=this)}var v=ae.prototype;return v.modifier=function(T,L,U){this.mSet=this.mSet||this.set,this.set=ta,this.m=T,this.mt=U,this.tween=L},ae}();ue($+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(ae){return be[ae]=1}),Et.TweenMax=Et.TweenLite=zi,Et.TimelineLite=Et.TimelineMax=Gr,We=new Gr({sortChildren:!1,defaults:p,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),h.stringFilter=Zf;var xh={registerPlugin:function(){for(var v=arguments.length,x=new Array(v),T=0;T<v;T++)x[T]=arguments[T];x.forEach(function(L){return Wp(L)})},timeline:function(v){return new Gr(v)},getTweensOf:function(v,x){return We.getTweensOf(v,x)},getProperty:function(v,x,T,L){V(v)&&(v=_r(v)[0]);var U=He(v||{}).get,z=T?Lt:it;return T==="native"&&(T=""),v&&(x?z((Pe[x]&&Pe[x].get||U)(v,x,T,L)):function(k,le,ve){return z((Pe[k]&&Pe[k].get||U)(v,k,le,ve))})},quickSetter:function(v,x,T){if(v=_r(v),v.length>1){var L=v.map(function(fe){return Ia.quickSetter(fe,x,T)}),U=L.length;return function(fe){for(var je=U;je--;)L[je](fe)}}v=v[0]||{};var z=Pe[x],k=He(v),le=k.harness&&(k.harness.aliases||{})[x]||x,ve=z?function(fe){var je=new z;hl._pt=0,je.init(v,T?fe+T:fe,hl,0,[v]),je.render(1,je),hl._pt&&Qt(1,hl)}:k.set(v,le);return z?ve:function(fe){return ve(v,le,T?fe+T:fe,k,1)}},isTweening:function(v){return We.getTweensOf(v,!0).length>0},defaults:function(v){return v&&v.ease&&(v.ease=js(v.ease,p.ease)),pi(p,v||{})},config:function(v){return pi(h,v||{})},registerEffect:function(v){var x=v.name,T=v.effect,L=v.plugins,U=v.defaults,z=v.extendTimeline;(L||"").split(",").forEach(function(k){return k&&!Pe[k]&&!Et[k]&&xe(x+" effect requires "+k+" plugin.")}),ze[x]=function(k,le,ve){return T(_r(k),pt(le||{},U),ve)},z&&(Gr.prototype[x]=function(k,le,ve){return this.add(ze[x](k,ge(le)?le:(ve=le)&&{},this),ve)})},registerEase:function(v,x){$n[v]=js(x)},parseEase:function(v,x){return arguments.length?js(v,x):$n},getById:function(v){return We.getById(v)},exportRoot:function(v,x){v===void 0&&(v={});var T=new Gr(v),L,U;for(T.smoothChildTiming=ye(v.smoothChildTiming),We.remove(T),T._dp=0,T._time=T._tTime=We._time,L=We._first;L;)U=L._next,(x||!(!L._dur&&L instanceof zi&&L.vars.onComplete===L._targets[0]))&&Qe(T,L,L._start-L._delay),L=U;return Qe(We,T,0),T},utils:{wrap:Hp,wrapYoyo:kp,distribute:zf,random:kf,snap:Hf,normalize:zp,getUnit:er,clamp:or,splitColor:Xf,toArray:_r,selector:Xs,mapRange:Wf,pipe:Up,unitize:Gp,interpolate:Vp,shuffle:gh},install:K,effects:ze,ticker:Ma,updateRoot:Gr.updateRoot,plugins:Pe,globalTimeline:We,core:{PropTween:pr,globals:te,Tween:zi,Timeline:Gr,Animation:Ro,getCache:He,_removeLinkedListItem:ua,suppressOverwrites:function(v){return g=v}}};ue("to,from,fromTo,delayedCall,set,killTweensOf",function(ae){return xh[ae]=zi[ae]}),Ma.add(Gr.updateRoot),hl=xh.to({},{duration:0});var Ti=function(v,x){for(var T=v._pt;T&&T.p!==x&&T.op!==x&&T.fp!==x;)T=T._next;return T},Ei=function(v,x){var T=v._targets,L,U,z;for(L in x)for(U=T.length;U--;)z=v._ptLookup[U][L],z&&(z=z.d)&&(z._pt&&(z=Ti(z,L)),z&&z.modifier&&z.modifier(x[L],v,T[U],L))},na=function(v,x){return{name:v,rawVars:1,init:function(L,U,z){z._onInit=function(k){var le,ve;if(V(U)&&(le={},ue(U,function(fe){return le[fe]=1}),U=le),x){le={};for(ve in U)le[ve]=x(U[ve]);U=le}Ei(k,U)}}}},Ia=xh.registerPlugin({name:"attr",init:function(v,x,T,L,U){var z,k;for(z in x)k=this.add(v,"setAttribute",(v.getAttribute(z)||0)+"",x[z],L,U,0,0,z),k&&(k.op=z),this._props.push(z)}},{name:"endArray",init:function(v,x){for(var T=x.length;T--;)this.add(v,T,v[T]||0,x[T])}},na("roundProps",vh),na("modifiers"),na("snap",Hf))||xh;zi.version=Gr.version=Ia.version="3.8.0",Yt=1,Q()&&fl();var Wr=$n.Power0,ee=$n.Power1,td=$n.Power2,Zp=$n.Power3,vs=$n.Power4,nd=$n.Linear,Ks=$n.Quad,ru=$n.Cubic,id=$n.Quart,hc=$n.Quint,fc=$n.Strong,dc=$n.Elastic,Po=$n.Back,Io=$n.SteppedEase,vl=$n.Bounce,au=$n.Sine,bh=$n.Expo,wh=$n.Circ,Do,Oo,da,$a,Qs,su,No=function(){return typeof window<"u"},ys={},_s=180/Math.PI,Fo=Math.PI/180,es=Math.atan2,Hn=1e8,yl=/([A-Z])/g,ts=/(?:left|right|width|margin|padding|x)/i,Tv=/[\s,\(]\S/,Bo={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},$s=function(v,x){return x.set(x.t,x.p,Math.round((x.s+x.c*v)*1e4)/1e4+x.u,x)},Mh=function(v,x){return x.set(x.t,x.p,v===1?x.e:Math.round((x.s+x.c*v)*1e4)/1e4+x.u,x)},Sa=function(v,x){return x.set(x.t,x.p,v?Math.round((x.s+x.c*v)*1e4)/1e4+x.u:x.b,x)},Sh=function(v,x){var T=x.s+x.c*v;x.set(x.t,x.p,~~(T+(T<0?-.5:.5))+x.u,x)},rd=function(v,x){return x.set(x.t,x.p,v?x.e:x.b,x)},ad=function(v,x){return x.set(x.t,x.p,v!==1?x.b:x.e,x)},sd=function(v,x,T){return v.style[x]=T},Ev=function(v,x,T){return v.style.setProperty(x,T)},Jp=function(v,x,T){return v._gsap[x]=T},pc=function(v,x,T){return v._gsap.scaleX=v._gsap.scaleY=T},eo=function(v,x,T,L,U){var z=v._gsap;z.scaleX=z.scaleY=T,z.renderTransform(U,z)},Th=function(v,x,T,L,U){var z=v._gsap;z[x]=T,z.renderTransform(U,z)},mr="transform",Uo=mr+"Origin",Kp,Eh=function(v,x){var T=Oo.createElementNS?Oo.createElementNS((x||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),v):Oo.createElement(v);return T.style?T:Oo.createElement(v)},xs=function ae(v,x,T){var L=getComputedStyle(v);return L[x]||L.getPropertyValue(x.replace(yl,"-$1").toLowerCase())||L.getPropertyValue(x)||!T&&ae(v,mc(x)||x,1)||""},od="O,Moz,ms,Ms,Webkit".split(","),mc=function(v,x,T){var L=x||Qs,U=L.style,z=5;if(v in U&&!T)return v;for(v=v.charAt(0).toUpperCase()+v.substr(1);z--&&!(od[z]+v in U););return z<0?null:(z===3?"ms":z>=0?od[z]:"")+v},ld=function(){No()&&window.document&&(Do=window,Oo=Do.document,da=Oo.documentElement,Qs=Eh("div")||{style:{}},Eh("div"),mr=mc(mr),Uo=mr+"Origin",Qs.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Kp=!!mc("perspective"),$a=1)},Jt=function ae(v){var x=Eh("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),T=this.parentNode,L=this.nextSibling,U=this.style.cssText,z;if(da.appendChild(x),x.appendChild(this),this.style.display="block",v)try{z=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=ae}catch{}else this._gsapBBox&&(z=this._gsapBBox());return T&&(L?T.insertBefore(this,L):T.appendChild(this)),da.removeChild(x),this.style.cssText=U,z},Ah=function(v,x){for(var T=x.length;T--;)if(v.hasAttribute(x[T]))return v.getAttribute(x[T])},Qp=function(v){var x;try{x=v.getBBox()}catch{x=Jt.call(v,!0)}return x&&(x.width||x.height)||v.getBBox===Jt||(x=Jt.call(v,!0)),x&&!x.width&&!x.x&&!x.y?{x:+Ah(v,["x","cx","x1"])||0,y:+Ah(v,["y","cy","y1"])||0,width:0,height:0}:x},$p=function(v){return!!(v.getCTM&&(!v.parentNode||v.ownerSVGElement)&&Qp(v))},pa=function(v,x){if(x){var T=v.style;x in ys&&x!==Uo&&(x=mr),T.removeProperty?((x.substr(0,2)==="ms"||x.substr(0,6)==="webkit")&&(x="-"+x),T.removeProperty(x.replace(yl,"-$1").toLowerCase())):T.removeAttribute(x)}},Cr=function(v,x,T,L,U,z){var k=new pr(v._pt,x,T,0,1,z?ad:rd);return v._pt=k,k.b=L,k.e=U,v._props.push(T),k},bs={deg:1,rad:1,turn:1},ws=function ae(v,x,T,L){var U=parseFloat(T)||0,z=(T+"").trim().substr((U+"").length)||"px",k=Qs.style,le=ts.test(x),ve=v.tagName.toLowerCase()==="svg",fe=(ve?"client":"offset")+(le?"Width":"Height"),je=100,ke=L==="px",Ae=L==="%",vt,Fe,yt,wt;return L===z||!U||bs[L]||bs[z]?U:(z!=="px"&&!ke&&(U=ae(v,x,T,"px")),wt=v.getCTM&&$p(v),(Ae||z==="%")&&(ys[x]||~x.indexOf("adius"))?(vt=wt?v.getBBox()[le?"width":"height"]:v[fe],Je(Ae?U/vt*je:U/100*vt)):(k[le?"width":"height"]=je+(ke?z:L),Fe=~x.indexOf("adius")||L==="em"&&v.appendChild&&!ve?v:v.parentNode,wt&&(Fe=(v.ownerSVGElement||{}).parentNode),(!Fe||Fe===Oo||!Fe.appendChild)&&(Fe=Oo.body),yt=Fe._gsap,yt&&Ae&&yt.width&&le&&yt.time===Ma.time?Je(U/yt.width*je):((Ae||z==="%")&&(k.position=xs(v,"position")),Fe===v&&(k.position="static"),Fe.appendChild(Qs),vt=Qs[fe],Fe.removeChild(Qs),k.position="absolute",le&&Ae&&(yt=He(Fe),yt.time=Ma.time,yt.width=Fe[fe]),Je(ke?vt*U/je:vt&&U?je/vt*U:0))))},ma=function(v,x,T,L){var U;return $a||ld(),x in Bo&&x!=="transform"&&(x=Bo[x],~x.indexOf(",")&&(x=x.split(",")[0])),ys[x]&&x!=="transform"?(U=bl(v,L),U=x!=="transformOrigin"?U[x]:U.svg?U.origin:_c(xs(v,Uo))+" "+U.zOrigin+"px"):(U=v.style[x],(!U||U==="auto"||L||~(U+"").indexOf("calc("))&&(U=vc[x]&&vc[x](v,x,T)||xs(v,x)||Ge(v,x)||(x==="opacity"?1:0))),T&&!~(U+"").trim().indexOf(" ")?ws(v,x,U,T)+T:U},gc=function(v,x,T,L){if(!T||T==="none"){var U=mc(x,v,1),z=U&&xs(v,U,1);z&&z!==T?(x=U,T=z):x==="borderColor"&&(T=xs(v,"borderTopColor"))}var k=new pr(this._pt,v.style,x,0,1,iu),le=0,ve=0,fe,je,ke,Ae,vt,Fe,yt,wt,Ut,Pt,Xt,Ct,It;if(k.b=T,k.e=L,T+="",L+="",L==="auto"&&(v.style[x]=L,L=xs(v,x)||L,v.style[x]=T),fe=[T,L],Zf(fe),T=fe[0],L=fe[1],ke=T.match(Ne)||[],It=L.match(Ne)||[],It.length){for(;je=Ne.exec(L);)yt=je[0],Ut=L.substring(le,je.index),vt?vt=(vt+1)%5:(Ut.substr(-5)==="rgba("||Ut.substr(-5)==="hsla(")&&(vt=1),yt!==(Fe=ke[ve++]||"")&&(Ae=parseFloat(Fe)||0,Xt=Fe.substr((Ae+"").length),Ct=yt.charAt(1)==="="?+(yt.charAt(0)+"1"):0,Ct&&(yt=yt.substr(2)),wt=parseFloat(yt),Pt=yt.substr((wt+"").length),le=Ne.lastIndex-Pt.length,Pt||(Pt=Pt||h.units[x]||Xt,le===L.length&&(L+=Pt,k.e+=Pt)),Xt!==Pt&&(Ae=ws(v,x,Fe,Pt)||0),k._pt={_next:k._pt,p:Ut||ve===1?Ut:",",s:Ae,c:Ct?Ct*wt:wt-Ae,m:vt&&vt<4||x==="zIndex"?Math.round:0});k.c=le<L.length?L.substring(le,L.length):""}else k.r=x==="display"&&L==="none"?ad:rd;return Le.test(L)&&(k.e=0),this._pt=k,k},_l={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},em=function(v){var x=v.split(" "),T=x[0],L=x[1]||"50%";return(T==="top"||T==="bottom"||L==="left"||L==="right")&&(v=T,T=L,L=v),x[0]=_l[T]||T,x[1]=_l[L]||L,x.join(" ")},cd=function(v,x){if(x.tween&&x.tween._time===x.tween._dur){var T=x.t,L=T.style,U=x.u,z=T._gsap,k,le,ve;if(U==="all"||U===!0)L.cssText="",le=1;else for(U=U.split(","),ve=U.length;--ve>-1;)k=U[ve],ys[k]&&(le=1,k=k==="transformOrigin"?Uo:mr),pa(T,k);le&&(pa(T,mr),z&&(z.svg&&T.removeAttribute("transform"),bl(T,1),z.uncache=1))}},vc={clearProps:function(v,x,T,L,U){if(U.data!=="isFromStart"){var z=v._pt=new pr(v._pt,x,T,0,0,cd);return z.u=L,z.pr=-10,z.tween=U,v._props.push(T),1}}},xl=[1,0,0,1,0,0],Da={},ud=function(v){return v==="matrix(1, 0, 0, 1, 0, 0)"||v==="none"||!v},Oa=function(v){var x=xs(v,mr);return ud(x)?xl:x.substr(7).match(Ye).map(Je)},yc=function(v,x){var T=v._gsap||He(v),L=v.style,U=Oa(v),z,k,le,ve;return T.svg&&v.getAttribute("transform")?(le=v.transform.baseVal.consolidate().matrix,U=[le.a,le.b,le.c,le.d,le.e,le.f],U.join(",")==="1,0,0,1,0,0"?xl:U):(U===xl&&!v.offsetParent&&v!==da&&!T.svg&&(le=L.display,L.display="block",z=v.parentNode,(!z||!v.offsetParent)&&(ve=1,k=v.nextSibling,da.appendChild(v)),U=Oa(v),le?L.display=le:pa(v,"display"),ve&&(k?z.insertBefore(v,k):z?z.appendChild(v):da.removeChild(v))),x&&U.length>6?[U[0],U[1],U[4],U[5],U[12],U[13]]:U)},ou=function(v,x,T,L,U,z){var k=v._gsap,le=U||yc(v,!0),ve=k.xOrigin||0,fe=k.yOrigin||0,je=k.xOffset||0,ke=k.yOffset||0,Ae=le[0],vt=le[1],Fe=le[2],yt=le[3],wt=le[4],Ut=le[5],Pt=x.split(" "),Xt=parseFloat(Pt[0])||0,Ct=parseFloat(Pt[1])||0,It,kt,jt,Gt;T?le!==xl&&(kt=Ae*yt-vt*Fe)&&(jt=Xt*(yt/kt)+Ct*(-Fe/kt)+(Fe*Ut-yt*wt)/kt,Gt=Xt*(-vt/kt)+Ct*(Ae/kt)-(Ae*Ut-vt*wt)/kt,Xt=jt,Ct=Gt):(It=Qp(v),Xt=It.x+(~Pt[0].indexOf("%")?Xt/100*It.width:Xt),Ct=It.y+(~(Pt[1]||Pt[0]).indexOf("%")?Ct/100*It.height:Ct)),L||L!==!1&&k.smooth?(wt=Xt-ve,Ut=Ct-fe,k.xOffset=je+(wt*Ae+Ut*Fe)-wt,k.yOffset=ke+(wt*vt+Ut*yt)-Ut):k.xOffset=k.yOffset=0,k.xOrigin=Xt,k.yOrigin=Ct,k.smooth=!!L,k.origin=x,k.originIsAbsolute=!!T,v.style[Uo]="0px 0px",z&&(Cr(z,k,"xOrigin",ve,Xt),Cr(z,k,"yOrigin",fe,Ct),Cr(z,k,"xOffset",je,k.xOffset),Cr(z,k,"yOffset",ke,k.yOffset)),v.setAttribute("data-svg-origin",Xt+" "+Ct)},bl=function(v,x){var T=v._gsap||new Qc(v);if("x"in T&&!x&&!T.uncache)return T;var L=v.style,U=T.scaleX<0,z="px",k="deg",le=xs(v,Uo)||"0",ve,fe,je,ke,Ae,vt,Fe,yt,wt,Ut,Pt,Xt,Ct,It,kt,jt,Gt,Yn,xi,ji,gr,tr,Fn,Ir,ia,ns,Na,xr,Go,qr,Dr,Ni;return ve=fe=je=vt=Fe=yt=wt=Ut=Pt=0,ke=Ae=1,T.svg=!!(v.getCTM&&$p(v)),It=yc(v,T.svg),T.svg&&(Ir=(!T.uncache||le==="0px 0px")&&!x&&v.getAttribute("data-svg-origin"),ou(v,Ir||le,!!Ir||T.originIsAbsolute,T.smooth!==!1,It)),Xt=T.xOrigin||0,Ct=T.yOrigin||0,It!==xl&&(Yn=It[0],xi=It[1],ji=It[2],gr=It[3],ve=tr=It[4],fe=Fn=It[5],It.length===6?(ke=Math.sqrt(Yn*Yn+xi*xi),Ae=Math.sqrt(gr*gr+ji*ji),vt=Yn||xi?es(xi,Yn)*_s:0,wt=ji||gr?es(ji,gr)*_s+vt:0,wt&&(Ae*=Math.abs(Math.cos(wt*Fo))),T.svg&&(ve-=Xt-(Xt*Yn+Ct*ji),fe-=Ct-(Xt*xi+Ct*gr))):(Ni=It[6],qr=It[7],Na=It[8],xr=It[9],Go=It[10],Dr=It[11],ve=It[12],fe=It[13],je=It[14],kt=es(Ni,Go),Fe=kt*_s,kt&&(jt=Math.cos(-kt),Gt=Math.sin(-kt),Ir=tr*jt+Na*Gt,ia=Fn*jt+xr*Gt,ns=Ni*jt+Go*Gt,Na=tr*-Gt+Na*jt,xr=Fn*-Gt+xr*jt,Go=Ni*-Gt+Go*jt,Dr=qr*-Gt+Dr*jt,tr=Ir,Fn=ia,Ni=ns),kt=es(-ji,Go),yt=kt*_s,kt&&(jt=Math.cos(-kt),Gt=Math.sin(-kt),Ir=Yn*jt-Na*Gt,ia=xi*jt-xr*Gt,ns=ji*jt-Go*Gt,Dr=gr*Gt+Dr*jt,Yn=Ir,xi=ia,ji=ns),kt=es(xi,Yn),vt=kt*_s,kt&&(jt=Math.cos(kt),Gt=Math.sin(kt),Ir=Yn*jt+xi*Gt,ia=tr*jt+Fn*Gt,xi=xi*jt-Yn*Gt,Fn=Fn*jt-tr*Gt,Yn=Ir,tr=ia),Fe&&Math.abs(Fe)+Math.abs(vt)>359.9&&(Fe=vt=0,yt=180-yt),ke=Je(Math.sqrt(Yn*Yn+xi*xi+ji*ji)),Ae=Je(Math.sqrt(Fn*Fn+Ni*Ni)),kt=es(tr,Fn),wt=Math.abs(kt)>2e-4?kt*_s:0,Pt=Dr?1/(Dr<0?-Dr:Dr):0),T.svg&&(Ir=v.getAttribute("transform"),T.forceCSS=v.setAttribute("transform","")||!ud(xs(v,mr)),Ir&&v.setAttribute("transform",Ir))),Math.abs(wt)>90&&Math.abs(wt)<270&&(U?(ke*=-1,wt+=vt<=0?180:-180,vt+=vt<=0?180:-180):(Ae*=-1,wt+=wt<=0?180:-180)),T.x=ve-((T.xPercent=ve&&(T.xPercent||(Math.round(v.offsetWidth/2)===Math.round(-ve)?-50:0)))?v.offsetWidth*T.xPercent/100:0)+z,T.y=fe-((T.yPercent=fe&&(T.yPercent||(Math.round(v.offsetHeight/2)===Math.round(-fe)?-50:0)))?v.offsetHeight*T.yPercent/100:0)+z,T.z=je+z,T.scaleX=Je(ke),T.scaleY=Je(Ae),T.rotation=Je(vt)+k,T.rotationX=Je(Fe)+k,T.rotationY=Je(yt)+k,T.skewX=wt+k,T.skewY=Ut+k,T.transformPerspective=Pt+z,(T.zOrigin=parseFloat(le.split(" ")[2])||0)&&(L[Uo]=_c(le)),T.xOffset=T.yOffset=0,T.force3D=h.force3D,T.renderTransform=T.svg?Lh:Kp?Ci:lu,T.uncache=0,T},_c=function(v){return(v=v.split(" "))[0]+" "+v[1]},qt=function(v,x,T){var L=er(x);return Je(parseFloat(x)+parseFloat(ws(v,"x",T+"px",L)))+L},lu=function(v,x){x.z="0px",x.rotationY=x.rotationX="0deg",x.force3D=0,Ci(v,x)},wl="0deg",an="0px",Pr=") ",Ci=function(v,x){var T=x||this,L=T.xPercent,U=T.yPercent,z=T.x,k=T.y,le=T.z,ve=T.rotation,fe=T.rotationY,je=T.rotationX,ke=T.skewX,Ae=T.skewY,vt=T.scaleX,Fe=T.scaleY,yt=T.transformPerspective,wt=T.force3D,Ut=T.target,Pt=T.zOrigin,Xt="",Ct=wt==="auto"&&v&&v!==1||wt===!0;if(Pt&&(je!==wl||fe!==wl)){var It=parseFloat(fe)*Fo,kt=Math.sin(It),jt=Math.cos(It),Gt;It=parseFloat(je)*Fo,Gt=Math.cos(It),z=qt(Ut,z,kt*Gt*-Pt),k=qt(Ut,k,-Math.sin(It)*-Pt),le=qt(Ut,le,jt*Gt*-Pt+Pt)}yt!==an&&(Xt+="perspective("+yt+Pr),(L||U)&&(Xt+="translate("+L+"%, "+U+"%) "),(Ct||z!==an||k!==an||le!==an)&&(Xt+=le!==an||Ct?"translate3d("+z+", "+k+", "+le+") ":"translate("+z+", "+k+Pr),ve!==wl&&(Xt+="rotate("+ve+Pr),fe!==wl&&(Xt+="rotateY("+fe+Pr),je!==wl&&(Xt+="rotateX("+je+Pr),(ke!==wl||Ae!==wl)&&(Xt+="skew("+ke+", "+Ae+Pr),(vt!==1||Fe!==1)&&(Xt+="scale("+vt+", "+Fe+Pr),Ut.style[mr]=Xt||"translate(0, 0)"},Lh=function(v,x){var T=x||this,L=T.xPercent,U=T.yPercent,z=T.x,k=T.y,le=T.rotation,ve=T.skewX,fe=T.skewY,je=T.scaleX,ke=T.scaleY,Ae=T.target,vt=T.xOrigin,Fe=T.yOrigin,yt=T.xOffset,wt=T.yOffset,Ut=T.forceCSS,Pt=parseFloat(z),Xt=parseFloat(k),Ct,It,kt,jt,Gt;le=parseFloat(le),ve=parseFloat(ve),fe=parseFloat(fe),fe&&(fe=parseFloat(fe),ve+=fe,le+=fe),le||ve?(le*=Fo,ve*=Fo,Ct=Math.cos(le)*je,It=Math.sin(le)*je,kt=Math.sin(le-ve)*-ke,jt=Math.cos(le-ve)*ke,ve&&(fe*=Fo,Gt=Math.tan(ve-fe),Gt=Math.sqrt(1+Gt*Gt),kt*=Gt,jt*=Gt,fe&&(Gt=Math.tan(fe),Gt=Math.sqrt(1+Gt*Gt),Ct*=Gt,It*=Gt)),Ct=Je(Ct),It=Je(It),kt=Je(kt),jt=Je(jt)):(Ct=je,jt=ke,It=kt=0),(Pt&&!~(z+"").indexOf("px")||Xt&&!~(k+"").indexOf("px"))&&(Pt=ws(Ae,"x",z,"px"),Xt=ws(Ae,"y",k,"px")),(vt||Fe||yt||wt)&&(Pt=Je(Pt+vt-(vt*Ct+Fe*kt)+yt),Xt=Je(Xt+Fe-(vt*It+Fe*jt)+wt)),(L||U)&&(Gt=Ae.getBBox(),Pt=Je(Pt+L/100*Gt.width),Xt=Je(Xt+U/100*Gt.height)),Gt="matrix("+Ct+","+It+","+kt+","+jt+","+Pt+","+Xt+")",Ae.setAttribute("transform",Gt),Ut&&(Ae.style[mr]=Gt)},fn=function(v,x,T,L,U,z){var k=360,le=V(U),ve=parseFloat(U)*(le&&~U.indexOf("rad")?_s:1),fe=z?ve*z:ve-L,je=L+fe+"deg",ke,Ae;return le&&(ke=U.split("_")[1],ke==="short"&&(fe%=k,fe!==fe%(k/2)&&(fe+=fe<0?k:-k)),ke==="cw"&&fe<0?fe=(fe+k*Hn)%k-~~(fe/k)*k:ke==="ccw"&&fe>0&&(fe=(fe-k*Hn)%k-~~(fe/k)*k)),v._pt=Ae=new pr(v._pt,x,T,L,fe,Mh),Ae.e=je,Ae.u="deg",v._props.push(T),Ae},xc=function(v,x){for(var T in x)v[T]=x[T];return v},cu=function(v,x,T){var L=xc({},T._gsap),U="perspective,force3D,transformOrigin,svgOrigin",z=T.style,k,le,ve,fe,je,ke,Ae,vt;L.svg?(ve=T.getAttribute("transform"),T.setAttribute("transform",""),z[mr]=x,k=bl(T,1),pa(T,mr),T.setAttribute("transform",ve)):(ve=getComputedStyle(T)[mr],z[mr]=x,k=bl(T,1),z[mr]=ve);for(le in ys)ve=L[le],fe=k[le],ve!==fe&&U.indexOf(le)<0&&(Ae=er(ve),vt=er(fe),je=Ae!==vt?ws(T,le,ve,vt):parseFloat(ve),ke=parseFloat(fe),v._pt=new pr(v._pt,k,le,je,ke-je,$s),v._pt.u=vt||0,v._props.push(le));xc(k,L)};ue("padding,margin,Width,Radius",function(ae,v){var x="Top",T="Right",L="Bottom",U="Left",z=(v<3?[x,T,L,U]:[x+U,x+T,L+T,L+U]).map(function(k){return v<2?ae+k:"border"+k+ae});vc[v>1?"border"+ae:ae]=function(k,le,ve,fe,je){var ke,Ae;if(arguments.length<4)return ke=z.map(function(vt){return ma(k,vt,ve)}),Ae=ke.join(" "),Ae.split(ke[0]).length===5?ke[0]:Ae;ke=(fe+"").split(" "),Ae={},z.forEach(function(vt,Fe){return Ae[vt]=ke[Fe]=ke[Fe]||ke[(Fe-1)/2|0]}),k.init(le,Ae,je)}});var Ml={name:"css",register:ld,targetTest:function(v){return v.style&&v.nodeType},init:function(v,x,T,L,U){var z=this._props,k=v.style,le=T.vars.startAt,ve,fe,je,ke,Ae,vt,Fe,yt,wt,Ut,Pt,Xt,Ct,It,kt;$a||ld();for(Fe in x)if(Fe!=="autoRound"&&(fe=x[Fe],!(Pe[Fe]&&$f(Fe,x,T,L,v,U)))){if(Ae=typeof fe,vt=vc[Fe],Ae==="function"&&(fe=fe.call(T,L,v,U),Ae=typeof fe),Ae==="string"&&~fe.indexOf("random(")&&(fe=ac(fe)),vt)vt(this,v,Fe,fe,T)&&(kt=1);else if(Fe.substr(0,2)==="--")ve=(getComputedStyle(v).getPropertyValue(Fe)+"").trim(),fe+="",Ys.lastIndex=0,Ys.test(ve)||(yt=er(ve),wt=er(fe)),wt?yt!==wt&&(ve=ws(v,Fe,ve,wt)+wt):yt&&(fe+=yt),this.add(k,"setProperty",ve,fe,L,U,0,0,Fe),z.push(Fe);else if(Ae!=="undefined"){if(le&&Fe in le?(ve=typeof le[Fe]=="function"?le[Fe].call(T,L,v,U):le[Fe],Fe in h.units&&!er(ve)&&(ve+=h.units[Fe]),V(ve)&&~ve.indexOf("random(")&&(ve=ac(ve)),(ve+"").charAt(1)==="="&&(ve=ma(v,Fe))):ve=ma(v,Fe),ke=parseFloat(ve),Ut=Ae==="string"&&fe.charAt(1)==="="?+(fe.charAt(0)+"1"):0,Ut&&(fe=fe.substr(2)),je=parseFloat(fe),Fe in Bo&&(Fe==="autoAlpha"&&(ke===1&&ma(v,"visibility")==="hidden"&&je&&(ke=0),Cr(this,k,"visibility",ke?"inherit":"hidden",je?"inherit":"hidden",!je)),Fe!=="scale"&&Fe!=="transform"&&(Fe=Bo[Fe],~Fe.indexOf(",")&&(Fe=Fe.split(",")[0]))),Pt=Fe in ys,Pt){if(Xt||(Ct=v._gsap,Ct.renderTransform&&!x.parseTransform||bl(v,x.parseTransform),It=x.smoothOrigin!==!1&&Ct.smooth,Xt=this._pt=new pr(this._pt,k,mr,0,1,Ct.renderTransform,Ct,0,-1),Xt.dep=1),Fe==="scale")this._pt=new pr(this._pt,Ct,"scaleY",Ct.scaleY,(Ut?Ut*je:je-Ct.scaleY)||0),z.push("scaleY",Fe),Fe+="X";else if(Fe==="transformOrigin"){fe=em(fe),Ct.svg?ou(v,fe,0,It,0,this):(wt=parseFloat(fe.split(" ")[2])||0,wt!==Ct.zOrigin&&Cr(this,Ct,"zOrigin",Ct.zOrigin,wt),Cr(this,k,Fe,_c(ve),_c(fe)));continue}else if(Fe==="svgOrigin"){ou(v,fe,1,It,0,this);continue}else if(Fe in Da){fn(this,Ct,Fe,ke,fe,Ut);continue}else if(Fe==="smoothOrigin"){Cr(this,Ct,"smooth",Ct.smooth,fe);continue}else if(Fe==="force3D"){Ct[Fe]=fe;continue}else if(Fe==="transform"){cu(this,fe,v);continue}}else Fe in k||(Fe=mc(Fe)||Fe);if(Pt||(je||je===0)&&(ke||ke===0)&&!Tv.test(fe)&&Fe in k)yt=(ve+"").substr((ke+"").length),je||(je=0),wt=er(fe)||(Fe in h.units?h.units[Fe]:yt),yt!==wt&&(ke=ws(v,Fe,ve,wt)),this._pt=new pr(this._pt,Pt?Ct:k,Fe,ke,Ut?Ut*je:je-ke,!Pt&&(wt==="px"||Fe==="zIndex")&&x.autoRound!==!1?Sh:$s),this._pt.u=wt||0,yt!==wt&&wt!=="%"&&(this._pt.b=ve,this._pt.r=Sa);else if(Fe in k)gc.call(this,v,Fe,ve,fe);else if(Fe in v)this.add(v,Fe,ve||v[Fe],fe,L,U);else{H(Fe,fe);continue}z.push(Fe)}}kt&&gl(this)},get:ma,aliases:Bo,getSetter:function(v,x,T){var L=Bo[x];return L&&L.indexOf(",")<0&&(x=L),x in ys&&x!==Uo&&(v._gsap.x||ma(v,"x"))?T&&su===T?x==="scale"?pc:Jp:(su=T||{})&&(x==="scale"?eo:Th):v.style&&!pe(v.style[x])?sd:~x.indexOf("-")?Ev:cc(v,x)},core:{_removeProperty:pa,_getMatrix:yc}};Ia.utils.checkPrefix=mc,function(ae,v,x,T){var L=ue(ae+","+v+","+x,function(U){ys[U]=1});ue(v,function(U){h.units[U]="deg",Da[U]=1}),Bo[L[13]]=ae+","+v,ue(T,function(U){var z=U.split(":");Bo[z[1]]=L[z[0]]})}("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY"),ue("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(ae){h.units[ae]="px"}),Ia.registerPlugin(Ml);var Sl=Ia.registerPlugin(Ml)||Ia,Tl=Sl.core.Tween;n.Back=Po,n.Bounce=vl,n.CSSPlugin=Ml,n.Circ=wh,n.Cubic=ru,n.Elastic=dc,n.Expo=bh,n.Linear=nd,n.Power0=Wr,n.Power1=ee,n.Power2=td,n.Power3=Zp,n.Power4=vs,n.Quad=Ks,n.Quart=id,n.Quint=hc,n.Sine=au,n.SteppedEase=Io,n.Strong=fc,n.TimelineLite=Gr,n.TimelineMax=Gr,n.TweenLite=zi,n.TweenMax=Tl,n.default=Sl,n.gsap=Sl,typeof window>"u"||window!==n?Object.defineProperty(n,"__esModule",{value:!0}):delete window.default})});ls(za);var Ol=za.TweenMax,fo=Ki(function(r,i){(function(n,l){l(i)})(fi,function(n){Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52)),Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),t=1;t<arguments.length;t++){var a=arguments[t];if(a!=null)for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s[o]=a[o])}return s});var l="121",u=0,h=1,p=2,g=1,_=2,b=3,A=0,S=1,R=2,E=1,N=0,W=1,V=2,B=3,O=4,pe=5,ge=100,ye=101,Q=102,Ie=103,tt=104,qe=200,ht=201,Ye=202,Ne=203,Ue=204,Le=205,Te=206,Ve=207,We=208,rt=209,Tt=210,nt=0,Et=1,$t=2,Yt=3,K=4,H=5,xe=6,te=7,de=0,be=1,Re=2,we=0,Se=1,Pe=2,ze=3,Ze=4,Xe=5,$=300,j=301,He=302,Ge=303,ue=304,Je=306,lt=307,Nt=1e3,ct=1001,me=1002,it=1003,Lt=1004,pt=1005,Dt=1006,cn=1007,pi=1008,Rr=1009,$i=1010,Br=1011,Vs=1012,ua=1013,qi=1014,Ri=1015,Ja=1016,ha=1017,gs=1018,dr=1019,fa=1020,ba=1021,Ka=1022,re=1023,Qe=1024,Ke=1025,ut=re,Ft=1026,Tn=1027,Ln=1028,Vn=1029,wn=1030,Xi=1031,Yi=1032,nn=1033,ni=33776,yr=33777,ii=33778,er=33779,or=35840,Ws=35841,Sr=35842,qs=35843,_r=36196,Xs=37492,gh=37496,zf=37808,vh=37809,Hf=37810,kf=37811,Up=37812,Gp=37813,zp=37814,Vf=37815,Hp=37816,kp=37817,ac=37818,Wf=37819,Vp=37820,qf=37821,wa=36492,sc=37840,hl=37841,Wp=37842,Si=37843,oc=37844,yh=37845,Xf=37846,Yf=37847,jf=37848,Ys=37849,qp=37850,Zf=37851,Zc=37852,Ma=37853,fl=2200,$n=2201,Xp=2202,Jc=2300,Kc=2301,_h=2302,dl=2400,Lo=2401,lc=2402,js=2500,Zs=2501,Jf=0,Ur=3e3,pl=3001,Qc=3007,Ro=3002,Gr=3003,Kf=3004,$c=3005,Qf=3006,$f=3200,Js=3201,ml=0,Yp=1,Co=7680,ed=519,eu=35044,zi=35048,tu="300 es";function Qa(){}Object.assign(Qa.prototype,{addEventListener:function(e,s){this._listeners===void 0&&(this._listeners={});var t=this._listeners;t[e]===void 0&&(t[e]=[]),t[e].indexOf(s)===-1&&t[e].push(s)},hasEventListener:function(e,s){if(this._listeners===void 0)return!1;var t=this._listeners;return t[e]!==void 0&&t[e].indexOf(s)!==-1},removeEventListener:function(e,s){if(this._listeners!==void 0){var t=this._listeners,a=t[e];if(a!==void 0){var o=a.indexOf(s);o!==-1&&a.splice(o,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var s=this._listeners,t=s[e.type];if(t!==void 0){e.target=this;for(var a=t.slice(0),o=0,c=a.length;o<c;o++)a[o].call(this,e)}}}});for(var zr=[],nu=0;nu<256;nu++)zr[nu]=(nu<16?"0":"")+nu.toString(16);var cc=1234567,Mn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,t=Math.random()*4294967295|0,a=Math.random()*4294967295|0,o=zr[e&255]+zr[e>>8&255]+zr[e>>16&255]+zr[e>>24&255]+"-"+zr[s&255]+zr[s>>8&255]+"-"+zr[s>>16&15|64]+zr[s>>24&255]+"-"+zr[t&63|128]+zr[t>>8&255]+"-"+zr[t>>16&255]+zr[t>>24&255]+zr[a&255]+zr[a>>8&255]+zr[a>>16&255]+zr[a>>24&255];return o.toUpperCase()},clamp:function(e,s,t){return Math.max(s,Math.min(t,e))},euclideanModulo:function(e,s){return(e%s+s)%s},mapLinear:function(e,s,t,a,o){return a+(e-s)*(o-a)/(t-s)},lerp:function(e,s,t){return(1-t)*e+t*s},smoothstep:function(e,s,t){return e<=s?0:e>=t?1:(e=(e-s)/(t-s),e*e*(3-2*e))},smootherstep:function(e,s,t){return e<=s?0:e>=t?1:(e=(e-s)/(t-s),e*e*e*(e*(e*6-15)+10))},randInt:function(e,s){return e+Math.floor(Math.random()*(s-e+1))},randFloat:function(e,s){return e+Math.random()*(s-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return e!==void 0&&(cc=e%2147483647),cc=cc*16807%2147483647,(cc-1)/2147483646},degToRad:function(e){return e*Mn.DEG2RAD},radToDeg:function(e){return e*Mn.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,s,t,a,o){var c=Math.cos,f=Math.sin,d=c(t/2),m=f(t/2),y=c((s+a)/2),w=f((s+a)/2),M=c((s-a)/2),D=f((s-a)/2),P=c((a-s)/2),F=f((a-s)/2);switch(o){case"XYX":e.set(d*w,m*M,m*D,d*y);break;case"YZY":e.set(m*D,d*w,m*M,d*y);break;case"ZXZ":e.set(m*M,m*D,d*w,d*y);break;case"XZX":e.set(d*w,m*F,m*P,d*y);break;case"YXY":e.set(m*P,d*w,m*F,d*y);break;case"ZYZ":e.set(m*F,m*P,d*w,d*y);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}};function jp(e,s){for(var t=0;t<s.length;t++){var a=s[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function iu(e,s,t){return s&&jp(e.prototype,s),t&&jp(e,t),e}function Qt(e,s){e.prototype=Object.create(s.prototype),e.prototype.constructor=e,e.__proto__=s}function uc(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var _t=function(){function e(t,a){t===void 0&&(t=0),a===void 0&&(a=0),Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=a}var s=e.prototype;return s.set=function(t,a){return this.x=t,this.y=a,this},s.setScalar=function(t){return this.x=t,this.y=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y)},s.copy=function(t){return this.x=t.x,this.y=t.y,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this},s.multiply=function(t){return this.x*=t.x,this.y*=t.y,this},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this},s.divide=function(t){return this.x/=t.x,this.y/=t.y,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.applyMatrix3=function(t){var a=this.x,o=this.y,c=t.elements;return this.x=c[0]*a+c[3]*o+c[6],this.y=c[1]*a+c[4]*o+c[7],this},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this},s.dot=function(t){return this.x*t.x+this.y*t.y},s.cross=function(t){return this.x*t.y-this.y*t.x},s.lengthSq=function(){return this.x*this.x+this.y*this.y},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.angle=function(){var a=Math.atan2(-this.y,-this.x)+Math.PI;return a},s.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},s.distanceToSquared=function(t){var a=this.x-t.x,o=this.y-t.y;return a*a+o*o},s.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this},s.equals=function(t){return t.x===this.x&&t.y===this.y},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this},s.rotateAround=function(t,a){var o=Math.cos(a),c=Math.sin(a),f=this.x-t.x,d=this.y-t.y;return this.x=f*o-d*c+t.x,this.y=f*c+d*o+t.y,this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this},iu(e,[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}}]),e}(),ta=function(){function e(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}var s=e.prototype;return s.set=function(t,a,o,c,f,d,m,y,w){var M=this.elements;return M[0]=t,M[1]=c,M[2]=m,M[3]=a,M[4]=f,M[5]=y,M[6]=o,M[7]=d,M[8]=w,this},s.identity=function(){return this.set(1,0,0,0,1,0,0,0,1),this},s.clone=function(){return new this.constructor().fromArray(this.elements)},s.copy=function(t){var a=this.elements,o=t.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],this},s.extractBasis=function(t,a,o){return t.setFromMatrix3Column(this,0),a.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this},s.setFromMatrix4=function(t){var a=t.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this},s.multiply=function(t){return this.multiplyMatrices(this,t)},s.premultiply=function(t){return this.multiplyMatrices(t,this)},s.multiplyMatrices=function(t,a){var o=t.elements,c=a.elements,f=this.elements,d=o[0],m=o[3],y=o[6],w=o[1],M=o[4],D=o[7],P=o[2],F=o[5],C=o[8],I=c[0],q=c[3],J=c[6],Z=c[1],G=c[4],Y=c[7],ne=c[2],se=c[5],Ee=c[8];return f[0]=d*I+m*Z+y*ne,f[3]=d*q+m*G+y*se,f[6]=d*J+m*Y+y*Ee,f[1]=w*I+M*Z+D*ne,f[4]=w*q+M*G+D*se,f[7]=w*J+M*Y+D*Ee,f[2]=P*I+F*Z+C*ne,f[5]=P*q+F*G+C*se,f[8]=P*J+F*Y+C*Ee,this},s.multiplyScalar=function(t){var a=this.elements;return a[0]*=t,a[3]*=t,a[6]*=t,a[1]*=t,a[4]*=t,a[7]*=t,a[2]*=t,a[5]*=t,a[8]*=t,this},s.determinant=function(){var t=this.elements,a=t[0],o=t[1],c=t[2],f=t[3],d=t[4],m=t[5],y=t[6],w=t[7],M=t[8];return a*d*M-a*m*w-o*f*M+o*m*y+c*f*w-c*d*y},s.getInverse=function(t,a){a!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var o=t.elements,c=this.elements,f=o[0],d=o[1],m=o[2],y=o[3],w=o[4],M=o[5],D=o[6],P=o[7],F=o[8],C=F*w-M*P,I=M*D-F*y,q=P*y-w*D,J=f*C+d*I+m*q;if(J===0)return this.set(0,0,0,0,0,0,0,0,0);var Z=1/J;return c[0]=C*Z,c[1]=(m*P-F*d)*Z,c[2]=(M*d-m*w)*Z,c[3]=I*Z,c[4]=(F*f-m*D)*Z,c[5]=(m*y-M*f)*Z,c[6]=q*Z,c[7]=(d*D-P*f)*Z,c[8]=(w*f-d*y)*Z,this},s.transpose=function(){var t,a=this.elements;return t=a[1],a[1]=a[3],a[3]=t,t=a[2],a[2]=a[6],a[6]=t,t=a[5],a[5]=a[7],a[7]=t,this},s.getNormalMatrix=function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},s.transposeIntoArray=function(t){var a=this.elements;return t[0]=a[0],t[1]=a[3],t[2]=a[6],t[3]=a[1],t[4]=a[4],t[5]=a[7],t[6]=a[2],t[7]=a[5],t[8]=a[8],this},s.setUvTransform=function(t,a,o,c,f,d,m){var y=Math.cos(f),w=Math.sin(f);this.set(o*y,o*w,-o*(y*d+w*m)+d+t,-c*w,c*y,-c*(-w*d+y*m)+m+a,0,0,1)},s.scale=function(t,a){var o=this.elements;return o[0]*=t,o[3]*=t,o[6]*=t,o[1]*=a,o[4]*=a,o[7]*=a,this},s.rotate=function(t){var a=Math.cos(t),o=Math.sin(t),c=this.elements,f=c[0],d=c[3],m=c[6],y=c[1],w=c[4],M=c[7];return c[0]=a*f+o*y,c[3]=a*d+o*w,c[6]=a*m+o*M,c[1]=-o*f+a*y,c[4]=-o*d+a*w,c[7]=-o*m+a*M,this},s.translate=function(t,a){var o=this.elements;return o[0]+=t*o[2],o[3]+=t*o[5],o[6]+=t*o[8],o[1]+=a*o[2],o[4]+=a*o[5],o[7]+=a*o[8],this},s.equals=function(t){for(var a=this.elements,o=t.elements,c=0;c<9;c++)if(a[c]!==o[c])return!1;return!0},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=0;o<9;o++)this.elements[o]=t[o+a];return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);var o=this.elements;return t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3],t[a+4]=o[4],t[a+5]=o[5],t[a+6]=o[6],t[a+7]=o[7],t[a+8]=o[8],t},e}(),gl,pr={getDataURL:function(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;var s;if(e instanceof HTMLCanvasElement)s=e;else{gl===void 0&&(gl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),gl.width=e.width,gl.height=e.height;var t=gl.getContext("2d");e instanceof ImageData?t.putImageData(e,0,0):t.drawImage(e,0,0,e.width,e.height),s=gl}return s.width>2048||s.height>2048?s.toDataURL("image/jpeg",.6):s.toDataURL("image/png")}},xh=0;function Ti(e,s,t,a,o,c,f,d,m,y){Object.defineProperty(this,"id",{value:xh++}),this.uuid=Mn.generateUUID(),this.name="",this.image=e!==void 0?e:Ti.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=s!==void 0?s:Ti.DEFAULT_MAPPING,this.wrapS=t!==void 0?t:ct,this.wrapT=a!==void 0?a:ct,this.magFilter=o!==void 0?o:Dt,this.minFilter=c!==void 0?c:pi,this.anisotropy=m!==void 0?m:1,this.format=f!==void 0?f:re,this.internalFormat=null,this.type=d!==void 0?d:Rr,this.offset=new _t(0,0),this.repeat=new _t(1,1),this.center=new _t(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ta,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=y!==void 0?y:Ur,this.version=0,this.onUpdate=null}Ti.DEFAULT_IMAGE=void 0,Ti.DEFAULT_MAPPING=$,Ti.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ti,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var s=e===void 0||typeof e=="string";if(!s&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var t={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var a=this.image;if(a.uuid===void 0&&(a.uuid=Mn.generateUUID()),!s&&e.images[a.uuid]===void 0){var o;if(Array.isArray(a)){o=[];for(var c=0,f=a.length;c<f;c++)o.push(pr.getDataURL(a[c]))}else o=pr.getDataURL(a);e.images[a.uuid]={uuid:a.uuid,url:o}}t.image=a.uuid}return s||(e.textures[this.uuid]=t),t},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==$)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Nt:e.x=e.x-Math.floor(e.x);break;case ct:e.x=e.x<0?0:1;break;case me:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Nt:e.y=e.y-Math.floor(e.y);break;case ct:e.y=e.y<0?0:1;break;case me:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Ti.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});var Ei=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=1),Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=a,this.z=o,this.w=c}var s=e.prototype;return s.set=function(t,a,o,c){return this.x=t,this.y=a,this.z=o,this.w=c,this},s.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setZ=function(t){return this.z=t,this},s.setW=function(t){return this.w=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y,this.z,this.w)},s.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this.z=t.z+a.z,this.w=t.w+a.w,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this.z+=t.z*a,this.w+=t.w*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this.z=t.z-a.z,this.w=t.w-a.w,this},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},s.applyMatrix4=function(t){var a=this.x,o=this.y,c=this.z,f=this.w,d=t.elements;return this.x=d[0]*a+d[4]*o+d[8]*c+d[12]*f,this.y=d[1]*a+d[5]*o+d[9]*c+d[13]*f,this.z=d[2]*a+d[6]*o+d[10]*c+d[14]*f,this.w=d[3]*a+d[7]*o+d[11]*c+d[15]*f,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.setAxisAngleFromQuaternion=function(t){this.w=2*Math.acos(t.w);var a=Math.sqrt(1-t.w*t.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/a,this.y=t.y/a,this.z=t.z/a),this},s.setAxisAngleFromRotationMatrix=function(t){var a,o,c,f,d=.01,m=.1,y=t.elements,w=y[0],M=y[4],D=y[8],P=y[1],F=y[5],C=y[9],I=y[2],q=y[6],J=y[10];if(Math.abs(M-P)<d&&Math.abs(D-I)<d&&Math.abs(C-q)<d){if(Math.abs(M+P)<m&&Math.abs(D+I)<m&&Math.abs(C+q)<m&&Math.abs(w+F+J-3)<m)return this.set(1,0,0,0),this;a=Math.PI;var Z=(w+1)/2,G=(F+1)/2,Y=(J+1)/2,ne=(M+P)/4,se=(D+I)/4,Ee=(C+q)/4;return Z>G&&Z>Y?Z<d?(o=0,c=.707106781,f=.707106781):(o=Math.sqrt(Z),c=ne/o,f=se/o):G>Y?G<d?(o=.707106781,c=0,f=.707106781):(c=Math.sqrt(G),o=ne/c,f=Ee/c):Y<d?(o=.707106781,c=.707106781,f=0):(f=Math.sqrt(Y),o=se/f,c=Ee/f),this.set(o,c,f,a),this}var Be=Math.sqrt((q-C)*(q-C)+(D-I)*(D-I)+(P-M)*(P-M));return Math.abs(Be)<.001&&(Be=1),this.x=(q-C)/Be,this.y=(D-I)/Be,this.z=(P-M)/Be,this.w=Math.acos((w+F+J-1)/2),this},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this.z=Math.max(t.z,Math.min(a.z,this.z)),this.w=Math.max(t.w,Math.min(a.w,this.w)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this.z=Math.max(t,Math.min(a,this.z)),this.w=Math.max(t,Math.min(a,this.w)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},s.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},s.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this.z+=(t.z-this.z)*a,this.w+=(t.w-this.w)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this.z=t.z+(a.z-t.z)*o,this.w=t.w+(a.w-t.w)*o,this},s.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this.z=t[a+2],this.w=t[a+3],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t[a+2]=this.z,t[a+3]=this.w,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this.z=t.getZ(a),this.w=t.getW(a),this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this},iu(e,[{key:"width",get:function(){return this.z},set:function(t){this.z=t}},{key:"height",get:function(){return this.w},set:function(t){this.w=t}}]),e}();function na(e,s,t){this.width=e,this.height=s,this.scissor=new Ei(0,0,e,s),this.scissorTest=!1,this.viewport=new Ei(0,0,e,s),t=t||{},this.texture=new Ti(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=s,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Dt,this.depthBuffer=t.depthBuffer!==void 0?t.depthBuffer:!0,this.stencilBuffer=t.stencilBuffer!==void 0?t.stencilBuffer:!1,this.depthTexture=t.depthTexture!==void 0?t.depthTexture:null}na.prototype=Object.assign(Object.create(Qa.prototype),{constructor:na,isWebGLRenderTarget:!0,setSize:function(e,s){(this.width!==e||this.height!==s)&&(this.width=e,this.height=s,this.texture.image.width=e,this.texture.image.height=s,this.dispose()),this.viewport.set(0,0,e,s),this.scissor.set(0,0,e,s)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function Ia(e,s,t){na.call(this,e,s,t),this.samples=4}Ia.prototype=Object.assign(Object.create(na.prototype),{constructor:Ia,isWebGLMultisampleRenderTarget:!0,copy:function(e){return na.prototype.copy.call(this,e),this.samples=e.samples,this}});var Wr=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=1),Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=a,this._z=o,this._w=c}e.slerp=function(t,a,o,c){return o.copy(t).slerp(a,c)},e.slerpFlat=function(t,a,o,c,f,d,m){var y=o[c+0],w=o[c+1],M=o[c+2],D=o[c+3],P=f[d+0],F=f[d+1],C=f[d+2],I=f[d+3];if(D!==I||y!==P||w!==F||M!==C){var q=1-m,J=y*P+w*F+M*C+D*I,Z=J>=0?1:-1,G=1-J*J;if(G>Number.EPSILON){var Y=Math.sqrt(G),ne=Math.atan2(Y,J*Z);q=Math.sin(q*ne)/Y,m=Math.sin(m*ne)/Y}var se=m*Z;if(y=y*q+P*se,w=w*q+F*se,M=M*q+C*se,D=D*q+I*se,q===1-m){var Ee=1/Math.sqrt(y*y+w*w+M*M+D*D);y*=Ee,w*=Ee,M*=Ee,D*=Ee}}t[a]=y,t[a+1]=w,t[a+2]=M,t[a+3]=D},e.multiplyQuaternionsFlat=function(t,a,o,c,f,d){var m=o[c],y=o[c+1],w=o[c+2],M=o[c+3],D=f[d],P=f[d+1],F=f[d+2],C=f[d+3];return t[a]=m*C+M*D+y*F-w*P,t[a+1]=y*C+M*P+w*D-m*F,t[a+2]=w*C+M*F+m*P-y*D,t[a+3]=M*C-m*D-y*P-w*F,t};var s=e.prototype;return s.set=function(t,a,o,c){return this._x=t,this._y=a,this._z=o,this._w=c,this._onChangeCallback(),this},s.clone=function(){return new this.constructor(this._x,this._y,this._z,this._w)},s.copy=function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},s.setFromEuler=function(t,a){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var o=t._x,c=t._y,f=t._z,d=t._order,m=Math.cos,y=Math.sin,w=m(o/2),M=m(c/2),D=m(f/2),P=y(o/2),F=y(c/2),C=y(f/2);switch(d){case"XYZ":this._x=P*M*D+w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D-P*F*C;break;case"YXZ":this._x=P*M*D+w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D+P*F*C;break;case"ZXY":this._x=P*M*D-w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D-P*F*C;break;case"ZYX":this._x=P*M*D-w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D+P*F*C;break;case"YZX":this._x=P*M*D+w*F*C,this._y=w*F*D+P*M*C,this._z=w*M*C-P*F*D,this._w=w*M*D-P*F*C;break;case"XZY":this._x=P*M*D-w*F*C,this._y=w*F*D-P*M*C,this._z=w*M*C+P*F*D,this._w=w*M*D+P*F*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+d)}return a!==!1&&this._onChangeCallback(),this},s.setFromAxisAngle=function(t,a){var o=a/2,c=Math.sin(o);return this._x=t.x*c,this._y=t.y*c,this._z=t.z*c,this._w=Math.cos(o),this._onChangeCallback(),this},s.setFromRotationMatrix=function(t){var a=t.elements,o=a[0],c=a[4],f=a[8],d=a[1],m=a[5],y=a[9],w=a[2],M=a[6],D=a[10],P=o+m+D;if(P>0){var F=.5/Math.sqrt(P+1);this._w=.25/F,this._x=(M-y)*F,this._y=(f-w)*F,this._z=(d-c)*F}else if(o>m&&o>D){var C=2*Math.sqrt(1+o-m-D);this._w=(M-y)/C,this._x=.25*C,this._y=(c+d)/C,this._z=(f+w)/C}else if(m>D){var I=2*Math.sqrt(1+m-o-D);this._w=(f-w)/I,this._x=(c+d)/I,this._y=.25*I,this._z=(y+M)/I}else{var q=2*Math.sqrt(1+D-o-m);this._w=(d-c)/q,this._x=(f+w)/q,this._y=(y+M)/q,this._z=.25*q}return this._onChangeCallback(),this},s.setFromUnitVectors=function(t,a){var o=t.dot(a)+1;return o<1e-6?(o=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=o):(this._x=0,this._y=-t.z,this._z=t.y,this._w=o)):(this._x=t.y*a.z-t.z*a.y,this._y=t.z*a.x-t.x*a.z,this._z=t.x*a.y-t.y*a.x,this._w=o),this.normalize()},s.angleTo=function(t){return 2*Math.acos(Math.abs(Mn.clamp(this.dot(t),-1,1)))},s.rotateTowards=function(t,a){var o=this.angleTo(t);if(o===0)return this;var c=Math.min(1,a/o);return this.slerp(t,c),this},s.identity=function(){return this.set(0,0,0,1)},s.inverse=function(){return this.conjugate()},s.conjugate=function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},s.dot=function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},s.lengthSq=function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},s.length=function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},s.normalize=function(){var t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,a)):this.multiplyQuaternions(this,t)},s.premultiply=function(t){return this.multiplyQuaternions(t,this)},s.multiplyQuaternions=function(t,a){var o=t._x,c=t._y,f=t._z,d=t._w,m=a._x,y=a._y,w=a._z,M=a._w;return this._x=o*M+d*m+c*w-f*y,this._y=c*M+d*y+f*m-o*w,this._z=f*M+d*w+o*y-c*m,this._w=d*M-o*m-c*y-f*w,this._onChangeCallback(),this},s.slerp=function(t,a){if(a===0)return this;if(a===1)return this.copy(t);var o=this._x,c=this._y,f=this._z,d=this._w,m=d*t._w+o*t._x+c*t._y+f*t._z;if(m<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,m=-m):this.copy(t),m>=1)return this._w=d,this._x=o,this._y=c,this._z=f,this;var y=1-m*m;if(y<=Number.EPSILON){var w=1-a;return this._w=w*d+a*this._w,this._x=w*o+a*this._x,this._y=w*c+a*this._y,this._z=w*f+a*this._z,this.normalize(),this._onChangeCallback(),this}var M=Math.sqrt(y),D=Math.atan2(M,m),P=Math.sin((1-a)*D)/M,F=Math.sin(a*D)/M;return this._w=d*P+this._w*F,this._x=o*P+this._x*F,this._y=c*P+this._y*F,this._z=f*P+this._z*F,this._onChangeCallback(),this},s.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},s.fromArray=function(t,a){return a===void 0&&(a=0),this._x=t[a],this._y=t[a+1],this._z=t[a+2],this._w=t[a+3],this._onChangeCallback(),this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this._x,t[a+1]=this._y,t[a+2]=this._z,t[a+3]=this._w,t},s.fromBufferAttribute=function(t,a){return this._x=t.getX(a),this._y=t.getY(a),this._z=t.getZ(a),this._w=t.getW(a),this},s._onChange=function(t){return this._onChangeCallback=t,this},s._onChangeCallback=function(){},iu(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}]),e}(),ee=function(){function e(t,a,o){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=a,this.z=o}var s=e.prototype;return s.set=function(t,a,o){return o===void 0&&(o=this.z),this.x=t,this.y=a,this.z=o,this},s.setScalar=function(t){return this.x=t,this.y=t,this.z=t,this},s.setX=function(t){return this.x=t,this},s.setY=function(t){return this.y=t,this},s.setZ=function(t){return this.z=t,this},s.setComponent=function(t,a){switch(t){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+t)}return this},s.getComponent=function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},s.clone=function(){return new this.constructor(this.x,this.y,this.z)},s.copy=function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},s.add=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,a)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},s.addScalar=function(t){return this.x+=t,this.y+=t,this.z+=t,this},s.addVectors=function(t,a){return this.x=t.x+a.x,this.y=t.y+a.y,this.z=t.z+a.z,this},s.addScaledVector=function(t,a){return this.x+=t.x*a,this.y+=t.y*a,this.z+=t.z*a,this},s.sub=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,a)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},s.subScalar=function(t){return this.x-=t,this.y-=t,this.z-=t,this},s.subVectors=function(t,a){return this.x=t.x-a.x,this.y=t.y-a.y,this.z=t.z-a.z,this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,a)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},s.multiplyScalar=function(t){return this.x*=t,this.y*=t,this.z*=t,this},s.multiplyVectors=function(t,a){return this.x=t.x*a.x,this.y=t.y*a.y,this.z=t.z*a.z,this},s.applyEuler=function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Zp.setFromEuler(t))},s.applyAxisAngle=function(t,a){return this.applyQuaternion(Zp.setFromAxisAngle(t,a))},s.applyMatrix3=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements;return this.x=f[0]*a+f[3]*o+f[6]*c,this.y=f[1]*a+f[4]*o+f[7]*c,this.z=f[2]*a+f[5]*o+f[8]*c,this},s.applyNormalMatrix=function(t){return this.applyMatrix3(t).normalize()},s.applyMatrix4=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements,d=1/(f[3]*a+f[7]*o+f[11]*c+f[15]);return this.x=(f[0]*a+f[4]*o+f[8]*c+f[12])*d,this.y=(f[1]*a+f[5]*o+f[9]*c+f[13])*d,this.z=(f[2]*a+f[6]*o+f[10]*c+f[14])*d,this},s.applyQuaternion=function(t){var a=this.x,o=this.y,c=this.z,f=t.x,d=t.y,m=t.z,y=t.w,w=y*a+d*c-m*o,M=y*o+m*a-f*c,D=y*c+f*o-d*a,P=-f*a-d*o-m*c;return this.x=w*y+P*-f+M*-m-D*-d,this.y=M*y+P*-d+D*-f-w*-m,this.z=D*y+P*-m+w*-d-M*-f,this},s.project=function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},s.unproject=function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},s.transformDirection=function(t){var a=this.x,o=this.y,c=this.z,f=t.elements;return this.x=f[0]*a+f[4]*o+f[8]*c,this.y=f[1]*a+f[5]*o+f[9]*c,this.z=f[2]*a+f[6]*o+f[10]*c,this.normalize()},s.divide=function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},s.divideScalar=function(t){return this.multiplyScalar(1/t)},s.min=function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},s.max=function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},s.clamp=function(t,a){return this.x=Math.max(t.x,Math.min(a.x,this.x)),this.y=Math.max(t.y,Math.min(a.y,this.y)),this.z=Math.max(t.z,Math.min(a.z,this.z)),this},s.clampScalar=function(t,a){return this.x=Math.max(t,Math.min(a,this.x)),this.y=Math.max(t,Math.min(a,this.y)),this.z=Math.max(t,Math.min(a,this.z)),this},s.clampLength=function(t,a){var o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(t,Math.min(a,o)))},s.floor=function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},s.ceil=function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},s.round=function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},s.roundToZero=function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},s.negate=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},s.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},s.lengthSq=function(){return this.x*this.x+this.y*this.y+this.z*this.z},s.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},s.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},s.normalize=function(){return this.divideScalar(this.length()||1)},s.setLength=function(t){return this.normalize().multiplyScalar(t)},s.lerp=function(t,a){return this.x+=(t.x-this.x)*a,this.y+=(t.y-this.y)*a,this.z+=(t.z-this.z)*a,this},s.lerpVectors=function(t,a,o){return this.x=t.x+(a.x-t.x)*o,this.y=t.y+(a.y-t.y)*o,this.z=t.z+(a.z-t.z)*o,this},s.cross=function(t,a){return a!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,a)):this.crossVectors(this,t)},s.crossVectors=function(t,a){var o=t.x,c=t.y,f=t.z,d=a.x,m=a.y,y=a.z;return this.x=c*y-f*m,this.y=f*d-o*y,this.z=o*m-c*d,this},s.projectOnVector=function(t){var a=t.lengthSq();if(a===0)return this.set(0,0,0);var o=t.dot(this)/a;return this.copy(t).multiplyScalar(o)},s.projectOnPlane=function(t){return td.copy(this).projectOnVector(t),this.sub(td)},s.reflect=function(t){return this.sub(td.copy(t).multiplyScalar(2*this.dot(t)))},s.angleTo=function(t){var a=Math.sqrt(this.lengthSq()*t.lengthSq());if(a===0)return Math.PI/2;var o=this.dot(t)/a;return Math.acos(Mn.clamp(o,-1,1))},s.distanceTo=function(t){return Math.sqrt(this.distanceToSquared(t))},s.distanceToSquared=function(t){var a=this.x-t.x,o=this.y-t.y,c=this.z-t.z;return a*a+o*o+c*c},s.manhattanDistanceTo=function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},s.setFromSpherical=function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},s.setFromSphericalCoords=function(t,a,o){var c=Math.sin(a)*t;return this.x=c*Math.sin(o),this.y=Math.cos(a)*t,this.z=c*Math.cos(o),this},s.setFromCylindrical=function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},s.setFromCylindricalCoords=function(t,a,o){return this.x=t*Math.sin(a),this.y=o,this.z=t*Math.cos(a),this},s.setFromMatrixPosition=function(t){var a=t.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this},s.setFromMatrixScale=function(t){var a=this.setFromMatrixColumn(t,0).length(),o=this.setFromMatrixColumn(t,1).length(),c=this.setFromMatrixColumn(t,2).length();return this.x=a,this.y=o,this.z=c,this},s.setFromMatrixColumn=function(t,a){return this.fromArray(t.elements,a*4)},s.setFromMatrix3Column=function(t,a){return this.fromArray(t.elements,a*3)},s.equals=function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},s.fromArray=function(t,a){return a===void 0&&(a=0),this.x=t[a],this.y=t[a+1],this.z=t[a+2],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.x,t[a+1]=this.y,t[a+2]=this.z,t},s.fromBufferAttribute=function(t,a,o){return o!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(a),this.y=t.getY(a),this.z=t.getZ(a),this},s.random=function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this},e}(),td=new ee,Zp=new Wr,vs=function(){function e(t,a){Object.defineProperty(this,"isBox3",{value:!0}),this.min=t!==void 0?t:new ee(1/0,1/0,1/0),this.max=a!==void 0?a:new ee(-1/0,-1/0,-1/0)}var s=e.prototype;return s.set=function(t,a){return this.min.copy(t),this.max.copy(a),this},s.setFromArray=function(t){for(var a=1/0,o=1/0,c=1/0,f=-1/0,d=-1/0,m=-1/0,y=0,w=t.length;y<w;y+=3){var M=t[y],D=t[y+1],P=t[y+2];M<a&&(a=M),D<o&&(o=D),P<c&&(c=P),M>f&&(f=M),D>d&&(d=D),P>m&&(m=P)}return this.min.set(a,o,c),this.max.set(f,d,m),this},s.setFromBufferAttribute=function(t){for(var a=1/0,o=1/0,c=1/0,f=-1/0,d=-1/0,m=-1/0,y=0,w=t.count;y<w;y++){var M=t.getX(y),D=t.getY(y),P=t.getZ(y);M<a&&(a=M),D<o&&(o=D),P<c&&(c=P),M>f&&(f=M),D>d&&(d=D),P>m&&(m=P)}return this.min.set(a,o,c),this.max.set(f,d,m),this},s.setFromPoints=function(t){this.makeEmpty();for(var a=0,o=t.length;a<o;a++)this.expandByPoint(t[a]);return this},s.setFromCenterAndSize=function(t,a){var o=ru.copy(a).multiplyScalar(.5);return this.min.copy(t).sub(o),this.max.copy(t).add(o),this},s.setFromObject=function(t){return this.makeEmpty(),this.expandByObject(t)},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},s.makeEmpty=function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},s.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ee),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},s.getSize=function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ee),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},s.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},s.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},s.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},s.expandByObject=function(t){t.updateWorldMatrix(!1,!1);var a=t.geometry;a!==void 0&&(a.boundingBox===null&&a.computeBoundingBox(),id.copy(a.boundingBox),id.applyMatrix4(t.matrixWorld),this.union(id));for(var o=t.children,c=0,f=o.length;c<f;c++)this.expandByObject(o[c]);return this},s.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},s.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},s.getParameter=function(t,a){return a===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),a=new ee),a.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},s.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},s.intersectsSphere=function(t){return this.clampPoint(t.center,ru),ru.distanceToSquared(t.center)<=t.radius*t.radius},s.intersectsPlane=function(t){var a,o;return t.normal.x>0?(a=t.normal.x*this.min.x,o=t.normal.x*this.max.x):(a=t.normal.x*this.max.x,o=t.normal.x*this.min.x),t.normal.y>0?(a+=t.normal.y*this.min.y,o+=t.normal.y*this.max.y):(a+=t.normal.y*this.max.y,o+=t.normal.y*this.min.y),t.normal.z>0?(a+=t.normal.z*this.min.z,o+=t.normal.z*this.max.z):(a+=t.normal.z*this.max.z,o+=t.normal.z*this.min.z),a<=-t.constant&&o>=-t.constant},s.intersectsTriangle=function(t){if(this.isEmpty())return!1;this.getCenter(au),bh.subVectors(this.max,au),hc.subVectors(t.a,au),fc.subVectors(t.b,au),dc.subVectors(t.c,au),Po.subVectors(fc,hc),Io.subVectors(dc,fc),vl.subVectors(hc,dc);var a=[0,-Po.z,Po.y,0,-Io.z,Io.y,0,-vl.z,vl.y,Po.z,0,-Po.x,Io.z,0,-Io.x,vl.z,0,-vl.x,-Po.y,Po.x,0,-Io.y,Io.x,0,-vl.y,vl.x,0];return!nd(a,hc,fc,dc,bh)||(a=[1,0,0,0,1,0,0,0,1],!nd(a,hc,fc,dc,bh))?!1:(wh.crossVectors(Po,Io),a=[wh.x,wh.y,wh.z],nd(a,hc,fc,dc,bh))},s.clampPoint=function(t,a){return a===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),a=new ee),a.copy(t).clamp(this.min,this.max)},s.distanceToPoint=function(t){var a=ru.copy(t).clamp(this.min,this.max);return a.sub(t).length()},s.getBoundingSphere=function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=this.getSize(ru).length()*.5,t},s.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},s.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},s.applyMatrix4=function(t){return this.isEmpty()?this:(Ks[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ks[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ks[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ks[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ks[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ks[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ks[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ks[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ks),this)},s.translate=function(t){return this.min.add(t),this.max.add(t),this},s.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}();function nd(e,s,t,a,o){for(var c=0,f=e.length-3;c<=f;c+=3){Do.fromArray(e,c);var d=o.x*Math.abs(Do.x)+o.y*Math.abs(Do.y)+o.z*Math.abs(Do.z),m=s.dot(Do),y=t.dot(Do),w=a.dot(Do);if(Math.max(-Math.max(m,y,w),Math.min(m,y,w))>d)return!1}return!0}var Ks=[new ee,new ee,new ee,new ee,new ee,new ee,new ee,new ee],ru=new ee,id=new vs,hc=new ee,fc=new ee,dc=new ee,Po=new ee,Io=new ee,vl=new ee,au=new ee,bh=new ee,wh=new ee,Do=new ee,Oo=new vs,da=function(){function e(t,a){this.center=t!==void 0?t:new ee,this.radius=a!==void 0?a:-1}var s=e.prototype;return s.set=function(t,a){return this.center.copy(t),this.radius=a,this},s.setFromPoints=function(t,a){var o=this.center;a!==void 0?o.copy(a):Oo.setFromPoints(t).getCenter(o);for(var c=0,f=0,d=t.length;f<d;f++)c=Math.max(c,o.distanceToSquared(t[f]));return this.radius=Math.sqrt(c),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.center.copy(t.center),this.radius=t.radius,this},s.isEmpty=function(){return this.radius<0},s.makeEmpty=function(){return this.center.set(0,0,0),this.radius=-1,this},s.containsPoint=function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},s.distanceToPoint=function(t){return t.distanceTo(this.center)-this.radius},s.intersectsSphere=function(t){var a=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=a*a},s.intersectsBox=function(t){return t.intersectsSphere(this)},s.intersectsPlane=function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},s.clampPoint=function(t,a){var o=this.center.distanceToSquared(t);return a===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),a=new ee),a.copy(t),o>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a},s.getBoundingBox=function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new vs),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},s.applyMatrix4=function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},s.translate=function(t){return this.center.add(t),this},s.equals=function(t){return t.center.equals(this.center)&&t.radius===this.radius},e}(),$a=new ee,Qs=new ee,su=new ee,No=new ee,ys=new ee,_s=new ee,Fo=new ee,es=function(){function e(t,a){this.origin=t!==void 0?t:new ee,this.direction=a!==void 0?a:new ee(0,0,-1)}var s=e.prototype;return s.set=function(t,a){return this.origin.copy(t),this.direction.copy(a),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},s.at=function(t,a){return a===void 0&&(console.warn("THREE.Ray: .at() target is now required"),a=new ee),a.copy(this.direction).multiplyScalar(t).add(this.origin)},s.lookAt=function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},s.recast=function(t){return this.origin.copy(this.at(t,$a)),this},s.closestPointToPoint=function(t,a){a===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),a=new ee),a.subVectors(t,this.origin);var o=a.dot(this.direction);return o<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(o).add(this.origin)},s.distanceToPoint=function(t){return Math.sqrt(this.distanceSqToPoint(t))},s.distanceSqToPoint=function(t){var a=$a.subVectors(t,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(t):($a.copy(this.direction).multiplyScalar(a).add(this.origin),$a.distanceToSquared(t))},s.distanceSqToSegment=function(t,a,o,c){Qs.copy(t).add(a).multiplyScalar(.5),su.copy(a).sub(t).normalize(),No.copy(this.origin).sub(Qs);var f=t.distanceTo(a)*.5,d=-this.direction.dot(su),m=No.dot(this.direction),y=-No.dot(su),w=No.lengthSq(),M=Math.abs(1-d*d),D,P,F,C;if(M>0)if(D=d*y-m,P=d*m-y,C=f*M,D>=0)if(P>=-C)if(P<=C){var I=1/M;D*=I,P*=I,F=D*(D+d*P+2*m)+P*(d*D+P+2*y)+w}else P=f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;else P=-f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;else P<=-C?(D=Math.max(0,-(-d*f+m)),P=D>0?-f:Math.min(Math.max(-f,-y),f),F=-D*D+P*(P+2*y)+w):P<=C?(D=0,P=Math.min(Math.max(-f,-y),f),F=P*(P+2*y)+w):(D=Math.max(0,-(d*f+m)),P=D>0?f:Math.min(Math.max(-f,-y),f),F=-D*D+P*(P+2*y)+w);else P=d>0?-f:f,D=Math.max(0,-(d*P+m)),F=-D*D+P*(P+2*y)+w;return o&&o.copy(this.direction).multiplyScalar(D).add(this.origin),c&&c.copy(su).multiplyScalar(P).add(Qs),F},s.intersectSphere=function(t,a){$a.subVectors(t.center,this.origin);var o=$a.dot(this.direction),c=$a.dot($a)-o*o,f=t.radius*t.radius;if(c>f)return null;var d=Math.sqrt(f-c),m=o-d,y=o+d;return m<0&&y<0?null:m<0?this.at(y,a):this.at(m,a)},s.intersectsSphere=function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},s.distanceToPlane=function(t){var a=t.normal.dot(this.direction);if(a===0)return t.distanceToPoint(this.origin)===0?0:null;var o=-(this.origin.dot(t.normal)+t.constant)/a;return o>=0?o:null},s.intersectPlane=function(t,a){var o=this.distanceToPlane(t);return o===null?null:this.at(o,a)},s.intersectsPlane=function(t){var a=t.distanceToPoint(this.origin);if(a===0)return!0;var o=t.normal.dot(this.direction);return o*a<0},s.intersectBox=function(t,a){var o,c,f,d,m,y,w=1/this.direction.x,M=1/this.direction.y,D=1/this.direction.z,P=this.origin;return w>=0?(o=(t.min.x-P.x)*w,c=(t.max.x-P.x)*w):(o=(t.max.x-P.x)*w,c=(t.min.x-P.x)*w),M>=0?(f=(t.min.y-P.y)*M,d=(t.max.y-P.y)*M):(f=(t.max.y-P.y)*M,d=(t.min.y-P.y)*M),o>d||f>c||((f>o||o!==o)&&(o=f),(d<c||c!==c)&&(c=d),D>=0?(m=(t.min.z-P.z)*D,y=(t.max.z-P.z)*D):(m=(t.max.z-P.z)*D,y=(t.min.z-P.z)*D),o>y||m>c)||((m>o||o!==o)&&(o=m),(y<c||c!==c)&&(c=y),c<0)?null:this.at(o>=0?o:c,a)},s.intersectsBox=function(t){return this.intersectBox(t,$a)!==null},s.intersectTriangle=function(t,a,o,c,f){ys.subVectors(a,t),_s.subVectors(o,t),Fo.crossVectors(ys,_s);var d=this.direction.dot(Fo),m;if(d>0){if(c)return null;m=1}else if(d<0)m=-1,d=-d;else return null;No.subVectors(this.origin,t);var y=m*this.direction.dot(_s.crossVectors(No,_s));if(y<0)return null;var w=m*this.direction.dot(ys.cross(No));if(w<0||y+w>d)return null;var M=-m*No.dot(Fo);return M<0?null:this.at(M/d,f)},s.applyMatrix4=function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},s.equals=function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)},e}(),Hn=function(){function e(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}var s=e.prototype;return s.set=function(t,a,o,c,f,d,m,y,w,M,D,P,F,C,I,q){var J=this.elements;return J[0]=t,J[4]=a,J[8]=o,J[12]=c,J[1]=f,J[5]=d,J[9]=m,J[13]=y,J[2]=w,J[6]=M,J[10]=D,J[14]=P,J[3]=F,J[7]=C,J[11]=I,J[15]=q,this},s.identity=function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},s.clone=function(){return new e().fromArray(this.elements)},s.copy=function(t){var a=this.elements,o=t.elements;return a[0]=o[0],a[1]=o[1],a[2]=o[2],a[3]=o[3],a[4]=o[4],a[5]=o[5],a[6]=o[6],a[7]=o[7],a[8]=o[8],a[9]=o[9],a[10]=o[10],a[11]=o[11],a[12]=o[12],a[13]=o[13],a[14]=o[14],a[15]=o[15],this},s.copyPosition=function(t){var a=this.elements,o=t.elements;return a[12]=o[12],a[13]=o[13],a[14]=o[14],this},s.extractBasis=function(t,a,o){return t.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this},s.makeBasis=function(t,a,o){return this.set(t.x,a.x,o.x,0,t.y,a.y,o.y,0,t.z,a.z,o.z,0,0,0,0,1),this},s.extractRotation=function(t){var a=this.elements,o=t.elements,c=1/yl.setFromMatrixColumn(t,0).length(),f=1/yl.setFromMatrixColumn(t,1).length(),d=1/yl.setFromMatrixColumn(t,2).length();return a[0]=o[0]*c,a[1]=o[1]*c,a[2]=o[2]*c,a[3]=0,a[4]=o[4]*f,a[5]=o[5]*f,a[6]=o[6]*f,a[7]=0,a[8]=o[8]*d,a[9]=o[9]*d,a[10]=o[10]*d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},s.makeRotationFromEuler=function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var a=this.elements,o=t.x,c=t.y,f=t.z,d=Math.cos(o),m=Math.sin(o),y=Math.cos(c),w=Math.sin(c),M=Math.cos(f),D=Math.sin(f);if(t.order==="XYZ"){var P=d*M,F=d*D,C=m*M,I=m*D;a[0]=y*M,a[4]=-y*D,a[8]=w,a[1]=F+C*w,a[5]=P-I*w,a[9]=-m*y,a[2]=I-P*w,a[6]=C+F*w,a[10]=d*y}else if(t.order==="YXZ"){var q=y*M,J=y*D,Z=w*M,G=w*D;a[0]=q+G*m,a[4]=Z*m-J,a[8]=d*w,a[1]=d*D,a[5]=d*M,a[9]=-m,a[2]=J*m-Z,a[6]=G+q*m,a[10]=d*y}else if(t.order==="ZXY"){var Y=y*M,ne=y*D,se=w*M,Ee=w*D;a[0]=Y-Ee*m,a[4]=-d*D,a[8]=se+ne*m,a[1]=ne+se*m,a[5]=d*M,a[9]=Ee-Y*m,a[2]=-d*w,a[6]=m,a[10]=d*y}else if(t.order==="ZYX"){var Be=d*M,ce=d*D,oe=m*M,ie=m*D;a[0]=y*M,a[4]=oe*w-ce,a[8]=Be*w+ie,a[1]=y*D,a[5]=ie*w+Be,a[9]=ce*w-oe,a[2]=-w,a[6]=m*y,a[10]=d*y}else if(t.order==="YZX"){var Ce=d*y,De=d*w,Oe=m*y,et=m*w;a[0]=y*M,a[4]=et-Ce*D,a[8]=Oe*D+De,a[1]=D,a[5]=d*M,a[9]=-m*M,a[2]=-w*M,a[6]=De*D+Oe,a[10]=Ce-et*D}else if(t.order==="XZY"){var mt=d*y,dt=d*w,ot=m*y,Mt=m*w;a[0]=y*M,a[4]=-D,a[8]=w*M,a[1]=mt*D+Mt,a[5]=d*M,a[9]=dt*D-ot,a[2]=ot*D-dt,a[6]=m*M,a[10]=Mt*D+mt}return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},s.makeRotationFromQuaternion=function(t){return this.compose(Tv,t,Bo)},s.lookAt=function(t,a,o){var c=this.elements;return Sa.subVectors(t,a),Sa.lengthSq()===0&&(Sa.z=1),Sa.normalize(),$s.crossVectors(o,Sa),$s.lengthSq()===0&&(Math.abs(o.z)===1?Sa.x+=1e-4:Sa.z+=1e-4,Sa.normalize(),$s.crossVectors(o,Sa)),$s.normalize(),Mh.crossVectors(Sa,$s),c[0]=$s.x,c[4]=Mh.x,c[8]=Sa.x,c[1]=$s.y,c[5]=Mh.y,c[9]=Sa.y,c[2]=$s.z,c[6]=Mh.z,c[10]=Sa.z,this},s.multiply=function(t,a){return a!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,a)):this.multiplyMatrices(this,t)},s.premultiply=function(t){return this.multiplyMatrices(t,this)},s.multiplyMatrices=function(t,a){var o=t.elements,c=a.elements,f=this.elements,d=o[0],m=o[4],y=o[8],w=o[12],M=o[1],D=o[5],P=o[9],F=o[13],C=o[2],I=o[6],q=o[10],J=o[14],Z=o[3],G=o[7],Y=o[11],ne=o[15],se=c[0],Ee=c[4],Be=c[8],ce=c[12],oe=c[1],ie=c[5],Ce=c[9],De=c[13],Oe=c[2],et=c[6],mt=c[10],dt=c[14],ot=c[3],Mt=c[7],zt=c[11],Bt=c[15];return f[0]=d*se+m*oe+y*Oe+w*ot,f[4]=d*Ee+m*ie+y*et+w*Mt,f[8]=d*Be+m*Ce+y*mt+w*zt,f[12]=d*ce+m*De+y*dt+w*Bt,f[1]=M*se+D*oe+P*Oe+F*ot,f[5]=M*Ee+D*ie+P*et+F*Mt,f[9]=M*Be+D*Ce+P*mt+F*zt,f[13]=M*ce+D*De+P*dt+F*Bt,f[2]=C*se+I*oe+q*Oe+J*ot,f[6]=C*Ee+I*ie+q*et+J*Mt,f[10]=C*Be+I*Ce+q*mt+J*zt,f[14]=C*ce+I*De+q*dt+J*Bt,f[3]=Z*se+G*oe+Y*Oe+ne*ot,f[7]=Z*Ee+G*ie+Y*et+ne*Mt,f[11]=Z*Be+G*Ce+Y*mt+ne*zt,f[15]=Z*ce+G*De+Y*dt+ne*Bt,this},s.multiplyScalar=function(t){var a=this.elements;return a[0]*=t,a[4]*=t,a[8]*=t,a[12]*=t,a[1]*=t,a[5]*=t,a[9]*=t,a[13]*=t,a[2]*=t,a[6]*=t,a[10]*=t,a[14]*=t,a[3]*=t,a[7]*=t,a[11]*=t,a[15]*=t,this},s.determinant=function(){var t=this.elements,a=t[0],o=t[4],c=t[8],f=t[12],d=t[1],m=t[5],y=t[9],w=t[13],M=t[2],D=t[6],P=t[10],F=t[14],C=t[3],I=t[7],q=t[11],J=t[15];return C*(+f*y*D-c*w*D-f*m*P+o*w*P+c*m*F-o*y*F)+I*(+a*y*F-a*w*P+f*d*P-c*d*F+c*w*M-f*y*M)+q*(+a*w*D-a*m*F-f*d*D+o*d*F+f*m*M-o*w*M)+J*(-c*m*M-a*y*D+a*m*P+c*d*D-o*d*P+o*y*M)},s.transpose=function(){var t=this.elements,a=t[1];return t[1]=t[4],t[4]=a,a=t[2],t[2]=t[8],t[8]=a,a=t[6],t[6]=t[9],t[9]=a,a=t[3],t[3]=t[12],t[12]=a,a=t[7],t[7]=t[13],t[13]=a,a=t[11],t[11]=t[14],t[14]=a,this},s.setPosition=function(t,a,o){var c=this.elements;return t.isVector3?(c[12]=t.x,c[13]=t.y,c[14]=t.z):(c[12]=t,c[13]=a,c[14]=o),this},s.getInverse=function(t,a){a!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");var o=this.elements,c=t.elements,f=c[0],d=c[1],m=c[2],y=c[3],w=c[4],M=c[5],D=c[6],P=c[7],F=c[8],C=c[9],I=c[10],q=c[11],J=c[12],Z=c[13],G=c[14],Y=c[15],ne=C*G*P-Z*I*P+Z*D*q-M*G*q-C*D*Y+M*I*Y,se=J*I*P-F*G*P-J*D*q+w*G*q+F*D*Y-w*I*Y,Ee=F*Z*P-J*C*P+J*M*q-w*Z*q-F*M*Y+w*C*Y,Be=J*C*D-F*Z*D-J*M*I+w*Z*I+F*M*G-w*C*G,ce=f*ne+d*se+m*Ee+y*Be;if(ce===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var oe=1/ce;return o[0]=ne*oe,o[1]=(Z*I*y-C*G*y-Z*m*q+d*G*q+C*m*Y-d*I*Y)*oe,o[2]=(M*G*y-Z*D*y+Z*m*P-d*G*P-M*m*Y+d*D*Y)*oe,o[3]=(C*D*y-M*I*y-C*m*P+d*I*P+M*m*q-d*D*q)*oe,o[4]=se*oe,o[5]=(F*G*y-J*I*y+J*m*q-f*G*q-F*m*Y+f*I*Y)*oe,o[6]=(J*D*y-w*G*y-J*m*P+f*G*P+w*m*Y-f*D*Y)*oe,o[7]=(w*I*y-F*D*y+F*m*P-f*I*P-w*m*q+f*D*q)*oe,o[8]=Ee*oe,o[9]=(J*C*y-F*Z*y-J*d*q+f*Z*q+F*d*Y-f*C*Y)*oe,o[10]=(w*Z*y-J*M*y+J*d*P-f*Z*P-w*d*Y+f*M*Y)*oe,o[11]=(F*M*y-w*C*y-F*d*P+f*C*P+w*d*q-f*M*q)*oe,o[12]=Be*oe,o[13]=(F*Z*m-J*C*m+J*d*I-f*Z*I-F*d*G+f*C*G)*oe,o[14]=(J*M*m-w*Z*m-J*d*D+f*Z*D+w*d*G-f*M*G)*oe,o[15]=(w*C*m-F*M*m+F*d*D-f*C*D-w*d*I+f*M*I)*oe,this},s.scale=function(t){var a=this.elements,o=t.x,c=t.y,f=t.z;return a[0]*=o,a[4]*=c,a[8]*=f,a[1]*=o,a[5]*=c,a[9]*=f,a[2]*=o,a[6]*=c,a[10]*=f,a[3]*=o,a[7]*=c,a[11]*=f,this},s.getMaxScaleOnAxis=function(){var t=this.elements,a=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],o=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],c=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(a,o,c))},s.makeTranslation=function(t,a,o){return this.set(1,0,0,t,0,1,0,a,0,0,1,o,0,0,0,1),this},s.makeRotationX=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(1,0,0,0,0,a,-o,0,0,o,a,0,0,0,0,1),this},s.makeRotationY=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(a,0,o,0,0,1,0,0,-o,0,a,0,0,0,0,1),this},s.makeRotationZ=function(t){var a=Math.cos(t),o=Math.sin(t);return this.set(a,-o,0,0,o,a,0,0,0,0,1,0,0,0,0,1),this},s.makeRotationAxis=function(t,a){var o=Math.cos(a),c=Math.sin(a),f=1-o,d=t.x,m=t.y,y=t.z,w=f*d,M=f*m;return this.set(w*d+o,w*m-c*y,w*y+c*m,0,w*m+c*y,M*m+o,M*y-c*d,0,w*y-c*m,M*y+c*d,f*y*y+o,0,0,0,0,1),this},s.makeScale=function(t,a,o){return this.set(t,0,0,0,0,a,0,0,0,0,o,0,0,0,0,1),this},s.makeShear=function(t,a,o){return this.set(1,a,o,0,t,1,o,0,t,a,1,0,0,0,0,1),this},s.compose=function(t,a,o){var c=this.elements,f=a._x,d=a._y,m=a._z,y=a._w,w=f+f,M=d+d,D=m+m,P=f*w,F=f*M,C=f*D,I=d*M,q=d*D,J=m*D,Z=y*w,G=y*M,Y=y*D,ne=o.x,se=o.y,Ee=o.z;return c[0]=(1-(I+J))*ne,c[1]=(F+Y)*ne,c[2]=(C-G)*ne,c[3]=0,c[4]=(F-Y)*se,c[5]=(1-(P+J))*se,c[6]=(q+Z)*se,c[7]=0,c[8]=(C+G)*Ee,c[9]=(q-Z)*Ee,c[10]=(1-(P+I))*Ee,c[11]=0,c[12]=t.x,c[13]=t.y,c[14]=t.z,c[15]=1,this},s.decompose=function(t,a,o){var c=this.elements,f=yl.set(c[0],c[1],c[2]).length(),d=yl.set(c[4],c[5],c[6]).length(),m=yl.set(c[8],c[9],c[10]).length(),y=this.determinant();y<0&&(f=-f),t.x=c[12],t.y=c[13],t.z=c[14],ts.copy(this);var w=1/f,M=1/d,D=1/m;return ts.elements[0]*=w,ts.elements[1]*=w,ts.elements[2]*=w,ts.elements[4]*=M,ts.elements[5]*=M,ts.elements[6]*=M,ts.elements[8]*=D,ts.elements[9]*=D,ts.elements[10]*=D,a.setFromRotationMatrix(ts),o.x=f,o.y=d,o.z=m,this},s.makePerspective=function(t,a,o,c,f,d){d===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var m=this.elements;return m[0]=2*f/(a-t),m[4]=0,m[8]=(a+t)/(a-t),m[12]=0,m[1]=0,m[5]=2*f/(o-c),m[9]=(o+c)/(o-c),m[13]=0,m[2]=0,m[6]=0,m[10]=-(d+f)/(d-f),m[14]=-2*d*f/(d-f),m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this},s.makeOrthographic=function(t,a,o,c,f,d){var m=this.elements,y=1/(a-t),w=1/(o-c),M=1/(d-f);return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-((a+t)*y),m[1]=0,m[5]=2*w,m[9]=0,m[13]=-((o+c)*w),m[2]=0,m[6]=0,m[10]=-2*M,m[14]=-((d+f)*M),m[3]=0,m[7]=0,m[11]=0,m[15]=1,this},s.equals=function(t){for(var a=this.elements,o=t.elements,c=0;c<16;c++)if(a[c]!==o[c])return!1;return!0},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=0;o<16;o++)this.elements[o]=t[o+a];return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);var o=this.elements;return t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3],t[a+4]=o[4],t[a+5]=o[5],t[a+6]=o[6],t[a+7]=o[7],t[a+8]=o[8],t[a+9]=o[9],t[a+10]=o[10],t[a+11]=o[11],t[a+12]=o[12],t[a+13]=o[13],t[a+14]=o[14],t[a+15]=o[15],t},e}(),yl=new ee,ts=new Hn,Tv=new ee(0,0,0),Bo=new ee(1,1,1),$s=new ee,Mh=new ee,Sa=new ee,Sh=function(){function e(t,a,o,c){t===void 0&&(t=0),a===void 0&&(a=0),o===void 0&&(o=0),c===void 0&&(c=e.DefaultOrder),Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=a,this._z=o,this._order=c}var s=e.prototype;return s.set=function(t,a,o,c){return this._x=t,this._y=a,this._z=o,this._order=c||this._order,this._onChangeCallback(),this},s.clone=function(){return new this.constructor(this._x,this._y,this._z,this._order)},s.copy=function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},s.setFromRotationMatrix=function(t,a,o){var c=Mn.clamp,f=t.elements,d=f[0],m=f[4],y=f[8],w=f[1],M=f[5],D=f[9],P=f[2],F=f[6],C=f[10];switch(a=a||this._order,a){case"XYZ":this._y=Math.asin(c(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-D,C),this._z=Math.atan2(-m,d)):(this._x=Math.atan2(F,M),this._z=0);break;case"YXZ":this._x=Math.asin(-c(D,-1,1)),Math.abs(D)<.9999999?(this._y=Math.atan2(y,C),this._z=Math.atan2(w,M)):(this._y=Math.atan2(-P,d),this._z=0);break;case"ZXY":this._x=Math.asin(c(F,-1,1)),Math.abs(F)<.9999999?(this._y=Math.atan2(-P,C),this._z=Math.atan2(-m,M)):(this._y=0,this._z=Math.atan2(w,d));break;case"ZYX":this._y=Math.asin(-c(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(F,C),this._z=Math.atan2(w,d)):(this._x=0,this._z=Math.atan2(-m,M));break;case"YZX":this._z=Math.asin(c(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(-D,M),this._y=Math.atan2(-P,d)):(this._x=0,this._y=Math.atan2(y,C));break;case"XZY":this._z=Math.asin(-c(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(F,M),this._y=Math.atan2(y,d)):(this._x=Math.atan2(-D,C),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+a)}return this._order=a,o!==!1&&this._onChangeCallback(),this},s.setFromQuaternion=function(t,a,o){return rd.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rd,a,o)},s.setFromVector3=function(t,a){return this.set(t.x,t.y,t.z,a||this._order)},s.reorder=function(t){return ad.setFromEuler(this),this.setFromQuaternion(ad,t)},s.equals=function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},s.fromArray=function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this._x,t[a+1]=this._y,t[a+2]=this._z,t[a+3]=this._order,t},s.toVector3=function(t){return t?t.set(this._x,this._y,this._z):new ee(this._x,this._y,this._z)},s._onChange=function(t){return this._onChangeCallback=t,this},s._onChangeCallback=function(){},iu(e,[{key:"x",get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}]),e}();Sh.DefaultOrder="XYZ",Sh.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var rd=new Hn,ad=new Wr,sd=function(){function e(){this.mask=1}var s=e.prototype;return s.set=function(t){this.mask=1<<t|0},s.enable=function(t){this.mask|=1<<t|0},s.enableAll=function(){this.mask=-1},s.toggle=function(t){this.mask^=1<<t|0},s.disable=function(t){this.mask&=~(1<<t|0)},s.disableAll=function(){this.mask=0},s.test=function(t){return(this.mask&t.mask)!==0},e}(),Ev=0,Jp=new ee,pc=new Wr,eo=new Hn,Th=new ee,mr=new ee,Uo=new ee,Kp=new Wr,Eh=new ee(1,0,0),xs=new ee(0,1,0),od=new ee(0,0,1),mc={type:"added"},ld={type:"removed"};function Jt(){Object.defineProperty(this,"id",{value:Ev++}),this.uuid=Mn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Jt.DefaultUp.clone();var e=new ee,s=new Sh,t=new Wr,a=new ee(1,1,1);s._onChange(function(){t.setFromEuler(s,!1)}),t._onChange(function(){s.setFromQuaternion(t,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:a},modelViewMatrix:{value:new Hn},normalMatrix:{value:new ta}}),this.matrix=new Hn,this.matrixWorld=new Hn,this.matrixAutoUpdate=Jt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new sd,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Jt.DefaultUp=new ee(0,1,0),Jt.DefaultMatrixAutoUpdate=!0,Jt.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Jt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,s){this.quaternion.setFromAxisAngle(e,s)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,s){return pc.setFromAxisAngle(e,s),this.quaternion.multiply(pc),this},rotateOnWorldAxis:function(e,s){return pc.setFromAxisAngle(e,s),this.quaternion.premultiply(pc),this},rotateX:function(e){return this.rotateOnAxis(Eh,e)},rotateY:function(e){return this.rotateOnAxis(xs,e)},rotateZ:function(e){return this.rotateOnAxis(od,e)},translateOnAxis:function(e,s){return Jp.copy(e).applyQuaternion(this.quaternion),this.position.add(Jp.multiplyScalar(s)),this},translateX:function(e){return this.translateOnAxis(Eh,e)},translateY:function(e){return this.translateOnAxis(xs,e)},translateZ:function(e){return this.translateOnAxis(od,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(eo.getInverse(this.matrixWorld))},lookAt:function(e,s,t){e.isVector3?Th.copy(e):Th.set(e,s,t);var a=this.parent;this.updateWorldMatrix(!0,!1),mr.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?eo.lookAt(mr,Th,this.up):eo.lookAt(Th,mr,this.up),this.quaternion.setFromRotationMatrix(eo),a&&(eo.extractRotation(a.matrixWorld),pc.setFromRotationMatrix(eo),this.quaternion.premultiply(pc.inverse()))},add:function(e){if(arguments.length>1){for(var s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(mc)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var s=0;s<arguments.length;s++)this.remove(arguments[s]);return this}var t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(ld)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),eo.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),eo.multiply(e.parent.matrixWorld)),e.applyMatrix4(eo),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,s){if(this[e]===s)return this;for(var t=0,a=this.children.length;t<a;t++){var o=this.children[t],c=o.getObjectByProperty(e,s);if(c!==void 0)return c}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Wr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mr,e,Uo),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(mr,Kp,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new ee),this.updateWorldMatrix(!0,!1);var s=this.matrixWorld.elements;return e.set(s[8],s[9],s[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].traverseVisible(e)}},traverseAncestors:function(e){var s=this.parent;s!==null&&(e(s),s.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var s=this.children,t=0,a=s.length;t<a;t++)s[t].updateMatrixWorld(e)},updateWorldMatrix:function(e,s){var t=this.parent;if(e===!0&&t!==null&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),s===!0)for(var a=this.children,o=0,c=a.length;o<c;o++)a[o].updateWorldMatrix(!1,!0)},toJSON:function(e){var s=e===void 0||typeof e=="string",t={};s&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},t.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var a={};a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON());function o(G,Y){return G[Y.uuid]===void 0&&(G[Y.uuid]=Y.toJSON(e)),Y.uuid}if(this.isMesh||this.isLine||this.isPoints){a.geometry=o(e.geometries,this.geometry);var c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){var f=c.shapes;if(Array.isArray(f))for(var d=0,m=f.length;d<m;d++){var y=f[d];o(e.shapes,y)}else o(e.shapes,f)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var w=[],M=0,D=this.material.length;M<D;M++)w.push(o(e.materials,this.material[M]));a.material=w}else a.material=o(e.materials,this.material);if(this.children.length>0){a.children=[];for(var P=0;P<this.children.length;P++)a.children.push(this.children[P].toJSON(e).object)}if(s){var F=Z(e.geometries),C=Z(e.materials),I=Z(e.textures),q=Z(e.images),J=Z(e.shapes);F.length>0&&(t.geometries=F),C.length>0&&(t.materials=C),I.length>0&&(t.textures=I),q.length>0&&(t.images=q),J.length>0&&(t.shapes=J)}return t.object=a,t;function Z(G){var Y=[];for(var ne in G){var se=G[ne];delete se.metadata,Y.push(se)}return Y}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,s){if(s===void 0&&(s=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),s===!0)for(var t=0;t<e.children.length;t++){var a=e.children[t];this.add(a.clone())}return this}});var Ah=new ee,Qp=new ee,$p=new ta,pa=function(){function e(t,a){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=t!==void 0?t:new ee(1,0,0),this.constant=a!==void 0?a:0}var s=e.prototype;return s.set=function(t,a){return this.normal.copy(t),this.constant=a,this},s.setComponents=function(t,a,o,c){return this.normal.set(t,a,o),this.constant=c,this},s.setFromNormalAndCoplanarPoint=function(t,a){return this.normal.copy(t),this.constant=-a.dot(this.normal),this},s.setFromCoplanarPoints=function(t,a,o){var c=Ah.subVectors(o,a).cross(Qp.subVectors(t,a)).normalize();return this.setFromNormalAndCoplanarPoint(c,t),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},s.normalize=function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},s.negate=function(){return this.constant*=-1,this.normal.negate(),this},s.distanceToPoint=function(t){return this.normal.dot(t)+this.constant},s.distanceToSphere=function(t){return this.distanceToPoint(t.center)-t.radius},s.projectPoint=function(t,a){return a===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),a=new ee),a.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},s.intersectLine=function(t,a){a===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),a=new ee);var o=t.delta(Ah),c=this.normal.dot(o);if(c===0)return this.distanceToPoint(t.start)===0?a.copy(t.start):void 0;var f=-(t.start.dot(this.normal)+this.constant)/c;if(!(f<0||f>1))return a.copy(o).multiplyScalar(f).add(t.start)},s.intersectsLine=function(t){var a=this.distanceToPoint(t.start),o=this.distanceToPoint(t.end);return a<0&&o>0||o<0&&a>0},s.intersectsBox=function(t){return t.intersectsPlane(this)},s.intersectsSphere=function(t){return t.intersectsPlane(this)},s.coplanarPoint=function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ee),t.copy(this.normal).multiplyScalar(-this.constant)},s.applyMatrix4=function(t,a){var o=a||$p.getNormalMatrix(t),c=this.coplanarPoint(Ah).applyMatrix4(t),f=this.normal.applyMatrix3(o).normalize();return this.constant=-c.dot(f),this},s.translate=function(t){return this.constant-=t.dot(this.normal),this},s.equals=function(t){return t.normal.equals(this.normal)&&t.constant===this.constant},e}(),Cr=new ee,bs=new ee,ws=new ee,ma=new ee,gc=new ee,_l=new ee,em=new ee,cd=new ee,vc=new ee,xl=new ee,Da=function(){function e(t,a,o){this.a=t!==void 0?t:new ee,this.b=a!==void 0?a:new ee,this.c=o!==void 0?o:new ee}e.getNormal=function(t,a,o,c){c===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),c=new ee),c.subVectors(o,a),Cr.subVectors(t,a),c.cross(Cr);var f=c.lengthSq();return f>0?c.multiplyScalar(1/Math.sqrt(f)):c.set(0,0,0)},e.getBarycoord=function(t,a,o,c,f){Cr.subVectors(c,a),bs.subVectors(o,a),ws.subVectors(t,a);var d=Cr.dot(Cr),m=Cr.dot(bs),y=Cr.dot(ws),w=bs.dot(bs),M=bs.dot(ws),D=d*w-m*m;if(f===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),f=new ee),D===0)return f.set(-2,-1,-1);var P=1/D,F=(w*y-m*M)*P,C=(d*M-m*y)*P;return f.set(1-F-C,C,F)},e.containsPoint=function(t,a,o,c){return this.getBarycoord(t,a,o,c,ma),ma.x>=0&&ma.y>=0&&ma.x+ma.y<=1},e.getUV=function(t,a,o,c,f,d,m,y){return this.getBarycoord(t,a,o,c,ma),y.set(0,0),y.addScaledVector(f,ma.x),y.addScaledVector(d,ma.y),y.addScaledVector(m,ma.z),y},e.isFrontFacing=function(t,a,o,c){return Cr.subVectors(o,a),bs.subVectors(t,a),Cr.cross(bs).dot(c)<0};var s=e.prototype;return s.set=function(t,a,o){return this.a.copy(t),this.b.copy(a),this.c.copy(o),this},s.setFromPointsAndIndices=function(t,a,o,c){return this.a.copy(t[a]),this.b.copy(t[o]),this.c.copy(t[c]),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},s.getArea=function(){return Cr.subVectors(this.c,this.b),bs.subVectors(this.a,this.b),Cr.cross(bs).length()*.5},s.getMidpoint=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ee),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},s.getNormal=function(t){return e.getNormal(this.a,this.b,this.c,t)},s.getPlane=function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new pa),t.setFromCoplanarPoints(this.a,this.b,this.c)},s.getBarycoord=function(t,a){return e.getBarycoord(t,this.a,this.b,this.c,a)},s.getUV=function(t,a,o,c,f){return e.getUV(t,this.a,this.b,this.c,a,o,c,f)},s.containsPoint=function(t){return e.containsPoint(t,this.a,this.b,this.c)},s.isFrontFacing=function(t){return e.isFrontFacing(this.a,this.b,this.c,t)},s.intersectsBox=function(t){return t.intersectsTriangle(this)},s.closestPointToPoint=function(t,a){a===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),a=new ee);var o=this.a,c=this.b,f=this.c,d,m;gc.subVectors(c,o),_l.subVectors(f,o),cd.subVectors(t,o);var y=gc.dot(cd),w=_l.dot(cd);if(y<=0&&w<=0)return a.copy(o);vc.subVectors(t,c);var M=gc.dot(vc),D=_l.dot(vc);if(M>=0&&D<=M)return a.copy(c);var P=y*D-M*w;if(P<=0&&y>=0&&M<=0)return d=y/(y-M),a.copy(o).addScaledVector(gc,d);xl.subVectors(t,f);var F=gc.dot(xl),C=_l.dot(xl);if(C>=0&&F<=C)return a.copy(f);var I=F*w-y*C;if(I<=0&&w>=0&&C<=0)return m=w/(w-C),a.copy(o).addScaledVector(_l,m);var q=M*C-F*D;if(q<=0&&D-M>=0&&F-C>=0)return em.subVectors(f,c),m=(D-M)/(D-M+(F-C)),a.copy(c).addScaledVector(em,m);var J=1/(q+I+P);return d=I*J,m=P*J,a.copy(o).addScaledVector(gc,d).addScaledVector(_l,m)},s.equals=function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)},e}(),ud={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Oa={h:0,s:0,l:0},yc={h:0,s:0,l:0};function ou(e,s,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+(s-e)*6*t:t<1/2?s:t<2/3?e+(s-e)*6*(2/3-t):e}function bl(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function _c(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}var qt=function(){function e(t,a,o){return Object.defineProperty(this,"isColor",{value:!0}),a===void 0&&o===void 0?this.set(t):this.setRGB(t,a,o)}var s=e.prototype;return s.set=function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},s.setScalar=function(t){return this.r=t,this.g=t,this.b=t,this},s.setHex=function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},s.setRGB=function(t,a,o){return this.r=t,this.g=a,this.b=o,this},s.setHSL=function(t,a,o){if(t=Mn.euclideanModulo(t,1),a=Mn.clamp(a,0,1),o=Mn.clamp(o,0,1),a===0)this.r=this.g=this.b=o;else{var c=o<=.5?o*(1+a):o+a-o*a,f=2*o-c;this.r=ou(f,c,t+1/3),this.g=ou(f,c,t),this.b=ou(f,c,t-1/3)}return this},s.setStyle=function(t){function a(P){P!==void 0&&parseFloat(P)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var o;if(o=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var c,f=o[1],d=o[2];switch(f){case"rgb":case"rgba":if(c=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(255,parseInt(c[1],10))/255,this.g=Math.min(255,parseInt(c[2],10))/255,this.b=Math.min(255,parseInt(c[3],10))/255,a(c[5]),this;if(c=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d))return this.r=Math.min(100,parseInt(c[1],10))/100,this.g=Math.min(100,parseInt(c[2],10))/100,this.b=Math.min(100,parseInt(c[3],10))/100,a(c[5]),this;break;case"hsl":case"hsla":if(c=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(d)){var m=parseFloat(c[1])/360,y=parseInt(c[2],10)/100,w=parseInt(c[3],10)/100;return a(c[5]),this.setHSL(m,y,w)}break}}else if(o=/^\#([A-Fa-f0-9]+)$/.exec(t)){var M=o[1],D=M.length;if(D===3)return this.r=parseInt(M.charAt(0)+M.charAt(0),16)/255,this.g=parseInt(M.charAt(1)+M.charAt(1),16)/255,this.b=parseInt(M.charAt(2)+M.charAt(2),16)/255,this;if(D===6)return this.r=parseInt(M.charAt(0)+M.charAt(1),16)/255,this.g=parseInt(M.charAt(2)+M.charAt(3),16)/255,this.b=parseInt(M.charAt(4)+M.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},s.setColorName=function(t){var a=ud[t];return a!==void 0?this.setHex(a):console.warn("THREE.Color: Unknown color "+t),this},s.clone=function(){return new this.constructor(this.r,this.g,this.b)},s.copy=function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},s.copyGammaToLinear=function(t,a){return a===void 0&&(a=2),this.r=Math.pow(t.r,a),this.g=Math.pow(t.g,a),this.b=Math.pow(t.b,a),this},s.copyLinearToGamma=function(t,a){a===void 0&&(a=2);var o=a>0?1/a:1;return this.r=Math.pow(t.r,o),this.g=Math.pow(t.g,o),this.b=Math.pow(t.b,o),this},s.convertGammaToLinear=function(t){return this.copyGammaToLinear(this,t),this},s.convertLinearToGamma=function(t){return this.copyLinearToGamma(this,t),this},s.copySRGBToLinear=function(t){return this.r=bl(t.r),this.g=bl(t.g),this.b=bl(t.b),this},s.copyLinearToSRGB=function(t){return this.r=_c(t.r),this.g=_c(t.g),this.b=_c(t.b),this},s.convertSRGBToLinear=function(){return this.copySRGBToLinear(this),this},s.convertLinearToSRGB=function(){return this.copyLinearToSRGB(this),this},s.getHex=function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},s.getHexString=function(){return("000000"+this.getHex().toString(16)).slice(-6)},s.getHSL=function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var a=this.r,o=this.g,c=this.b,f=Math.max(a,o,c),d=Math.min(a,o,c),m,y,w=(d+f)/2;if(d===f)m=0,y=0;else{var M=f-d;switch(y=w<=.5?M/(f+d):M/(2-f-d),f){case a:m=(o-c)/M+(o<c?6:0);break;case o:m=(c-a)/M+2;break;case c:m=(a-o)/M+4;break}m/=6}return t.h=m,t.s=y,t.l=w,t},s.getStyle=function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},s.offsetHSL=function(t,a,o){return this.getHSL(Oa),Oa.h+=t,Oa.s+=a,Oa.l+=o,this.setHSL(Oa.h,Oa.s,Oa.l),this},s.add=function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},s.addColors=function(t,a){return this.r=t.r+a.r,this.g=t.g+a.g,this.b=t.b+a.b,this},s.addScalar=function(t){return this.r+=t,this.g+=t,this.b+=t,this},s.sub=function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},s.multiply=function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},s.multiplyScalar=function(t){return this.r*=t,this.g*=t,this.b*=t,this},s.lerp=function(t,a){return this.r+=(t.r-this.r)*a,this.g+=(t.g-this.g)*a,this.b+=(t.b-this.b)*a,this},s.lerpHSL=function(t,a){this.getHSL(Oa),t.getHSL(yc);var o=Mn.lerp(Oa.h,yc.h,a),c=Mn.lerp(Oa.s,yc.s,a),f=Mn.lerp(Oa.l,yc.l,a);return this.setHSL(o,c,f),this},s.equals=function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},s.fromArray=function(t,a){return a===void 0&&(a=0),this.r=t[a],this.g=t[a+1],this.b=t[a+2],this},s.toArray=function(t,a){return t===void 0&&(t=[]),a===void 0&&(a=0),t[a]=this.r,t[a+1]=this.g,t[a+2]=this.b,t},s.fromBufferAttribute=function(t,a){return this.r=t.getX(a),this.g=t.getY(a),this.b=t.getZ(a),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this},s.toJSON=function(){return this.getHex()},e}();qt.NAMES=ud,qt.prototype.r=1,qt.prototype.g=1,qt.prototype.b=1;var lu=function(){function e(t,a,o,c,f,d){this.a=t,this.b=a,this.c=o,this.normal=c&&c.isVector3?c:new ee,this.vertexNormals=Array.isArray(c)?c:[],this.color=f&&f.isColor?f:new qt,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=d!==void 0?d:0}var s=e.prototype;return s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var a=0,o=t.vertexNormals.length;a<o;a++)this.vertexNormals[a]=t.vertexNormals[a].clone();for(var c=0,f=t.vertexColors.length;c<f;c++)this.vertexColors[c]=t.vertexColors[c].clone();return this},e}(),wl=0;function an(){Object.defineProperty(this,"id",{value:wl++}),this.uuid=Mn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=W,this.side=A,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ue,this.blendDst=Le,this.blendEquation=ge,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Yt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=ed,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Co,this.stencilZFail=Co,this.stencilZPass=Co,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}an.prototype=Object.assign(Object.create(Qa.prototype),{constructor:an,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(e!==void 0)for(var s in e){var t=e[s];if(t===void 0){console.warn("THREE.Material: '"+s+"' parameter is undefined.");continue}if(s==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===E;continue}var a=this[s];if(a===void 0){console.warn("THREE."+this.type+": '"+s+"' is not a property of this material.");continue}a&&a.isColor?a.set(t):a&&a.isVector3&&t&&t.isVector3?a.copy(t):this[s]=t}},toJSON:function(e){var s=e===void 0||typeof e=="string";s&&(e={textures:{},images:{}});var t={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),this.color&&this.color.isColor&&(t.color=this.color.getHex()),this.roughness!==void 0&&(t.roughness=this.roughness),this.metalness!==void 0&&(t.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(t.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(t.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(t.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(t.specular=this.specular.getHex()),this.shininess!==void 0&&(t.shininess=this.shininess),this.clearcoat!==void 0&&(t.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(t.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(t.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(t.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(t.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,t.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(t.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(t.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(t.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(t.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(t.aoMap=this.aoMap.toJSON(e).uuid,t.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(t.bumpMap=this.bumpMap.toJSON(e).uuid,t.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(t.normalMap=this.normalMap.toJSON(e).uuid,t.normalMapType=this.normalMapType,t.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(t.displacementMap=this.displacementMap.toJSON(e).uuid,t.displacementScale=this.displacementScale,t.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(t.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(t.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(t.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(t.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(t.envMap=this.envMap.toJSON(e).uuid,t.reflectivity=this.reflectivity,t.refractionRatio=this.refractionRatio,this.combine!==void 0&&(t.combine=this.combine),this.envMapIntensity!==void 0&&(t.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(t.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(t.size=this.size),this.sizeAttenuation!==void 0&&(t.sizeAttenuation=this.sizeAttenuation),this.blending!==W&&(t.blending=this.blending),this.flatShading===!0&&(t.flatShading=this.flatShading),this.side!==A&&(t.side=this.side),this.vertexColors&&(t.vertexColors=!0),this.opacity<1&&(t.opacity=this.opacity),this.transparent===!0&&(t.transparent=this.transparent),t.depthFunc=this.depthFunc,t.depthTest=this.depthTest,t.depthWrite=this.depthWrite,t.stencilWrite=this.stencilWrite,t.stencilWriteMask=this.stencilWriteMask,t.stencilFunc=this.stencilFunc,t.stencilRef=this.stencilRef,t.stencilFuncMask=this.stencilFuncMask,t.stencilFail=this.stencilFail,t.stencilZFail=this.stencilZFail,t.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(t.rotation=this.rotation),this.polygonOffset===!0&&(t.polygonOffset=!0),this.polygonOffsetFactor!==0&&(t.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(t.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(t.linewidth=this.linewidth),this.dashSize!==void 0&&(t.dashSize=this.dashSize),this.gapSize!==void 0&&(t.gapSize=this.gapSize),this.scale!==void 0&&(t.scale=this.scale),this.dithering===!0&&(t.dithering=!0),this.alphaTest>0&&(t.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(t.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(t.wireframe=this.wireframe),this.wireframeLinewidth>1&&(t.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(t.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(t.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(t.morphTargets=!0),this.morphNormals===!0&&(t.morphNormals=!0),this.skinning===!0&&(t.skinning=!0),this.visible===!1&&(t.visible=!1),this.toneMapped===!1&&(t.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(t.userData=this.userData);function a(f){var d=[];for(var m in f){var y=f[m];delete y.metadata,d.push(y)}return d}if(s){var o=a(e.textures),c=a(e.images);o.length>0&&(t.textures=o),c.length>0&&(t.images=c)}return t},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var s=e.clippingPlanes,t=null;if(s!==null){var a=s.length;t=new Array(a);for(var o=0;o!==a;++o)t[o]=s[o].clone()}return this.clippingPlanes=t,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(an.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function Pr(e){an.call(this),this.type="MeshBasicMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}Pr.prototype=Object.create(an.prototype),Pr.prototype.constructor=Pr,Pr.prototype.isMeshBasicMaterial=!0,Pr.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var Ci=new ee,Lh=new _t;function fn(e,s,t){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=s,this.count=e!==void 0?e.length/s:0,this.normalized=t===!0,this.usage=eu,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(fn.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(fn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,s,t){e*=this.itemSize,t*=s.itemSize;for(var a=0,o=this.itemSize;a<o;a++)this.array[e+a]=s.array[t+a];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",a),c=new qt),s[t++]=c.r,s[t++]=c.g,s[t++]=c.b}return this},copyVector2sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",a),c=new _t),s[t++]=c.x,s[t++]=c.y}return this},copyVector3sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",a),c=new ee),s[t++]=c.x,s[t++]=c.y,s[t++]=c.z}return this},copyVector4sArray:function(e){for(var s=this.array,t=0,a=0,o=e.length;a<o;a++){var c=e[a];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",a),c=new Ei),s[t++]=c.x,s[t++]=c.y,s[t++]=c.z,s[t++]=c.w}return this},applyMatrix3:function(e){if(this.itemSize===2)for(var s=0,t=this.count;s<t;s++)Lh.fromBufferAttribute(this,s),Lh.applyMatrix3(e),this.setXY(s,Lh.x,Lh.y);else if(this.itemSize===3)for(var a=0,o=this.count;a<o;a++)Ci.fromBufferAttribute(this,a),Ci.applyMatrix3(e),this.setXYZ(a,Ci.x,Ci.y,Ci.z);return this},applyMatrix4:function(e){for(var s=0,t=this.count;s<t;s++)Ci.x=this.getX(s),Ci.y=this.getY(s),Ci.z=this.getZ(s),Ci.applyMatrix4(e),this.setXYZ(s,Ci.x,Ci.y,Ci.z);return this},applyNormalMatrix:function(e){for(var s=0,t=this.count;s<t;s++)Ci.x=this.getX(s),Ci.y=this.getY(s),Ci.z=this.getZ(s),Ci.applyNormalMatrix(e),this.setXYZ(s,Ci.x,Ci.y,Ci.z);return this},transformDirection:function(e){for(var s=0,t=this.count;s<t;s++)Ci.x=this.getX(s),Ci.y=this.getY(s),Ci.z=this.getZ(s),Ci.transformDirection(e),this.setXYZ(s,Ci.x,Ci.y,Ci.z);return this},set:function(e,s){return s===void 0&&(s=0),this.array.set(e,s),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,s){return this.array[e*this.itemSize]=s,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,s){return this.array[e*this.itemSize+1]=s,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,s){return this.array[e*this.itemSize+2]=s,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,s){return this.array[e*this.itemSize+3]=s,this},setXY:function(e,s,t){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this},setXYZ:function(e,s,t,a){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this.array[e+2]=a,this},setXYZW:function(e,s,t,a,o){return e*=this.itemSize,this.array[e+0]=s,this.array[e+1]=t,this.array[e+2]=a,this.array[e+3]=o,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function xc(e,s,t){fn.call(this,new Int8Array(e),s,t)}xc.prototype=Object.create(fn.prototype),xc.prototype.constructor=xc;function cu(e,s,t){fn.call(this,new Uint8Array(e),s,t)}cu.prototype=Object.create(fn.prototype),cu.prototype.constructor=cu;function Ml(e,s,t){fn.call(this,new Uint8ClampedArray(e),s,t)}Ml.prototype=Object.create(fn.prototype),Ml.prototype.constructor=Ml;function Sl(e,s,t){fn.call(this,new Int16Array(e),s,t)}Sl.prototype=Object.create(fn.prototype),Sl.prototype.constructor=Sl;function Tl(e,s,t){fn.call(this,new Uint16Array(e),s,t)}Tl.prototype=Object.create(fn.prototype),Tl.prototype.constructor=Tl;function ae(e,s,t){fn.call(this,new Int32Array(e),s,t)}ae.prototype=Object.create(fn.prototype),ae.prototype.constructor=ae;function v(e,s,t){fn.call(this,new Uint32Array(e),s,t)}v.prototype=Object.create(fn.prototype),v.prototype.constructor=v;function x(e,s,t){fn.call(this,new Float32Array(e),s,t)}x.prototype=Object.create(fn.prototype),x.prototype.constructor=x;function T(e,s,t){fn.call(this,new Float64Array(e),s,t)}T.prototype=Object.create(fn.prototype),T.prototype.constructor=T;var L=function(){function e(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}var s=e.prototype;return s.computeGroups=function(t){var a=[],o,c,f=void 0,d=t.faces;for(c=0;c<d.length;c++){var m=d[c];m.materialIndex!==f&&(f=m.materialIndex,o!==void 0&&(o.count=c*3-o.start,a.push(o)),o={start:c*3,materialIndex:f})}o!==void 0&&(o.count=c*3-o.start,a.push(o)),this.groups=a},s.fromGeometry=function(t){var a=t.faces,o=t.vertices,c=t.faceVertexUvs,f=c[0]&&c[0].length>0,d=c[1]&&c[1].length>0,m=t.morphTargets,y=m.length,w;if(y>0){w=[];for(var M=0;M<y;M++)w[M]={name:m[M].name,data:[]};this.morphTargets.position=w}var D=t.morphNormals,P=D.length,F;if(P>0){F=[];for(var C=0;C<P;C++)F[C]={name:D[C].name,data:[]};this.morphTargets.normal=F}var I=t.skinIndices,q=t.skinWeights,J=I.length===o.length,Z=q.length===o.length;o.length>0&&a.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var G=0;G<a.length;G++){var Y=a[G];this.vertices.push(o[Y.a],o[Y.b],o[Y.c]);var ne=Y.vertexNormals;if(ne.length===3)this.normals.push(ne[0],ne[1],ne[2]);else{var se=Y.normal;this.normals.push(se,se,se)}var Ee=Y.vertexColors;if(Ee.length===3)this.colors.push(Ee[0],Ee[1],Ee[2]);else{var Be=Y.color;this.colors.push(Be,Be,Be)}if(f===!0){var ce=c[0][G];ce!==void 0?this.uvs.push(ce[0],ce[1],ce[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",G),this.uvs.push(new _t,new _t,new _t))}if(d===!0){var oe=c[1][G];oe!==void 0?this.uvs2.push(oe[0],oe[1],oe[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",G),this.uvs2.push(new _t,new _t,new _t))}for(var ie=0;ie<y;ie++){var Ce=m[ie].vertices;w[ie].data.push(Ce[Y.a],Ce[Y.b],Ce[Y.c])}for(var De=0;De<P;De++){var Oe=D[De].vertexNormals[G];F[De].data.push(Oe.a,Oe.b,Oe.c)}J&&this.skinIndices.push(I[Y.a],I[Y.b],I[Y.c]),Z&&this.skinWeights.push(q[Y.a],q[Y.b],q[Y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},e}();function U(e){if(e.length===0)return-1/0;for(var s=e[0],t=1,a=e.length;t<a;++t)e[t]>s&&(s=e[t]);return s}var z=1,k=new Hn,le=new Jt,ve=new ee,fe=new vs,je=new vs,ke=new ee;function Ae(){Object.defineProperty(this,"id",{value:z+=2}),this.uuid=Mn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Ae.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ae,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(U(e)>65535?v:Tl)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,s){return this.attributes[e]=s,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,s,t){this.groups.push({start:e,count:s,materialIndex:t!==void 0?t:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,s){this.drawRange.start=e,this.drawRange.count=s},applyMatrix4:function(e){var s=this.attributes.position;s!==void 0&&(s.applyMatrix4(e),s.needsUpdate=!0);var t=this.attributes.normal;if(t!==void 0){var a=new ta().getNormalMatrix(e);t.applyNormalMatrix(a),t.needsUpdate=!0}var o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return k.makeRotationX(e),this.applyMatrix4(k),this},rotateY:function(e){return k.makeRotationY(e),this.applyMatrix4(k),this},rotateZ:function(e){return k.makeRotationZ(e),this.applyMatrix4(k),this},translate:function(e,s,t){return k.makeTranslation(e,s,t),this.applyMatrix4(k),this},scale:function(e,s,t){return k.makeScale(e,s,t),this.applyMatrix4(k),this},lookAt:function(e){return le.lookAt(e),le.updateMatrix(),this.applyMatrix4(le.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ve).negate(),this.translate(ve.x,ve.y,ve.z),this},setFromObject:function(e){var s=e.geometry;if(e.isPoints||e.isLine){var t=new x(s.vertices.length*3,3),a=new x(s.colors.length*3,3);if(this.setAttribute("position",t.copyVector3sArray(s.vertices)),this.setAttribute("color",a.copyColorsArray(s.colors)),s.lineDistances&&s.lineDistances.length===s.vertices.length){var o=new x(s.lineDistances.length,1);this.setAttribute("lineDistance",o.copyArray(s.lineDistances))}s.boundingSphere!==null&&(this.boundingSphere=s.boundingSphere.clone()),s.boundingBox!==null&&(this.boundingBox=s.boundingBox.clone())}else e.isMesh&&s&&s.isGeometry&&this.fromGeometry(s);return this},setFromPoints:function(e){for(var s=[],t=0,a=e.length;t<a;t++){var o=e[t];s.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new x(s,3)),this},updateFromObject:function(e){var s=e.geometry;if(e.isMesh){var t=s.__directGeometry;if(s.elementsNeedUpdate===!0&&(t=void 0,s.elementsNeedUpdate=!1),t===void 0)return this.fromGeometry(s);t.verticesNeedUpdate=s.verticesNeedUpdate,t.normalsNeedUpdate=s.normalsNeedUpdate,t.colorsNeedUpdate=s.colorsNeedUpdate,t.uvsNeedUpdate=s.uvsNeedUpdate,t.groupsNeedUpdate=s.groupsNeedUpdate,s.verticesNeedUpdate=!1,s.normalsNeedUpdate=!1,s.colorsNeedUpdate=!1,s.uvsNeedUpdate=!1,s.groupsNeedUpdate=!1,s=t}if(s.verticesNeedUpdate===!0){var a=this.attributes.position;a!==void 0&&(a.copyVector3sArray(s.vertices),a.needsUpdate=!0),s.verticesNeedUpdate=!1}if(s.normalsNeedUpdate===!0){var o=this.attributes.normal;o!==void 0&&(o.copyVector3sArray(s.normals),o.needsUpdate=!0),s.normalsNeedUpdate=!1}if(s.colorsNeedUpdate===!0){var c=this.attributes.color;c!==void 0&&(c.copyColorsArray(s.colors),c.needsUpdate=!0),s.colorsNeedUpdate=!1}if(s.uvsNeedUpdate){var f=this.attributes.uv;f!==void 0&&(f.copyVector2sArray(s.uvs),f.needsUpdate=!0),s.uvsNeedUpdate=!1}if(s.lineDistancesNeedUpdate){var d=this.attributes.lineDistance;d!==void 0&&(d.copyArray(s.lineDistances),d.needsUpdate=!0),s.lineDistancesNeedUpdate=!1}return s.groupsNeedUpdate&&(s.computeGroups(e.geometry),this.groups=s.groups,s.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new L().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var s=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new fn(s,3).copyVector3sArray(e.vertices)),e.normals.length>0){var t=new Float32Array(e.normals.length*3);this.setAttribute("normal",new fn(t,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var a=new Float32Array(e.colors.length*3);this.setAttribute("color",new fn(a,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var o=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new fn(o,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var c=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new fn(c,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var f in e.morphTargets){for(var d=[],m=e.morphTargets[f],y=0,w=m.length;y<w;y++){var M=m[y],D=new x(M.data.length*3,3);D.name=M.name,d.push(D.copyVector3sArray(M.data))}this.morphAttributes[f]=d}if(e.skinIndices.length>0){var P=new x(e.skinIndices.length*4,4);this.setAttribute("skinIndex",P.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var F=new x(e.skinWeights.length*4,4);this.setAttribute("skinWeight",F.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new vs);var e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ee(-1/0,-1/0,-1/0),new ee(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),s)for(var t=0,a=s.length;t<a;t++){var o=s[t];fe.setFromBufferAttribute(o),this.morphTargetsRelative?(ke.addVectors(this.boundingBox.min,fe.min),this.boundingBox.expandByPoint(ke),ke.addVectors(this.boundingBox.max,fe.max),this.boundingBox.expandByPoint(ke)):(this.boundingBox.expandByPoint(fe.min),this.boundingBox.expandByPoint(fe.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new da);var e=this.attributes.position,s=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ee,1/0);return}if(e){var t=this.boundingSphere.center;if(fe.setFromBufferAttribute(e),s)for(var a=0,o=s.length;a<o;a++){var c=s[a];je.setFromBufferAttribute(c),this.morphTargetsRelative?(ke.addVectors(fe.min,je.min),fe.expandByPoint(ke),ke.addVectors(fe.max,je.max),fe.expandByPoint(ke)):(fe.expandByPoint(je.min),fe.expandByPoint(je.max))}fe.getCenter(t);for(var f=0,d=0,m=e.count;d<m;d++)ke.fromBufferAttribute(e,d),f=Math.max(f,t.distanceToSquared(ke));if(s)for(var y=0,w=s.length;y<w;y++)for(var M=s[y],D=this.morphTargetsRelative,P=0,F=M.count;P<F;P++)ke.fromBufferAttribute(M,P),D&&(ve.fromBufferAttribute(e,P),ke.add(ve)),f=Math.max(f,t.distanceToSquared(ke));this.boundingSphere.radius=Math.sqrt(f),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,s=this.getAttribute("position");if(s!==void 0){var t=this.getAttribute("normal");if(t===void 0)t=new fn(new Float32Array(s.count*3),3),this.setAttribute("normal",t);else for(var a=0,o=t.count;a<o;a++)t.setXYZ(a,0,0,0);var c=new ee,f=new ee,d=new ee,m=new ee,y=new ee,w=new ee,M=new ee,D=new ee;if(e)for(var P=0,F=e.count;P<F;P+=3){var C=e.getX(P+0),I=e.getX(P+1),q=e.getX(P+2);c.fromBufferAttribute(s,C),f.fromBufferAttribute(s,I),d.fromBufferAttribute(s,q),M.subVectors(d,f),D.subVectors(c,f),M.cross(D),m.fromBufferAttribute(t,C),y.fromBufferAttribute(t,I),w.fromBufferAttribute(t,q),m.add(M),y.add(M),w.add(M),t.setXYZ(C,m.x,m.y,m.z),t.setXYZ(I,y.x,y.y,y.z),t.setXYZ(q,w.x,w.y,w.z)}else for(var J=0,Z=s.count;J<Z;J+=3)c.fromBufferAttribute(s,J+0),f.fromBufferAttribute(s,J+1),d.fromBufferAttribute(s,J+2),M.subVectors(d,f),D.subVectors(c,f),M.cross(D),t.setXYZ(J+0,M.x,M.y,M.z),t.setXYZ(J+1,M.x,M.y,M.z),t.setXYZ(J+2,M.x,M.y,M.z);this.normalizeNormals(),t.needsUpdate=!0}},merge:function(e,s){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}s===void 0&&(s=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var t=this.attributes;for(var a in t)if(e.attributes[a]!==void 0)for(var o=t[a],c=o.array,f=e.attributes[a],d=f.array,m=f.itemSize*s,y=Math.min(d.length,c.length-m),w=0,M=m;w<y;w++,M++)c[M]=d[w];return this},normalizeNormals:function(){for(var e=this.attributes.normal,s=0,t=e.count;s<t;s++)ke.fromBufferAttribute(e,s),ke.normalize(),e.setXYZ(s,ke.x,ke.y,ke.z)},toNonIndexed:function(){function e(Z,G){for(var Y=Z.array,ne=Z.itemSize,se=Z.normalized,Ee=new Y.constructor(G.length*ne),Be=0,ce=0,oe=0,ie=G.length;oe<ie;oe++){Be=G[oe]*ne;for(var Ce=0;Ce<ne;Ce++)Ee[ce++]=Y[Be++]}return new fn(Ee,ne,se)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var s=new Ae,t=this.index.array,a=this.attributes;for(var o in a){var c=a[o],f=e(c,t);s.setAttribute(o,f)}var d=this.morphAttributes;for(var m in d){for(var y=[],w=d[m],M=0,D=w.length;M<D;M++){var P=w[M],F=e(P,t);y.push(F)}s.morphAttributes[m]=y}s.morphTargetsRelative=this.morphTargetsRelative;for(var C=this.groups,I=0,q=C.length;I<q;I++){var J=C[I];s.addGroup(J.start,J.count,J.materialIndex)}return s},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var s=this.parameters;for(var t in s)s[t]!==void 0&&(e[t]=s[t]);return e}e.data={attributes:{}};var a=this.index;a!==null&&(e.data.index={type:a.array.constructor.name,array:Array.prototype.slice.call(a.array)});var o=this.attributes;for(var c in o){var f=o[c],d=f.toJSON(e.data);f.name!==""&&(d.name=f.name),e.data.attributes[c]=d}var m={},y=!1;for(var w in this.morphAttributes){for(var M=this.morphAttributes[w],D=[],P=0,F=M.length;P<F;P++){var C=M[P],I=C.toJSON(e.data);C.name!==""&&(I.name=C.name),D.push(I)}D.length>0&&(m[w]=D,y=!0)}y&&(e.data.morphAttributes=m,e.data.morphTargetsRelative=this.morphTargetsRelative);var q=this.groups;q.length>0&&(e.data.groups=JSON.parse(JSON.stringify(q)));var J=this.boundingSphere;return J!==null&&(e.data.boundingSphere={center:J.center.toArray(),radius:J.radius}),e},clone:function(){return new Ae().copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var s={};this.name=e.name;var t=e.index;t!==null&&this.setIndex(t.clone(s));var a=e.attributes;for(var o in a){var c=a[o];this.setAttribute(o,c.clone(s))}var f=e.morphAttributes;for(var d in f){for(var m=[],y=f[d],w=0,M=y.length;w<M;w++)m.push(y[w].clone(s));this.morphAttributes[d]=m}this.morphTargetsRelative=e.morphTargetsRelative;for(var D=e.groups,P=0,F=D.length;P<F;P++){var C=D[P];this.addGroup(C.start,C.count,C.materialIndex)}var I=e.boundingBox;I!==null&&(this.boundingBox=I.clone());var q=e.boundingSphere;return q!==null&&(this.boundingSphere=q.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var vt=new Hn,Fe=new es,yt=new da,wt=new ee,Ut=new ee,Pt=new ee,Xt=new ee,Ct=new ee,It=new ee,kt=new ee,jt=new ee,Gt=new ee,Yn=new _t,xi=new _t,ji=new _t,gr=new ee,tr=new ee;function Fn(e,s){Jt.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new Pr,this.updateMorphTargets()}Fn.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Fn,isMesh:!0,copy:function(e){return Jt.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,s){var t=this.geometry,a=this.material,o=this.matrixWorld;if(a!==void 0&&(t.boundingSphere===null&&t.computeBoundingSphere(),yt.copy(t.boundingSphere),yt.applyMatrix4(o),e.ray.intersectsSphere(yt)!==!1&&(vt.getInverse(o),Fe.copy(e.ray).applyMatrix4(vt),!(t.boundingBox!==null&&Fe.intersectsBox(t.boundingBox)===!1)))){var c;if(t.isBufferGeometry){var f=t.index,d=t.attributes.position,m=t.morphAttributes.position,y=t.morphTargetsRelative,w=t.attributes.uv,M=t.attributes.uv2,D=t.groups,P=t.drawRange;if(f!==null)if(Array.isArray(a))for(var F=0,C=D.length;F<C;F++)for(var I=D[F],q=a[I.materialIndex],J=Math.max(I.start,P.start),Z=Math.min(I.start+I.count,P.start+P.count),G=J;G<Z;G+=3){var Y=f.getX(G),ne=f.getX(G+1),se=f.getX(G+2);c=ia(this,q,e,Fe,d,m,y,w,M,Y,ne,se),c&&(c.faceIndex=Math.floor(G/3),c.face.materialIndex=I.materialIndex,s.push(c))}else for(var Ee=Math.max(0,P.start),Be=Math.min(f.count,P.start+P.count),ce=Ee;ce<Be;ce+=3){var oe=f.getX(ce),ie=f.getX(ce+1),Ce=f.getX(ce+2);c=ia(this,a,e,Fe,d,m,y,w,M,oe,ie,Ce),c&&(c.faceIndex=Math.floor(ce/3),s.push(c))}else if(d!==void 0)if(Array.isArray(a))for(var De=0,Oe=D.length;De<Oe;De++)for(var et=D[De],mt=a[et.materialIndex],dt=Math.max(et.start,P.start),ot=Math.min(et.start+et.count,P.start+P.count),Mt=dt;Mt<ot;Mt+=3){var zt=Mt,Bt=Mt+1,en=Mt+2;c=ia(this,mt,e,Fe,d,m,y,w,M,zt,Bt,en),c&&(c.faceIndex=Math.floor(Mt/3),c.face.materialIndex=et.materialIndex,s.push(c))}else for(var on=Math.max(0,P.start),ft=Math.min(d.count,P.start+P.count),Bn=on;Bn<ft;Bn+=3){var Rn=Bn,mn=Bn+1,ri=Bn+2;c=ia(this,a,e,Fe,d,m,y,w,M,Rn,mn,ri),c&&(c.faceIndex=Math.floor(Bn/3),s.push(c))}}else if(t.isGeometry){var Wn=Array.isArray(a),mi=t.vertices,ei=t.faces,Hi,Me=t.faceVertexUvs[0];Me.length>0&&(Hi=Me);for(var X=0,At=ei.length;X<At;X++){var st=ei[X],Zt=Wn?a[st.materialIndex]:a;if(Zt!==void 0){var Rt=mi[st.a],un=mi[st.b],dn=mi[st.c];if(c=Ir(this,Zt,e,Fe,Rt,un,dn,gr),c){if(Hi&&Hi[X]){var tn=Hi[X];Yn.copy(tn[0]),xi.copy(tn[1]),ji.copy(tn[2]),c.uv=Da.getUV(gr,Rt,un,dn,Yn,xi,ji,new _t)}c.face=st,c.faceIndex=X,s.push(c)}}}}}}});function Ir(e,s,t,a,o,c,f,d){var m;if(s.side===S?m=a.intersectTriangle(f,c,o,!0,d):m=a.intersectTriangle(o,c,f,s.side!==R,d),m===null)return null;tr.copy(d),tr.applyMatrix4(e.matrixWorld);var y=t.ray.origin.distanceTo(tr);return y<t.near||y>t.far?null:{distance:y,point:tr.clone(),object:e}}function ia(e,s,t,a,o,c,f,d,m,y,w,M){wt.fromBufferAttribute(o,y),Ut.fromBufferAttribute(o,w),Pt.fromBufferAttribute(o,M);var D=e.morphTargetInfluences;if(s.morphTargets&&c&&D){kt.set(0,0,0),jt.set(0,0,0),Gt.set(0,0,0);for(var P=0,F=c.length;P<F;P++){var C=D[P],I=c[P];C!==0&&(Xt.fromBufferAttribute(I,y),Ct.fromBufferAttribute(I,w),It.fromBufferAttribute(I,M),f?(kt.addScaledVector(Xt,C),jt.addScaledVector(Ct,C),Gt.addScaledVector(It,C)):(kt.addScaledVector(Xt.sub(wt),C),jt.addScaledVector(Ct.sub(Ut),C),Gt.addScaledVector(It.sub(Pt),C)))}wt.add(kt),Ut.add(jt),Pt.add(Gt)}e.isSkinnedMesh&&(e.boneTransform(y,wt),e.boneTransform(w,Ut),e.boneTransform(M,Pt));var q=Ir(e,s,t,a,wt,Ut,Pt,gr);if(q){d&&(Yn.fromBufferAttribute(d,y),xi.fromBufferAttribute(d,w),ji.fromBufferAttribute(d,M),q.uv=Da.getUV(gr,wt,Ut,Pt,Yn,xi,ji,new _t)),m&&(Yn.fromBufferAttribute(m,y),xi.fromBufferAttribute(m,w),ji.fromBufferAttribute(m,M),q.uv2=Da.getUV(gr,wt,Ut,Pt,Yn,xi,ji,new _t));var J=new lu(y,w,M);Da.getNormal(wt,Ut,Pt,J.normal),q.face=J}return q}var ns=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m;t===void 0&&(t=1),a===void 0&&(a=1),o===void 0&&(o=1),c===void 0&&(c=1),f===void 0&&(f=1),d===void 0&&(d=1),m=e.call(this)||this,m.type="BoxBufferGeometry",m.parameters={width:t,height:a,depth:o,widthSegments:c,heightSegments:f,depthSegments:d};var y=uc(m);c=Math.floor(c),f=Math.floor(f),d=Math.floor(d);var w=[],M=[],D=[],P=[],F=0,C=0;I("z","y","x",-1,-1,o,a,t,d,f,0),I("z","y","x",1,-1,o,a,-t,d,f,1),I("x","z","y",1,1,t,o,a,c,d,2),I("x","z","y",1,-1,t,o,-a,c,d,3),I("x","y","z",1,-1,t,a,o,c,f,4),I("x","y","z",-1,-1,t,a,-o,c,f,5),m.setIndex(w),m.setAttribute("position",new x(M,3)),m.setAttribute("normal",new x(D,3)),m.setAttribute("uv",new x(P,2));function I(q,J,Z,G,Y,ne,se,Ee,Be,ce,oe){for(var ie=Be+1,Ce=0,De=0,Oe=new ee,et=0;et<ce+1;et++)for(var mt=et*(se/ce)-se/2,dt=0;dt<ie;dt++){var ot=dt*(ne/Be)-ne/2;Oe[q]=ot*G,Oe[J]=mt*Y,Oe[Z]=Ee/2,M.push(Oe.x,Oe.y,Oe.z),Oe[q]=0,Oe[J]=0,Oe[Z]=Ee>0?1:-1,D.push(Oe.x,Oe.y,Oe.z),P.push(dt/Be),P.push(1-et/ce),Ce+=1}for(var Mt=0;Mt<ce;Mt++)for(var zt=0;zt<Be;zt++){var Bt=F+zt+ie*Mt,en=F+zt+ie*(Mt+1),on=F+(zt+1)+ie*(Mt+1),ft=F+(zt+1)+ie*Mt;w.push(Bt,en,ft),w.push(en,on,ft),De+=6}y.addGroup(C,De,oe),C+=De,F+=Ce}return m}return s}(Ae);function Na(e){var s={};for(var t in e){s[t]={};for(var a in e[t]){var o=e[t][a];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture)?s[t][a]=o.clone():Array.isArray(o)?s[t][a]=o.slice():s[t][a]=o}}return s}function xr(e){for(var s={},t=0;t<e.length;t++){var a=Na(e[t]);for(var o in a)s[o]=a[o]}return s}var Go={clone:Na,merge:xr};function qr(e){an.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}qr.prototype=Object.create(an.prototype),qr.prototype.constructor=qr,qr.prototype.isShaderMaterial=!0,qr.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Na(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},qr.prototype.toJSON=function(e){var s=an.prototype.toJSON.call(this,e);s.glslVersion=this.glslVersion,s.uniforms={};for(var t in this.uniforms){var a=this.uniforms[t],o=a.value;o&&o.isTexture?s.uniforms[t]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?s.uniforms[t]={type:"c",value:o.getHex()}:o&&o.isVector2?s.uniforms[t]={type:"v2",value:o.toArray()}:o&&o.isVector3?s.uniforms[t]={type:"v3",value:o.toArray()}:o&&o.isVector4?s.uniforms[t]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?s.uniforms[t]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?s.uniforms[t]={type:"m4",value:o.toArray()}:s.uniforms[t]={value:o}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader;var c={};for(var f in this.extensions)this.extensions[f]===!0&&(c[f]=!0);return Object.keys(c).length>0&&(s.extensions=c),s};function Dr(){Jt.call(this),this.type="Camera",this.matrixWorldInverse=new Hn,this.projectionMatrix=new Hn,this.projectionMatrixInverse=new Hn}Dr.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Dr,isCamera:!0,copy:function(e,s){return Jt.prototype.copy.call(this,e,s),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new ee),this.updateMatrixWorld(!0);var s=this.matrixWorld.elements;return e.set(-s[8],-s[9],-s[10]).normalize()},updateMatrixWorld:function(e){Jt.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,s){Jt.prototype.updateWorldMatrix.call(this,e,s),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function Ni(e,s,t,a){Dr.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=t!==void 0?t:.1,this.far=a!==void 0?a:2e3,this.focus=10,this.aspect=s!==void 0?s:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Ni.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Ni,isPerspectiveCamera:!0,copy:function(e,s){return Dr.prototype.copy.call(this,e,s),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var s=.5*this.getFilmHeight()/e;this.fov=Mn.RAD2DEG*2*Math.atan(s),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(Mn.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return Mn.RAD2DEG*2*Math.atan(Math.tan(Mn.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,s,t,a,o,c){this.aspect=e/s,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=t,this.view.offsetY=a,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,s=e*Math.tan(Mn.DEG2RAD*.5*this.fov)/this.zoom,t=2*s,a=this.aspect*t,o=-.5*a,c=this.view;if(this.view!==null&&this.view.enabled){var f=c.fullWidth,d=c.fullHeight;o+=c.offsetX*a/f,s-=c.offsetY*t/d,a*=c.width/f,t*=c.height/d}var m=this.filmOffset;m!==0&&(o+=e*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+a,s,s-t,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var s=Jt.prototype.toJSON.call(this,e);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,this.view!==null&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}});var Rh=90,Ch=1;function Ph(e,s,t){if(Jt.call(this),this.type="CubeCamera",t.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=t;var a=new Ni(Rh,Ch,e,s);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new ee(1,0,0)),this.add(a);var o=new Ni(Rh,Ch,e,s);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new ee(-1,0,0)),this.add(o);var c=new Ni(Rh,Ch,e,s);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new ee(0,1,0)),this.add(c);var f=new Ni(Rh,Ch,e,s);f.layers=this.layers,f.up.set(0,0,-1),f.lookAt(new ee(0,-1,0)),this.add(f);var d=new Ni(Rh,Ch,e,s);d.layers=this.layers,d.up.set(0,-1,0),d.lookAt(new ee(0,0,1)),this.add(d);var m=new Ni(Rh,Ch,e,s);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new ee(0,0,-1)),this.add(m),this.update=function(y,w){this.parent===null&&this.updateMatrixWorld();var M=y.xr.enabled,D=y.getRenderTarget();y.xr.enabled=!1;var P=t.texture.generateMipmaps;t.texture.generateMipmaps=!1,y.setRenderTarget(t,0),y.render(w,a),y.setRenderTarget(t,1),y.render(w,o),y.setRenderTarget(t,2),y.render(w,c),y.setRenderTarget(t,3),y.render(w,f),y.setRenderTarget(t,4),y.render(w,d),t.texture.generateMipmaps=P,y.setRenderTarget(t,5),y.render(w,m),y.setRenderTarget(D),y.xr.enabled=M},this.clear=function(y,w,M,D){for(var P=y.getRenderTarget(),F=0;F<6;F++)y.setRenderTarget(t,F),y.clear(w,M,D);y.setRenderTarget(P)}}Ph.prototype=Object.create(Jt.prototype),Ph.prototype.constructor=Ph;function zo(e,s,t,a,o,c,f,d,m,y){e=e!==void 0?e:[],s=s!==void 0?s:j,f=f!==void 0?f:Ka,Ti.call(this,e,s,t,a,o,c,f,d,m,y),this.flipY=!1,this._needsFlipEnvMap=!0}zo.prototype=Object.create(Ti.prototype),zo.prototype.constructor=zo,zo.prototype.isCubeTexture=!0,Object.defineProperty(zo.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function bc(e,s,t){Number.isInteger(s)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),s=t),na.call(this,e,e,s),s=s||{},this.texture=new zo(void 0,s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.texture._needsFlipEnvMap=!1}bc.prototype=Object.create(na.prototype),bc.prototype.constructor=bc,bc.prototype.isWebGLCubeRenderTarget=!0,bc.prototype.fromEquirectangularTexture=function(e,s){this.texture.type=s.type,this.texture.format=re,this.texture.encoding=s.encoding,this.texture.generateMipmaps=s.generateMipmaps,this.texture.minFilter=s.minFilter,this.texture.magFilter=s.magFilter;var t={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},a=new ns(5,5,5),o=new qr({name:"CubemapFromEquirect",uniforms:Na(t.uniforms),vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,side:S,blending:N});o.uniforms.tEquirect.value=s;var c=new Fn(a,o),f=s.minFilter;s.minFilter===pi&&(s.minFilter=Dt);var d=new Ph(1,10,this);return d.update(e,c),s.minFilter=f,c.geometry.dispose(),c.material.dispose(),this};function uu(e,s,t,a,o,c,f,d,m,y,w,M){Ti.call(this,null,c,f,d,m,y,a,o,w,M),this.image={data:e||null,width:s||1,height:t||1},this.magFilter=m!==void 0?m:it,this.minFilter=y!==void 0?y:it,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}uu.prototype=Object.create(Ti.prototype),uu.prototype.constructor=uu,uu.prototype.isDataTexture=!0;var Ih=new da,tm=new ee,hd=function(){function e(t,a,o,c,f,d){this.planes=[t!==void 0?t:new pa,a!==void 0?a:new pa,o!==void 0?o:new pa,c!==void 0?c:new pa,f!==void 0?f:new pa,d!==void 0?d:new pa]}var s=e.prototype;return s.set=function(t,a,o,c,f,d){var m=this.planes;return m[0].copy(t),m[1].copy(a),m[2].copy(o),m[3].copy(c),m[4].copy(f),m[5].copy(d),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){for(var a=this.planes,o=0;o<6;o++)a[o].copy(t.planes[o]);return this},s.setFromProjectionMatrix=function(t){var a=this.planes,o=t.elements,c=o[0],f=o[1],d=o[2],m=o[3],y=o[4],w=o[5],M=o[6],D=o[7],P=o[8],F=o[9],C=o[10],I=o[11],q=o[12],J=o[13],Z=o[14],G=o[15];return a[0].setComponents(m-c,D-y,I-P,G-q).normalize(),a[1].setComponents(m+c,D+y,I+P,G+q).normalize(),a[2].setComponents(m+f,D+w,I+F,G+J).normalize(),a[3].setComponents(m-f,D-w,I-F,G-J).normalize(),a[4].setComponents(m-d,D-M,I-C,G-Z).normalize(),a[5].setComponents(m+d,D+M,I+C,G+Z).normalize(),this},s.intersectsObject=function(t){var a=t.geometry;return a.boundingSphere===null&&a.computeBoundingSphere(),Ih.copy(a.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ih)},s.intersectsSprite=function(t){return Ih.center.set(0,0,0),Ih.radius=.7071067811865476,Ih.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ih)},s.intersectsSphere=function(t){for(var a=this.planes,o=t.center,c=-t.radius,f=0;f<6;f++){var d=a[f].distanceToPoint(o);if(d<c)return!1}return!0},s.intersectsBox=function(t){for(var a=this.planes,o=0;o<6;o++){var c=a[o];if(tm.x=c.normal.x>0?t.max.x:t.min.x,tm.y=c.normal.y>0?t.max.y:t.min.y,tm.z=c.normal.z>0?t.max.z:t.min.z,c.distanceToPoint(tm)<0)return!1}return!0},s.containsPoint=function(t){for(var a=this.planes,o=0;o<6;o++)if(a[o].distanceToPoint(t)<0)return!1;return!0},e}();function N_(){var e=null,s=!1,t=null,a=null;function o(c,f){t(c,f),a=e.requestAnimationFrame(o)}return{start:function(){s!==!0&&t!==null&&(a=e.requestAnimationFrame(o),s=!0)},stop:function(){e.cancelAnimationFrame(a),s=!1},setAnimationLoop:function(c){t=c},setContext:function(c){e=c}}}function mA(e,s){var t=s.isWebGL2,a=new WeakMap;function o(f,d){var m=f.array,y=f.usage,w=e.createBuffer();e.bindBuffer(d,w),e.bufferData(d,m,y),f.onUploadCallback();var M=5126;return m instanceof Float32Array?M=5126:m instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):m instanceof Uint16Array?M=5123:m instanceof Int16Array?M=5122:m instanceof Uint32Array?M=5125:m instanceof Int32Array?M=5124:m instanceof Int8Array?M=5120:m instanceof Uint8Array&&(M=5121),{buffer:w,type:M,bytesPerElement:m.BYTES_PER_ELEMENT,version:f.version}}function c(f,d,m){var y=d.array,w=d.updateRange;e.bindBuffer(m,f),w.count===-1?e.bufferSubData(m,0,y):(t?e.bufferSubData(m,w.offset*y.BYTES_PER_ELEMENT,y,w.offset,w.count):e.bufferSubData(m,w.offset*y.BYTES_PER_ELEMENT,y.subarray(w.offset,w.offset+w.count)),w.count=-1)}return{get:function(f){return f.isInterleavedBufferAttribute&&(f=f.data),a.get(f)},remove:function(f){f.isInterleavedBufferAttribute&&(f=f.data);var d=a.get(f);d&&(e.deleteBuffer(d.buffer),a.delete(f))},update:function(f,d){if(f.isGLBufferAttribute){var m=a.get(f);(!m||m.version<f.version)&&a.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);var y=a.get(f);y===void 0?a.set(f,o(f,d)):y.version<f.version&&(c(y.buffer,f,d),y.version=f.version)}}}var nm=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="PlaneBufferGeometry",f.parameters={width:t,height:a,widthSegments:o,heightSegments:c},t=t||1,a=a||1;for(var d=t/2,m=a/2,y=Math.floor(o)||1,w=Math.floor(c)||1,M=y+1,D=t/y,P=a/w,F=[],C=[],I=[],q=[],J=0;J<w+1;J++)for(var Z=J*P-m,G=0;G<M;G++){var Y=G*D-d;C.push(Y,-Z,0),I.push(0,0,1),q.push(G/y),q.push(1-J/w)}for(var ne=0;ne<w;ne++)for(var se=0;se<y;se++){var Ee=se+M*ne,Be=se+M*(ne+1),ce=se+1+M*(ne+1),oe=se+1+M*ne;F.push(Ee,Be,oe),F.push(Be,ce,oe)}return f.setIndex(F),f.setAttribute("position",new x(C,3)),f.setAttribute("normal",new x(I,3)),f.setAttribute("uv",new x(q,2)),f}return s}(Ae),Zn={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmissionmap_fragment:`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,transmissionmap_pars_fragment:`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Vt={common:{diffuse:{value:new qt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ta},uv2Transform:{value:new ta},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new _t(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ta}},sprite:{diffuse:{value:new qt(15658734)},opacity:{value:1},center:{value:new _t(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ta}}},to={basic:{uniforms:xr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.fog]),vertexShader:Zn.meshbasic_vert,fragmentShader:Zn.meshbasic_frag},lambert:{uniforms:xr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.fog,Vt.lights,{emissive:{value:new qt(0)}}]),vertexShader:Zn.meshlambert_vert,fragmentShader:Zn.meshlambert_frag},phong:{uniforms:xr([Vt.common,Vt.specularmap,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,Vt.lights,{emissive:{value:new qt(0)},specular:{value:new qt(1118481)},shininess:{value:30}}]),vertexShader:Zn.meshphong_vert,fragmentShader:Zn.meshphong_frag},standard:{uniforms:xr([Vt.common,Vt.envmap,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.roughnessmap,Vt.metalnessmap,Vt.fog,Vt.lights,{emissive:{value:new qt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Zn.meshphysical_vert,fragmentShader:Zn.meshphysical_frag},toon:{uniforms:xr([Vt.common,Vt.aomap,Vt.lightmap,Vt.emissivemap,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.gradientmap,Vt.fog,Vt.lights,{emissive:{value:new qt(0)}}]),vertexShader:Zn.meshtoon_vert,fragmentShader:Zn.meshtoon_frag},matcap:{uniforms:xr([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,Vt.fog,{matcap:{value:null}}]),vertexShader:Zn.meshmatcap_vert,fragmentShader:Zn.meshmatcap_frag},points:{uniforms:xr([Vt.points,Vt.fog]),vertexShader:Zn.points_vert,fragmentShader:Zn.points_frag},dashed:{uniforms:xr([Vt.common,Vt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Zn.linedashed_vert,fragmentShader:Zn.linedashed_frag},depth:{uniforms:xr([Vt.common,Vt.displacementmap]),vertexShader:Zn.depth_vert,fragmentShader:Zn.depth_frag},normal:{uniforms:xr([Vt.common,Vt.bumpmap,Vt.normalmap,Vt.displacementmap,{opacity:{value:1}}]),vertexShader:Zn.normal_vert,fragmentShader:Zn.normal_frag},sprite:{uniforms:xr([Vt.sprite,Vt.fog]),vertexShader:Zn.sprite_vert,fragmentShader:Zn.sprite_frag},background:{uniforms:{uvTransform:{value:new ta},t2D:{value:null}},vertexShader:Zn.background_vert,fragmentShader:Zn.background_frag},cube:{uniforms:xr([Vt.envmap,{opacity:{value:1}}]),vertexShader:Zn.cube_vert,fragmentShader:Zn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Zn.equirect_vert,fragmentShader:Zn.equirect_frag},distanceRGBA:{uniforms:xr([Vt.common,Vt.displacementmap,{referencePosition:{value:new ee},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Zn.distanceRGBA_vert,fragmentShader:Zn.distanceRGBA_frag},shadow:{uniforms:xr([Vt.lights,Vt.fog,{color:{value:new qt(0)},opacity:{value:1}}]),vertexShader:Zn.shadow_vert,fragmentShader:Zn.shadow_frag}};to.physical={uniforms:xr([to.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new _t(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new qt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Zn.meshphysical_vert,fragmentShader:Zn.meshphysical_frag};function gA(e,s,t,a,o){var c=new qt(0),f=0,d,m,y=null,w=0,M=null;function D(F,C,I,q){var J=C.isScene===!0?C.background:null;J&&J.isTexture&&(J=s.get(J));var Z=e.xr,G=Z.getSession&&Z.getSession();G&&G.environmentBlendMode==="additive"&&(J=null),J===null?P(c,f):J&&J.isColor&&(P(J,1),q=!0),(e.autoClear||q)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),J&&(J.isCubeTexture||J.isWebGLCubeRenderTarget||J.mapping===Je)?(m===void 0&&(m=new Fn(new ns(1,1,1),new qr({name:"BackgroundCubeMaterial",uniforms:Na(to.cube.uniforms),vertexShader:to.cube.vertexShader,fragmentShader:to.cube.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(Y,ne,se){this.matrixWorld.copyPosition(se.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(m)),J.isWebGLCubeRenderTarget&&(J=J.texture),m.material.uniforms.envMap.value=J,m.material.uniforms.flipEnvMap.value=J.isCubeTexture&&J._needsFlipEnvMap?-1:1,(y!==J||w!==J.version||M!==e.toneMapping)&&(m.material.needsUpdate=!0,y=J,w=J.version,M=e.toneMapping),F.unshift(m,m.geometry,m.material,0,0,null)):J&&J.isTexture&&(d===void 0&&(d=new Fn(new nm(2,2),new qr({name:"BackgroundMaterial",uniforms:Na(to.background.uniforms),vertexShader:to.background.vertexShader,fragmentShader:to.background.fragmentShader,side:A,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(d)),d.material.uniforms.t2D.value=J,J.matrixAutoUpdate===!0&&J.updateMatrix(),d.material.uniforms.uvTransform.value.copy(J.matrix),(y!==J||w!==J.version||M!==e.toneMapping)&&(d.material.needsUpdate=!0,y=J,w=J.version,M=e.toneMapping),F.unshift(d,d.geometry,d.material,0,0,null))}function P(F,C){t.buffers.color.setClear(F.r,F.g,F.b,C,o)}return{getClearColor:function(){return c},setClearColor:function(F,C){c.set(F),f=C!==void 0?C:1,P(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(F){f=F,P(c,f)},render:D}}function vA(e,s,t,a){var o=e.getParameter(34921),c=a.isWebGL2?null:s.get("OES_vertex_array_object"),f=a.isWebGL2||c!==null,d={},m=C(null),y=m;function w(ce,oe,ie,Ce,De){var Oe=!1;if(f){var et=F(Ce,ie,oe);y!==et&&(y=et,D(y.object)),Oe=I(Ce,De),Oe&&q(Ce,De)}else{var mt=oe.wireframe===!0;(y.geometry!==Ce.id||y.program!==ie.id||y.wireframe!==mt)&&(y.geometry=Ce.id,y.program=ie.id,y.wireframe=mt,Oe=!0)}ce.isInstancedMesh===!0&&(Oe=!0),De!==null&&t.update(De,34963),Oe&&(se(ce,oe,ie,Ce),De!==null&&e.bindBuffer(34963,t.get(De).buffer))}function M(){return a.isWebGL2?e.createVertexArray():c.createVertexArrayOES()}function D(ce){return a.isWebGL2?e.bindVertexArray(ce):c.bindVertexArrayOES(ce)}function P(ce){return a.isWebGL2?e.deleteVertexArray(ce):c.deleteVertexArrayOES(ce)}function F(ce,oe,ie){var Ce=ie.wireframe===!0,De=d[ce.id];De===void 0&&(De={},d[ce.id]=De);var Oe=De[oe.id];Oe===void 0&&(Oe={},De[oe.id]=Oe);var et=Oe[Ce];return et===void 0&&(et=C(M()),Oe[Ce]=et),et}function C(ce){for(var oe=[],ie=[],Ce=[],De=0;De<o;De++)oe[De]=0,ie[De]=0,Ce[De]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:oe,enabledAttributes:ie,attributeDivisors:Ce,object:ce,attributes:{},index:null}}function I(ce,oe){var ie=y.attributes,Ce=ce.attributes;if(Object.keys(ie).length!==Object.keys(Ce).length)return!0;for(var De in Ce){var Oe=ie[De],et=Ce[De];if(Oe===void 0||Oe.attribute!==et||Oe.data!==et.data)return!0}return y.index!==oe}function q(ce,oe){var ie={},Ce=ce.attributes;for(var De in Ce){var Oe=Ce[De],et={};et.attribute=Oe,Oe.data&&(et.data=Oe.data),ie[De]=et}y.attributes=ie,y.index=oe}function J(){for(var ce=y.newAttributes,oe=0,ie=ce.length;oe<ie;oe++)ce[oe]=0}function Z(ce){G(ce,0)}function G(ce,oe){var ie=y.newAttributes,Ce=y.enabledAttributes,De=y.attributeDivisors;if(ie[ce]=1,Ce[ce]===0&&(e.enableVertexAttribArray(ce),Ce[ce]=1),De[ce]!==oe){var Oe=a.isWebGL2?e:s.get("ANGLE_instanced_arrays");Oe[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ce,oe),De[ce]=oe}}function Y(){for(var ce=y.newAttributes,oe=y.enabledAttributes,ie=0,Ce=oe.length;ie<Ce;ie++)oe[ie]!==ce[ie]&&(e.disableVertexAttribArray(ie),oe[ie]=0)}function ne(ce,oe,ie,Ce,De,Oe){a.isWebGL2===!0&&(ie===5124||ie===5125)?e.vertexAttribIPointer(ce,oe,ie,De,Oe):e.vertexAttribPointer(ce,oe,ie,Ce,De,Oe)}function se(ce,oe,ie,Ce){if(!(a.isWebGL2===!1&&(ce.isInstancedMesh||Ce.isInstancedBufferGeometry)&&s.get("ANGLE_instanced_arrays")===null)){J();var De=Ce.attributes,Oe=ie.getAttributes(),et=oe.defaultAttributeValues;for(var mt in Oe){var dt=Oe[mt];if(dt>=0){var ot=De[mt];if(ot!==void 0){var Mt=ot.normalized,zt=ot.itemSize,Bt=t.get(ot);if(Bt===void 0)continue;var en=Bt.buffer,on=Bt.type,ft=Bt.bytesPerElement;if(ot.isInterleavedBufferAttribute){var Bn=ot.data,Rn=Bn.stride,mn=ot.offset;Bn&&Bn.isInstancedInterleavedBuffer?(G(dt,Bn.meshPerAttribute),Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=Bn.meshPerAttribute*Bn.count)):Z(dt),e.bindBuffer(34962,en),ne(dt,zt,on,Mt,Rn*ft,mn*ft)}else ot.isInstancedBufferAttribute?(G(dt,ot.meshPerAttribute),Ce._maxInstanceCount===void 0&&(Ce._maxInstanceCount=ot.meshPerAttribute*ot.count)):Z(dt),e.bindBuffer(34962,en),ne(dt,zt,on,Mt,0,0)}else if(mt==="instanceMatrix"){var ri=t.get(ce.instanceMatrix);if(ri===void 0)continue;var Wn=ri.buffer,mi=ri.type;G(dt+0,1),G(dt+1,1),G(dt+2,1),G(dt+3,1),e.bindBuffer(34962,Wn),e.vertexAttribPointer(dt+0,4,mi,!1,64,0),e.vertexAttribPointer(dt+1,4,mi,!1,64,16),e.vertexAttribPointer(dt+2,4,mi,!1,64,32),e.vertexAttribPointer(dt+3,4,mi,!1,64,48)}else if(mt==="instanceColor"){var ei=t.get(ce.instanceColor);if(ei===void 0)continue;var Hi=ei.buffer,Me=ei.type;G(dt,1),e.bindBuffer(34962,Hi),e.vertexAttribPointer(dt,3,Me,!1,12,0)}else if(et!==void 0){var X=et[mt];if(X!==void 0)switch(X.length){case 2:e.vertexAttrib2fv(dt,X);break;case 3:e.vertexAttrib3fv(dt,X);break;case 4:e.vertexAttrib4fv(dt,X);break;default:e.vertexAttrib1fv(dt,X)}}}}Y()}}function Ee(){Be(),y!==m&&(y=m,D(y.object))}function Be(){m.geometry=null,m.program=null,m.wireframe=!1}return{setup:w,reset:Ee,resetDefaultState:Be,dispose:function(){Ee();for(var ce in d){var oe=d[ce];for(var ie in oe){var Ce=oe[ie];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete oe[ie]}delete d[ce]}},releaseStatesOfGeometry:function(ce){if(d[ce.id]!==void 0){var oe=d[ce.id];for(var ie in oe){var Ce=oe[ie];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete oe[ie]}delete d[ce.id]}},releaseStatesOfProgram:function(ce){for(var oe in d){var ie=d[oe];if(ie[ce.id]!==void 0){var Ce=ie[ce.id];for(var De in Ce)P(Ce[De].object),delete Ce[De];delete ie[ce.id]}}},initAttributes:J,enableAttribute:Z,disableUnusedAttributes:Y}}function yA(e,s,t,a){var o=a.isWebGL2,c;function f(m,y){e.drawArrays(c,m,y),t.update(y,c,1)}function d(m,y,w){if(w!==0){var M,D;if(o)M=e,D="drawArraysInstanced";else if(M=s.get("ANGLE_instanced_arrays"),D="drawArraysInstancedANGLE",M===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}M[D](c,m,y,w),t.update(y,c,w)}}this.setMode=function(m){c=m},this.render=f,this.renderInstances=d}function _A(e,s,t){var a;function o(){if(a!==void 0)return a;var Y=s.get("EXT_texture_filter_anisotropic");return Y!==null?a=e.getParameter(Y.MAX_TEXTURE_MAX_ANISOTROPY_EXT):a=0,a}function c(Y){if(Y==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Y="mediump"}return Y==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var f=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext,d=t.precision!==void 0?t.precision:"highp",m=c(d);m!==d&&(console.warn("THREE.WebGLRenderer:",d,"not supported, using",m,"instead."),d=m);var y=t.logarithmicDepthBuffer===!0,w=e.getParameter(34930),M=e.getParameter(35660),D=e.getParameter(3379),P=e.getParameter(34076),F=e.getParameter(34921),C=e.getParameter(36347),I=e.getParameter(36348),q=e.getParameter(36349),J=M>0,Z=f||!!s.get("OES_texture_float"),G=f?e.getParameter(36183):0;return{isWebGL2:f,getMaxAnisotropy:o,getMaxPrecision:c,precision:d,logarithmicDepthBuffer:y,maxTextures:w,maxVertexTextures:M,maxTextureSize:D,maxCubemapSize:P,maxAttributes:F,maxVertexUniforms:C,maxVaryings:I,maxFragmentUniforms:q,vertexTextures:J,floatFragmentTextures:Z,floatVertexTextures:J&&Z,maxSamples:G}}function xA(e){var s=this,t=null,a=0,o=!1,c=!1,f=new pa,d=new ta,m={value:null,needsUpdate:!1};this.uniform=m,this.numPlanes=0,this.numIntersection=0,this.init=function(M,D,P){var F=M.length!==0||D||a!==0||o;return o=D,t=w(M,P,0),a=M.length,F},this.beginShadows=function(){c=!0,w(null)},this.endShadows=function(){c=!1,y()},this.setState=function(M,D,P){var F=M.clippingPlanes,C=M.clipIntersection,I=M.clipShadows,q=e.get(M);if(!o||F===null||F.length===0||c&&!I)c?w(null):y();else{var J=c?0:a,Z=J*4,G=q.clippingState||null;m.value=G,G=w(F,D,Z,P);for(var Y=0;Y!==Z;++Y)G[Y]=t[Y];q.clippingState=G,this.numIntersection=C?this.numPlanes:0,this.numPlanes+=J}};function y(){m.value!==t&&(m.value=t,m.needsUpdate=a>0),s.numPlanes=a,s.numIntersection=0}function w(M,D,P,F){var C=M!==null?M.length:0,I=null;if(C!==0){if(I=m.value,F!==!0||I===null){var q=P+C*4,J=D.matrixWorldInverse;d.getNormalMatrix(J),(I===null||I.length<q)&&(I=new Float32Array(q));for(var Z=0,G=P;Z!==C;++Z,G+=4)f.copy(M[Z]).applyMatrix4(J,d),f.normal.toArray(I,G),I[G+3]=f.constant}m.value=I,m.needsUpdate=!0}return s.numPlanes=C,s.numIntersection=0,I}}function bA(e){var s=new WeakMap;function t(o,c){return c===Ge?o.mapping=j:c===ue&&(o.mapping=He),o}function a(o){if(o&&o.isTexture){var c=o.mapping;if(c===Ge||c===ue)if(s.has(o)){var f=s.get(o).texture;return t(f,o.mapping)}else{var d=o.image;if(d&&d.height>0){var m=e.getRenderList(),y=e.getRenderTarget(),w=e.getRenderState(),M=new bc(d.height/2);return M.fromEquirectangularTexture(e,o),s.set(o,M),e.setRenderTarget(y),e.setRenderList(m),e.setRenderState(w),t(M.texture,o.mapping)}else return null}}return o}return{get:a,dispose:function(){s=new WeakMap}}}function wA(e){var s={};return{has:function(t){if(s[t]!==void 0)return s[t]!==null;var a;switch(t){case"WEBGL_depth_texture":a=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":a=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":a=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":a=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:a=e.getExtension(t)}return s[t]=a,a!==null},get:function(t){return this.has(t)||console.warn("THREE.WebGLRenderer: "+t+" extension not supported."),s[t]}}}function MA(e,s,t,a){var o=new WeakMap,c=new WeakMap;function f(y){var w=y.target,M=o.get(w);M.index!==null&&s.remove(M.index);for(var D in M.attributes)s.remove(M.attributes[D]);w.removeEventListener("dispose",f),o.delete(w);var P=c.get(M);P&&(s.remove(P),c.delete(M)),a.releaseStatesOfGeometry(w),w.isInstancedBufferGeometry===!0&&delete w._maxInstanceCount,t.memory.geometries--}function d(y){var w=y.attributes;for(var M in w)s.update(w[M],34962);var D=y.morphAttributes;for(var P in D)for(var F=D[P],C=0,I=F.length;C<I;C++)s.update(F[C],34962)}function m(y){var w=[],M=y.index,D=y.attributes.position,P=0;if(M!==null){var F=M.array;P=M.version;for(var C=0,I=F.length;C<I;C+=3){var q=F[C+0],J=F[C+1],Z=F[C+2];w.push(q,J,J,Z,Z,q)}}else{var G=D.array;P=D.version;for(var Y=0,ne=G.length/3-1;Y<ne;Y+=3){var se=Y+0,Ee=Y+1,Be=Y+2;w.push(se,Ee,Ee,Be,Be,se)}}var ce=new(U(w)>65535?v:Tl)(w,1);ce.version=P;var oe=c.get(y);oe&&s.remove(oe),c.set(y,ce)}return{get:function(y,w){var M=o.get(w);return M||(w.addEventListener("dispose",f),w.isBufferGeometry?M=w:w.isGeometry&&(w._bufferGeometry===void 0&&(w._bufferGeometry=new Ae().setFromObject(y)),M=w._bufferGeometry),o.set(w,M),t.memory.geometries++,M)},update:d,getWireframeAttribute:function(y){var w=c.get(y);if(w){var M=y.index;M!==null&&w.version<M.version&&m(y)}else m(y);return c.get(y)}}}function SA(e,s,t,a){var o=a.isWebGL2,c,f,d;function m(w,M){e.drawElements(c,M,f,w*d),t.update(M,c,1)}function y(w,M,D){if(D!==0){var P,F;if(o)P=e,F="drawElementsInstanced";else if(P=s.get("ANGLE_instanced_arrays"),F="drawElementsInstancedANGLE",P===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}P[F](c,M,f,w*d,D),t.update(M,c,D)}}this.setMode=function(w){c=w},this.setIndex=function(w){f=w.type,d=w.bytesPerElement},this.render=m,this.renderInstances=y}function TA(){var e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(s,t,a){switch(e.calls++,t){case 4:e.triangles+=a*(s/3);break;case 1:e.lines+=a*(s/2);break;case 3:e.lines+=a*(s-1);break;case 2:e.lines+=a*s;break;case 0:e.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",t);break}}}}function EA(e,s){return e[0]-s[0]}function AA(e,s){return Math.abs(s[1])-Math.abs(e[1])}function LA(e){for(var s={},t=new Float32Array(8),a=[],o=0;o<8;o++)a[o]=[o,0];return{update:function(c,f,d,m){var y=c.morphTargetInfluences,w=y===void 0?0:y.length,M=s[f.id];if(M===void 0){M=[];for(var D=0;D<w;D++)M[D]=[D,0];s[f.id]=M}for(var P=0;P<w;P++){var F=M[P];F[0]=P,F[1]=y[P]}M.sort(AA);for(var C=0;C<8;C++)C<w&&M[C][1]?(a[C][0]=M[C][0],a[C][1]=M[C][1]):(a[C][0]=Number.MAX_SAFE_INTEGER,a[C][1]=0);a.sort(EA);for(var I=d.morphTargets&&f.morphAttributes.position,q=d.morphNormals&&f.morphAttributes.normal,J=0,Z=0;Z<8;Z++){var G=a[Z],Y=G[0],ne=G[1];Y!==Number.MAX_SAFE_INTEGER&&ne?(I&&f.getAttribute("morphTarget"+Z)!==I[Y]&&f.setAttribute("morphTarget"+Z,I[Y]),q&&f.getAttribute("morphNormal"+Z)!==q[Y]&&f.setAttribute("morphNormal"+Z,q[Y]),t[Z]=ne,J+=ne):(I&&f.getAttribute("morphTarget"+Z)!==void 0&&f.deleteAttribute("morphTarget"+Z),q&&f.getAttribute("morphNormal"+Z)!==void 0&&f.deleteAttribute("morphNormal"+Z),t[Z]=0)}var se=f.morphTargetsRelative?1:1-J;m.getUniforms().setValue(e,"morphTargetBaseInfluence",se),m.getUniforms().setValue(e,"morphTargetInfluences",t)}}}function RA(e,s,t,a){var o=new WeakMap;function c(f){var d=a.render.frame,m=f.geometry,y=s.get(f,m);return o.get(y)!==d&&(m.isGeometry&&y.updateFromObject(f),s.update(y),o.set(y,d)),f.isInstancedMesh&&(t.update(f.instanceMatrix,34962),f.instanceColor!==null&&t.update(f.instanceColor,34962)),y}return{update:c,dispose:function(){o=new WeakMap}}}function Dh(e,s,t,a){Ti.call(this,null),this.image={data:e||null,width:s||1,height:t||1,depth:a||1},this.magFilter=it,this.minFilter=it,this.wrapR=ct,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Dh.prototype=Object.create(Ti.prototype),Dh.prototype.constructor=Dh,Dh.prototype.isDataTexture2DArray=!0;function Oh(e,s,t,a){Ti.call(this,null),this.image={data:e||null,width:s||1,height:t||1,depth:a||1},this.magFilter=it,this.minFilter=it,this.wrapR=ct,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Oh.prototype=Object.create(Ti.prototype),Oh.prototype.constructor=Oh,Oh.prototype.isDataTexture3D=!0;var F_=new Ti,CA=new Dh,PA=new Oh,B_=new zo,U_=[],G_=[],z_=new Float32Array(16),H_=new Float32Array(9),k_=new Float32Array(4);function Nh(e,s,t){var a=e[0];if(a<=0||a>0)return e;var o=s*t,c=U_[o];if(c===void 0&&(c=new Float32Array(o),U_[o]=c),s!==0){a.toArray(c,0);for(var f=1,d=0;f!==s;++f)d+=t,e[f].toArray(c,d)}return c}function Ms(e,s){if(e.length!==s.length)return!1;for(var t=0,a=e.length;t<a;t++)if(e[t]!==s[t])return!1;return!0}function is(e,s){for(var t=0,a=s.length;t<a;t++)e[t]=s[t]}function V_(e,s){var t=G_[s];t===void 0&&(t=new Int32Array(s),G_[s]=t);for(var a=0;a!==s;++a)t[a]=e.allocateTextureUnit();return t}function IA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1f(this.addr,s),t[0]=s)}function DA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y)&&(e.uniform2f(this.addr,s.x,s.y),t[0]=s.x,t[1]=s.y);else{if(Ms(t,s))return;e.uniform2fv(this.addr,s),is(t,s)}}function OA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y||t[2]!==s.z)&&(e.uniform3f(this.addr,s.x,s.y,s.z),t[0]=s.x,t[1]=s.y,t[2]=s.z);else if(s.r!==void 0)(t[0]!==s.r||t[1]!==s.g||t[2]!==s.b)&&(e.uniform3f(this.addr,s.r,s.g,s.b),t[0]=s.r,t[1]=s.g,t[2]=s.b);else{if(Ms(t,s))return;e.uniform3fv(this.addr,s),is(t,s)}}function NA(e,s){var t=this.cache;if(s.x!==void 0)(t[0]!==s.x||t[1]!==s.y||t[2]!==s.z||t[3]!==s.w)&&(e.uniform4f(this.addr,s.x,s.y,s.z,s.w),t[0]=s.x,t[1]=s.y,t[2]=s.z,t[3]=s.w);else{if(Ms(t,s))return;e.uniform4fv(this.addr,s),is(t,s)}}function FA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ms(t,s))return;e.uniformMatrix2fv(this.addr,!1,s),is(t,s)}else{if(Ms(t,a))return;k_.set(a),e.uniformMatrix2fv(this.addr,!1,k_),is(t,a)}}function BA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ms(t,s))return;e.uniformMatrix3fv(this.addr,!1,s),is(t,s)}else{if(Ms(t,a))return;H_.set(a),e.uniformMatrix3fv(this.addr,!1,H_),is(t,a)}}function UA(e,s){var t=this.cache,a=s.elements;if(a===void 0){if(Ms(t,s))return;e.uniformMatrix4fv(this.addr,!1,s),is(t,s)}else{if(Ms(t,a))return;z_.set(a),e.uniformMatrix4fv(this.addr,!1,z_),is(t,a)}}function GA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.safeSetTexture2D(s||F_,o)}function zA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.setTexture2DArray(s||CA,o)}function HA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.setTexture3D(s||PA,o)}function kA(e,s,t){var a=this.cache,o=t.allocateTextureUnit();a[0]!==o&&(e.uniform1i(this.addr,o),a[0]=o),t.safeSetTextureCube(s||B_,o)}function VA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1i(this.addr,s),t[0]=s)}function WA(e,s){var t=this.cache;Ms(t,s)||(e.uniform2iv(this.addr,s),is(t,s))}function qA(e,s){var t=this.cache;Ms(t,s)||(e.uniform3iv(this.addr,s),is(t,s))}function XA(e,s){var t=this.cache;Ms(t,s)||(e.uniform4iv(this.addr,s),is(t,s))}function YA(e,s){var t=this.cache;t[0]!==s&&(e.uniform1ui(this.addr,s),t[0]=s)}function jA(e){switch(e){case 5126:return IA;case 35664:return DA;case 35665:return OA;case 35666:return NA;case 35674:return FA;case 35675:return BA;case 35676:return UA;case 5124:case 35670:return VA;case 35667:case 35671:return WA;case 35668:case 35672:return qA;case 35669:case 35673:return XA;case 5125:return YA;case 35678:case 36198:case 36298:case 36306:case 35682:return GA;case 35679:case 36299:case 36307:return HA;case 35680:case 36300:case 36308:case 36293:return kA;case 36289:case 36303:case 36311:case 36292:return zA}}function ZA(e,s){e.uniform1fv(this.addr,s)}function JA(e,s){e.uniform1iv(this.addr,s)}function KA(e,s){e.uniform2iv(this.addr,s)}function QA(e,s){e.uniform3iv(this.addr,s)}function $A(e,s){e.uniform4iv(this.addr,s)}function eL(e,s){var t=Nh(s,this.size,2);e.uniform2fv(this.addr,t)}function tL(e,s){var t=Nh(s,this.size,3);e.uniform3fv(this.addr,t)}function nL(e,s){var t=Nh(s,this.size,4);e.uniform4fv(this.addr,t)}function iL(e,s){var t=Nh(s,this.size,4);e.uniformMatrix2fv(this.addr,!1,t)}function rL(e,s){var t=Nh(s,this.size,9);e.uniformMatrix3fv(this.addr,!1,t)}function aL(e,s){var t=Nh(s,this.size,16);e.uniformMatrix4fv(this.addr,!1,t)}function sL(e,s,t){var a=s.length,o=V_(t,a);e.uniform1iv(this.addr,o);for(var c=0;c!==a;++c)t.safeSetTexture2D(s[c]||F_,o[c])}function oL(e,s,t){var a=s.length,o=V_(t,a);e.uniform1iv(this.addr,o);for(var c=0;c!==a;++c)t.safeSetTextureCube(s[c]||B_,o[c])}function lL(e){switch(e){case 5126:return ZA;case 35664:return eL;case 35665:return tL;case 35666:return nL;case 35674:return iL;case 35675:return rL;case 35676:return aL;case 5124:case 35670:return JA;case 35667:case 35671:return KA;case 35668:case 35672:return QA;case 35669:case 35673:return $A;case 35678:case 36198:case 36298:case 36306:case 35682:return sL;case 35680:case 36300:case 36308:case 36293:return oL}}function cL(e,s,t){this.id=e,this.addr=t,this.cache=[],this.setValue=jA(s.type)}function W_(e,s,t){this.id=e,this.addr=t,this.cache=[],this.size=s.size,this.setValue=lL(s.type)}W_.prototype.updateCache=function(e){var s=this.cache;e instanceof Float32Array&&s.length!==e.length&&(this.cache=new Float32Array(e.length)),is(s,e)};function q_(e){this.id=e,this.seq=[],this.map={}}q_.prototype.setValue=function(e,s,t){for(var a=this.seq,o=0,c=a.length;o!==c;++o){var f=a[o];f.setValue(e,s[f.id],t)}};var Av=/([\w\d_]+)(\])?(\[|\.)?/g;function X_(e,s){e.seq.push(s),e.map[s.id]=s}function uL(e,s,t){var a=e.name,o=a.length;for(Av.lastIndex=0;;){var c=Av.exec(a),f=Av.lastIndex,d=c[1],m=c[2]==="]",y=c[3];if(m&&(d=d|0),y===void 0||y==="["&&f+2===o){X_(t,y===void 0?new cL(d,e,s):new W_(d,e,s));break}else{var w=t.map,M=w[d];M===void 0&&(M=new q_(d),X_(t,M)),t=M}}}function wc(e,s){this.seq=[],this.map={};for(var t=e.getProgramParameter(s,35718),a=0;a<t;++a){var o=e.getActiveUniform(s,a),c=e.getUniformLocation(s,o.name);uL(o,c,this)}}wc.prototype.setValue=function(e,s,t,a){var o=this.map[s];o!==void 0&&o.setValue(e,t,a)},wc.prototype.setOptional=function(e,s,t){var a=s[t];a!==void 0&&this.setValue(e,t,a)},wc.upload=function(e,s,t,a){for(var o=0,c=s.length;o!==c;++o){var f=s[o],d=t[f.id];d.needsUpdate!==!1&&f.setValue(e,d.value,a)}},wc.seqWithValue=function(e,s){for(var t=[],a=0,o=e.length;a!==o;++a){var c=e[a];c.id in s&&t.push(c)}return t};function Y_(e,s,t){var a=e.createShader(s);return e.shaderSource(a,t),e.compileShader(a),a}var hL=0;function fL(e){for(var s=e.split(`
`),t=0;t<s.length;t++)s[t]=t+1+": "+s[t];return s.join(`
`)}function j_(e){switch(e){case Ur:return["Linear","( value )"];case pl:return["sRGB","( value )"];case Ro:return["RGBE","( value )"];case Kf:return["RGBM","( value, 7.0 )"];case $c:return["RGBM","( value, 16.0 )"];case Qf:return["RGBD","( value, 256.0 )"];case Qc:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Gr:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Z_(e,s,t){var a=e.getShaderParameter(s,35713),o=e.getShaderInfoLog(s).trim();if(a&&o==="")return"";var c=e.getShaderSource(s);return"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+o+fL(c)}function fd(e,s){var t=j_(s);return"vec4 "+e+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function dL(e,s){var t=j_(s);return"vec4 "+e+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function pL(e,s){var t;switch(s){case Se:t="Linear";break;case Pe:t="Reinhard";break;case ze:t="OptimizedCineon";break;case Ze:t="ACESFilmic";break;case Xe:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",s),t="Linear"}return"vec3 "+e+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function mL(e){var s=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return s.filter(dd).join(`
`)}function gL(e){var s=[];for(var t in e){var a=e[t];a!==!1&&s.push("#define "+t+" "+a)}return s.join(`
`)}function vL(e,s){for(var t={},a=e.getProgramParameter(s,35721),o=0;o<a;o++){var c=e.getActiveAttrib(s,o),f=c.name;t[f]=e.getAttribLocation(s,f)}return t}function dd(e){return e!==""}function J_(e,s){return e.replace(/NUM_DIR_LIGHTS/g,s.numDirLights).replace(/NUM_SPOT_LIGHTS/g,s.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,s.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,s.numPointLights).replace(/NUM_HEMI_LIGHTS/g,s.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,s.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,s.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,s.numPointLightShadows)}function K_(e,s){return e.replace(/NUM_CLIPPING_PLANES/g,s.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,s.numClippingPlanes-s.numClipIntersection)}function Lv(e){return e.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,yL)}function yL(e,s){var t=Zn[s];if(t===void 0)throw new Error("Can not resolve #include <"+s+">");return Lv(t)}function Q_(e){return e.replace(/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g,$_).replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,_L)}function _L(e,s,t,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),$_(e,s,t,a)}function $_(e,s,t,a){for(var o="",c=parseInt(s);c<parseInt(t);c++)o+=a.replace(/\[\s*i\s*\]/g,"[ "+c+" ]").replace(/UNROLLED_LOOP_INDEX/g,c);return o}function ex(e){var s="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?s+=`
#define HIGH_PRECISION`:e.precision==="mediump"?s+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(s+=`
#define LOW_PRECISION`),s}function xL(e){var s="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===g?s="SHADOWMAP_TYPE_PCF":e.shadowMapType===_?s="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===b&&(s="SHADOWMAP_TYPE_VSM"),s}function bL(e){var s="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case j:case He:s="ENVMAP_TYPE_CUBE";break;case Je:case lt:s="ENVMAP_TYPE_CUBE_UV";break}return s}function wL(e){var s="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case He:case lt:s="ENVMAP_MODE_REFRACTION";break}return s}function ML(e){var s="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case de:s="ENVMAP_BLENDING_MULTIPLY";break;case be:s="ENVMAP_BLENDING_MIX";break;case Re:s="ENVMAP_BLENDING_ADD";break}return s}function SL(e,s,t,a){var o=e.getContext(),c=t.defines,f=t.vertexShader,d=t.fragmentShader,m=xL(t),y=bL(t),w=wL(t),M=ML(t),D=e.gammaFactor>0?e.gammaFactor:1,P=t.isWebGL2?"":mL(t),F=gL(c),C=o.createProgram(),I,q,J=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(I=[F].filter(dd).join(`
`),I.length>0&&(I+=`
`),q=[P,F].filter(dd).join(`
`),q.length>0&&(q+=`
`)):(I=[ex(t),"#define SHADER_NAME "+t.shaderName,F,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+D,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+w:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+m:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(dd).join(`
`),q=[P,ex(t),"#define SHADER_NAME "+t.shaderName,F,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+D,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+y:"",t.envMap?"#define "+w:"",t.envMap?"#define "+M:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+m:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==we?"#define TONE_MAPPING":"",t.toneMapping!==we?Zn.tonemapping_pars_fragment:"",t.toneMapping!==we?pL("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",Zn.encodings_pars_fragment,t.map?fd("mapTexelToLinear",t.mapEncoding):"",t.matcap?fd("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?fd("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?fd("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?fd("lightMapTexelToLinear",t.lightMapEncoding):"",dL("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(dd).join(`
`)),f=Lv(f),f=J_(f,t),f=K_(f,t),d=Lv(d),d=J_(d,t),d=K_(d,t),f=Q_(f),d=Q_(d),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(J=`#version 300 es
`,I=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+I,q=["#define varying in",t.glslVersion===tu?"":"out highp vec4 pc_fragColor;",t.glslVersion===tu?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+q);var Z=J+I+f,G=J+q+d,Y=Y_(o,35633,Z),ne=Y_(o,35632,G);if(o.attachShader(C,Y),o.attachShader(C,ne),t.index0AttributeName!==void 0?o.bindAttribLocation(C,0,t.index0AttributeName):t.morphTargets===!0&&o.bindAttribLocation(C,0,"position"),o.linkProgram(C),e.debug.checkShaderErrors){var se=o.getProgramInfoLog(C).trim(),Ee=o.getShaderInfoLog(Y).trim(),Be=o.getShaderInfoLog(ne).trim(),ce=!0,oe=!0;if(o.getProgramParameter(C,35714)===!1){ce=!1;var ie=Z_(o,Y,"vertex"),Ce=Z_(o,ne,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(C,35715),"gl.getProgramInfoLog",se,ie,Ce)}else se!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",se):(Ee===""||Be==="")&&(oe=!1);oe&&(this.diagnostics={runnable:ce,programLog:se,vertexShader:{log:Ee,prefix:I},fragmentShader:{log:Be,prefix:q}})}o.deleteShader(Y),o.deleteShader(ne);var De;this.getUniforms=function(){return De===void 0&&(De=new wc(o,C)),De};var Oe;return this.getAttributes=function(){return Oe===void 0&&(Oe=vL(o,C)),Oe},this.destroy=function(){a.releaseStatesOfProgram(this),o.deleteProgram(C),this.program=void 0},this.name=t.shaderName,this.id=hL++,this.cacheKey=s,this.usedTimes=1,this.program=C,this.vertexShader=Y,this.fragmentShader=ne,this}function TL(e,s,t,a,o,c){var f=[],d=a.isWebGL2,m=a.logarithmicDepthBuffer,y=a.floatVertexTextures,w=a.maxVertexUniforms,M=a.vertexTextures,D=a.precision,P={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},F=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function C(G){var Y=G.skeleton,ne=Y.bones;if(y)return 1024;var se=Math.floor((w-20)/4),Ee=Math.min(se,ne.length);return Ee<ne.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+ne.length+" bones. This GPU supports "+Ee+"."),0):Ee}function I(G){var Y;return G?G.isTexture?Y=G.encoding:G.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Y=G.texture.encoding):Y=Ur,Y}function q(G,Y,ne,se,Ee){var Be=se.fog,ce=G.isMeshStandardMaterial?se.environment:null,oe=s.get(G.envMap||ce),ie=P[G.type],Ce=Ee.isSkinnedMesh?C(Ee):0;G.precision!==null&&(D=a.getMaxPrecision(G.precision),D!==G.precision&&console.warn("THREE.WebGLProgram.getParameters:",G.precision,"not supported, using",D,"instead."));var De,Oe;if(ie){var et=to[ie];De=et.vertexShader,Oe=et.fragmentShader}else De=G.vertexShader,Oe=G.fragmentShader;var mt=e.getRenderTarget(),dt={isWebGL2:d,shaderID:ie,shaderName:G.type,vertexShader:De,fragmentShader:Oe,defines:G.defines,isRawShaderMaterial:G.isRawShaderMaterial===!0,glslVersion:G.glslVersion,precision:D,instancing:Ee.isInstancedMesh===!0,instancingColor:Ee.isInstancedMesh===!0&&Ee.instanceColor!==null,supportsVertexTextures:M,outputEncoding:mt!==null?I(mt.texture):e.outputEncoding,map:!!G.map,mapEncoding:I(G.map),matcap:!!G.matcap,matcapEncoding:I(G.matcap),envMap:!!oe,envMapMode:oe&&oe.mapping,envMapEncoding:I(oe),envMapCubeUV:!!oe&&(oe.mapping===Je||oe.mapping===lt),lightMap:!!G.lightMap,lightMapEncoding:I(G.lightMap),aoMap:!!G.aoMap,emissiveMap:!!G.emissiveMap,emissiveMapEncoding:I(G.emissiveMap),bumpMap:!!G.bumpMap,normalMap:!!G.normalMap,objectSpaceNormalMap:G.normalMapType===Yp,tangentSpaceNormalMap:G.normalMapType===ml,clearcoatMap:!!G.clearcoatMap,clearcoatRoughnessMap:!!G.clearcoatRoughnessMap,clearcoatNormalMap:!!G.clearcoatNormalMap,displacementMap:!!G.displacementMap,roughnessMap:!!G.roughnessMap,metalnessMap:!!G.metalnessMap,specularMap:!!G.specularMap,alphaMap:!!G.alphaMap,gradientMap:!!G.gradientMap,sheen:!!G.sheen,transmissionMap:!!G.transmissionMap,combine:G.combine,vertexTangents:G.normalMap&&G.vertexTangents,vertexColors:G.vertexColors,vertexUvs:!!G.map||!!G.bumpMap||!!G.normalMap||!!G.specularMap||!!G.alphaMap||!!G.emissiveMap||!!G.roughnessMap||!!G.metalnessMap||!!G.clearcoatMap||!!G.clearcoatRoughnessMap||!!G.clearcoatNormalMap||!!G.displacementMap||!!G.transmissionMap,uvsVertexOnly:!(!!G.map||!!G.bumpMap||!!G.normalMap||!!G.specularMap||!!G.alphaMap||!!G.emissiveMap||!!G.roughnessMap||!!G.metalnessMap||!!G.clearcoatNormalMap||!!G.transmissionMap)&&!!G.displacementMap,fog:!!Be,useFog:G.fog,fogExp2:Be&&Be.isFogExp2,flatShading:G.flatShading,sizeAttenuation:G.sizeAttenuation,logarithmicDepthBuffer:m,skinning:G.skinning&&Ce>0,maxBones:Ce,useVertexTexture:y,morphTargets:G.morphTargets,morphNormals:G.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:Y.directional.length,numPointLights:Y.point.length,numSpotLights:Y.spot.length,numRectAreaLights:Y.rectArea.length,numHemiLights:Y.hemi.length,numDirLightShadows:Y.directionalShadowMap.length,numPointLightShadows:Y.pointShadowMap.length,numSpotLightShadows:Y.spotShadowMap.length,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:G.dithering,shadowMapEnabled:e.shadowMap.enabled&&ne.length>0,shadowMapType:e.shadowMap.type,toneMapping:G.toneMapped?e.toneMapping:we,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:G.premultipliedAlpha,alphaTest:G.alphaTest,doubleSided:G.side===R,flipSided:G.side===S,depthPacking:G.depthPacking!==void 0?G.depthPacking:!1,index0AttributeName:G.index0AttributeName,extensionDerivatives:G.extensions&&G.extensions.derivatives,extensionFragDepth:G.extensions&&G.extensions.fragDepth,extensionDrawBuffers:G.extensions&&G.extensions.drawBuffers,extensionShaderTextureLOD:G.extensions&&G.extensions.shaderTextureLOD,rendererExtensionFragDepth:d||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||t.has("EXT_shader_texture_lod"),customProgramCacheKey:G.customProgramCacheKey()};return dt}function J(G){var Y=[];if(G.shaderID?Y.push(G.shaderID):(Y.push(G.fragmentShader),Y.push(G.vertexShader)),G.defines!==void 0)for(var ne in G.defines)Y.push(ne),Y.push(G.defines[ne]);if(G.isRawShaderMaterial===!1){for(var se=0;se<F.length;se++)Y.push(G[F[se]]);Y.push(e.outputEncoding),Y.push(e.gammaFactor)}return Y.push(G.customProgramCacheKey),Y.join()}function Z(G){if(--G.usedTimes===0){var Y=f.indexOf(G);f[Y]=f[f.length-1],f.pop(),G.destroy()}}return{getParameters:q,getProgramCacheKey:J,getUniforms:function(G){var Y=P[G.type],ne;if(Y){var se=to[Y];ne=Go.clone(se.uniforms)}else ne=G.uniforms;return ne},acquireProgram:function(G,Y){for(var ne,se=0,Ee=f.length;se<Ee;se++){var Be=f[se];if(Be.cacheKey===Y){ne=Be,++ne.usedTimes;break}}return ne===void 0&&(ne=new SL(e,Y,G,o),f.push(ne)),ne},releaseProgram:Z,programs:f}}function EL(){var e=new WeakMap;function s(o){var c=e.get(o);return c===void 0&&(c={},e.set(o,c)),c}function t(o){e.delete(o)}function a(o,c,f){e.get(o)[c]=f}return{get:s,remove:t,update:a,dispose:function(){e=new WeakMap}}}function AL(e,s){return e.groupOrder!==s.groupOrder?e.groupOrder-s.groupOrder:e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.program!==s.program?e.program.id-s.program.id:e.material.id!==s.material.id?e.material.id-s.material.id:e.z!==s.z?e.z-s.z:e.id-s.id}function LL(e,s){return e.groupOrder!==s.groupOrder?e.groupOrder-s.groupOrder:e.renderOrder!==s.renderOrder?e.renderOrder-s.renderOrder:e.z!==s.z?s.z-e.z:e.id-s.id}function tx(e){var s=[],t=0,a=[],o=[],c={id:-1};function f(m,y,w,M,D,P){var F=s[t],C=e.get(w);return F===void 0?(F={id:m.id,object:m,geometry:y,material:w,program:C.program||c,groupOrder:M,renderOrder:m.renderOrder,z:D,group:P},s[t]=F):(F.id=m.id,F.object=m,F.geometry=y,F.material=w,F.program=C.program||c,F.groupOrder=M,F.renderOrder=m.renderOrder,F.z=D,F.group=P),t++,F}function d(){for(var m=t,y=s.length;m<y;m++){var w=s[m];if(w.id===null)break;w.id=null,w.object=null,w.geometry=null,w.material=null,w.program=null,w.group=null}}return{opaque:a,transparent:o,init:function(){t=0,a.length=0,o.length=0},push:function(m,y,w,M,D,P){var F=f(m,y,w,M,D,P);(w.transparent===!0?o:a).push(F)},unshift:function(m,y,w,M,D,P){var F=f(m,y,w,M,D,P);(w.transparent===!0?o:a).unshift(F)},finish:d,sort:function(m,y){a.length>1&&a.sort(m||AL),o.length>1&&o.sort(y||LL)}}}function RL(e){var s=new WeakMap;function t(a,o){var c=s.get(a),f;return c===void 0?(f=new tx(e),s.set(a,new WeakMap),s.get(a).set(o,f)):(f=c.get(o),f===void 0&&(f=new tx(e),c.set(o,f))),f}return{get:t,dispose:function(){s=new WeakMap}}}function CL(){var e={};return{get:function(s){if(e[s.id]!==void 0)return e[s.id];var t;switch(s.type){case"DirectionalLight":t={direction:new ee,color:new qt};break;case"SpotLight":t={position:new ee,direction:new ee,color:new qt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ee,color:new qt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ee,skyColor:new qt,groundColor:new qt};break;case"RectAreaLight":t={color:new qt,position:new ee,halfWidth:new ee,halfHeight:new ee};break}return e[s.id]=t,t}}}function PL(){var e={};return{get:function(s){if(e[s.id]!==void 0)return e[s.id];var t;switch(s.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _t};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _t};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new _t,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[s.id]=t,t}}}var IL=0;function DL(e,s){return(s.castShadow?1:0)-(e.castShadow?1:0)}function OL(){for(var e=new CL,s=PL(),t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},a=0;a<9;a++)t.probe.push(new ee);var o=new ee,c=new Hn,f=new Hn;function d(m,y,w){for(var M=0,D=0,P=0,F=0;F<9;F++)t.probe[F].set(0,0,0);var C=0,I=0,q=0,J=0,Z=0,G=0,Y=0,ne=0,se=w.matrixWorldInverse;m.sort(DL);for(var Ee=0,Be=m.length;Ee<Be;Ee++){var ce=m[Ee],oe=ce.color,ie=ce.intensity,Ce=ce.distance,De=ce.shadow&&ce.shadow.map?ce.shadow.map.texture:null;if(ce.isAmbientLight)M+=oe.r*ie,D+=oe.g*ie,P+=oe.b*ie;else if(ce.isLightProbe)for(var Oe=0;Oe<9;Oe++)t.probe[Oe].addScaledVector(ce.sh.coefficients[Oe],ie);else if(ce.isDirectionalLight){var et=e.get(ce);if(et.color.copy(ce.color).multiplyScalar(ce.intensity),et.direction.setFromMatrixPosition(ce.matrixWorld),o.setFromMatrixPosition(ce.target.matrixWorld),et.direction.sub(o),et.direction.transformDirection(se),ce.castShadow){var mt=ce.shadow,dt=s.get(ce);dt.shadowBias=mt.bias,dt.shadowNormalBias=mt.normalBias,dt.shadowRadius=mt.radius,dt.shadowMapSize=mt.mapSize,t.directionalShadow[C]=dt,t.directionalShadowMap[C]=De,t.directionalShadowMatrix[C]=ce.shadow.matrix,G++}t.directional[C]=et,C++}else if(ce.isSpotLight){var ot=e.get(ce);if(ot.position.setFromMatrixPosition(ce.matrixWorld),ot.position.applyMatrix4(se),ot.color.copy(oe).multiplyScalar(ie),ot.distance=Ce,ot.direction.setFromMatrixPosition(ce.matrixWorld),o.setFromMatrixPosition(ce.target.matrixWorld),ot.direction.sub(o),ot.direction.transformDirection(se),ot.coneCos=Math.cos(ce.angle),ot.penumbraCos=Math.cos(ce.angle*(1-ce.penumbra)),ot.decay=ce.decay,ce.castShadow){var Mt=ce.shadow,zt=s.get(ce);zt.shadowBias=Mt.bias,zt.shadowNormalBias=Mt.normalBias,zt.shadowRadius=Mt.radius,zt.shadowMapSize=Mt.mapSize,t.spotShadow[q]=zt,t.spotShadowMap[q]=De,t.spotShadowMatrix[q]=ce.shadow.matrix,ne++}t.spot[q]=ot,q++}else if(ce.isRectAreaLight){var Bt=e.get(ce);Bt.color.copy(oe).multiplyScalar(ie),Bt.position.setFromMatrixPosition(ce.matrixWorld),Bt.position.applyMatrix4(se),f.identity(),c.copy(ce.matrixWorld),c.premultiply(se),f.extractRotation(c),Bt.halfWidth.set(ce.width*.5,0,0),Bt.halfHeight.set(0,ce.height*.5,0),Bt.halfWidth.applyMatrix4(f),Bt.halfHeight.applyMatrix4(f),t.rectArea[J]=Bt,J++}else if(ce.isPointLight){var en=e.get(ce);if(en.position.setFromMatrixPosition(ce.matrixWorld),en.position.applyMatrix4(se),en.color.copy(ce.color).multiplyScalar(ce.intensity),en.distance=ce.distance,en.decay=ce.decay,ce.castShadow){var on=ce.shadow,ft=s.get(ce);ft.shadowBias=on.bias,ft.shadowNormalBias=on.normalBias,ft.shadowRadius=on.radius,ft.shadowMapSize=on.mapSize,ft.shadowCameraNear=on.camera.near,ft.shadowCameraFar=on.camera.far,t.pointShadow[I]=ft,t.pointShadowMap[I]=De,t.pointShadowMatrix[I]=ce.shadow.matrix,Y++}t.point[I]=en,I++}else if(ce.isHemisphereLight){var Bn=e.get(ce);Bn.direction.setFromMatrixPosition(ce.matrixWorld),Bn.direction.transformDirection(se),Bn.direction.normalize(),Bn.skyColor.copy(ce.color).multiplyScalar(ie),Bn.groundColor.copy(ce.groundColor).multiplyScalar(ie),t.hemi[Z]=Bn,Z++}}J>0&&(t.rectAreaLTC1=Vt.LTC_1,t.rectAreaLTC2=Vt.LTC_2),t.ambient[0]=M,t.ambient[1]=D,t.ambient[2]=P;var Rn=t.hash;(Rn.directionalLength!==C||Rn.pointLength!==I||Rn.spotLength!==q||Rn.rectAreaLength!==J||Rn.hemiLength!==Z||Rn.numDirectionalShadows!==G||Rn.numPointShadows!==Y||Rn.numSpotShadows!==ne)&&(t.directional.length=C,t.spot.length=q,t.rectArea.length=J,t.point.length=I,t.hemi.length=Z,t.directionalShadow.length=G,t.directionalShadowMap.length=G,t.pointShadow.length=Y,t.pointShadowMap.length=Y,t.spotShadow.length=ne,t.spotShadowMap.length=ne,t.directionalShadowMatrix.length=G,t.pointShadowMatrix.length=Y,t.spotShadowMatrix.length=ne,Rn.directionalLength=C,Rn.pointLength=I,Rn.spotLength=q,Rn.rectAreaLength=J,Rn.hemiLength=Z,Rn.numDirectionalShadows=G,Rn.numPointShadows=Y,Rn.numSpotShadows=ne,t.version=IL++)}return{setup:d,state:t}}function nx(){var e=new OL,s=[],t=[];return{init:function(){s.length=0,t.length=0},state:{lightsArray:s,shadowsArray:t,lights:e},setupLights:function(a){e.setup(s,t,a)},pushLight:function(a){s.push(a)},pushShadow:function(a){t.push(a)}}}function NL(){var e=new WeakMap;function s(t,a){var o;return e.has(t)===!1?(o=new nx,e.set(t,new WeakMap),e.get(t).set(a,o)):e.get(t).has(a)===!1?(o=new nx,e.get(t).set(a,o)):o=e.get(t).get(a),o}return{get:s,dispose:function(){e=new WeakMap}}}function Mc(e){an.call(this),this.type="MeshDepthMaterial",this.depthPacking=$f,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}Mc.prototype=Object.create(an.prototype),Mc.prototype.constructor=Mc,Mc.prototype.isMeshDepthMaterial=!0,Mc.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function Sc(e){an.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ee,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}Sc.prototype=Object.create(an.prototype),Sc.prototype.constructor=Sc,Sc.prototype.isMeshDistanceMaterial=!0,Sc.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};function ix(e,s,t){var a=new hd,o=new _t,c=new _t,f=new Ei,d=[],m=[],y={},w={0:S,1:A,2:R},M=new qr({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new _t},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),D=M.clone();D.defines.HORIZONAL_PASS=1;var P=new Ae;P.setAttribute("position",new fn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var F=new Fn(P,M),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g,this.render=function(Y,ne,se){if(C.enabled!==!1&&!(C.autoUpdate===!1&&C.needsUpdate===!1)&&Y.length!==0){var Ee=e.getRenderTarget(),Be=e.getActiveCubeFace(),ce=e.getActiveMipmapLevel(),oe=e.state;oe.setBlending(N),oe.buffers.color.setClear(1,1,1,1),oe.buffers.depth.setTest(!0),oe.setScissorTest(!1);for(var ie=0,Ce=Y.length;ie<Ce;ie++){var De=Y[ie],Oe=De.shadow;if(Oe===void 0){console.warn("THREE.WebGLShadowMap:",De,"has no shadow.");continue}if(!(Oe.autoUpdate===!1&&Oe.needsUpdate===!1)){o.copy(Oe.mapSize);var et=Oe.getFrameExtents();if(o.multiply(et),c.copy(Oe.mapSize),(o.x>t||o.y>t)&&(o.x>t&&(c.x=Math.floor(t/et.x),o.x=c.x*et.x,Oe.mapSize.x=c.x),o.y>t&&(c.y=Math.floor(t/et.y),o.y=c.y*et.y,Oe.mapSize.y=c.y)),Oe.map===null&&!Oe.isPointLightShadow&&this.type===b){var mt={minFilter:Dt,magFilter:Dt,format:re};Oe.map=new na(o.x,o.y,mt),Oe.map.texture.name=De.name+".shadowMap",Oe.mapPass=new na(o.x,o.y,mt),Oe.camera.updateProjectionMatrix()}Oe.map===null&&(Oe.map=new na(o.x,o.y,{minFilter:it,magFilter:it,format:re}),Oe.map.texture.name=De.name+".shadowMap",Oe.camera.updateProjectionMatrix()),e.setRenderTarget(Oe.map),e.clear();for(var dt=Oe.getViewportCount(),ot=0;ot<dt;ot++){var Mt=Oe.getViewport(ot);f.set(c.x*Mt.x,c.y*Mt.y,c.x*Mt.z,c.y*Mt.w),oe.viewport(f),Oe.updateMatrices(De,ot),a=Oe.getFrustum(),G(ne,se,Oe.camera,De,this.type)}!Oe.isPointLightShadow&&this.type===b&&I(Oe,se),Oe.needsUpdate=!1}}C.needsUpdate=!1,e.setRenderTarget(Ee,Be,ce)}};function I(Y,ne){var se=s.update(F);M.uniforms.shadow_pass.value=Y.map.texture,M.uniforms.resolution.value=Y.mapSize,M.uniforms.radius.value=Y.radius,e.setRenderTarget(Y.mapPass),e.clear(),e.renderBufferDirect(ne,null,se,M,F,null),D.uniforms.shadow_pass.value=Y.mapPass.texture,D.uniforms.resolution.value=Y.mapSize,D.uniforms.radius.value=Y.radius,e.setRenderTarget(Y.map),e.clear(),e.renderBufferDirect(ne,null,se,D,F,null)}function q(Y,ne,se){var Ee=Y<<0|ne<<1|se<<2,Be=d[Ee];return Be===void 0&&(Be=new Mc({depthPacking:Js,morphTargets:Y,skinning:ne}),d[Ee]=Be),Be}function J(Y,ne,se){var Ee=Y<<0|ne<<1|se<<2,Be=m[Ee];return Be===void 0&&(Be=new Sc({morphTargets:Y,skinning:ne}),m[Ee]=Be),Be}function Z(Y,ne,se,Ee,Be,ce,oe){var ie=null,Ce=q,De=Y.customDepthMaterial;if(Ee.isPointLight===!0&&(Ce=J,De=Y.customDistanceMaterial),De===void 0){var Oe=!1;se.morphTargets===!0&&(Oe=ne.morphAttributes&&ne.morphAttributes.position&&ne.morphAttributes.position.length>0);var et=!1;Y.isSkinnedMesh===!0&&(se.skinning===!0?et=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Y));var mt=Y.isInstancedMesh===!0;ie=Ce(Oe,et,mt)}else ie=De;if(e.localClippingEnabled&&se.clipShadows===!0&&se.clippingPlanes.length!==0){var dt=ie.uuid,ot=se.uuid,Mt=y[dt];Mt===void 0&&(Mt={},y[dt]=Mt);var zt=Mt[ot];zt===void 0&&(zt=ie.clone(),Mt[ot]=zt),ie=zt}return ie.visible=se.visible,ie.wireframe=se.wireframe,oe===b?ie.side=se.shadowSide!==null?se.shadowSide:se.side:ie.side=se.shadowSide!==null?se.shadowSide:w[se.side],ie.clipShadows=se.clipShadows,ie.clippingPlanes=se.clippingPlanes,ie.clipIntersection=se.clipIntersection,ie.wireframeLinewidth=se.wireframeLinewidth,ie.linewidth=se.linewidth,Ee.isPointLight===!0&&ie.isMeshDistanceMaterial===!0&&(ie.referencePosition.setFromMatrixPosition(Ee.matrixWorld),ie.nearDistance=Be,ie.farDistance=ce),ie}function G(Y,ne,se,Ee,Be){if(Y.visible!==!1){var ce=Y.layers.test(ne.layers);if(ce&&(Y.isMesh||Y.isLine||Y.isPoints)&&(Y.castShadow||Y.receiveShadow&&Be===b)&&(!Y.frustumCulled||a.intersectsObject(Y))){Y.modelViewMatrix.multiplyMatrices(se.matrixWorldInverse,Y.matrixWorld);var oe=s.update(Y),ie=Y.material;if(Array.isArray(ie))for(var Ce=oe.groups,De=0,Oe=Ce.length;De<Oe;De++){var et=Ce[De],mt=ie[et.materialIndex];if(mt&&mt.visible){var dt=Z(Y,oe,mt,Ee,se.near,se.far,Be);e.renderBufferDirect(se,null,oe,dt,Y,et)}}else if(ie.visible){var ot=Z(Y,oe,ie,Ee,se.near,se.far,Be);e.renderBufferDirect(se,null,oe,ot,Y,null)}}for(var Mt=Y.children,zt=0,Bt=Mt.length;zt<Bt;zt++)G(Mt[zt],ne,se,Ee,Be)}}}function FL(e,s,t){var a,o,c=t.isWebGL2,f=new function(){var X=!1,At=new Ei,st=null,Zt=new Ei(0,0,0,0);return{setMask:function(Rt){st!==Rt&&!X&&(e.colorMask(Rt,Rt,Rt,Rt),st=Rt)},setLocked:function(Rt){X=Rt},setClear:function(Rt,un,dn,tn,gn){gn===!0&&(Rt*=tn,un*=tn,dn*=tn),At.set(Rt,un,dn,tn),Zt.equals(At)===!1&&(e.clearColor(Rt,un,dn,tn),Zt.copy(At))},reset:function(){X=!1,st=null,Zt.set(-1,0,0,0)}}},d=new function(){var X=!1,At=null,st=null,Zt=null;return{setTest:function(Rt){Rt?ot(2929):Mt(2929)},setMask:function(Rt){At!==Rt&&!X&&(e.depthMask(Rt),At=Rt)},setFunc:function(Rt){if(st!==Rt){if(Rt)switch(Rt){case nt:e.depthFunc(512);break;case Et:e.depthFunc(519);break;case $t:e.depthFunc(513);break;case Yt:e.depthFunc(515);break;case K:e.depthFunc(514);break;case H:e.depthFunc(518);break;case xe:e.depthFunc(516);break;case te:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);st=Rt}},setLocked:function(Rt){X=Rt},setClear:function(Rt){Zt!==Rt&&(e.clearDepth(Rt),Zt=Rt)},reset:function(){X=!1,At=null,st=null,Zt=null}}},m=new function(){var X=!1,At=null,st=null,Zt=null,Rt=null,un=null,dn=null,tn=null,gn=null;return{setTest:function(vn){X||(vn?ot(2960):Mt(2960))},setMask:function(vn){At!==vn&&!X&&(e.stencilMask(vn),At=vn)},setFunc:function(vn,jn,Ai){(st!==vn||Zt!==jn||Rt!==Ai)&&(e.stencilFunc(vn,jn,Ai),st=vn,Zt=jn,Rt=Ai)},setOp:function(vn,jn,Ai){(un!==vn||dn!==jn||tn!==Ai)&&(e.stencilOp(vn,jn,Ai),un=vn,dn=jn,tn=Ai)},setLocked:function(vn){X=vn},setClear:function(vn){gn!==vn&&(e.clearStencil(vn),gn=vn)},reset:function(){X=!1,At=null,st=null,Zt=null,Rt=null,un=null,dn=null,tn=null,gn=null}}},y={},w=null,M=null,D=null,P=null,F=null,C=null,I=null,q=null,J=null,Z=!1,G=null,Y=null,ne=null,se=null,Ee=null,Be=e.getParameter(35661),ce=!1,oe=0,ie=e.getParameter(7938);ie.indexOf("WebGL")!==-1?(oe=parseFloat(/^WebGL\ ([0-9])/.exec(ie)[1]),ce=oe>=1):ie.indexOf("OpenGL ES")!==-1&&(oe=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(ie)[1]),ce=oe>=2);var Ce=null,De={},Oe=new Ei,et=new Ei;function mt(X,At,st){var Zt=new Uint8Array(4),Rt=e.createTexture();e.bindTexture(X,Rt),e.texParameteri(X,10241,9728),e.texParameteri(X,10240,9728);for(var un=0;un<st;un++)e.texImage2D(At+un,0,6408,1,1,0,6408,5121,Zt);return Rt}var dt={};dt[3553]=mt(3553,3553,1),dt[34067]=mt(34067,34069,6),f.setClear(0,0,0,1),d.setClear(1),m.setClear(0),ot(2929),d.setFunc(Yt),Bn(!1),Rn(h),ot(2884),ft(N);function ot(X){y[X]!==!0&&(e.enable(X),y[X]=!0)}function Mt(X){y[X]!==!1&&(e.disable(X),y[X]=!1)}function zt(X){return w!==X?(e.useProgram(X),w=X,!0):!1}var Bt=(a={},a[ge]=32774,a[ye]=32778,a[Q]=32779,a);if(c)Bt[Ie]=32775,Bt[tt]=32776;else{var en=s.get("EXT_blend_minmax");en!==null&&(Bt[Ie]=en.MIN_EXT,Bt[tt]=en.MAX_EXT)}var on=(o={},o[qe]=0,o[ht]=1,o[Ye]=768,o[Ue]=770,o[Tt]=776,o[We]=774,o[Te]=772,o[Ne]=769,o[Le]=771,o[rt]=775,o[Ve]=773,o);function ft(X,At,st,Zt,Rt,un,dn,tn){if(X===N){M&&(Mt(3042),M=!1);return}if(M||(ot(3042),M=!0),X!==pe){if(X!==D||tn!==Z){if((P!==ge||I!==ge)&&(e.blendEquation(32774),P=ge,I=ge),tn)switch(X){case W:e.blendFuncSeparate(1,771,1,771);break;case V:e.blendFunc(1,1);break;case B:e.blendFuncSeparate(0,0,769,771);break;case O:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}else switch(X){case W:e.blendFuncSeparate(770,771,1,771);break;case V:e.blendFunc(770,1);break;case B:e.blendFunc(0,769);break;case O:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",X);break}F=null,C=null,q=null,J=null,D=X,Z=tn}return}Rt=Rt||At,un=un||st,dn=dn||Zt,(At!==P||Rt!==I)&&(e.blendEquationSeparate(Bt[At],Bt[Rt]),P=At,I=Rt),(st!==F||Zt!==C||un!==q||dn!==J)&&(e.blendFuncSeparate(on[st],on[Zt],on[un],on[dn]),F=st,C=Zt,q=un,J=dn),D=X,Z=null}function Bn(X){G!==X&&(X?e.frontFace(2304):e.frontFace(2305),G=X)}function Rn(X){X!==u?(ot(2884),X!==Y&&(X===h?e.cullFace(1029):X===p?e.cullFace(1028):e.cullFace(1032))):Mt(2884),Y=X}function mn(X){X!==ne&&(ce&&e.lineWidth(X),ne=X)}function ri(X,At,st){X?(ot(32823),(se!==At||Ee!==st)&&(e.polygonOffset(At,st),se=At,Ee=st)):Mt(32823)}function Wn(X){X===void 0&&(X=33984+Be-1),Ce!==X&&(e.activeTexture(X),Ce=X)}function mi(X,At){Ce===null&&Wn();var st=De[Ce];st===void 0&&(st={type:void 0,texture:void 0},De[Ce]=st),(st.type!==X||st.texture!==At)&&(e.bindTexture(X,At||dt[X]),st.type=X,st.texture=At)}function ei(){var X=De[Ce];X!==void 0&&X.type!==void 0&&(e.bindTexture(X.type,null),X.type=void 0,X.texture=void 0)}function Hi(X){Oe.equals(X)===!1&&(e.scissor(X.x,X.y,X.z,X.w),Oe.copy(X))}function Me(X){et.equals(X)===!1&&(e.viewport(X.x,X.y,X.z,X.w),et.copy(X))}return{buffers:{color:f,depth:d,stencil:m},enable:ot,disable:Mt,useProgram:zt,setBlending:ft,setMaterial:function(X,At){X.side===R?Mt(2884):ot(2884);var st=X.side===S;At&&(st=!st),Bn(st),X.blending===W&&X.transparent===!1?ft(N):ft(X.blending,X.blendEquation,X.blendSrc,X.blendDst,X.blendEquationAlpha,X.blendSrcAlpha,X.blendDstAlpha,X.premultipliedAlpha),d.setFunc(X.depthFunc),d.setTest(X.depthTest),d.setMask(X.depthWrite),f.setMask(X.colorWrite);var Zt=X.stencilWrite;m.setTest(Zt),Zt&&(m.setMask(X.stencilWriteMask),m.setFunc(X.stencilFunc,X.stencilRef,X.stencilFuncMask),m.setOp(X.stencilFail,X.stencilZFail,X.stencilZPass)),ri(X.polygonOffset,X.polygonOffsetFactor,X.polygonOffsetUnits)},setFlipSided:Bn,setCullFace:Rn,setLineWidth:mn,setPolygonOffset:ri,setScissorTest:function(X){X?ot(3089):Mt(3089)},activeTexture:Wn,bindTexture:mi,unbindTexture:ei,compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(X){console.error("THREE.WebGLState:",X)}},scissor:Hi,viewport:Me,reset:function(){y={},Ce=null,De={},w=null,D=null,G=null,Y=null,f.reset(),d.reset(),m.reset()}}}function BL(e,s,t,a,o,c,f){var d,m,y=o.isWebGL2,w=o.maxTextures,M=o.maxCubemapSize,D=o.maxTextureSize,P=o.maxSamples,F=new WeakMap,C,I=!1;try{I=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function q(Me,X){return I?new OffscreenCanvas(Me,X):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function J(Me,X,At,st){var Zt=1;if((Me.width>st||Me.height>st)&&(Zt=st/Math.max(Me.width,Me.height)),Zt<1||X===!0)if(typeof HTMLImageElement<"u"&&Me instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Me instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Me instanceof ImageBitmap){var Rt=X?Mn.floorPowerOfTwo:Math.floor,un=Rt(Zt*Me.width),dn=Rt(Zt*Me.height);C===void 0&&(C=q(un,dn));var tn=At?q(un,dn):C;tn.width=un,tn.height=dn;var gn=tn.getContext("2d");return gn.drawImage(Me,0,0,un,dn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Me.width+"x"+Me.height+") to ("+un+"x"+dn+")."),tn}else return"data"in Me&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Me.width+"x"+Me.height+")."),Me;return Me}function Z(Me){return Mn.isPowerOfTwo(Me.width)&&Mn.isPowerOfTwo(Me.height)}function G(Me){return y?!1:Me.wrapS!==ct||Me.wrapT!==ct||Me.minFilter!==it&&Me.minFilter!==Dt}function Y(Me,X){return Me.generateMipmaps&&X&&Me.minFilter!==it&&Me.minFilter!==Dt}function ne(Me,X,At,st){e.generateMipmap(Me);var Zt=a.get(X);Zt.__maxMipLevel=Math.log(Math.max(At,st))*Math.LOG2E}function se(Me,X,At){if(y===!1)return X;if(Me!==null){if(e[Me]!==void 0)return e[Me];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Me+"'")}var st=X;return X===6403&&(At===5126&&(st=33326),At===5131&&(st=33325),At===5121&&(st=33321)),X===6407&&(At===5126&&(st=34837),At===5131&&(st=34843),At===5121&&(st=32849)),X===6408&&(At===5126&&(st=34836),At===5131&&(st=34842),At===5121&&(st=32856)),(st===33325||st===33326||st===34842||st===34836)&&s.get("EXT_color_buffer_float"),st}function Ee(Me){return Me===it||Me===Lt||Me===pt?9728:9729}function Be(Me){var X=Me.target;X.removeEventListener("dispose",Be),oe(X),X.isVideoTexture&&F.delete(X),f.memory.textures--}function ce(Me){var X=Me.target;X.removeEventListener("dispose",ce),ie(X),f.memory.textures--}function oe(Me){var X=a.get(Me);X.__webglInit!==void 0&&(e.deleteTexture(X.__webglTexture),a.remove(Me))}function ie(Me){var X=a.get(Me),At=a.get(Me.texture);if(!!Me){if(At.__webglTexture!==void 0&&e.deleteTexture(At.__webglTexture),Me.depthTexture&&Me.depthTexture.dispose(),Me.isWebGLCubeRenderTarget)for(var st=0;st<6;st++)e.deleteFramebuffer(X.__webglFramebuffer[st]),X.__webglDepthbuffer&&e.deleteRenderbuffer(X.__webglDepthbuffer[st]);else e.deleteFramebuffer(X.__webglFramebuffer),X.__webglDepthbuffer&&e.deleteRenderbuffer(X.__webglDepthbuffer),X.__webglMultisampledFramebuffer&&e.deleteFramebuffer(X.__webglMultisampledFramebuffer),X.__webglColorRenderbuffer&&e.deleteRenderbuffer(X.__webglColorRenderbuffer),X.__webglDepthRenderbuffer&&e.deleteRenderbuffer(X.__webglDepthRenderbuffer);a.remove(Me.texture),a.remove(Me)}}var Ce=0;function De(){var Me=Ce;return Me>=w&&console.warn("THREE.WebGLTextures: Trying to use "+Me+" texture units while this GPU supports only "+w),Ce+=1,Me}function Oe(Me,X){var At=a.get(Me);if(Me.isVideoTexture&&ri(Me),Me.version>0&&At.__version!==Me.version){var st=Me.image;if(st===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(st.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{zt(At,Me,X);return}}t.activeTexture(33984+X),t.bindTexture(3553,At.__webglTexture)}function et(Me,X){var At=a.get(Me);if(Me.version>0&&At.__version!==Me.version){Bt(At,Me,X);return}t.activeTexture(33984+X),t.bindTexture(34067,At.__webglTexture)}var mt=(d={},d[Nt]=10497,d[ct]=33071,d[me]=33648,d),dt=(m={},m[it]=9728,m[Lt]=9984,m[pt]=9986,m[Dt]=9729,m[cn]=9985,m[pi]=9987,m);function ot(Me,X,At){At?(e.texParameteri(Me,10242,mt[X.wrapS]),e.texParameteri(Me,10243,mt[X.wrapT]),(Me===32879||Me===35866)&&e.texParameteri(Me,32882,mt[X.wrapR]),e.texParameteri(Me,10240,dt[X.magFilter]),e.texParameteri(Me,10241,dt[X.minFilter])):(e.texParameteri(Me,10242,33071),e.texParameteri(Me,10243,33071),(Me===32879||Me===35866)&&e.texParameteri(Me,32882,33071),(X.wrapS!==ct||X.wrapT!==ct)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(Me,10240,Ee(X.magFilter)),e.texParameteri(Me,10241,Ee(X.minFilter)),X.minFilter!==it&&X.minFilter!==Dt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var st=s.get("EXT_texture_filter_anisotropic");if(st){if(X.type===Ri&&s.get("OES_texture_float_linear")===null||X.type===Ja&&(y||s.get("OES_texture_half_float_linear"))===null)return;(X.anisotropy>1||a.get(X).__currentAnisotropy)&&(e.texParameterf(Me,st.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,o.getMaxAnisotropy())),a.get(X).__currentAnisotropy=X.anisotropy)}}function Mt(Me,X){Me.__webglInit===void 0&&(Me.__webglInit=!0,X.addEventListener("dispose",Be),Me.__webglTexture=e.createTexture(),f.memory.textures++)}function zt(Me,X,At){var st=3553;X.isDataTexture2DArray&&(st=35866),X.isDataTexture3D&&(st=32879),Mt(Me,X),t.activeTexture(33984+At),t.bindTexture(st,Me.__webglTexture),e.pixelStorei(37440,X.flipY),e.pixelStorei(37441,X.premultiplyAlpha),e.pixelStorei(3317,X.unpackAlignment);var Zt=G(X)&&Z(X.image)===!1,Rt=J(X.image,Zt,!1,D),un=Z(Rt)||y,dn=c.convert(X.format),tn=c.convert(X.type),gn=se(X.internalFormat,dn,tn);ot(st,X,un);var vn,jn=X.mipmaps;if(X.isDepthTexture)gn=6402,y?X.type===Ri?gn=36012:X.type===qi?gn=33190:X.type===fa?gn=35056:gn=33189:X.type===Ri&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),X.format===Ft&&gn===6402&&X.type!==Vs&&X.type!==qi&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),X.type=Vs,tn=c.convert(X.type)),X.format===Tn&&gn===6402&&(gn=34041,X.type!==fa&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),X.type=fa,tn=c.convert(X.type))),t.texImage2D(3553,0,gn,Rt.width,Rt.height,0,dn,tn,null);else if(X.isDataTexture)if(jn.length>0&&un){for(var Ai=0,Or=jn.length;Ai<Or;Ai++)vn=jn[Ai],t.texImage2D(3553,Ai,gn,vn.width,vn.height,0,dn,tn,vn.data);X.generateMipmaps=!1,Me.__maxMipLevel=jn.length-1}else t.texImage2D(3553,0,gn,Rt.width,Rt.height,0,dn,tn,Rt.data),Me.__maxMipLevel=0;else if(X.isCompressedTexture){for(var Bi=0,Ba=jn.length;Bi<Ba;Bi++)vn=jn[Bi],X.format!==re&&X.format!==Ka?dn!==null?t.compressedTexImage2D(3553,Bi,gn,vn.width,vn.height,0,vn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(3553,Bi,gn,vn.width,vn.height,0,dn,tn,vn.data);Me.__maxMipLevel=jn.length-1}else if(X.isDataTexture2DArray)t.texImage3D(35866,0,gn,Rt.width,Rt.height,Rt.depth,0,dn,tn,Rt.data),Me.__maxMipLevel=0;else if(X.isDataTexture3D)t.texImage3D(32879,0,gn,Rt.width,Rt.height,Rt.depth,0,dn,tn,Rt.data),Me.__maxMipLevel=0;else if(jn.length>0&&un){for(var bi=0,co=jn.length;bi<co;bi++)vn=jn[bi],t.texImage2D(3553,bi,gn,dn,tn,vn);X.generateMipmaps=!1,Me.__maxMipLevel=jn.length-1}else t.texImage2D(3553,0,gn,dn,tn,Rt),Me.__maxMipLevel=0;Y(X,un)&&ne(st,X,Rt.width,Rt.height),Me.__version=X.version,X.onUpdate&&X.onUpdate(X)}function Bt(Me,X,At){if(X.image.length===6){Mt(Me,X),t.activeTexture(33984+At),t.bindTexture(34067,Me.__webglTexture),e.pixelStorei(37440,X.flipY);for(var st=X&&(X.isCompressedTexture||X.image[0].isCompressedTexture),Zt=X.image[0]&&X.image[0].isDataTexture,Rt=[],un=0;un<6;un++)!st&&!Zt?Rt[un]=J(X.image[un],!1,!0,M):Rt[un]=Zt?X.image[un].image:X.image[un];var dn=Rt[0],tn=Z(dn)||y,gn=c.convert(X.format),vn=c.convert(X.type),jn=se(X.internalFormat,gn,vn);ot(34067,X,tn);var Ai;if(st){for(var Or=0;Or<6;Or++){Ai=Rt[Or].mipmaps;for(var Bi=0;Bi<Ai.length;Bi++){var Ba=Ai[Bi];X.format!==re&&X.format!==Ka?gn!==null?t.compressedTexImage2D(34069+Or,Bi,jn,Ba.width,Ba.height,0,Ba.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(34069+Or,Bi,jn,Ba.width,Ba.height,0,gn,vn,Ba.data)}}Me.__maxMipLevel=Ai.length-1}else{Ai=X.mipmaps;for(var bi=0;bi<6;bi++)if(Zt){t.texImage2D(34069+bi,0,jn,Rt[bi].width,Rt[bi].height,0,gn,vn,Rt[bi].data);for(var co=0;co<Ai.length;co++){var Tu=Ai[co],uo=Tu.image[bi].image;t.texImage2D(34069+bi,co+1,jn,uo.width,uo.height,0,gn,vn,uo.data)}}else{t.texImage2D(34069+bi,0,jn,gn,vn,Rt[bi]);for(var Pl=0;Pl<Ai.length;Pl++){var $h=Ai[Pl];t.texImage2D(34069+bi,Pl+1,jn,gn,vn,$h.image[bi])}}Me.__maxMipLevel=Ai.length}Y(X,tn)&&ne(34067,X,dn.width,dn.height),Me.__version=X.version,X.onUpdate&&X.onUpdate(X)}}function en(Me,X,At,st){var Zt=c.convert(X.texture.format),Rt=c.convert(X.texture.type),un=se(X.texture.internalFormat,Zt,Rt);t.texImage2D(st,0,un,X.width,X.height,0,Zt,Rt,null),e.bindFramebuffer(36160,Me),e.framebufferTexture2D(36160,At,st,a.get(X.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function on(Me,X,At){if(e.bindRenderbuffer(36161,Me),X.depthBuffer&&!X.stencilBuffer){var st=33189;if(At){var Zt=X.depthTexture;Zt&&Zt.isDepthTexture&&(Zt.type===Ri?st=36012:Zt.type===qi&&(st=33190));var Rt=mn(X);e.renderbufferStorageMultisample(36161,Rt,st,X.width,X.height)}else e.renderbufferStorage(36161,st,X.width,X.height);e.framebufferRenderbuffer(36160,36096,36161,Me)}else if(X.depthBuffer&&X.stencilBuffer){if(At){var un=mn(X);e.renderbufferStorageMultisample(36161,un,35056,X.width,X.height)}else e.renderbufferStorage(36161,34041,X.width,X.height);e.framebufferRenderbuffer(36160,33306,36161,Me)}else{var dn=c.convert(X.texture.format),tn=c.convert(X.texture.type),gn=se(X.texture.internalFormat,dn,tn);if(At){var vn=mn(X);e.renderbufferStorageMultisample(36161,vn,gn,X.width,X.height)}else e.renderbufferStorage(36161,gn,X.width,X.height)}e.bindRenderbuffer(36161,null)}function ft(Me,X){var At=X&&X.isWebGLCubeRenderTarget;if(At)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,Me),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!a.get(X.depthTexture).__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),Oe(X.depthTexture,0);var st=a.get(X.depthTexture).__webglTexture;if(X.depthTexture.format===Ft)e.framebufferTexture2D(36160,36096,3553,st,0);else if(X.depthTexture.format===Tn)e.framebufferTexture2D(36160,33306,3553,st,0);else throw new Error("Unknown depthTexture format")}function Bn(Me){var X=a.get(Me),At=Me.isWebGLCubeRenderTarget===!0;if(Me.depthTexture){if(At)throw new Error("target.depthTexture not supported in Cube render targets");ft(X.__webglFramebuffer,Me)}else if(At){X.__webglDepthbuffer=[];for(var st=0;st<6;st++)e.bindFramebuffer(36160,X.__webglFramebuffer[st]),X.__webglDepthbuffer[st]=e.createRenderbuffer(),on(X.__webglDepthbuffer[st],Me,!1)}else e.bindFramebuffer(36160,X.__webglFramebuffer),X.__webglDepthbuffer=e.createRenderbuffer(),on(X.__webglDepthbuffer,Me,!1);e.bindFramebuffer(36160,null)}function Rn(Me){var X=a.get(Me),At=a.get(Me.texture);Me.addEventListener("dispose",ce),At.__webglTexture=e.createTexture(),f.memory.textures++;var st=Me.isWebGLCubeRenderTarget===!0,Zt=Me.isWebGLMultisampleRenderTarget===!0,Rt=Z(Me)||y;if(y&&Me.texture.format===Ka&&(Me.texture.type===Ri||Me.texture.type===Ja)&&(Me.texture.format=re,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),st){X.__webglFramebuffer=[];for(var un=0;un<6;un++)X.__webglFramebuffer[un]=e.createFramebuffer()}else if(X.__webglFramebuffer=e.createFramebuffer(),Zt)if(y){X.__webglMultisampledFramebuffer=e.createFramebuffer(),X.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,X.__webglColorRenderbuffer);var dn=c.convert(Me.texture.format),tn=c.convert(Me.texture.type),gn=se(Me.texture.internalFormat,dn,tn),vn=mn(Me);e.renderbufferStorageMultisample(36161,vn,gn,Me.width,Me.height),e.bindFramebuffer(36160,X.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,X.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),Me.depthBuffer&&(X.__webglDepthRenderbuffer=e.createRenderbuffer(),on(X.__webglDepthRenderbuffer,Me,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(st){t.bindTexture(34067,At.__webglTexture),ot(34067,Me.texture,Rt);for(var jn=0;jn<6;jn++)en(X.__webglFramebuffer[jn],Me,36064,34069+jn);Y(Me.texture,Rt)&&ne(34067,Me.texture,Me.width,Me.height),t.bindTexture(34067,null)}else t.bindTexture(3553,At.__webglTexture),ot(3553,Me.texture,Rt),en(X.__webglFramebuffer,Me,36064,3553),Y(Me.texture,Rt)&&ne(3553,Me.texture,Me.width,Me.height),t.bindTexture(3553,null);Me.depthBuffer&&Bn(Me)}function mn(Me){return y&&Me.isWebGLMultisampleRenderTarget?Math.min(P,Me.samples):0}function ri(Me){var X=f.render.frame;F.get(Me)!==X&&(F.set(Me,X),Me.update())}var Wn=!1,mi=!1;function ei(Me,X){Me&&Me.isWebGLRenderTarget&&(Wn===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Wn=!0),Me=Me.texture),Oe(Me,X)}function Hi(Me,X){Me&&Me.isWebGLCubeRenderTarget&&(mi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),mi=!0),Me=Me.texture),et(Me,X)}this.allocateTextureUnit=De,this.resetTextureUnits=function(){Ce=0},this.setTexture2D=Oe,this.setTexture2DArray=function(Me,X){var At=a.get(Me);if(Me.version>0&&At.__version!==Me.version){zt(At,Me,X);return}t.activeTexture(33984+X),t.bindTexture(35866,At.__webglTexture)},this.setTexture3D=function(Me,X){var At=a.get(Me);if(Me.version>0&&At.__version!==Me.version){zt(At,Me,X);return}t.activeTexture(33984+X),t.bindTexture(32879,At.__webglTexture)},this.setTextureCube=et,this.setupRenderTarget=Rn,this.updateRenderTargetMipmap=function(Me){var X=Me.texture,At=Z(Me)||y;if(Y(X,At)){var st=Me.isWebGLCubeRenderTarget?34067:3553,Zt=a.get(X).__webglTexture;t.bindTexture(st,Zt),ne(st,X,Me.width,Me.height),t.bindTexture(st,null)}},this.updateMultisampleRenderTarget=function(Me){if(Me.isWebGLMultisampleRenderTarget)if(y){var X=a.get(Me);e.bindFramebuffer(36008,X.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,X.__webglFramebuffer);var At=Me.width,st=Me.height,Zt=16384;Me.depthBuffer&&(Zt|=256),Me.stencilBuffer&&(Zt|=1024),e.blitFramebuffer(0,0,At,st,0,0,At,st,Zt,9728),e.bindFramebuffer(36160,X.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=ei,this.safeSetTextureCube=Hi}function rx(e,s,t){var a=t.isWebGL2;return{convert:function(o){var c;if(o===Rr)return 5121;if(o===ha)return 32819;if(o===gs)return 32820;if(o===dr)return 33635;if(o===$i)return 5120;if(o===Br)return 5122;if(o===Vs)return 5123;if(o===ua)return 5124;if(o===qi)return 5125;if(o===Ri)return 5126;if(o===Ja)return a?5131:(c=s.get("OES_texture_half_float"),c!==null?c.HALF_FLOAT_OES:null);if(o===ba)return 6406;if(o===Ka)return 6407;if(o===re)return 6408;if(o===Qe)return 6409;if(o===Ke)return 6410;if(o===Ft)return 6402;if(o===Tn)return 34041;if(o===Ln)return 6403;if(o===Vn)return 36244;if(o===wn)return 33319;if(o===Xi)return 33320;if(o===Yi)return 36248;if(o===nn)return 36249;if(o===ni||o===yr||o===ii||o===er)if(c=s.get("WEBGL_compressed_texture_s3tc"),c!==null){if(o===ni)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(o===yr)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(o===ii)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(o===er)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(o===or||o===Ws||o===Sr||o===qs)if(c=s.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(o===or)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(o===Ws)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(o===Sr)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(o===qs)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(o===_r)return c=s.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((o===Xs||o===gh)&&(c=s.get("WEBGL_compressed_texture_etc"),c!==null)){if(o===Xs)return c.COMPRESSED_RGB8_ETC2;if(o===gh)return c.COMPRESSED_RGBA8_ETC2_EAC}if(o===zf||o===vh||o===Hf||o===kf||o===Up||o===Gp||o===zp||o===Vf||o===Hp||o===kp||o===ac||o===Wf||o===Vp||o===qf||o===sc||o===hl||o===Wp||o===Si||o===oc||o===yh||o===Xf||o===Yf||o===jf||o===Ys||o===qp||o===Zf||o===Zc||o===Ma)return c=s.get("WEBGL_compressed_texture_astc"),c!==null?o:null;if(o===wa)return c=s.get("EXT_texture_compression_bptc"),c!==null?o:null;if(o===fa)return a?34042:(c=s.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}}}function im(e){Ni.call(this),this.cameras=e||[]}im.prototype=Object.assign(Object.create(Ni.prototype),{constructor:im,isArrayCamera:!0});function Tc(){Jt.call(this),this.type="Group"}Tc.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Tc,isGroup:!0});function pd(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(pd.prototype,{constructor:pd,getHandSpace:function(){if(this._hand===null&&(this._hand=new Tc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(var e=0;e<=window.XRHand.LITTLE_PHALANX_TIP;e++){var s=new Tc;s.matrixAutoUpdate=!1,s.visible=!1,this._hand.joints.push(s),this._hand.add(s)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Tc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Tc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(e,s,t){var a=null,o=null,c=null,f=this._targetRay,d=this._grip,m=this._hand;if(e)if(m&&e.hand){c=!0;for(var y=0;y<=window.XRHand.LITTLE_PHALANX_TIP;y++)if(e.hand[y]){var w=s.getJointPose(e.hand[y],t),M=m.joints[y];w!==null&&(M.matrix.fromArray(w.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.jointRadius=w.radius),M.visible=w!==null;var D=m.joints[window.XRHand.INDEX_PHALANX_TIP],P=m.joints[window.XRHand.THUMB_PHALANX_TIP],F=D.position.distanceTo(P.position),C=.02,I=.005;m.inputState.pinching&&F>C+I?(m.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!m.inputState.pinching&&F<=C-I&&(m.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}}else f!==null&&(a=s.getPose(e.targetRaySpace,t),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale))),d!==null&&e.gripSpace&&(o=s.getPose(e.gripSpace,t),o!==null&&(d.matrix.fromArray(o.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale)));return f!==null&&(f.visible=a!==null),d!==null&&(d.visible=o!==null),m!==null&&(m.visible=c!==null),this}});function ax(e,s){var t=this,a=null,o=1,c=null,f="local-floor",d=null,m=[],y=new Map,w=new Ni;w.layers.enable(1),w.viewport=new Ei;var M=new Ni;M.layers.enable(2),M.viewport=new Ei;var D=[w,M],P=new im;P.layers.enable(1),P.layers.enable(2);var F=null,C=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){var ie=m[oe];return ie===void 0&&(ie=new pd,m[oe]=ie),ie.getTargetRaySpace()},this.getControllerGrip=function(oe){var ie=m[oe];return ie===void 0&&(ie=new pd,m[oe]=ie),ie.getGripSpace()},this.getHand=function(oe){var ie=m[oe];return ie===void 0&&(ie=new pd,m[oe]=ie),ie.getHandSpace()};function I(oe){var ie=y.get(oe.inputSource);ie&&ie.dispatchEvent({type:oe.type,data:oe.inputSource})}function q(){y.forEach(function(oe,ie){oe.disconnect(ie)}),y.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),ce.stop(),t.isPresenting=!1,t.dispatchEvent({type:"sessionend"})}function J(oe){c=oe,ce.setContext(a),ce.start(),t.isPresenting=!0,t.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(oe){o=oe,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){f=oe,t.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c},this.getSession=function(){return a},this.setSession=function(oe){if(a=oe,a!==null){a.addEventListener("select",I),a.addEventListener("selectstart",I),a.addEventListener("selectend",I),a.addEventListener("squeeze",I),a.addEventListener("squeezestart",I),a.addEventListener("squeezeend",I),a.addEventListener("end",q);var ie=s.getContextAttributes();ie.xrCompatible!==!0&&s.makeXRCompatible();var Ce={antialias:ie.antialias,alpha:ie.alpha,depth:ie.depth,stencil:ie.stencil,framebufferScaleFactor:o},De=new XRWebGLLayer(a,s,Ce);a.updateRenderState({baseLayer:De}),a.requestReferenceSpace(f).then(J),a.addEventListener("inputsourceschange",Z)}};function Z(oe){for(var ie=a.inputSources,Ce=0;Ce<m.length;Ce++)y.set(ie[Ce],m[Ce]);for(var De=0;De<oe.removed.length;De++){var Oe=oe.removed[De],et=y.get(Oe);et&&(et.dispatchEvent({type:"disconnected",data:Oe}),y.delete(Oe))}for(var mt=0;mt<oe.added.length;mt++){var dt=oe.added[mt],ot=y.get(dt);ot&&ot.dispatchEvent({type:"connected",data:dt})}}var G=new ee,Y=new ee;function ne(oe,ie,Ce){G.setFromMatrixPosition(ie.matrixWorld),Y.setFromMatrixPosition(Ce.matrixWorld);var De=G.distanceTo(Y),Oe=ie.projectionMatrix.elements,et=Ce.projectionMatrix.elements,mt=Oe[14]/(Oe[10]-1),dt=Oe[14]/(Oe[10]+1),ot=(Oe[9]+1)/Oe[5],Mt=(Oe[9]-1)/Oe[5],zt=(Oe[8]-1)/Oe[0],Bt=(et[8]+1)/et[0],en=De/(-zt+Bt),on=en*-zt;ie.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(on),oe.translateZ(en),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.getInverse(oe.matrixWorld);var ft=mt+en,Bn=dt+en;oe.projectionMatrix.makePerspective(mt*zt-on,mt*Bt+(De-on),ot*dt/Bn*ft,Mt*dt/Bn*ft,ft,Bn)}function se(oe,ie){ie===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(ie.matrixWorld,oe.matrix),oe.matrixWorldInverse.getInverse(oe.matrixWorld)}this.getCamera=function(oe){P.near=M.near=w.near=oe.near,P.far=M.far=w.far=oe.far,(F!==P.near||C!==P.far)&&(a.updateRenderState({depthNear:P.near,depthFar:P.far}),F=P.near,C=P.far);var ie=oe.parent,Ce=P.cameras;se(P,ie);for(var De=0;De<Ce.length;De++)se(Ce[De],ie);oe.matrixWorld.copy(P.matrixWorld);for(var Oe=oe.children,et=0,mt=Oe.length;et<mt;et++)Oe[et].updateMatrixWorld(!0);return Ce.length===2?ne(P,w,M):P.projectionMatrix.copy(w.projectionMatrix),P};var Ee=null;function Be(oe,ie){if(d=ie.getViewerPose(c),d!==null){var Ce=d.views,De=a.renderState.baseLayer;e.setFramebuffer(De.framebuffer);var Oe=!1;Ce.length!==P.cameras.length&&(P.cameras.length=0,Oe=!0);for(var et=0;et<Ce.length;et++){var mt=Ce[et],dt=De.getViewport(mt),ot=D[et];ot.matrix.fromArray(mt.transform.matrix),ot.projectionMatrix.fromArray(mt.projectionMatrix),ot.viewport.set(dt.x,dt.y,dt.width,dt.height),et===0&&P.matrix.copy(ot.matrix),Oe===!0&&P.cameras.push(ot)}}for(var Mt=a.inputSources,zt=0;zt<m.length;zt++){var Bt=m[zt],en=Mt[zt];Bt.update(en,ie,c)}Ee&&Ee(oe,ie)}var ce=new N_;ce.setAnimationLoop(Be),this.setAnimationLoop=function(oe){Ee=oe},this.dispose=function(){}}Object.assign(ax.prototype,Qa.prototype);function UL(e){function s(C,I){C.opacity.value=I.opacity,I.color&&C.diffuse.value.copy(I.color),I.emissive&&C.emissive.value.copy(I.emissive).multiplyScalar(I.emissiveIntensity),I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap),I.specularMap&&(C.specularMap.value=I.specularMap);var q=e.get(I).envMap;if(q){C.envMap.value=q,C.flipEnvMap.value=q.isCubeTexture&&q._needsFlipEnvMap?-1:1,C.reflectivity.value=I.reflectivity,C.refractionRatio.value=I.refractionRatio;var J=e.get(q).__maxMipLevel;J!==void 0&&(C.maxMipLevel.value=J)}I.lightMap&&(C.lightMap.value=I.lightMap,C.lightMapIntensity.value=I.lightMapIntensity),I.aoMap&&(C.aoMap.value=I.aoMap,C.aoMapIntensity.value=I.aoMapIntensity);var Z;I.map?Z=I.map:I.specularMap?Z=I.specularMap:I.displacementMap?Z=I.displacementMap:I.normalMap?Z=I.normalMap:I.bumpMap?Z=I.bumpMap:I.roughnessMap?Z=I.roughnessMap:I.metalnessMap?Z=I.metalnessMap:I.alphaMap?Z=I.alphaMap:I.emissiveMap?Z=I.emissiveMap:I.clearcoatMap?Z=I.clearcoatMap:I.clearcoatNormalMap?Z=I.clearcoatNormalMap:I.clearcoatRoughnessMap&&(Z=I.clearcoatRoughnessMap),Z!==void 0&&(Z.isWebGLRenderTarget&&(Z=Z.texture),Z.matrixAutoUpdate===!0&&Z.updateMatrix(),C.uvTransform.value.copy(Z.matrix));var G;I.aoMap?G=I.aoMap:I.lightMap&&(G=I.lightMap),G!==void 0&&(G.isWebGLRenderTarget&&(G=G.texture),G.matrixAutoUpdate===!0&&G.updateMatrix(),C.uv2Transform.value.copy(G.matrix))}function t(C,I){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity}function a(C,I){C.dashSize.value=I.dashSize,C.totalSize.value=I.dashSize+I.gapSize,C.scale.value=I.scale}function o(C,I,q,J){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity,C.size.value=I.size*q,C.scale.value=J*.5,I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap);var Z;I.map?Z=I.map:I.alphaMap&&(Z=I.alphaMap),Z!==void 0&&(Z.matrixAutoUpdate===!0&&Z.updateMatrix(),C.uvTransform.value.copy(Z.matrix))}function c(C,I){C.diffuse.value.copy(I.color),C.opacity.value=I.opacity,C.rotation.value=I.rotation,I.map&&(C.map.value=I.map),I.alphaMap&&(C.alphaMap.value=I.alphaMap);var q;I.map?q=I.map:I.alphaMap&&(q=I.alphaMap),q!==void 0&&(q.matrixAutoUpdate===!0&&q.updateMatrix(),C.uvTransform.value.copy(q.matrix))}function f(C,I){I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap)}function d(C,I){C.specular.value.copy(I.specular),C.shininess.value=Math.max(I.shininess,1e-4),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function m(C,I){I.gradientMap&&(C.gradientMap.value=I.gradientMap),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function y(C,I){C.roughness.value=I.roughness,C.metalness.value=I.metalness,I.roughnessMap&&(C.roughnessMap.value=I.roughnessMap),I.metalnessMap&&(C.metalnessMap.value=I.metalnessMap),I.emissiveMap&&(C.emissiveMap.value=I.emissiveMap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias);var q=e.get(I).envMap;q&&(C.envMapIntensity.value=I.envMapIntensity)}function w(C,I){y(C,I),C.reflectivity.value=I.reflectivity,C.clearcoat.value=I.clearcoat,C.clearcoatRoughness.value=I.clearcoatRoughness,I.sheen&&C.sheen.value.copy(I.sheen),I.clearcoatMap&&(C.clearcoatMap.value=I.clearcoatMap),I.clearcoatRoughnessMap&&(C.clearcoatRoughnessMap.value=I.clearcoatRoughnessMap),I.clearcoatNormalMap&&(C.clearcoatNormalScale.value.copy(I.clearcoatNormalScale),C.clearcoatNormalMap.value=I.clearcoatNormalMap,I.side===S&&C.clearcoatNormalScale.value.negate()),C.transmission.value=I.transmission,I.transmissionMap&&(C.transmissionMap.value=I.transmissionMap)}function M(C,I){I.matcap&&(C.matcap.value=I.matcap),I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function D(C,I){I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}function P(C,I){I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias),C.referencePosition.value.copy(I.referencePosition),C.nearDistance.value=I.nearDistance,C.farDistance.value=I.farDistance}function F(C,I){I.bumpMap&&(C.bumpMap.value=I.bumpMap,C.bumpScale.value=I.bumpScale,I.side===S&&(C.bumpScale.value*=-1)),I.normalMap&&(C.normalMap.value=I.normalMap,C.normalScale.value.copy(I.normalScale),I.side===S&&C.normalScale.value.negate()),I.displacementMap&&(C.displacementMap.value=I.displacementMap,C.displacementScale.value=I.displacementScale,C.displacementBias.value=I.displacementBias)}return{refreshFogUniforms:function(C,I){C.fogColor.value.copy(I.color),I.isFog?(C.fogNear.value=I.near,C.fogFar.value=I.far):I.isFogExp2&&(C.fogDensity.value=I.density)},refreshMaterialUniforms:function(C,I,q,J){I.isMeshBasicMaterial?s(C,I):I.isMeshLambertMaterial?(s(C,I),f(C,I)):I.isMeshToonMaterial?(s(C,I),m(C,I)):I.isMeshPhongMaterial?(s(C,I),d(C,I)):I.isMeshStandardMaterial?(s(C,I),I.isMeshPhysicalMaterial?w(C,I):y(C,I)):I.isMeshMatcapMaterial?(s(C,I),M(C,I)):I.isMeshDepthMaterial?(s(C,I),D(C,I)):I.isMeshDistanceMaterial?(s(C,I),P(C,I)):I.isMeshNormalMaterial?(s(C,I),F(C,I)):I.isLineBasicMaterial?(t(C,I),I.isLineDashedMaterial&&a(C,I)):I.isPointsMaterial?o(C,I,q,J):I.isSpriteMaterial?c(C,I):I.isShadowMaterial?(C.color.value.copy(I.color),C.opacity.value=I.opacity):I.isShaderMaterial&&(I.uniformsNeedUpdate=!1)}}}function md(e){e=e||{};var s=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),t=e.context!==void 0?e.context:null,a=e.alpha!==void 0?e.alpha:!1,o=e.depth!==void 0?e.depth:!0,c=e.stencil!==void 0?e.stencil:!0,f=e.antialias!==void 0?e.antialias:!1,d=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,m=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,y=e.powerPreference!==void 0?e.powerPreference:"default",w=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,M=null,D=null;this.domElement=s,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ur,this.physicallyCorrectLights=!1,this.toneMapping=we,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var P=this,F=!1,C=null,I=0,q=0,J=null,Z=null,G=-1,Y=null,ne=null,se=new Ei,Ee=new Ei,Be=null,ce=s.width,oe=s.height,ie=1,Ce=null,De=null,Oe=new Ei(0,0,ce,oe),et=new Ei(0,0,ce,oe),mt=!1,dt=new hd,ot=!1,Mt=!1,zt=new Hn,Bt=new ee,en={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function on(){return J===null?ie:1}var ft=t;function Bn(he,at){for(var $e=0;$e<he.length;$e++){var gt=he[$e],Ht=s.getContext(gt,at);if(Ht!==null)return Ht}return null}try{if(s.addEventListener("webglcontextlost",Tu,!1),s.addEventListener("webglcontextrestored",uo,!1),ft===null){var Rn=["webgl2","webgl","experimental-webgl"];if(P.isWebGL1Renderer===!0&&Rn.shift(),ft=Bn(Rn,{alpha:a,depth:o,stencil:c,antialias:f,premultipliedAlpha:d,preserveDrawingBuffer:m,powerPreference:y,failIfMajorPerformanceCaveat:w}),ft===null)throw Bn(Rn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ft.getShaderPrecisionFormat===void 0&&(ft.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(he){throw console.error("THREE.WebGLRenderer: "+he.message),he}var mn,ri,Wn,mi,ei,Hi,Me,X,At,st,Zt,Rt,un,dn,tn,gn,vn,jn,Ai,Or,Bi;function Ba(){mn=new wA(ft),ri=new _A(ft,mn,e),ri.isWebGL2===!1&&(mn.get("WEBGL_depth_texture"),mn.get("OES_texture_float"),mn.get("OES_texture_half_float"),mn.get("OES_texture_half_float_linear"),mn.get("OES_standard_derivatives"),mn.get("OES_element_index_uint"),mn.get("OES_vertex_array_object"),mn.get("ANGLE_instanced_arrays")),mn.get("OES_texture_float_linear"),Or=new rx(ft,mn,ri),Wn=new FL(ft,mn,ri),Wn.scissor(Ee.copy(et).multiplyScalar(ie).floor()),Wn.viewport(se.copy(Oe).multiplyScalar(ie).floor()),mi=new TA(ft),ei=new EL,Hi=new BL(ft,mn,Wn,ei,ri,Or,mi),Me=new bA(P),X=new mA(ft,ri),Bi=new vA(ft,mn,X,ri),At=new MA(ft,X,mi,Bi),st=new RA(ft,At,X,mi),vn=new LA(ft),tn=new xA(ei),Zt=new TL(P,Me,mn,ri,Bi,tn),Rt=new UL(ei),un=new RL(ei),dn=new NL,gn=new gA(P,Me,Wn,st,d),jn=new yA(ft,mn,mi,ri),Ai=new SA(ft,mn,mi,ri),mi.programs=Zt.programs,P.capabilities=ri,P.extensions=mn,P.properties=ei,P.renderLists=un,P.state=Wn,P.info=mi}Ba();var bi=new ax(P,ft);this.xr=bi;var co=new ix(P,st,ri.maxTextureSize);this.shadowMap=co,this.getContext=function(){return ft},this.getContextAttributes=function(){return ft.getContextAttributes()},this.forceContextLoss=function(){var he=mn.get("WEBGL_lose_context");he&&he.loseContext()},this.forceContextRestore=function(){var he=mn.get("WEBGL_lose_context");he&&he.restoreContext()},this.getPixelRatio=function(){return ie},this.setPixelRatio=function(he){he!==void 0&&(ie=he,this.setSize(ce,oe,!1))},this.getSize=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),he=new _t),he.set(ce,oe)},this.setSize=function(he,at,$e){if(bi.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ce=he,oe=at,s.width=Math.floor(he*ie),s.height=Math.floor(at*ie),$e!==!1&&(s.style.width=he+"px",s.style.height=at+"px"),this.setViewport(0,0,he,at)},this.getDrawingBufferSize=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),he=new _t),he.set(ce*ie,oe*ie).floor()},this.setDrawingBufferSize=function(he,at,$e){ce=he,oe=at,ie=$e,s.width=Math.floor(he*$e),s.height=Math.floor(at*$e),this.setViewport(0,0,he,at)},this.getCurrentViewport=function(he){return he===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),he=new Ei),he.copy(se)},this.getViewport=function(he){return he.copy(Oe)},this.setViewport=function(he,at,$e,gt){he.isVector4?Oe.set(he.x,he.y,he.z,he.w):Oe.set(he,at,$e,gt),Wn.viewport(se.copy(Oe).multiplyScalar(ie).floor())},this.getScissor=function(he){return he.copy(et)},this.setScissor=function(he,at,$e,gt){he.isVector4?et.set(he.x,he.y,he.z,he.w):et.set(he,at,$e,gt),Wn.scissor(Ee.copy(et).multiplyScalar(ie).floor())},this.getScissorTest=function(){return mt},this.setScissorTest=function(he){Wn.setScissorTest(mt=he)},this.setOpaqueSort=function(he){Ce=he},this.setTransparentSort=function(he){De=he},this.getClearColor=function(){return gn.getClearColor()},this.setClearColor=function(){gn.setClearColor.apply(gn,arguments)},this.getClearAlpha=function(){return gn.getClearAlpha()},this.setClearAlpha=function(){gn.setClearAlpha.apply(gn,arguments)},this.clear=function(he,at,$e){var gt=0;(he===void 0||he)&&(gt|=16384),(at===void 0||at)&&(gt|=256),($e===void 0||$e)&&(gt|=1024),ft.clear(gt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",Tu,!1),s.removeEventListener("webglcontextrestored",uo,!1),un.dispose(),dn.dispose(),ei.dispose(),Me.dispose(),st.dispose(),Bi.dispose(),bi.dispose(),ho.stop()};function Tu(he){he.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),F=!0}function uo(){console.log("THREE.WebGLRenderer: Context Restored."),F=!1,Ba()}function Pl(he){var at=he.target;at.removeEventListener("dispose",Pl),$h(at)}function $h(he){Eu(he),ei.remove(he)}function Eu(he){var at=ei.get(he).program;at!==void 0&&Zt.releaseProgram(at)}function Gy(he,at){he.render(function($e){P.renderBufferImmediate($e,at)})}this.renderBufferImmediate=function(he,at){Bi.initAttributes();var $e=ei.get(he);he.hasPositions&&!$e.position&&($e.position=ft.createBuffer()),he.hasNormals&&!$e.normal&&($e.normal=ft.createBuffer()),he.hasUvs&&!$e.uv&&($e.uv=ft.createBuffer()),he.hasColors&&!$e.color&&($e.color=ft.createBuffer());var gt=at.getAttributes();he.hasPositions&&(ft.bindBuffer(34962,$e.position),ft.bufferData(34962,he.positionArray,35048),Bi.enableAttribute(gt.position),ft.vertexAttribPointer(gt.position,3,5126,!1,0,0)),he.hasNormals&&(ft.bindBuffer(34962,$e.normal),ft.bufferData(34962,he.normalArray,35048),Bi.enableAttribute(gt.normal),ft.vertexAttribPointer(gt.normal,3,5126,!1,0,0)),he.hasUvs&&(ft.bindBuffer(34962,$e.uv),ft.bufferData(34962,he.uvArray,35048),Bi.enableAttribute(gt.uv),ft.vertexAttribPointer(gt.uv,2,5126,!1,0,0)),he.hasColors&&(ft.bindBuffer(34962,$e.color),ft.bufferData(34962,he.colorArray,35048),Bi.enableAttribute(gt.color),ft.vertexAttribPointer(gt.color,3,5126,!1,0,0)),Bi.disableUnusedAttributes(),ft.drawArrays(4,0,he.count),he.count=0},this.renderBufferDirect=function(he,at,$e,gt,Ht,oi){at===null&&(at=en);var ti=Ht.isMesh&&Ht.matrixWorld.determinant()<0,hi=tf(he,at,gt,Ht);Wn.setMaterial(gt,ti);var Un=$e.index,cr=$e.attributes.position;if(Un===null){if(cr===void 0||cr.count===0)return}else if(Un.count===0)return;var ur=1;gt.wireframe===!0&&(Un=At.getWireframeAttribute($e),ur=2),(gt.morphTargets||gt.morphNormals)&&vn.update(Ht,$e,gt,hi),Bi.setup(Ht,gt,hi,$e,Un);var Er,rn=jn;Un!==null&&(Er=X.get(Un),rn=Ai,rn.setIndex(Er));var Xr=Un!==null?Un.count:cr.count,Yr=$e.drawRange.start*ur,gi=$e.drawRange.count*ur,Nr=oi!==null?oi.start*ur:0,li=oi!==null?oi.count*ur:1/0,Cn=Math.max(Yr,Nr),vi=Math.min(Xr,Yr+gi,Nr+li)-1,Jn=Math.max(0,vi-Cn+1);if(Jn!==0){if(Ht.isMesh)gt.wireframe===!0?(Wn.setLineWidth(gt.wireframeLinewidth*on()),rn.setMode(1)):rn.setMode(4);else if(Ht.isLine){var ai=gt.linewidth;ai===void 0&&(ai=1),Wn.setLineWidth(ai*on()),Ht.isLineSegments?rn.setMode(1):Ht.isLineLoop?rn.setMode(2):rn.setMode(3)}else Ht.isPoints?rn.setMode(0):Ht.isSprite&&rn.setMode(4);if(Ht.isInstancedMesh)rn.renderInstances(Cn,Jn,Ht.count);else if($e.isInstancedBufferGeometry){var ir=Math.min($e.instanceCount,$e._maxInstanceCount);rn.renderInstances(Cn,Jn,ir)}else rn.render(Cn,Jn)}},this.compile=function(he,at){D=dn.get(he,at),D.init(),he.traverse(function(gt){gt.isLight&&(D.pushLight(gt),gt.castShadow&&D.pushShadow(gt))}),D.setupLights(at);var $e=new WeakMap;he.traverse(function(gt){var Ht=gt.material;if(Ht)if(Array.isArray(Ht))for(var oi=0;oi<Ht.length;oi++){var ti=Ht[oi];$e.has(ti)===!1&&(Ua(ti,he,gt),$e.set(ti))}else $e.has(Ht)===!1&&(Ua(Ht,he,gt),$e.set(Ht))})};var ef=null;function ig(he){bi.isPresenting||ef&&ef(he)}var ho=new N_;ho.setAnimationLoop(ig),typeof window<"u"&&ho.setContext(window),this.setAnimationLoop=function(he){ef=he,bi.setAnimationLoop(he),he===null?ho.stop():ho.start()},this.render=function(he,at){var $e,gt;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),$e=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),gt=arguments[3]),at!==void 0&&at.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(F!==!0){Bi.resetDefaultState(),G=-1,Y=null,he.autoUpdate===!0&&he.updateMatrixWorld(),at.parent===null&&at.updateMatrixWorld(),bi.enabled===!0&&bi.isPresenting===!0&&(at=bi.getCamera(at)),he.isScene===!0&&he.onBeforeRender(P,he,at,$e||J),D=dn.get(he,at),D.init(),zt.multiplyMatrices(at.projectionMatrix,at.matrixWorldInverse),dt.setFromProjectionMatrix(zt),Mt=this.localClippingEnabled,ot=tn.init(this.clippingPlanes,Mt,at),M=un.get(he,at),M.init(),Au(he,at,0,P.sortObjects),M.finish(),P.sortObjects===!0&&M.sort(Ce,De),ot===!0&&tn.beginShadows();var Ht=D.state.shadowsArray;co.render(Ht,he,at),D.setupLights(at),ot===!0&&tn.endShadows(),this.info.autoReset===!0&&this.info.reset(),$e!==void 0&&this.setRenderTarget($e),gn.render(M,he,at,gt);var oi=M.opaque,ti=M.transparent;oi.length>0&&Il(oi,he,at),ti.length>0&&Il(ti,he,at),he.isScene===!0&&he.onAfterRender(P,he,at),J!==null&&(Hi.updateRenderTargetMipmap(J),Hi.updateMultisampleRenderTarget(J)),Wn.buffers.depth.setTest(!0),Wn.buffers.depth.setMask(!0),Wn.buffers.color.setMask(!0),Wn.setPolygonOffset(!1),M=null,D=null}};function Au(he,at,$e,gt){if(he.visible!==!1){var Ht=he.layers.test(at.layers);if(Ht){if(he.isGroup)$e=he.renderOrder;else if(he.isLOD)he.autoUpdate===!0&&he.update(at);else if(he.isLight)D.pushLight(he),he.castShadow&&D.pushShadow(he);else if(he.isSprite){if(!he.frustumCulled||dt.intersectsSprite(he)){gt&&Bt.setFromMatrixPosition(he.matrixWorld).applyMatrix4(zt);var oi=st.update(he),ti=he.material;ti.visible&&M.push(he,oi,ti,$e,Bt.z,null)}}else if(he.isImmediateRenderObject)gt&&Bt.setFromMatrixPosition(he.matrixWorld).applyMatrix4(zt),M.push(he,null,he.material,$e,Bt.z,null);else if((he.isMesh||he.isLine||he.isPoints)&&(he.isSkinnedMesh&&he.skeleton.frame!==mi.render.frame&&(he.skeleton.update(),he.skeleton.frame=mi.render.frame),!he.frustumCulled||dt.intersectsObject(he))){gt&&Bt.setFromMatrixPosition(he.matrixWorld).applyMatrix4(zt);var hi=st.update(he),Un=he.material;if(Array.isArray(Un))for(var cr=hi.groups,ur=0,Er=cr.length;ur<Er;ur++){var rn=cr[ur],Xr=Un[rn.materialIndex];Xr&&Xr.visible&&M.push(he,hi,Xr,$e,Bt.z,rn)}else Un.visible&&M.push(he,hi,Un,$e,Bt.z,null)}}for(var Yr=he.children,gi=0,Nr=Yr.length;gi<Nr;gi++)Au(Yr[gi],at,$e,gt)}}function Il(he,at,$e){for(var gt=at.isScene===!0?at.overrideMaterial:null,Ht=0,oi=he.length;Ht<oi;Ht++){var ti=he[Ht],hi=ti.object,Un=ti.geometry,cr=gt===null?ti.material:gt,ur=ti.group;if($e.isArrayCamera){ne=$e;for(var Er=$e.cameras,rn=0,Xr=Er.length;rn<Xr;rn++){var Yr=Er[rn];hi.layers.test(Yr.layers)&&(Wn.viewport(se.copy(Yr.viewport)),D.setupLights(Yr),Oc(hi,at,Yr,Un,cr,ur))}}else ne=null,Oc(hi,at,$e,Un,cr,ur)}}function Oc(he,at,$e,gt,Ht,oi){if(he.onBeforeRender(P,at,$e,gt,Ht,oi),D=dn.get(at,ne||$e),he.modelViewMatrix.multiplyMatrices($e.matrixWorldInverse,he.matrixWorld),he.normalMatrix.getNormalMatrix(he.modelViewMatrix),he.isImmediateRenderObject){var ti=tf($e,at,Ht,he);Wn.setMaterial(Ht),Bi.reset(),Gy(he,ti)}else P.renderBufferDirect($e,at,gt,Ht,he,oi);he.onAfterRender(P,at,$e,gt,Ht,oi),D=dn.get(at,ne||$e)}function Ua(he,at,$e){at.isScene!==!0&&(at=en);var gt=ei.get(he),Ht=D.state.lights,oi=D.state.shadowsArray,ti=Ht.state.version,hi=Zt.getParameters(he,Ht.state,oi,at,$e),Un=Zt.getProgramCacheKey(hi),cr=gt.program,ur=!0;if(cr===void 0)he.addEventListener("dispose",Pl);else if(cr.cacheKey!==Un)Eu(he);else if(gt.lightsStateVersion!==ti)ur=!1;else if(hi.shaderID!==void 0){var Er=he.isMeshStandardMaterial?at.environment:null;gt.envMap=Me.get(he.envMap||Er);return}else ur=!1;ur&&(hi.uniforms=Zt.getUniforms(he),he.onBeforeCompile(hi,P),cr=Zt.acquireProgram(hi,Un),gt.program=cr,gt.uniforms=hi.uniforms,gt.outputEncoding=hi.outputEncoding);var rn=gt.uniforms;(!he.isShaderMaterial&&!he.isRawShaderMaterial||he.clipping===!0)&&(gt.numClippingPlanes=tn.numPlanes,gt.numIntersection=tn.numIntersection,rn.clippingPlanes=tn.uniform),gt.environment=he.isMeshStandardMaterial?at.environment:null,gt.fog=at.fog,gt.envMap=Me.get(he.envMap||gt.environment),gt.needsLights=Bd(he),gt.lightsStateVersion=ti,gt.needsLights&&(rn.ambientLightColor.value=Ht.state.ambient,rn.lightProbe.value=Ht.state.probe,rn.directionalLights.value=Ht.state.directional,rn.directionalLightShadows.value=Ht.state.directionalShadow,rn.spotLights.value=Ht.state.spot,rn.spotLightShadows.value=Ht.state.spotShadow,rn.rectAreaLights.value=Ht.state.rectArea,rn.ltc_1.value=Ht.state.rectAreaLTC1,rn.ltc_2.value=Ht.state.rectAreaLTC2,rn.pointLights.value=Ht.state.point,rn.pointLightShadows.value=Ht.state.pointShadow,rn.hemisphereLights.value=Ht.state.hemi,rn.directionalShadowMap.value=Ht.state.directionalShadowMap,rn.directionalShadowMatrix.value=Ht.state.directionalShadowMatrix,rn.spotShadowMap.value=Ht.state.spotShadowMap,rn.spotShadowMatrix.value=Ht.state.spotShadowMatrix,rn.pointShadowMap.value=Ht.state.pointShadowMap,rn.pointShadowMatrix.value=Ht.state.pointShadowMatrix);var Xr=gt.program.getUniforms(),Yr=wc.seqWithValue(Xr.seq,rn);gt.uniformsList=Yr}function tf(he,at,$e,gt){at.isScene!==!0&&(at=en),Hi.resetTextureUnits();var Ht=at.fog,oi=$e.isMeshStandardMaterial?at.environment:null,ti=J===null?P.outputEncoding:J.texture.encoding,hi=Me.get($e.envMap||oi),Un=ei.get($e),cr=D.state.lights;if(ot===!0&&(Mt===!0||he!==Y)){var ur=he===Y&&$e.id===G;tn.setState($e,he,ur)}$e.version===Un.__version?($e.fog&&Un.fog!==Ht||Un.environment!==oi||Un.needsLights&&Un.lightsStateVersion!==cr.state.version||Un.numClippingPlanes!==void 0&&(Un.numClippingPlanes!==tn.numPlanes||Un.numIntersection!==tn.numIntersection)||Un.outputEncoding!==ti||Un.envMap!==hi)&&Ua($e,at,gt):(Ua($e,at,gt),Un.__version=$e.version);var Er=!1,rn=!1,Xr=!1,Yr=Un.program,gi=Yr.getUniforms(),Nr=Un.uniforms;if(Wn.useProgram(Yr.program)&&(Er=!0,rn=!0,Xr=!0),$e.id!==G&&(G=$e.id,rn=!0),Er||Y!==he){if(gi.setValue(ft,"projectionMatrix",he.projectionMatrix),ri.logarithmicDepthBuffer&&gi.setValue(ft,"logDepthBufFC",2/(Math.log(he.far+1)/Math.LN2)),Y!==he&&(Y=he,rn=!0,Xr=!0),$e.isShaderMaterial||$e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshStandardMaterial||$e.envMap){var li=gi.map.cameraPosition;li!==void 0&&li.setValue(ft,Bt.setFromMatrixPosition(he.matrixWorld))}($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial)&&gi.setValue(ft,"isOrthographic",he.isOrthographicCamera===!0),($e.isMeshPhongMaterial||$e.isMeshToonMaterial||$e.isMeshLambertMaterial||$e.isMeshBasicMaterial||$e.isMeshStandardMaterial||$e.isShaderMaterial||$e.isShadowMaterial||$e.skinning)&&gi.setValue(ft,"viewMatrix",he.matrixWorldInverse)}if($e.skinning){gi.setOptional(ft,gt,"bindMatrix"),gi.setOptional(ft,gt,"bindMatrixInverse");var Cn=gt.skeleton;if(Cn){var vi=Cn.bones;if(ri.floatVertexTextures){if(Cn.boneTexture===void 0){var Jn=Math.sqrt(vi.length*4);Jn=Mn.ceilPowerOfTwo(Jn),Jn=Math.max(Jn,4);var ai=new Float32Array(Jn*Jn*4);ai.set(Cn.boneMatrices);var ir=new uu(ai,Jn,Jn,re,Ri);Cn.boneMatrices=ai,Cn.boneTexture=ir,Cn.boneTextureSize=Jn}gi.setValue(ft,"boneTexture",Cn.boneTexture,Hi),gi.setValue(ft,"boneTextureSize",Cn.boneTextureSize)}else gi.setOptional(ft,Cn,"boneMatrices")}}return(rn||Un.receiveShadow!==gt.receiveShadow)&&(Un.receiveShadow=gt.receiveShadow,gi.setValue(ft,"receiveShadow",gt.receiveShadow)),rn&&(gi.setValue(ft,"toneMappingExposure",P.toneMappingExposure),Un.needsLights&&rg(Nr,Xr),Ht&&$e.fog&&Rt.refreshFogUniforms(Nr,Ht),Rt.refreshMaterialUniforms(Nr,$e,ie,oe),wc.upload(ft,Un.uniformsList,Nr,Hi)),$e.isShaderMaterial&&$e.uniformsNeedUpdate===!0&&(wc.upload(ft,Un.uniformsList,Nr,Hi),$e.uniformsNeedUpdate=!1),$e.isSpriteMaterial&&gi.setValue(ft,"center",gt.center),gi.setValue(ft,"modelViewMatrix",gt.modelViewMatrix),gi.setValue(ft,"normalMatrix",gt.normalMatrix),gi.setValue(ft,"modelMatrix",gt.matrixWorld),Yr}function rg(he,at){he.ambientLightColor.needsUpdate=at,he.lightProbe.needsUpdate=at,he.directionalLights.needsUpdate=at,he.directionalLightShadows.needsUpdate=at,he.pointLights.needsUpdate=at,he.pointLightShadows.needsUpdate=at,he.spotLights.needsUpdate=at,he.spotLightShadows.needsUpdate=at,he.rectAreaLights.needsUpdate=at,he.hemisphereLights.needsUpdate=at}function Bd(he){return he.isMeshLambertMaterial||he.isMeshToonMaterial||he.isMeshPhongMaterial||he.isMeshStandardMaterial||he.isShadowMaterial||he.isShaderMaterial&&he.lights===!0}this.setFramebuffer=function(he){C!==he&&J===null&&ft.bindFramebuffer(36160,he),C=he},this.getActiveCubeFace=function(){return I},this.getActiveMipmapLevel=function(){return q},this.getRenderList=function(){return M},this.setRenderList=function(he){M=he},this.getRenderState=function(){return D},this.setRenderState=function(he){D=he},this.getRenderTarget=function(){return J},this.setRenderTarget=function(he,at,$e){at===void 0&&(at=0),$e===void 0&&($e=0),J=he,I=at,q=$e,he&&ei.get(he).__webglFramebuffer===void 0&&Hi.setupRenderTarget(he);var gt=C,Ht=!1;if(he){var oi=ei.get(he).__webglFramebuffer;he.isWebGLCubeRenderTarget?(gt=oi[at],Ht=!0):he.isWebGLMultisampleRenderTarget?gt=ei.get(he).__webglMultisampledFramebuffer:gt=oi,se.copy(he.viewport),Ee.copy(he.scissor),Be=he.scissorTest}else se.copy(Oe).multiplyScalar(ie).floor(),Ee.copy(et).multiplyScalar(ie).floor(),Be=mt;if(Z!==gt&&(ft.bindFramebuffer(36160,gt),Z=gt),Wn.viewport(se),Wn.scissor(Ee),Wn.setScissorTest(Be),Ht){var ti=ei.get(he.texture);ft.framebufferTexture2D(36160,36064,34069+at,ti.__webglTexture,$e)}},this.readRenderTargetPixels=function(he,at,$e,gt,Ht,oi,ti){if(!(he&&he.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var hi=ei.get(he).__webglFramebuffer;if(he.isWebGLCubeRenderTarget&&ti!==void 0&&(hi=hi[ti]),hi){var Un=!1;hi!==Z&&(ft.bindFramebuffer(36160,hi),Un=!0);try{var cr=he.texture,ur=cr.format,Er=cr.type;if(ur!==re&&Or.convert(ur)!==ft.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(Er!==Rr&&Or.convert(Er)!==ft.getParameter(35738)&&!(Er===Ri&&(ri.isWebGL2||mn.get("OES_texture_float")||mn.get("WEBGL_color_buffer_float")))&&!(Er===Ja&&(ri.isWebGL2?mn.get("EXT_color_buffer_float"):mn.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ft.checkFramebufferStatus(36160)===36053?at>=0&&at<=he.width-gt&&$e>=0&&$e<=he.height-Ht&&ft.readPixels(at,$e,gt,Ht,Or.convert(ur),Or.convert(Er),oi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Un&&ft.bindFramebuffer(36160,Z)}}},this.copyFramebufferToTexture=function(he,at,$e){$e===void 0&&($e=0);var gt=Math.pow(2,-$e),Ht=Math.floor(at.image.width*gt),oi=Math.floor(at.image.height*gt),ti=Or.convert(at.format);Hi.setTexture2D(at,0),ft.copyTexImage2D(3553,$e,ti,he.x,he.y,Ht,oi,0),Wn.unbindTexture()},this.copyTextureToTexture=function(he,at,$e,gt){gt===void 0&&(gt=0);var Ht=at.image.width,oi=at.image.height,ti=Or.convert($e.format),hi=Or.convert($e.type);Hi.setTexture2D($e,0),ft.pixelStorei(37440,$e.flipY),ft.pixelStorei(37441,$e.premultiplyAlpha),ft.pixelStorei(3317,$e.unpackAlignment),at.isDataTexture?ft.texSubImage2D(3553,gt,he.x,he.y,Ht,oi,ti,hi,at.image.data):at.isCompressedTexture?ft.compressedTexSubImage2D(3553,gt,he.x,he.y,at.mipmaps[0].width,at.mipmaps[0].height,ti,at.mipmaps[0].data):ft.texSubImage2D(3553,gt,he.x,he.y,ti,hi,at.image),gt===0&&$e.generateMipmaps&&ft.generateMipmap(3553),Wn.unbindTexture()},this.initTexture=function(he){Hi.setTexture2D(he,0),Wn.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Rv(e){md.call(this,e)}Rv.prototype=Object.assign(Object.create(md.prototype),{constructor:Rv,isWebGL1Renderer:!0});var sx=function(){function e(t,a){Object.defineProperty(this,"isFogExp2",{value:!0}),this.name="",this.color=new qt(t),this.density=a!==void 0?a:25e-5}var s=e.prototype;return s.clone=function(){return new e(this.color,this.density)},s.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},e}(),ox=function(){function e(t,a,o){Object.defineProperty(this,"isFog",{value:!0}),this.name="",this.color=new qt(t),this.near=a!==void 0?a:1,this.far=o!==void 0?o:1e3}var s=e.prototype;return s.clone=function(){return new e(this.color,this.near,this.far)},s.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},e}(),Cv=function(e){Qt(s,e);function s(){var a=e.call(this)||this;return Object.defineProperty(uc(a),"isScene",{value:!0}),a.type="Scene",a.background=null,a.environment=null,a.fog=null,a.overrideMaterial=null,a.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:uc(a)})),a}var t=s.prototype;return t.copy=function(a,o){return e.prototype.copy.call(this,a,o),a.background!==null&&(this.background=a.background.clone()),a.environment!==null&&(this.environment=a.environment.clone()),a.fog!==null&&(this.fog=a.fog.clone()),a.overrideMaterial!==null&&(this.overrideMaterial=a.overrideMaterial.clone()),this.autoUpdate=a.autoUpdate,this.matrixAutoUpdate=a.matrixAutoUpdate,this},t.toJSON=function(a){var o=e.prototype.toJSON.call(this,a);return this.background!==null&&(o.object.background=this.background.toJSON(a)),this.environment!==null&&(o.object.environment=this.environment.toJSON(a)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},s}(Jt);function rs(e,s){this.array=e,this.stride=s,this.count=e!==void 0?e.length/s:0,this.usage=eu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Mn.generateUUID()}Object.defineProperty(rs.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(rs.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,s,t){e*=this.stride,t*=s.stride;for(var a=0,o=this.stride;a<o;a++)this.array[e+a]=s.array[t+a];return this},set:function(e,s){return s===void 0&&(s=0),this.array.set(e,s),this},clone:function(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Mn.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var s=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),t=new rs(s,this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Mn.generateUUID()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var hu=new ee;function Ec(e,s,t,a){this.name="",this.data=e,this.itemSize=s,this.offset=t,this.normalized=a===!0}Object.defineProperties(Ec.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(Ec.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var s=0,t=this.data.count;s<t;s++)hu.x=this.getX(s),hu.y=this.getY(s),hu.z=this.getZ(s),hu.applyMatrix4(e),this.setXYZ(s,hu.x,hu.y,hu.z);return this},setX:function(e,s){return this.data.array[e*this.data.stride+this.offset]=s,this},setY:function(e,s){return this.data.array[e*this.data.stride+this.offset+1]=s,this},setZ:function(e,s){return this.data.array[e*this.data.stride+this.offset+2]=s,this},setW:function(e,s){return this.data.array[e*this.data.stride+this.offset+3]=s,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,s,t){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this},setXYZ:function(e,s,t,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this.data.array[e+2]=a,this},setXYZW:function(e,s,t,a,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=s,this.data.array[e+1]=t,this.data.array[e+2]=a,this.data.array[e+3]=o,this},clone:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var s=[],t=0;t<this.count;t++)for(var a=t*this.data.stride+this.offset,o=0;o<this.itemSize;o++)s.push(this.data.array[a+o]);return new fn(new this.array.constructor(s),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Ec(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var s=[],t=0;t<this.count;t++)for(var a=t*this.data.stride+this.offset,o=0;o<this.itemSize;o++)s.push(this.data.array[a+o]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function Ac(e){an.call(this),this.type="SpriteMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}Ac.prototype=Object.create(an.prototype),Ac.prototype.constructor=Ac,Ac.prototype.isSpriteMaterial=!0,Ac.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Fh,gd=new ee,Bh=new ee,Uh=new ee,Gh=new _t,vd=new _t,lx=new Hn,rm=new ee,yd=new ee,am=new ee,cx=new _t,Pv=new _t,ux=new _t;function _d(e){if(Jt.call(this),this.type="Sprite",Fh===void 0){Fh=new Ae;var s=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new rs(s,5);Fh.setIndex([0,1,2,0,2,3]),Fh.setAttribute("position",new Ec(t,3,0,!1)),Fh.setAttribute("uv",new Ec(t,2,3,!1))}this.geometry=Fh,this.material=e!==void 0?e:new Ac,this.center=new _t(.5,.5)}_d.prototype=Object.assign(Object.create(Jt.prototype),{constructor:_d,isSprite:!0,raycast:function(e,s){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Bh.setFromMatrixScale(this.matrixWorld),lx.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Uh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Bh.multiplyScalar(-Uh.z);var t=this.material.rotation,a,o;t!==0&&(o=Math.cos(t),a=Math.sin(t));var c=this.center;sm(rm.set(-.5,-.5,0),Uh,c,Bh,a,o),sm(yd.set(.5,-.5,0),Uh,c,Bh,a,o),sm(am.set(.5,.5,0),Uh,c,Bh,a,o),cx.set(0,0),Pv.set(1,0),ux.set(1,1);var f=e.ray.intersectTriangle(rm,yd,am,!1,gd);if(!(f===null&&(sm(yd.set(-.5,.5,0),Uh,c,Bh,a,o),Pv.set(0,1),f=e.ray.intersectTriangle(rm,am,yd,!1,gd),f===null))){var d=e.ray.origin.distanceTo(gd);d<e.near||d>e.far||s.push({distance:d,point:gd.clone(),uv:Da.getUV(gd,rm,yd,am,cx,Pv,ux,new _t),face:null,object:this})}},copy:function(e){return Jt.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}});function sm(e,s,t,a,o,c){Gh.subVectors(e,t).addScalar(.5).multiply(a),o!==void 0?(vd.x=c*Gh.x-o*Gh.y,vd.y=o*Gh.x+c*Gh.y):vd.copy(Gh),e.copy(s),e.x+=vd.x,e.y+=vd.y,e.applyMatrix4(lx)}var om=new ee,hx=new ee;function xd(){Jt.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}xd.prototype=Object.assign(Object.create(Jt.prototype),{constructor:xd,isLOD:!0,copy:function(e){Jt.prototype.copy.call(this,e,!1);for(var s=e.levels,t=0,a=s.length;t<a;t++){var o=s[t];this.addLevel(o.object.clone(),o.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,s){s===void 0&&(s=0),s=Math.abs(s);var t=this.levels,a;for(a=0;a<t.length&&!(s<t[a].distance);a++);return t.splice(a,0,{distance:s,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var s=this.levels;if(s.length>0){var t,a;for(t=1,a=s.length;t<a&&!(e<s[t].distance);t++);return s[t-1].object}return null},raycast:function(e,s){var t=this.levels;if(t.length>0){om.setFromMatrixPosition(this.matrixWorld);var a=e.ray.origin.distanceTo(om);this.getObjectForDistance(a).raycast(e,s)}},update:function(e){var s=this.levels;if(s.length>1){om.setFromMatrixPosition(e.matrixWorld),hx.setFromMatrixPosition(this.matrixWorld);var t=om.distanceTo(hx)/e.zoom;s[0].object.visible=!0;var a,o;for(a=1,o=s.length;a<o&&t>=s[a].distance;a++)s[a-1].object.visible=!1,s[a].object.visible=!0;for(this._currentLevel=a-1;a<o;a++)s[a].object.visible=!1}},toJSON:function(e){var s=Jt.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(s.object.autoUpdate=!1),s.object.levels=[];for(var t=this.levels,a=0,o=t.length;a<o;a++){var c=t[a];s.object.levels.push({object:c.object.uuid,distance:c.distance})}return s}});function lm(e,s){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Fn.call(this,e,s),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Hn,this.bindMatrixInverse=new Hn}lm.prototype=Object.assign(Object.create(Fn.prototype),{constructor:lm,isSkinnedMesh:!0,copy:function(e){return Fn.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,s){this.skeleton=e,s===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.getInverse(s)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Ei,s=this.geometry.attributes.skinWeight,t=0,a=s.count;t<a;t++){e.x=s.getX(t),e.y=s.getY(t),e.z=s.getZ(t),e.w=s.getW(t);var o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),s.setXYZW(t,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Fn.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){var e=new ee,s=new Ei,t=new Ei,a=new ee,o=new Hn;return function(c,f){var d=this.skeleton,m=this.geometry;s.fromBufferAttribute(m.attributes.skinIndex,c),t.fromBufferAttribute(m.attributes.skinWeight,c),e.fromBufferAttribute(m.attributes.position,c).applyMatrix4(this.bindMatrix),f.set(0,0,0);for(var y=0;y<4;y++){var w=t.getComponent(y);if(w!==0){var M=s.getComponent(y);o.multiplyMatrices(d.bones[M].matrixWorld,d.boneInverses[M]),f.addScaledVector(a.copy(e).applyMatrix4(o),w)}}return f.applyMatrix4(this.bindMatrixInverse)}}()});var fx=new Hn,GL=new Hn;function cm(e,s){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,s===void 0)this.calculateInverses();else if(this.bones.length===s.length)this.boneInverses=s.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var t=0,a=this.bones.length;t<a;t++)this.boneInverses.push(new Hn)}}Object.assign(cm.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,s=this.bones.length;e<s;e++){var t=new Hn;this.bones[e]&&t.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(t)}},pose:function(){for(var e=0,s=this.bones.length;e<s;e++){var t=this.bones[e];t&&t.matrixWorld.getInverse(this.boneInverses[e])}for(var a=0,o=this.bones.length;a<o;a++){var c=this.bones[a];c&&(c.parent&&c.parent.isBone?(c.matrix.getInverse(c.parent.matrixWorld),c.matrix.multiply(c.matrixWorld)):c.matrix.copy(c.matrixWorld),c.matrix.decompose(c.position,c.quaternion,c.scale))}},update:function(){for(var e=this.bones,s=this.boneInverses,t=this.boneMatrices,a=this.boneTexture,o=0,c=e.length;o<c;o++){var f=e[o]?e[o].matrixWorld:GL;fx.multiplyMatrices(f,s[o]),fx.toArray(t,o*16)}a!==void 0&&(a.needsUpdate=!0)},clone:function(){return new cm(this.bones,this.boneInverses)},getBoneByName:function(e){for(var s=0,t=this.bones.length;s<t;s++){var a=this.bones[s];if(a.name===e)return a}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function Iv(){Jt.call(this),this.type="Bone"}Iv.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Iv,isBone:!0});var dx=new Hn,px=new Hn,um=[],bd=new Fn;function hm(e,s,t){Fn.call(this,e,s),this.instanceMatrix=new fn(new Float32Array(t*16),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}hm.prototype=Object.assign(Object.create(Fn.prototype),{constructor:hm,isInstancedMesh:!0,copy:function(e){return Fn.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),this.count=e.count,this},setColorAt:function(e,s){this.instanceColor===null&&(this.instanceColor=new fn(new Float32Array(this.count*3),3)),s.toArray(this.instanceColor.array,e*3)},getMatrixAt:function(e,s){s.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,s){var t=this.matrixWorld,a=this.count;if(bd.geometry=this.geometry,bd.material=this.material,bd.material!==void 0)for(var o=0;o<a;o++){this.getMatrixAt(o,dx),px.multiplyMatrices(t,dx),bd.matrixWorld=px,bd.raycast(e,um);for(var c=0,f=um.length;c<f;c++){var d=um[c];d.instanceId=o,d.object=this,s.push(d)}um.length=0}},setMatrixAt:function(e,s){s.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function lr(e){an.call(this),this.type="LineBasicMaterial",this.color=new qt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}lr.prototype=Object.create(an.prototype),lr.prototype.constructor=lr,lr.prototype.isLineBasicMaterial=!0,lr.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var mx=new ee,gx=new ee,vx=new Hn,fm=new es,dm=new da;function Ss(e,s,t){t===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Jt.call(this),this.type="Line",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new lr,this.updateMorphTargets()}Ss.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Ss,isLine:!0,copy:function(e){return Jt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var s=e.attributes.position,t=[0],a=1,o=s.count;a<o;a++)mx.fromBufferAttribute(s,a-1),gx.fromBufferAttribute(s,a),t[a]=t[a-1],t[a]+=mx.distanceTo(gx);e.setAttribute("lineDistance",new x(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var c=e.vertices,f=e.lineDistances;f[0]=0;for(var d=1,m=c.length;d<m;d++)f[d]=f[d-1],f[d]+=c[d-1].distanceTo(c[d])}return this},raycast:function(e,s){var t=this.geometry,a=this.matrixWorld,o=e.params.Line.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),dm.copy(t.boundingSphere),dm.applyMatrix4(a),dm.radius+=o,e.ray.intersectsSphere(dm)!==!1){vx.getInverse(a),fm.copy(e.ray).applyMatrix4(vx);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,d=new ee,m=new ee,y=new ee,w=new ee,M=this.isLineSegments?2:1;if(t.isBufferGeometry){var D=t.index,P=t.attributes,F=P.position;if(D!==null)for(var C=D.array,I=0,q=C.length-1;I<q;I+=M){var J=C[I],Z=C[I+1];d.fromBufferAttribute(F,J),m.fromBufferAttribute(F,Z);var G=fm.distanceSqToSegment(d,m,w,y);if(!(G>f)){w.applyMatrix4(this.matrixWorld);var Y=e.ray.origin.distanceTo(w);Y<e.near||Y>e.far||s.push({distance:Y,point:y.clone().applyMatrix4(this.matrixWorld),index:I,face:null,faceIndex:null,object:this})}}else for(var ne=0,se=F.count-1;ne<se;ne+=M){d.fromBufferAttribute(F,ne),m.fromBufferAttribute(F,ne+1);var Ee=fm.distanceSqToSegment(d,m,w,y);if(!(Ee>f)){w.applyMatrix4(this.matrixWorld);var Be=e.ray.origin.distanceTo(w);Be<e.near||Be>e.far||s.push({distance:Be,point:y.clone().applyMatrix4(this.matrixWorld),index:ne,face:null,faceIndex:null,object:this})}}}else if(t.isGeometry)for(var ce=t.vertices,oe=ce.length,ie=0;ie<oe-1;ie+=M){var Ce=fm.distanceSqToSegment(ce[ie],ce[ie+1],w,y);if(!(Ce>f)){w.applyMatrix4(this.matrixWorld);var De=e.ray.origin.distanceTo(w);De<e.near||De>e.far||s.push({distance:De,point:y.clone().applyMatrix4(this.matrixWorld),index:ie,face:null,faceIndex:null,object:this})}}}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var pm=new ee,mm=new ee;function Ta(e,s){Ss.call(this,e,s),this.type="LineSegments"}Ta.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ta,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var s=e.attributes.position,t=[],a=0,o=s.count;a<o;a+=2)pm.fromBufferAttribute(s,a),mm.fromBufferAttribute(s,a+1),t[a]=a===0?0:t[a-1],t[a+1]=t[a]+pm.distanceTo(mm);e.setAttribute("lineDistance",new x(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var c=e.vertices,f=e.lineDistances,d=0,m=c.length;d<m;d+=2)pm.copy(c[d]),mm.copy(c[d+1]),f[d]=d===0?0:f[d-1],f[d+1]=f[d]+pm.distanceTo(mm);return this}});function gm(e,s){Ss.call(this,e,s),this.type="LineLoop"}gm.prototype=Object.assign(Object.create(Ss.prototype),{constructor:gm,isLineLoop:!0});function no(e){an.call(this),this.type="PointsMaterial",this.color=new qt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}no.prototype=Object.create(an.prototype),no.prototype.constructor=no,no.prototype.isPointsMaterial=!0,no.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var yx=new Hn,Dv=new es,vm=new da,ym=new ee;function zh(e,s){Jt.call(this),this.type="Points",this.geometry=e!==void 0?e:new Ae,this.material=s!==void 0?s:new no,this.updateMorphTargets()}zh.prototype=Object.assign(Object.create(Jt.prototype),{constructor:zh,isPoints:!0,copy:function(e){return Jt.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,s){var t=this.geometry,a=this.matrixWorld,o=e.params.Points.threshold;if(t.boundingSphere===null&&t.computeBoundingSphere(),vm.copy(t.boundingSphere),vm.applyMatrix4(a),vm.radius+=o,e.ray.intersectsSphere(vm)!==!1){yx.getInverse(a),Dv.copy(e.ray).applyMatrix4(yx);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c;if(t.isBufferGeometry){var d=t.index,m=t.attributes,y=m.position;if(d!==null)for(var w=d.array,M=0,D=w.length;M<D;M++){var P=w[M];ym.fromBufferAttribute(y,P),Ov(ym,P,f,a,e,s,this)}else for(var F=0,C=y.count;F<C;F++)ym.fromBufferAttribute(y,F),Ov(ym,F,f,a,e,s,this)}else for(var I=t.vertices,q=0,J=I.length;q<J;q++)Ov(I[q],q,f,a,e,s,this)}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var s=e.morphAttributes,t=Object.keys(s);if(t.length>0){var a=s[t[0]];if(a!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,c=a.length;o<c;o++){var f=a[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[f]=o}}}}else{var d=e.morphTargets;d!==void 0&&d.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Ov(e,s,t,a,o,c,f){var d=Dv.distanceSqToPoint(e);if(d<t){var m=new ee;Dv.closestPointToPoint(e,m),m.applyMatrix4(a);var y=o.ray.origin.distanceTo(m);if(y<o.near||y>o.far)return;c.push({distance:y,distanceToRay:Math.sqrt(d),point:m,index:s,face:null,object:f})}}function Nv(e,s,t,a,o,c,f,d,m){Ti.call(this,e,s,t,a,o,c,f,d,m),this.format=f!==void 0?f:Ka,this.minFilter=c!==void 0?c:Dt,this.magFilter=o!==void 0?o:Dt,this.generateMipmaps=!1;var y=this;function w(){y.needsUpdate=!0,e.requestVideoFrameCallback(w)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(w)}Nv.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Nv,isVideoTexture:!0,update:function(){var e=this.image,s="requestVideoFrameCallback"in e;s===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Hh(e,s,t,a,o,c,f,d,m,y,w,M){Ti.call(this,null,c,f,d,m,y,a,o,w,M),this.image={width:s,height:t},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}Hh.prototype=Object.create(Ti.prototype),Hh.prototype.constructor=Hh,Hh.prototype.isCompressedTexture=!0;function wd(e,s,t,a,o,c,f,d,m){Ti.call(this,e,s,t,a,o,c,f,d,m),this.needsUpdate=!0}wd.prototype=Object.create(Ti.prototype),wd.prototype.constructor=wd,wd.prototype.isCanvasTexture=!0;function Md(e,s,t,a,o,c,f,d,m,y){if(y=y!==void 0?y:Ft,y!==Ft&&y!==Tn)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");t===void 0&&y===Ft&&(t=Vs),t===void 0&&y===Tn&&(t=fa),Ti.call(this,null,a,o,c,f,d,y,t,m),this.image={width:e,height:s},this.magFilter=f!==void 0?f:it,this.minFilter=d!==void 0?d:it,this.flipY=!1,this.generateMipmaps=!1}Md.prototype=Object.create(Ti.prototype),Md.prototype.constructor=Md,Md.prototype.isDepthTexture=!0;var zL=0,Ho=new Hn,Fv=new Jt,_m=new ee;function Fi(){Object.defineProperty(this,"id",{value:zL+=2}),this.uuid=Mn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Fi.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Fi,isGeometry:!0,applyMatrix4:function(e){for(var s=new ta().getNormalMatrix(e),t=0,a=this.vertices.length;t<a;t++){var o=this.vertices[t];o.applyMatrix4(e)}for(var c=0,f=this.faces.length;c<f;c++){var d=this.faces[c];d.normal.applyMatrix3(s).normalize();for(var m=0,y=d.vertexNormals.length;m<y;m++)d.vertexNormals[m].applyMatrix3(s).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return Ho.makeRotationX(e),this.applyMatrix4(Ho),this},rotateY:function(e){return Ho.makeRotationY(e),this.applyMatrix4(Ho),this},rotateZ:function(e){return Ho.makeRotationZ(e),this.applyMatrix4(Ho),this},translate:function(e,s,t){return Ho.makeTranslation(e,s,t),this.applyMatrix4(Ho),this},scale:function(e,s,t){return Ho.makeScale(e,s,t),this.applyMatrix4(Ho),this},lookAt:function(e){return Fv.lookAt(e),Fv.updateMatrix(),this.applyMatrix4(Fv.matrix),this},fromBufferGeometry:function(e){var s=this,t=e.index!==null?e.index:void 0,a=e.attributes;if(a.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var o=a.position,c=a.normal,f=a.color,d=a.uv,m=a.uv2;m!==void 0&&(this.faceVertexUvs[1]=[]);for(var y=0;y<o.count;y++)s.vertices.push(new ee().fromBufferAttribute(o,y)),f!==void 0&&s.colors.push(new qt().fromBufferAttribute(f,y));function w(Z,G,Y,ne){var se=f===void 0?[]:[s.colors[Z].clone(),s.colors[G].clone(),s.colors[Y].clone()],Ee=c===void 0?[]:[new ee().fromBufferAttribute(c,Z),new ee().fromBufferAttribute(c,G),new ee().fromBufferAttribute(c,Y)],Be=new lu(Z,G,Y,Ee,se,ne);s.faces.push(Be),d!==void 0&&s.faceVertexUvs[0].push([new _t().fromBufferAttribute(d,Z),new _t().fromBufferAttribute(d,G),new _t().fromBufferAttribute(d,Y)]),m!==void 0&&s.faceVertexUvs[1].push([new _t().fromBufferAttribute(m,Z),new _t().fromBufferAttribute(m,G),new _t().fromBufferAttribute(m,Y)])}var M=e.groups;if(M.length>0)for(var D=0;D<M.length;D++)for(var P=M[D],F=P.start,C=P.count,I=F;I<F+C;I+=3)t!==void 0?w(t.getX(I),t.getX(I+1),t.getX(I+2),P.materialIndex):w(I,I+1,I+2,P.materialIndex);else if(t!==void 0)for(var q=0;q<t.count;q+=3)w(t.getX(q),t.getX(q+1),t.getX(q+2));else for(var J=0;J<o.count;J+=3)w(J,J+1,J+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_m).negate(),this.translate(_m.x,_m.y,_m.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,s=this.boundingSphere.radius,t=s===0?1:1/s,a=new Hn;return a.set(t,0,0,-t*e.x,0,t,0,-t*e.y,0,0,t,-t*e.z,0,0,0,1),this.applyMatrix4(a),this},computeFaceNormals:function(){for(var e=new ee,s=new ee,t=0,a=this.faces.length;t<a;t++){var o=this.faces[t],c=this.vertices[o.a],f=this.vertices[o.b],d=this.vertices[o.c];e.subVectors(d,f),s.subVectors(c,f),e.cross(s),e.normalize(),o.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);for(var s=new Array(this.vertices.length),t=0,a=this.vertices.length;t<a;t++)s[t]=new ee;if(e)for(var o=new ee,c=new ee,f=0,d=this.faces.length;f<d;f++){var m=this.faces[f],y=this.vertices[m.a],w=this.vertices[m.b],M=this.vertices[m.c];o.subVectors(M,w),c.subVectors(y,w),o.cross(c),s[m.a].add(o),s[m.b].add(o),s[m.c].add(o)}else{this.computeFaceNormals();for(var D=0,P=this.faces.length;D<P;D++){var F=this.faces[D];s[F.a].add(F.normal),s[F.b].add(F.normal),s[F.c].add(F.normal)}}for(var C=0,I=this.vertices.length;C<I;C++)s[C].normalize();for(var q=0,J=this.faces.length;q<J;q++){var Z=this.faces[q],G=Z.vertexNormals;G.length===3?(G[0].copy(s[Z.a]),G[1].copy(s[Z.b]),G[2].copy(s[Z.c])):(G[0]=s[Z.a].clone(),G[1]=s[Z.b].clone(),G[2]=s[Z.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(var e=0,s=this.faces.length;e<s;e++){var t=this.faces[e],a=t.vertexNormals;a.length===3?(a[0].copy(t.normal),a[1].copy(t.normal),a[2].copy(t.normal)):(a[0]=t.normal.clone(),a[1]=t.normal.clone(),a[2]=t.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(var e=0,s=this.faces.length;e<s;e++){var t=this.faces[e];t.__originalFaceNormal?t.__originalFaceNormal.copy(t.normal):t.__originalFaceNormal=t.normal.clone(),t.__originalVertexNormals||(t.__originalVertexNormals=[]);for(var a=0,o=t.vertexNormals.length;a<o;a++)t.__originalVertexNormals[a]?t.__originalVertexNormals[a].copy(t.vertexNormals[a]):t.__originalVertexNormals[a]=t.vertexNormals[a].clone()}var c=new Fi;c.faces=this.faces;for(var f=0,d=this.morphTargets.length;f<d;f++){if(!this.morphNormals[f]){this.morphNormals[f]={},this.morphNormals[f].faceNormals=[],this.morphNormals[f].vertexNormals=[];for(var m=this.morphNormals[f].faceNormals,y=this.morphNormals[f].vertexNormals,w=0,M=this.faces.length;w<M;w++){var D=new ee,P={a:new ee,b:new ee,c:new ee};m.push(D),y.push(P)}}var F=this.morphNormals[f];c.vertices=this.morphTargets[f].vertices,c.computeFaceNormals(),c.computeVertexNormals();for(var C=0,I=this.faces.length;C<I;C++){var q=this.faces[C],J=F.faceNormals[C],Z=F.vertexNormals[C];J.copy(q.normal),Z.a.copy(q.vertexNormals[0]),Z.b.copy(q.vertexNormals[1]),Z.c.copy(q.vertexNormals[2])}}for(var G=0,Y=this.faces.length;G<Y;G++){var ne=this.faces[G];ne.normal=ne.__originalFaceNormal,ne.vertexNormals=ne.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new vs),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new da),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,s,t){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var a,o=this.vertices.length,c=this.vertices,f=e.vertices,d=this.faces,m=e.faces,y=this.colors,w=e.colors;t===void 0&&(t=0),s!==void 0&&(a=new ta().getNormalMatrix(s));for(var M=0,D=f.length;M<D;M++){var P=f[M],F=P.clone();s!==void 0&&F.applyMatrix4(s),c.push(F)}for(var C=0,I=w.length;C<I;C++)y.push(w[C].clone());for(var q=0,J=m.length;q<J;q++){var Z=m[q],G=void 0,Y=void 0,ne=Z.vertexNormals,se=Z.vertexColors,Ee=new lu(Z.a+o,Z.b+o,Z.c+o);Ee.normal.copy(Z.normal),a!==void 0&&Ee.normal.applyMatrix3(a).normalize();for(var Be=0,ce=ne.length;Be<ce;Be++)G=ne[Be].clone(),a!==void 0&&G.applyMatrix3(a).normalize(),Ee.vertexNormals.push(G);Ee.color.copy(Z.color);for(var oe=0,ie=se.length;oe<ie;oe++)Y=se[oe],Ee.vertexColors.push(Y.clone());Ee.materialIndex=Z.materialIndex+t,d.push(Ee)}for(var Ce=0,De=e.faceVertexUvs.length;Ce<De;Ce++){var Oe=e.faceVertexUvs[Ce];this.faceVertexUvs[Ce]===void 0&&(this.faceVertexUvs[Ce]=[]);for(var et=0,mt=Oe.length;et<mt;et++){for(var dt=Oe[et],ot=[],Mt=0,zt=dt.length;Mt<zt;Mt++)ot.push(dt[Mt].clone());this.faceVertexUvs[Ce].push(ot)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){for(var e={},s=[],t=[],a=Math.pow(10,4),o=0,c=this.vertices.length;o<c;o++){var f=this.vertices[o],d=Math.round(f.x*a)+"_"+Math.round(f.y*a)+"_"+Math.round(f.z*a);e[d]===void 0?(e[d]=o,s.push(this.vertices[o]),t[o]=s.length-1):t[o]=t[e[d]]}for(var m=[],y=0,w=this.faces.length;y<w;y++){var M=this.faces[y];M.a=t[M.a],M.b=t[M.b],M.c=t[M.c];for(var D=[M.a,M.b,M.c],P=0;P<3;P++)if(D[P]===D[(P+1)%3]){m.push(y);break}}for(var F=m.length-1;F>=0;F--){var C=m[F];this.faces.splice(C,1);for(var I=0,q=this.faceVertexUvs.length;I<q;I++)this.faceVertexUvs[I].splice(C,1)}var J=this.vertices.length-s.length;return this.vertices=s,J},setFromPoints:function(e){this.vertices=[];for(var s=0,t=e.length;s<t;s++){var a=e[s];this.vertices.push(new ee(a.x,a.y,a.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,s=e.length,t=0;t<s;t++)e[t]._id=t;e.sort(function(y,w){return y.materialIndex-w.materialIndex});var a=this.faceVertexUvs[0],o=this.faceVertexUvs[1],c,f;a&&a.length===s&&(c=[]),o&&o.length===s&&(f=[]);for(var d=0;d<s;d++){var m=e[d]._id;c&&c.push(a[m]),f&&f.push(o[m])}c&&(this.faceVertexUvs[0]=c),f&&(this.faceVertexUvs[1]=f)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var s=this.parameters;for(var t in s)s[t]!==void 0&&(e[t]=s[t]);return e}for(var a=[],o=0;o<this.vertices.length;o++){var c=this.vertices[o];a.push(c.x,c.y,c.z)}for(var f=[],d=[],m={},y=[],w={},M=[],D={},P=0;P<this.faces.length;P++){var F=this.faces[P],C=this.faceVertexUvs[0][P]!==void 0,I=F.normal.length()>0,q=F.vertexNormals.length>0,J=F.color.r!==1||F.color.g!==1||F.color.b!==1,Z=F.vertexColors.length>0,G=0;if(G=Ee(G,0,0),G=Ee(G,1,!0),G=Ee(G,2,!1),G=Ee(G,3,C),G=Ee(G,4,I),G=Ee(G,5,q),G=Ee(G,6,J),G=Ee(G,7,Z),f.push(G),f.push(F.a,F.b,F.c),f.push(F.materialIndex),C){var Y=this.faceVertexUvs[0][P];f.push(oe(Y[0]),oe(Y[1]),oe(Y[2]))}if(I&&f.push(Be(F.normal)),q){var ne=F.vertexNormals;f.push(Be(ne[0]),Be(ne[1]),Be(ne[2]))}if(J&&f.push(ce(F.color)),Z){var se=F.vertexColors;f.push(ce(se[0]),ce(se[1]),ce(se[2]))}}function Ee(ie,Ce,De){return De?ie|1<<Ce:ie&~(1<<Ce)}function Be(ie){var Ce=ie.x.toString()+ie.y.toString()+ie.z.toString();return m[Ce]!==void 0||(m[Ce]=d.length/3,d.push(ie.x,ie.y,ie.z)),m[Ce]}function ce(ie){var Ce=ie.r.toString()+ie.g.toString()+ie.b.toString();return w[Ce]!==void 0||(w[Ce]=y.length,y.push(ie.getHex())),w[Ce]}function oe(ie){var Ce=ie.x.toString()+ie.y.toString();return D[Ce]!==void 0||(D[Ce]=M.length/2,M.push(ie.x,ie.y)),D[Ce]}return e.data={},e.data.vertices=a,e.data.normals=d,y.length>0&&(e.data.colors=y),M.length>0&&(e.data.uvs=[M]),e.data.faces=f,e},clone:function(){return new Fi().copy(this)},copy:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var s=e.vertices,t=0,a=s.length;t<a;t++)this.vertices.push(s[t].clone());for(var o=e.colors,c=0,f=o.length;c<f;c++)this.colors.push(o[c].clone());for(var d=e.faces,m=0,y=d.length;m<y;m++)this.faces.push(d[m].clone());for(var w=0,M=e.faceVertexUvs.length;w<M;w++){var D=e.faceVertexUvs[w];this.faceVertexUvs[w]===void 0&&(this.faceVertexUvs[w]=[]);for(var P=0,F=D.length;P<F;P++){for(var C=D[P],I=[],q=0,J=C.length;q<J;q++){var Z=C[q];I.push(Z.clone())}this.faceVertexUvs[w].push(I)}}for(var G=e.morphTargets,Y=0,ne=G.length;Y<ne;Y++){var se={};if(se.name=G[Y].name,G[Y].vertices!==void 0){se.vertices=[];for(var Ee=0,Be=G[Y].vertices.length;Ee<Be;Ee++)se.vertices.push(G[Y].vertices[Ee].clone())}if(G[Y].normals!==void 0){se.normals=[];for(var ce=0,oe=G[Y].normals.length;ce<oe;ce++)se.normals.push(G[Y].normals[ce].clone())}this.morphTargets.push(se)}for(var ie=e.morphNormals,Ce=0,De=ie.length;Ce<De;Ce++){var Oe={};if(ie[Ce].vertexNormals!==void 0){Oe.vertexNormals=[];for(var et=0,mt=ie[Ce].vertexNormals.length;et<mt;et++){var dt=ie[Ce].vertexNormals[et],ot={};ot.a=dt.a.clone(),ot.b=dt.b.clone(),ot.c=dt.c.clone(),Oe.vertexNormals.push(ot)}}if(ie[Ce].faceNormals!==void 0){Oe.faceNormals=[];for(var Mt=0,zt=ie[Ce].faceNormals.length;Mt<zt;Mt++)Oe.faceNormals.push(ie[Ce].faceNormals[Mt].clone())}this.morphNormals.push(Oe)}for(var Bt=e.skinWeights,en=0,on=Bt.length;en<on;en++)this.skinWeights.push(Bt[en].clone());for(var ft=e.skinIndices,Bn=0,Rn=ft.length;Bn<Rn;Bn++)this.skinIndices.push(ft[Bn].clone());for(var mn=e.lineDistances,ri=0,Wn=mn.length;ri<Wn;ri++)this.lineDistances.push(mn[ri]);var mi=e.boundingBox;mi!==null&&(this.boundingBox=mi.clone());var ei=e.boundingSphere;return ei!==null&&(this.boundingSphere=ei.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Bv=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;return m.type="BoxGeometry",m.parameters={width:t,height:a,depth:o,widthSegments:c,heightSegments:f,depthSegments:d},m.fromBufferGeometry(new ns(t,a,o,c,f,d)),m.mergeVertices(),m}return s}(Fi),Uv=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="CircleBufferGeometry",f.parameters={radius:t,segments:a,thetaStart:o,thetaLength:c},t=t||1,a=a!==void 0?Math.max(3,a):8,o=o!==void 0?o:0,c=c!==void 0?c:Math.PI*2;var d=[],m=[],y=[],w=[],M=new ee,D=new _t;m.push(0,0,0),y.push(0,0,1),w.push(.5,.5);for(var P=0,F=3;P<=a;P++,F+=3){var C=o+P/a*c;M.x=t*Math.cos(C),M.y=t*Math.sin(C),m.push(M.x,M.y,M.z),y.push(0,0,1),D.x=(m[F]/t+1)/2,D.y=(m[F+1]/t+1)/2,w.push(D.x,D.y)}for(var I=1;I<=a;I++)d.push(I,I+1,0);return f.setIndex(d),f.setAttribute("position",new x(m,3)),f.setAttribute("normal",new x(y,3)),f.setAttribute("uv",new x(w,2)),f}return s}(Ae),_x=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="CircleGeometry",f.parameters={radius:t,segments:a,thetaStart:o,thetaLength:c},f.fromBufferGeometry(new Uv(t,a,o,c)),f.mergeVertices(),f}return s}(Fi),Sd=function(e){Qt(s,e);function s(t,a,o,c,f,d,m,y){var w=e.call(this)||this;w.type="CylinderBufferGeometry",w.parameters={radiusTop:t,radiusBottom:a,height:o,radialSegments:c,heightSegments:f,openEnded:d,thetaStart:m,thetaLength:y};var M=uc(w);t=t!==void 0?t:1,a=a!==void 0?a:1,o=o||1,c=Math.floor(c)||8,f=Math.floor(f)||1,d=d!==void 0?d:!1,m=m!==void 0?m:0,y=y!==void 0?y:Math.PI*2;var D=[],P=[],F=[],C=[],I=0,q=[],J=o/2,Z=0;G(),d===!1&&(t>0&&Y(!0),a>0&&Y(!1)),w.setIndex(D),w.setAttribute("position",new x(P,3)),w.setAttribute("normal",new x(F,3)),w.setAttribute("uv",new x(C,2));function G(){for(var ne=new ee,se=new ee,Ee=0,Be=(a-t)/o,ce=0;ce<=f;ce++){for(var oe=[],ie=ce/f,Ce=ie*(a-t)+t,De=0;De<=c;De++){var Oe=De/c,et=Oe*y+m,mt=Math.sin(et),dt=Math.cos(et);se.x=Ce*mt,se.y=-ie*o+J,se.z=Ce*dt,P.push(se.x,se.y,se.z),ne.set(mt,Be,dt).normalize(),F.push(ne.x,ne.y,ne.z),C.push(Oe,1-ie),oe.push(I++)}q.push(oe)}for(var ot=0;ot<c;ot++)for(var Mt=0;Mt<f;Mt++){var zt=q[Mt][ot],Bt=q[Mt+1][ot],en=q[Mt+1][ot+1],on=q[Mt][ot+1];D.push(zt,Bt,on),D.push(Bt,en,on),Ee+=6}M.addGroup(Z,Ee,0),Z+=Ee}function Y(ne){for(var se=I,Ee=new _t,Be=new ee,ce=0,oe=ne===!0?t:a,ie=ne===!0?1:-1,Ce=1;Ce<=c;Ce++)P.push(0,J*ie,0),F.push(0,ie,0),C.push(.5,.5),I++;for(var De=I,Oe=0;Oe<=c;Oe++){var et=Oe/c,mt=et*y+m,dt=Math.cos(mt),ot=Math.sin(mt);Be.x=oe*ot,Be.y=J*ie,Be.z=oe*dt,P.push(Be.x,Be.y,Be.z),F.push(0,ie,0),Ee.x=dt*.5+.5,Ee.y=ot*.5*ie+.5,C.push(Ee.x,Ee.y),I++}for(var Mt=0;Mt<c;Mt++){var zt=se+Mt,Bt=De+Mt;ne===!0?D.push(Bt,Bt+1,zt):D.push(Bt+1,Bt,zt),ce+=3}M.addGroup(Z,ce,ne===!0?1:2),Z+=ce}return w}return s}(Ae),Gv=function(e){Qt(s,e);function s(t,a,o,c,f,d,m,y){var w=e.call(this)||this;return w.type="CylinderGeometry",w.parameters={radiusTop:t,radiusBottom:a,height:o,radialSegments:c,heightSegments:f,openEnded:d,thetaStart:m,thetaLength:y},w.fromBufferGeometry(new Sd(t,a,o,c,f,d,m,y)),w.mergeVertices(),w}return s}(Fi),xx=function(e){Qt(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this,0,t,a,o,c,f,d,m)||this;return y.type="ConeGeometry",y.parameters={radius:t,height:a,radialSegments:o,heightSegments:c,openEnded:f,thetaStart:d,thetaLength:m},y}return s}(Gv),bx=function(e){Qt(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this,0,t,a,o,c,f,d,m)||this;return y.type="ConeBufferGeometry",y.parameters={radius:t,height:a,radialSegments:o,heightSegments:c,openEnded:f,thetaStart:d,thetaLength:m},y}return s}(Sd),fu=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="PolyhedronBufferGeometry",f.parameters={vertices:t,indices:a,radius:o,detail:c},o=o||1,c=c||0;var d=[],m=[];y(c),M(o),D(),f.setAttribute("position",new x(d,3)),f.setAttribute("normal",new x(d.slice(),3)),f.setAttribute("uv",new x(m,2)),c===0?f.computeVertexNormals():f.normalizeNormals();function y(G){for(var Y=new ee,ne=new ee,se=new ee,Ee=0;Ee<a.length;Ee+=3)C(a[Ee+0],Y),C(a[Ee+1],ne),C(a[Ee+2],se),w(Y,ne,se,G)}function w(G,Y,ne,se){for(var Ee=se+1,Be=[],ce=0;ce<=Ee;ce++){Be[ce]=[];for(var oe=G.clone().lerp(ne,ce/Ee),ie=Y.clone().lerp(ne,ce/Ee),Ce=Ee-ce,De=0;De<=Ce;De++)De===0&&ce===Ee?Be[ce][De]=oe:Be[ce][De]=oe.clone().lerp(ie,De/Ce)}for(var Oe=0;Oe<Ee;Oe++)for(var et=0;et<2*(Ee-Oe)-1;et++){var mt=Math.floor(et/2);et%2===0?(F(Be[Oe][mt+1]),F(Be[Oe+1][mt]),F(Be[Oe][mt])):(F(Be[Oe][mt+1]),F(Be[Oe+1][mt+1]),F(Be[Oe+1][mt]))}}function M(G){for(var Y=new ee,ne=0;ne<d.length;ne+=3)Y.x=d[ne+0],Y.y=d[ne+1],Y.z=d[ne+2],Y.normalize().multiplyScalar(G),d[ne+0]=Y.x,d[ne+1]=Y.y,d[ne+2]=Y.z}function D(){for(var G=new ee,Y=0;Y<d.length;Y+=3){G.x=d[Y+0],G.y=d[Y+1],G.z=d[Y+2];var ne=J(G)/2/Math.PI+.5,se=Z(G)/Math.PI+.5;m.push(ne,1-se)}I(),P()}function P(){for(var G=0;G<m.length;G+=6){var Y=m[G+0],ne=m[G+2],se=m[G+4],Ee=Math.max(Y,ne,se),Be=Math.min(Y,ne,se);Ee>.9&&Be<.1&&(Y<.2&&(m[G+0]+=1),ne<.2&&(m[G+2]+=1),se<.2&&(m[G+4]+=1))}}function F(G){d.push(G.x,G.y,G.z)}function C(G,Y){var ne=G*3;Y.x=t[ne+0],Y.y=t[ne+1],Y.z=t[ne+2]}function I(){for(var G=new ee,Y=new ee,ne=new ee,se=new ee,Ee=new _t,Be=new _t,ce=new _t,oe=0,ie=0;oe<d.length;oe+=9,ie+=6){G.set(d[oe+0],d[oe+1],d[oe+2]),Y.set(d[oe+3],d[oe+4],d[oe+5]),ne.set(d[oe+6],d[oe+7],d[oe+8]),Ee.set(m[ie+0],m[ie+1]),Be.set(m[ie+2],m[ie+3]),ce.set(m[ie+4],m[ie+5]),se.copy(G).add(Y).add(ne).divideScalar(3);var Ce=J(se);q(Ee,ie+0,G,Ce),q(Be,ie+2,Y,Ce),q(ce,ie+4,ne,Ce)}}function q(G,Y,ne,se){se<0&&G.x===1&&(m[Y]=G.x-1),ne.x===0&&ne.z===0&&(m[Y]=se/2/Math.PI+.5)}function J(G){return Math.atan2(G.z,-G.x)}function Z(G){return Math.atan2(-G.y,Math.sqrt(G.x*G.x+G.z*G.z))}return f}return s}(Ae),zv=function(e){Qt(s,e);function s(t,a){var o,c=(1+Math.sqrt(5))/2,f=1/c;return o=e.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-f,-c,0,-f,c,0,f,-c,0,f,c,-f,-c,0,-f,c,0,f,-c,0,f,c,0,-c,0,-f,c,0,-f,-c,0,f,c,0,f],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,a)||this,o.type="DodecahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(fu),wx=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;return o.type="DodecahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new zv(t,a)),o.mergeVertices(),o}return s}(Fi),xm=new ee,bm=new ee,Hv=new ee,kh=new Da,kv=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;o.type="EdgesGeometry",o.parameters={thresholdAngle:a},a=a!==void 0?a:1,t.isGeometry&&(t=new Ae().fromGeometry(t));for(var c=Math.pow(10,4),f=Math.cos(Mn.DEG2RAD*a),d=t.getIndex(),m=t.getAttribute("position"),y=d?d.count:m.count,w=[0,0,0],M=["a","b","c"],D=new Array(3),P={},F=[],C=0;C<y;C+=3){d?(w[0]=d.getX(C),w[1]=d.getX(C+1),w[2]=d.getX(C+2)):(w[0]=C,w[1]=C+1,w[2]=C+2);var I=kh.a,q=kh.b,J=kh.c;if(I.fromBufferAttribute(m,w[0]),q.fromBufferAttribute(m,w[1]),J.fromBufferAttribute(m,w[2]),kh.getNormal(Hv),D[0]=Math.round(I.x*c)+","+Math.round(I.y*c)+","+Math.round(I.z*c),D[1]=Math.round(q.x*c)+","+Math.round(q.y*c)+","+Math.round(q.z*c),D[2]=Math.round(J.x*c)+","+Math.round(J.y*c)+","+Math.round(J.z*c),!(D[0]===D[1]||D[1]===D[2]||D[2]===D[0]))for(var Z=0;Z<3;Z++){var G=(Z+1)%3,Y=D[Z],ne=D[G],se=kh[M[Z]],Ee=kh[M[G]],Be=Y+"_"+ne,ce=ne+"_"+Y;ce in P&&P[ce]?(Hv.dot(P[ce].normal)<=f&&(F.push(se.x,se.y,se.z),F.push(Ee.x,Ee.y,Ee.z)),P[ce]=null):Be in P||(P[Be]={index0:w[Z],index1:w[G],normal:Hv.clone()})}}for(var oe in P)if(P[oe]){var ie=P[oe],Ce=ie.index0,De=ie.index1;xm.fromBufferAttribute(m,Ce),bm.fromBufferAttribute(m,De),F.push(xm.x,xm.y,xm.z),F.push(bm.x,bm.y,bm.z)}return o.setAttribute("position",new x(F,3)),o}return s}(Ae),HL={triangulate:function(e,s,t){t=t||2;var a=s&&s.length,o=a?s[0]*t:e.length,c=Mx(e,0,o,t,!0),f=[];if(!c||c.next===c.prev)return f;var d,m,y,w,M,D,P;if(a&&(c=XL(e,s,c,t)),e.length>80*t){d=y=e[0],m=w=e[1];for(var F=t;F<o;F+=t)M=e[F],D=e[F+1],M<d&&(d=M),D<m&&(m=D),M>y&&(y=M),D>w&&(w=D);P=Math.max(y-d,w-m),P=P!==0?1/P:0}return Td(c,f,t,d,m,P),f}};function Mx(e,s,t,a,o){var c,f;if(o===iR(e,s,t,a)>0)for(c=s;c<t;c+=a)f=Ex(c,e[c],e[c+1],f);else for(c=t-a;c>=s;c-=a)f=Ex(c,e[c],e[c+1],f);return f&&wm(f,f.next)&&(Ad(f),f=f.next),f}function Lc(e,s){if(!e)return e;s||(s=e);var t=e,a;do if(a=!1,!t.steiner&&(wm(t,t.next)||vr(t.prev,t,t.next)===0)){if(Ad(t),t=s=t.prev,t===t.next)break;a=!0}else t=t.next;while(a||t!==s);return s}function Td(e,s,t,a,o,c,f){if(!!e){!f&&c&&KL(e,a,o,c);for(var d=e,m,y;e.prev!==e.next;){if(m=e.prev,y=e.next,c?VL(e,a,o,c):kL(e)){s.push(m.i/t),s.push(e.i/t),s.push(y.i/t),Ad(e),e=y.next,d=y.next;continue}if(e=y,e===d){f?f===1?(e=WL(Lc(e),s,t),Td(e,s,t,a,o,c,2)):f===2&&qL(e,s,t,a,o,c):Td(Lc(e),s,t,a,o,c,1);break}}}}function kL(e){var s=e.prev,t=e,a=e.next;if(vr(s,t,a)>=0)return!1;for(var o=e.next.next;o!==e.prev;){if(Vh(s.x,s.y,t.x,t.y,a.x,a.y,o.x,o.y)&&vr(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function VL(e,s,t,a){var o=e.prev,c=e,f=e.next;if(vr(o,c,f)>=0)return!1;for(var d=o.x<c.x?o.x<f.x?o.x:f.x:c.x<f.x?c.x:f.x,m=o.y<c.y?o.y<f.y?o.y:f.y:c.y<f.y?c.y:f.y,y=o.x>c.x?o.x>f.x?o.x:f.x:c.x>f.x?c.x:f.x,w=o.y>c.y?o.y>f.y?o.y:f.y:c.y>f.y?c.y:f.y,M=Vv(d,m,s,t,a),D=Vv(y,w,s,t,a),P=e.prevZ,F=e.nextZ;P&&P.z>=M&&F&&F.z<=D;){if(P!==e.prev&&P!==e.next&&Vh(o.x,o.y,c.x,c.y,f.x,f.y,P.x,P.y)&&vr(P.prev,P,P.next)>=0||(P=P.prevZ,F!==e.prev&&F!==e.next&&Vh(o.x,o.y,c.x,c.y,f.x,f.y,F.x,F.y)&&vr(F.prev,F,F.next)>=0))return!1;F=F.nextZ}for(;P&&P.z>=M;){if(P!==e.prev&&P!==e.next&&Vh(o.x,o.y,c.x,c.y,f.x,f.y,P.x,P.y)&&vr(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;F&&F.z<=D;){if(F!==e.prev&&F!==e.next&&Vh(o.x,o.y,c.x,c.y,f.x,f.y,F.x,F.y)&&vr(F.prev,F,F.next)>=0)return!1;F=F.nextZ}return!0}function WL(e,s,t){var a=e;do{var o=a.prev,c=a.next.next;!wm(o,c)&&Sx(o,a,a.next,c)&&Ed(o,c)&&Ed(c,o)&&(s.push(o.i/t),s.push(a.i/t),s.push(c.i/t),Ad(a),Ad(a.next),a=e=c),a=a.next}while(a!==e);return Lc(a)}function qL(e,s,t,a,o,c){var f=e;do{for(var d=f.next.next;d!==f.prev;){if(f.i!==d.i&&eR(f,d)){var m=Tx(f,d);f=Lc(f,f.next),m=Lc(m,m.next),Td(f,s,t,a,o,c),Td(m,s,t,a,o,c);return}d=d.next}f=f.next}while(f!==e)}function XL(e,s,t,a){var o=[],c,f,d,m,y;for(c=0,f=s.length;c<f;c++)d=s[c]*a,m=c<f-1?s[c+1]*a:e.length,y=Mx(e,d,m,a,!1),y===y.next&&(y.steiner=!0),o.push($L(y));for(o.sort(YL),c=0;c<o.length;c++)jL(o[c],t),t=Lc(t,t.next);return t}function YL(e,s){return e.x-s.x}function jL(e,s){if(s=ZL(e,s),s){var t=Tx(s,e);Lc(s,s.next),Lc(t,t.next)}}function ZL(e,s){var t=s,a=e.x,o=e.y,c=-1/0,f;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){var d=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(d<=a&&d>c){if(c=d,d===a){if(o===t.y)return t;if(o===t.next.y)return t.next}f=t.x<t.next.x?t:t.next}}t=t.next}while(t!==s);if(!f)return null;if(a===c)return f;var m=f,y=f.x,w=f.y,M=1/0,D;t=f;do a>=t.x&&t.x>=y&&a!==t.x&&Vh(o<w?a:c,o,y,w,o<w?c:a,o,t.x,t.y)&&(D=Math.abs(o-t.y)/(a-t.x),Ed(t,e)&&(D<M||D===M&&(t.x>f.x||t.x===f.x&&JL(f,t)))&&(f=t,M=D)),t=t.next;while(t!==m);return f}function JL(e,s){return vr(e.prev,e,s.prev)<0&&vr(s.next,e,e.next)<0}function KL(e,s,t,a){var o=e;do o.z===null&&(o.z=Vv(o.x,o.y,s,t,a)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==e);o.prevZ.nextZ=null,o.prevZ=null,QL(o)}function QL(e){var s,t,a,o,c,f,d,m,y=1;do{for(t=e,e=null,c=null,f=0;t;){for(f++,a=t,d=0,s=0;s<y&&(d++,a=a.nextZ,!!a);s++);for(m=y;d>0||m>0&&a;)d!==0&&(m===0||!a||t.z<=a.z)?(o=t,t=t.nextZ,d--):(o=a,a=a.nextZ,m--),c?c.nextZ=o:e=o,o.prevZ=c,c=o;t=a}c.nextZ=null,y*=2}while(f>1);return e}function Vv(e,s,t,a,o){return e=32767*(e-t)*o,s=32767*(s-a)*o,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,e|s<<1}function $L(e){var s=e,t=e;do(s.x<t.x||s.x===t.x&&s.y<t.y)&&(t=s),s=s.next;while(s!==e);return t}function Vh(e,s,t,a,o,c,f,d){return(o-f)*(s-d)-(e-f)*(c-d)>=0&&(e-f)*(a-d)-(t-f)*(s-d)>=0&&(t-f)*(c-d)-(o-f)*(a-d)>=0}function eR(e,s){return e.next.i!==s.i&&e.prev.i!==s.i&&!tR(e,s)&&(Ed(e,s)&&Ed(s,e)&&nR(e,s)&&(vr(e.prev,e,s.prev)||vr(e,s.prev,s))||wm(e,s)&&vr(e.prev,e,e.next)>0&&vr(s.prev,s,s.next)>0)}function vr(e,s,t){return(s.y-e.y)*(t.x-s.x)-(s.x-e.x)*(t.y-s.y)}function wm(e,s){return e.x===s.x&&e.y===s.y}function Sx(e,s,t,a){var o=Sm(vr(e,s,t)),c=Sm(vr(e,s,a)),f=Sm(vr(t,a,e)),d=Sm(vr(t,a,s));return!!(o!==c&&f!==d||o===0&&Mm(e,t,s)||c===0&&Mm(e,a,s)||f===0&&Mm(t,e,a)||d===0&&Mm(t,s,a))}function Mm(e,s,t){return s.x<=Math.max(e.x,t.x)&&s.x>=Math.min(e.x,t.x)&&s.y<=Math.max(e.y,t.y)&&s.y>=Math.min(e.y,t.y)}function Sm(e){return e>0?1:e<0?-1:0}function tR(e,s){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==s.i&&t.next.i!==s.i&&Sx(t,t.next,e,s))return!0;t=t.next}while(t!==e);return!1}function Ed(e,s){return vr(e.prev,e,e.next)<0?vr(e,s,e.next)>=0&&vr(e,e.prev,s)>=0:vr(e,s,e.prev)<0||vr(e,e.next,s)<0}function nR(e,s){var t=e,a=!1,o=(e.x+s.x)/2,c=(e.y+s.y)/2;do t.y>c!=t.next.y>c&&t.next.y!==t.y&&o<(t.next.x-t.x)*(c-t.y)/(t.next.y-t.y)+t.x&&(a=!a),t=t.next;while(t!==e);return a}function Tx(e,s){var t=new Wv(e.i,e.x,e.y),a=new Wv(s.i,s.x,s.y),o=e.next,c=s.prev;return e.next=s,s.prev=e,t.next=o,o.prev=t,a.next=t,t.prev=a,c.next=a,a.prev=c,a}function Ex(e,s,t,a){var o=new Wv(e,s,t);return a?(o.next=a.next,o.prev=a,a.next.prev=o,a.next=o):(o.prev=o,o.next=o),o}function Ad(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Wv(e,s,t){this.i=e,this.x=s,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iR(e,s,t,a){for(var o=0,c=s,f=t-a;c<t;c+=a)o+=(e[f]-e[c])*(e[c+1]+e[f+1]),f=c;return o}var El={area:function(e){for(var s=e.length,t=0,a=s-1,o=0;o<s;a=o++)t+=e[a].x*e[o].y-e[o].x*e[a].y;return t*.5},isClockWise:function(e){return El.area(e)<0},triangulateShape:function(e,s){var t=[],a=[],o=[];Ax(e),Lx(t,e);var c=e.length;s.forEach(Ax);for(var f=0;f<s.length;f++)a.push(c),c+=s[f].length,Lx(t,s[f]);for(var d=HL.triangulate(t,a),m=0;m<d.length;m+=3)o.push(d.slice(m,m+3));return o}};function Ax(e){var s=e.length;s>2&&e[s-1].equals(e[0])&&e.pop()}function Lx(e,s){for(var t=0;t<s.length;t++)e.push(s[t].x),e.push(s[t].y)}var Ld=function(e){Qt(s,e);function s(a,o){var c=e.call(this)||this;c.type="ExtrudeBufferGeometry",c.parameters={shapes:a,options:o},a=Array.isArray(a)?a:[a];for(var f=uc(c),d=[],m=[],y=0,w=a.length;y<w;y++){var M=a[y];D(M)}c.setAttribute("position",new x(d,3)),c.setAttribute("uv",new x(m,2)),c.computeVertexNormals();function D(P){var F=[],C=o.curveSegments!==void 0?o.curveSegments:12,I=o.steps!==void 0?o.steps:1,q=o.depth!==void 0?o.depth:100,J=o.bevelEnabled!==void 0?o.bevelEnabled:!0,Z=o.bevelThickness!==void 0?o.bevelThickness:6,G=o.bevelSize!==void 0?o.bevelSize:Z-2,Y=o.bevelOffset!==void 0?o.bevelOffset:0,ne=o.bevelSegments!==void 0?o.bevelSegments:3,se=o.extrudePath,Ee=o.UVGenerator!==void 0?o.UVGenerator:rR;o.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),q=o.amount);var Be,ce=!1,oe,ie,Ce,De;se&&(Be=se.getSpacedPoints(I),ce=!0,J=!1,oe=se.computeFrenetFrames(I,!1),ie=new ee,Ce=new ee,De=new ee),J||(ne=0,Z=0,G=0,Y=0);var Oe=P.extractPoints(C),et=Oe.shape,mt=Oe.holes,dt=!El.isClockWise(et);if(dt){et=et.reverse();for(var ot=0,Mt=mt.length;ot<Mt;ot++){var zt=mt[ot];El.isClockWise(zt)&&(mt[ot]=zt.reverse())}}for(var Bt=El.triangulateShape(et,mt),en=et,on=0,ft=mt.length;on<ft;on++){var Bn=mt[on];et=et.concat(Bn)}function Rn(li,Cn,vi){return Cn||console.error("THREE.ExtrudeGeometry: vec does not exist"),Cn.clone().multiplyScalar(vi).add(li)}var mn=et.length,ri=Bt.length;function Wn(li,Cn,vi){var Jn,ai,ir,ya=li.x-Cn.x,_a=li.y-Cn.y,Aa=vi.x-li.x,os=vi.y-li.y,Dl=ya*ya+_a*_a;if(Math.abs(ya*os-_a*Aa)>Number.EPSILON){var Ab=Math.sqrt(Dl),Lb=Math.sqrt(Aa*Aa+os*os),Rb=Cn.x-_a/Ab,Cb=Cn.y+ya/Ab,QR=vi.x-os/Lb,$R=vi.y+Aa/Lb,Pb=((QR-Rb)*os-($R-Cb)*Aa)/(ya*os-_a*Aa);Jn=Rb+ya*Pb-li.x,ai=Cb+_a*Pb-li.y;var Ib=Jn*Jn+ai*ai;if(Ib<=2)return new _t(Jn,ai);ir=Math.sqrt(Ib/2)}else{var ag=!1;ya>Number.EPSILON?Aa>Number.EPSILON&&(ag=!0):ya<-Number.EPSILON?Aa<-Number.EPSILON&&(ag=!0):Math.sign(_a)===Math.sign(os)&&(ag=!0),ag?(Jn=-_a,ai=ya,ir=Math.sqrt(Dl)):(Jn=ya,ai=_a,ir=Math.sqrt(Dl/2))}return new _t(Jn/ir,ai/ir)}for(var mi=[],ei=0,Hi=en.length,Me=Hi-1,X=ei+1;ei<Hi;ei++,Me++,X++)Me===Hi&&(Me=0),X===Hi&&(X=0),mi[ei]=Wn(en[ei],en[Me],en[X]);for(var At=[],st,Zt=mi.concat(),Rt=0,un=mt.length;Rt<un;Rt++){var dn=mt[Rt];st=[];for(var tn=0,gn=dn.length,vn=gn-1,jn=tn+1;tn<gn;tn++,vn++,jn++)vn===gn&&(vn=0),jn===gn&&(jn=0),st[tn]=Wn(dn[tn],dn[vn],dn[jn]);At.push(st),Zt=Zt.concat(st)}for(var Ai=0;Ai<ne;Ai++){for(var Or=Ai/ne,Bi=Z*Math.cos(Or*Math.PI/2),Ba=G*Math.sin(Or*Math.PI/2)+Y,bi=0,co=en.length;bi<co;bi++){var Tu=Rn(en[bi],mi[bi],Ba);rn(Tu.x,Tu.y,-Bi)}for(var uo=0,Pl=mt.length;uo<Pl;uo++){var $h=mt[uo];st=At[uo];for(var Eu=0,Gy=$h.length;Eu<Gy;Eu++){var ef=Rn($h[Eu],st[Eu],Ba);rn(ef.x,ef.y,-Bi)}}}for(var ig=G+Y,ho=0;ho<mn;ho++){var Au=J?Rn(et[ho],Zt[ho],ig):et[ho];ce?(Ce.copy(oe.normals[0]).multiplyScalar(Au.x),ie.copy(oe.binormals[0]).multiplyScalar(Au.y),De.copy(Be[0]).add(Ce).add(ie),rn(De.x,De.y,De.z)):rn(Au.x,Au.y,0)}for(var Il=1;Il<=I;Il++)for(var Oc=0;Oc<mn;Oc++){var Ua=J?Rn(et[Oc],Zt[Oc],ig):et[Oc];ce?(Ce.copy(oe.normals[Il]).multiplyScalar(Ua.x),ie.copy(oe.binormals[Il]).multiplyScalar(Ua.y),De.copy(Be[Il]).add(Ce).add(ie),rn(De.x,De.y,De.z)):rn(Ua.x,Ua.y,q/I*Il)}for(var tf=ne-1;tf>=0;tf--){for(var rg=tf/ne,Bd=Z*Math.cos(rg*Math.PI/2),he=G*Math.sin(rg*Math.PI/2)+Y,at=0,$e=en.length;at<$e;at++){var gt=Rn(en[at],mi[at],he);rn(gt.x,gt.y,q+Bd)}for(var Ht=0,oi=mt.length;Ht<oi;Ht++){var ti=mt[Ht];st=At[Ht];for(var hi=0,Un=ti.length;hi<Un;hi++){var cr=Rn(ti[hi],st[hi],he);ce?rn(cr.x,cr.y+Be[I-1].y,Be[I-1].x+Bd):rn(cr.x,cr.y,q+Bd)}}}ur(),function(){var li=d.length/3,Cn=0;Er(en,Cn),Cn+=en.length;for(var vi=0,Jn=mt.length;vi<Jn;vi++){var ai=mt[vi];Er(ai,Cn),Cn+=ai.length}f.addGroup(li,d.length/3-li,1)}();function ur(){var li=d.length/3;if(J){for(var Cn=0,vi=mn*Cn,Jn=0;Jn<ri;Jn++){var ai=Bt[Jn];Xr(ai[2]+vi,ai[1]+vi,ai[0]+vi)}Cn=I+ne*2,vi=mn*Cn;for(var ir=0;ir<ri;ir++){var ya=Bt[ir];Xr(ya[0]+vi,ya[1]+vi,ya[2]+vi)}}else{for(var _a=0;_a<ri;_a++){var Aa=Bt[_a];Xr(Aa[2],Aa[1],Aa[0])}for(var os=0;os<ri;os++){var Dl=Bt[os];Xr(Dl[0]+mn*I,Dl[1]+mn*I,Dl[2]+mn*I)}}f.addGroup(li,d.length/3-li,0)}function Er(li,Cn){for(var vi=li.length;--vi>=0;){var Jn=vi,ai=vi-1;ai<0&&(ai=li.length-1);for(var ir=0,ya=I+ne*2;ir<ya;ir++){var _a=mn*ir,Aa=mn*(ir+1),os=Cn+ai+_a,Dl=Cn+ai+Aa;Yr(Cn+Jn+_a,os,Dl,Cn+Jn+Aa)}}}function rn(li,Cn,vi){F.push(li),F.push(Cn),F.push(vi)}function Xr(li,Cn,vi){gi(li),gi(Cn),gi(vi);var Jn=d.length/3,ai=Ee.generateTopUV(f,d,Jn-3,Jn-2,Jn-1);Nr(ai[0]),Nr(ai[1]),Nr(ai[2])}function Yr(li,Cn,vi,Jn){gi(li),gi(Cn),gi(Jn),gi(Cn),gi(vi),gi(Jn);var ai=d.length/3,ir=Ee.generateSideWallUV(f,d,ai-6,ai-3,ai-2,ai-1);Nr(ir[0]),Nr(ir[1]),Nr(ir[3]),Nr(ir[1]),Nr(ir[2]),Nr(ir[3])}function gi(li){d.push(F[li*3+0]),d.push(F[li*3+1]),d.push(F[li*3+2])}function Nr(li){m.push(li.x),m.push(li.y)}}return c}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this),o=this.parameters.shapes,c=this.parameters.options;return aR(o,c,a)},s}(Ae),rR={generateTopUV:function(e,s,t,a,o){var c=s[t*3],f=s[t*3+1],d=s[a*3],m=s[a*3+1],y=s[o*3],w=s[o*3+1];return[new _t(c,f),new _t(d,m),new _t(y,w)]},generateSideWallUV:function(e,s,t,a,o,c){var f=s[t*3],d=s[t*3+1],m=s[t*3+2],y=s[a*3],w=s[a*3+1],M=s[a*3+2],D=s[o*3],P=s[o*3+1],F=s[o*3+2],C=s[c*3],I=s[c*3+1],q=s[c*3+2];return Math.abs(d-w)<.01?[new _t(f,1-m),new _t(y,1-M),new _t(D,1-F),new _t(C,1-q)]:[new _t(d,1-m),new _t(w,1-M),new _t(P,1-F),new _t(I,1-q)]}};function aR(e,s,t){if(t.shapes=[],Array.isArray(e))for(var a=0,o=e.length;a<o;a++){var c=e[a];t.shapes.push(c.uuid)}else t.shapes.push(e.uuid);return s.extrudePath!==void 0&&(t.options.extrudePath=s.extrudePath.toJSON()),t}var qv=function(e){Qt(s,e);function s(a,o){var c=e.call(this)||this;return c.type="ExtrudeGeometry",c.parameters={shapes:a,options:o},c.fromBufferGeometry(new Ld(a,o)),c.mergeVertices(),c}var t=s.prototype;return t.toJSON=function(){var a=e.prototype.toJSON.call(this),o=this.parameters.shapes,c=this.parameters.options;return sR(o,c,a)},s}(Fi);function sR(e,s,t){if(t.shapes=[],Array.isArray(e))for(var a=0,o=e.length;a<o;a++){var c=e[a];t.shapes.push(c.uuid)}else t.shapes.push(e.uuid);return s.extrudePath!==void 0&&(t.options.extrudePath=s.extrudePath.toJSON()),t}var Xv=function(e){Qt(s,e);function s(t,a){var o,c=(1+Math.sqrt(5))/2;return o=e.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,a)||this,o.type="IcosahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(fu),Rx=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;return o.type="IcosahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Xv(t,a)),o.mergeVertices(),o}return s}(Fi),Yv=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;f.type="LatheBufferGeometry",f.parameters={points:t,segments:a,phiStart:o,phiLength:c},a=Math.floor(a)||12,o=o||0,c=c||Math.PI*2,c=Mn.clamp(c,0,Math.PI*2);for(var d=[],m=[],y=[],w=1/a,M=new ee,D=new _t,P=0;P<=a;P++)for(var F=o+P*w*c,C=Math.sin(F),I=Math.cos(F),q=0;q<=t.length-1;q++)M.x=t[q].x*C,M.y=t[q].y,M.z=t[q].x*I,m.push(M.x,M.y,M.z),D.x=P/a,D.y=q/(t.length-1),y.push(D.x,D.y);for(var J=0;J<a;J++)for(var Z=0;Z<t.length-1;Z++){var G=Z+J*t.length,Y=G+t.length,ne=G+t.length+1,se=G+1;d.push(G,Y,se),d.push(Y,ne,se)}if(f.setIndex(d),f.setAttribute("position",new x(m,3)),f.setAttribute("uv",new x(y,2)),f.computeVertexNormals(),c===Math.PI*2)for(var Ee=f.attributes.normal.array,Be=new ee,ce=new ee,oe=new ee,ie=a*t.length*3,Ce=0,De=0;Ce<t.length;Ce++,De+=3)Be.x=Ee[De+0],Be.y=Ee[De+1],Be.z=Ee[De+2],ce.x=Ee[ie+De+0],ce.y=Ee[ie+De+1],ce.z=Ee[ie+De+2],oe.addVectors(Be,ce).normalize(),Ee[De+0]=Ee[ie+De+0]=oe.x,Ee[De+1]=Ee[ie+De+1]=oe.y,Ee[De+2]=Ee[ie+De+2]=oe.z;return f}return s}(Ae),Cx=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="LatheGeometry",f.parameters={points:t,segments:a,phiStart:o,phiLength:c},f.fromBufferGeometry(new Yv(t,a,o,c)),f.mergeVertices(),f}return s}(Fi),Tm=function(e){Qt(s,e);function s(t,a){var o=e.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,a)||this;return o.type="OctahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(fu),Px=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;return o.type="OctahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Tm(t,a)),o.mergeVertices(),o}return s}(Fi);function Wh(e,s,t){Ae.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:s,stacks:t};var a=[],o=[],c=[],f=[],d=1e-5,m=new ee,y=new ee,w=new ee,M=new ee,D=new ee;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var P=s+1,F=0;F<=t;F++)for(var C=F/t,I=0;I<=s;I++){var q=I/s;e(q,C,y),o.push(y.x,y.y,y.z),q-d>=0?(e(q-d,C,w),M.subVectors(y,w)):(e(q+d,C,w),M.subVectors(w,y)),C-d>=0?(e(q,C-d,w),D.subVectors(y,w)):(e(q,C+d,w),D.subVectors(w,y)),m.crossVectors(M,D).normalize(),c.push(m.x,m.y,m.z),f.push(q,C)}for(var J=0;J<t;J++)for(var Z=0;Z<s;Z++){var G=J*P+Z,Y=J*P+Z+1,ne=(J+1)*P+Z+1,se=(J+1)*P+Z;a.push(G,Y,se),a.push(Y,ne,se)}this.setIndex(a),this.setAttribute("position",new x(o,3)),this.setAttribute("normal",new x(c,3)),this.setAttribute("uv",new x(f,2))}Wh.prototype=Object.create(Ae.prototype),Wh.prototype.constructor=Wh;function Rd(e,s,t){Fi.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:s,stacks:t},this.fromBufferGeometry(new Wh(e,s,t)),this.mergeVertices()}Rd.prototype=Object.create(Fi.prototype),Rd.prototype.constructor=Rd;var Ix=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="PlaneGeometry",f.parameters={width:t,height:a,widthSegments:o,heightSegments:c},f.fromBufferGeometry(new nm(t,a,o,c)),f.mergeVertices(),f}return s}(Fi),Dx=function(e){Qt(s,e);function s(t,a,o,c){var f=e.call(this)||this;return f.type="PolyhedronGeometry",f.parameters={vertices:t,indices:a,radius:o,detail:c},f.fromBufferGeometry(new fu(t,a,o,c)),f.mergeVertices(),f}return s}(Fi),jv=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="RingBufferGeometry",m.parameters={innerRadius:t,outerRadius:a,thetaSegments:o,phiSegments:c,thetaStart:f,thetaLength:d},t=t||.5,a=a||1,f=f!==void 0?f:0,d=d!==void 0?d:Math.PI*2,o=o!==void 0?Math.max(3,o):8,c=c!==void 0?Math.max(1,c):1;for(var y=[],w=[],M=[],D=[],P=t,F=(a-t)/c,C=new ee,I=new _t,q=0;q<=c;q++){for(var J=0;J<=o;J++){var Z=f+J/o*d;C.x=P*Math.cos(Z),C.y=P*Math.sin(Z),w.push(C.x,C.y,C.z),M.push(0,0,1),I.x=(C.x/a+1)/2,I.y=(C.y/a+1)/2,D.push(I.x,I.y)}P+=F}for(var G=0;G<c;G++)for(var Y=G*(o+1),ne=0;ne<o;ne++){var se=ne+Y,Ee=se+o+1,Be=se+o+2,ce=se+1;y.push(se,Ee,ce),y.push(Ee,Be,ce)}return m.setIndex(y),m.setAttribute("position",new x(w,3)),m.setAttribute("normal",new x(M,3)),m.setAttribute("uv",new x(D,2)),m}return s}(Ae),Ox=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;return m.type="RingGeometry",m.parameters={innerRadius:t,outerRadius:a,thetaSegments:o,phiSegments:c,thetaStart:f,thetaLength:d},m.fromBufferGeometry(new jv(t,a,o,c,f,d)),m.mergeVertices(),m}return s}(Fi),Zv=function(e){Qt(s,e);function s(a,o){var c=e.call(this)||this;c.type="ShapeBufferGeometry",c.parameters={shapes:a,curveSegments:o},o=o||12;var f=[],d=[],m=[],y=[],w=0,M=0;if(Array.isArray(a)===!1)P(a);else for(var D=0;D<a.length;D++)P(a[D]),c.addGroup(w,M,D),w+=M,M=0;c.setIndex(f),c.setAttribute("position",new x(d,3)),c.setAttribute("normal",new x(m,3)),c.setAttribute("uv",new x(y,2));function P(F){var C=d.length/3,I=F.extractPoints(o),q=I.shape,J=I.holes;El.isClockWise(q)===!1&&(q=q.reverse());for(var Z=0,G=J.length;Z<G;Z++){var Y=J[Z];El.isClockWise(Y)===!0&&(J[Z]=Y.reverse())}for(var ne=El.triangulateShape(q,J),se=0,Ee=J.length;se<Ee;se++){var Be=J[se];q=q.concat(Be)}for(var ce=0,oe=q.length;ce<oe;ce++){var ie=q[ce];d.push(ie.x,ie.y,0),m.push(0,0,1),y.push(ie.x,ie.y)}for(var Ce=0,De=ne.length;Ce<De;Ce++){var Oe=ne[Ce],et=Oe[0]+C,mt=Oe[1]+C,dt=Oe[2]+C;f.push(et,mt,dt),M+=3}}return c}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this),o=this.parameters.shapes;return oR(o,a)},s}(Ae);function oR(e,s){if(s.shapes=[],Array.isArray(e))for(var t=0,a=e.length;t<a;t++){var o=e[t];s.shapes.push(o.uuid)}else s.shapes.push(e.uuid);return s}var Jv=function(e){Qt(s,e);function s(a,o){var c=e.call(this)||this;return c.type="ShapeGeometry",typeof o=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),o=o.curveSegments),c.parameters={shapes:a,curveSegments:o},c.fromBufferGeometry(new Zv(a,o)),c.mergeVertices(),c}var t=s.prototype;return t.toJSON=function(){var a=Fi.prototype.toJSON.call(this),o=this.parameters.shapes;return lR(o,a)},s}(Fi);function lR(e,s){if(s.shapes=[],Array.isArray(e))for(var t=0,a=e.length;t<a;t++){var o=e[t];s.shapes.push(o.uuid)}else s.shapes.push(e.uuid);return s}var Em=function(e){Qt(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;y.type="SphereBufferGeometry",y.parameters={radius:t,widthSegments:a,heightSegments:o,phiStart:c,phiLength:f,thetaStart:d,thetaLength:m},t=t||1,a=Math.max(3,Math.floor(a)||8),o=Math.max(2,Math.floor(o)||6),c=c!==void 0?c:0,f=f!==void 0?f:Math.PI*2,d=d!==void 0?d:0,m=m!==void 0?m:Math.PI;for(var w=Math.min(d+m,Math.PI),M=0,D=[],P=new ee,F=new ee,C=[],I=[],q=[],J=[],Z=0;Z<=o;Z++){var G=[],Y=Z/o,ne=0;Z==0&&d==0?ne=.5/a:Z==o&&w==Math.PI&&(ne=-.5/a);for(var se=0;se<=a;se++){var Ee=se/a;P.x=-t*Math.cos(c+Ee*f)*Math.sin(d+Y*m),P.y=t*Math.cos(d+Y*m),P.z=t*Math.sin(c+Ee*f)*Math.sin(d+Y*m),I.push(P.x,P.y,P.z),F.copy(P).normalize(),q.push(F.x,F.y,F.z),J.push(Ee+ne,1-Y),G.push(M++)}D.push(G)}for(var Be=0;Be<o;Be++)for(var ce=0;ce<a;ce++){var oe=D[Be][ce+1],ie=D[Be][ce],Ce=D[Be+1][ce],De=D[Be+1][ce+1];(Be!==0||d>0)&&C.push(oe,ie,De),(Be!==o-1||w<Math.PI)&&C.push(ie,Ce,De)}return y.setIndex(C),y.setAttribute("position",new x(I,3)),y.setAttribute("normal",new x(q,3)),y.setAttribute("uv",new x(J,2)),y}return s}(Ae),Nx=function(e){Qt(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;return y.type="SphereGeometry",y.parameters={radius:t,widthSegments:a,heightSegments:o,phiStart:c,phiLength:f,thetaStart:d,thetaLength:m},y.fromBufferGeometry(new Em(t,a,o,c,f,d,m)),y.mergeVertices(),y}return s}(Fi),Kv=function(e){Qt(s,e);function s(t,a){var o=e.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,a)||this;return o.type="TetrahedronBufferGeometry",o.parameters={radius:t,detail:a},o}return s}(fu),Fx=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;return o.type="TetrahedronGeometry",o.parameters={radius:t,detail:a},o.fromBufferGeometry(new Kv(t,a)),o.mergeVertices(),o}return s}(Fi),Qv=function(e){Qt(s,e);function s(t,a){var o;a=a||{};var c=a.font;if(!(c&&c.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Ae||uc(o);var f=c.generateShapes(t,a.size);return a.depth=a.height!==void 0?a.height:50,a.bevelThickness===void 0&&(a.bevelThickness=10),a.bevelSize===void 0&&(a.bevelSize=8),a.bevelEnabled===void 0&&(a.bevelEnabled=!1),o=e.call(this,f,a)||this,o.type="TextBufferGeometry",o}return s}(Ld),Bx=function(e){Qt(s,e);function s(t,a){var o=e.call(this)||this;return o.type="TextGeometry",o.parameters={text:t,parameters:a},o.fromBufferGeometry(new Qv(t,a)),o.mergeVertices(),o}return s}(Fi),$v=function(e){Qt(s,e);function s(t,a,o,c,f){var d=e.call(this)||this;d.type="TorusBufferGeometry",d.parameters={radius:t,tube:a,radialSegments:o,tubularSegments:c,arc:f},t=t||1,a=a||.4,o=Math.floor(o)||8,c=Math.floor(c)||6,f=f||Math.PI*2;for(var m=[],y=[],w=[],M=[],D=new ee,P=new ee,F=new ee,C=0;C<=o;C++)for(var I=0;I<=c;I++){var q=I/c*f,J=C/o*Math.PI*2;P.x=(t+a*Math.cos(J))*Math.cos(q),P.y=(t+a*Math.cos(J))*Math.sin(q),P.z=a*Math.sin(J),y.push(P.x,P.y,P.z),D.x=t*Math.cos(q),D.y=t*Math.sin(q),F.subVectors(P,D).normalize(),w.push(F.x,F.y,F.z),M.push(I/c),M.push(C/o)}for(var Z=1;Z<=o;Z++)for(var G=1;G<=c;G++){var Y=(c+1)*Z+G-1,ne=(c+1)*(Z-1)+G-1,se=(c+1)*(Z-1)+G,Ee=(c+1)*Z+G;m.push(Y,ne,Ee),m.push(ne,se,Ee)}return d.setIndex(m),d.setAttribute("position",new x(y,3)),d.setAttribute("normal",new x(w,3)),d.setAttribute("uv",new x(M,2)),d}return s}(Ae),Ux=function(e){Qt(s,e);function s(t,a,o,c,f){var d=e.call(this)||this;return d.type="TorusGeometry",d.parameters={radius:t,tube:a,radialSegments:o,tubularSegments:c,arc:f},d.fromBufferGeometry(new $v(t,a,o,c,f)),d.mergeVertices(),d}return s}(Fi),ey=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="TorusKnotBufferGeometry",m.parameters={radius:t,tube:a,tubularSegments:o,radialSegments:c,p:f,q:d},t=t||1,a=a||.4,o=Math.floor(o)||64,c=Math.floor(c)||8,f=f||2,d=d||3;for(var y=[],w=[],M=[],D=[],P=new ee,F=new ee,C=new ee,I=new ee,q=new ee,J=new ee,Z=new ee,G=0;G<=o;++G){var Y=G/o*f*Math.PI*2;et(Y,f,d,t,C),et(Y+.01,f,d,t,I),J.subVectors(I,C),Z.addVectors(I,C),q.crossVectors(J,Z),Z.crossVectors(q,J),q.normalize(),Z.normalize();for(var ne=0;ne<=c;++ne){var se=ne/c*Math.PI*2,Ee=-a*Math.cos(se),Be=a*Math.sin(se);P.x=C.x+(Ee*Z.x+Be*q.x),P.y=C.y+(Ee*Z.y+Be*q.y),P.z=C.z+(Ee*Z.z+Be*q.z),w.push(P.x,P.y,P.z),F.subVectors(P,C).normalize(),M.push(F.x,F.y,F.z),D.push(G/o),D.push(ne/c)}}for(var ce=1;ce<=o;ce++)for(var oe=1;oe<=c;oe++){var ie=(c+1)*(ce-1)+(oe-1),Ce=(c+1)*ce+(oe-1),De=(c+1)*ce+oe,Oe=(c+1)*(ce-1)+oe;y.push(ie,Ce,Oe),y.push(Ce,De,Oe)}m.setIndex(y),m.setAttribute("position",new x(w,3)),m.setAttribute("normal",new x(M,3)),m.setAttribute("uv",new x(D,2));function et(mt,dt,ot,Mt,zt){var Bt=Math.cos(mt),en=Math.sin(mt),on=ot/dt*mt,ft=Math.cos(on);zt.x=Mt*(2+ft)*.5*Bt,zt.y=Mt*(2+ft)*en*.5,zt.z=Mt*Math.sin(on)*.5}return m}return s}(Ae),Gx=function(e){Qt(s,e);function s(t,a,o,c,f,d,m){var y=e.call(this)||this;return y.type="TorusKnotGeometry",y.parameters={radius:t,tube:a,tubularSegments:o,radialSegments:c,p:f,q:d},m!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),y.fromBufferGeometry(new ey(t,a,o,c,f,d)),y.mergeVertices(),y}return s}(Fi),ty=function(e){Qt(s,e);function s(a,o,c,f,d){var m=e.call(this)||this;m.type="TubeBufferGeometry",m.parameters={path:a,tubularSegments:o,radius:c,radialSegments:f,closed:d},o=o||64,c=c||1,f=f||8,d=d||!1;var y=a.computeFrenetFrames(o,d);m.tangents=y.tangents,m.normals=y.normals,m.binormals=y.binormals;var w=new ee,M=new ee,D=new _t,P=new ee,F=[],C=[],I=[],q=[];J(),m.setIndex(q),m.setAttribute("position",new x(F,3)),m.setAttribute("normal",new x(C,3)),m.setAttribute("uv",new x(I,2));function J(){for(var ne=0;ne<o;ne++)Z(ne);Z(d===!1?o:0),Y(),G()}function Z(ne){P=a.getPointAt(ne/o,P);for(var se=y.normals[ne],Ee=y.binormals[ne],Be=0;Be<=f;Be++){var ce=Be/f*Math.PI*2,oe=Math.sin(ce),ie=-Math.cos(ce);M.x=ie*se.x+oe*Ee.x,M.y=ie*se.y+oe*Ee.y,M.z=ie*se.z+oe*Ee.z,M.normalize(),C.push(M.x,M.y,M.z),w.x=P.x+c*M.x,w.y=P.y+c*M.y,w.z=P.z+c*M.z,F.push(w.x,w.y,w.z)}}function G(){for(var ne=1;ne<=o;ne++)for(var se=1;se<=f;se++){var Ee=(f+1)*(ne-1)+(se-1),Be=(f+1)*ne+(se-1),ce=(f+1)*ne+se,oe=(f+1)*(ne-1)+se;q.push(Ee,Be,oe),q.push(Be,ce,oe)}}function Y(){for(var ne=0;ne<=o;ne++)for(var se=0;se<=f;se++)D.x=ne/o,D.y=se/f,I.push(D.x,D.y)}return m}var t=s.prototype;return t.toJSON=function(){var a=Ae.prototype.toJSON.call(this);return a.path=this.parameters.path.toJSON(),a},s}(Ae),zx=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m=e.call(this)||this;m.type="TubeGeometry",m.parameters={path:t,tubularSegments:a,radius:o,radialSegments:c,closed:f},d!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var y=new ty(t,a,o,c,f);return m.tangents=y.tangents,m.normals=y.normals,m.binormals=y.binormals,m.fromBufferGeometry(y),m.mergeVertices(),m}return s}(Fi),ny=function(e){Qt(s,e);function s(t){var a=e.call(this)||this;a.type="WireframeGeometry";var o=[],c=[0,0],f={},d=["a","b","c"];if(t&&t.isGeometry){for(var m=t.faces,y=0,w=m.length;y<w;y++)for(var M=m[y],D=0;D<3;D++){var P=M[d[D]],F=M[d[(D+1)%3]];c[0]=Math.min(P,F),c[1]=Math.max(P,F);var C=c[0]+","+c[1];f[C]===void 0&&(f[C]={index1:c[0],index2:c[1]})}for(var I in f){var q=f[I],J=t.vertices[q.index1];o.push(J.x,J.y,J.z),J=t.vertices[q.index2],o.push(J.x,J.y,J.z)}}else if(t&&t.isBufferGeometry){var Z=new ee;if(t.index!==null){var G=t.attributes.position,Y=t.index,ne=t.groups;ne.length===0&&(ne=[{start:0,count:Y.count,materialIndex:0}]);for(var se=0,Ee=ne.length;se<Ee;++se)for(var Be=ne[se],ce=Be.start,oe=Be.count,ie=ce;ie<ce+oe;ie+=3)for(var Ce=0;Ce<3;Ce++){var De=Y.getX(ie+Ce),Oe=Y.getX(ie+(Ce+1)%3);c[0]=Math.min(De,Oe),c[1]=Math.max(De,Oe);var et=c[0]+","+c[1];f[et]===void 0&&(f[et]={index1:c[0],index2:c[1]})}for(var mt in f){var dt=f[mt];Z.fromBufferAttribute(G,dt.index1),o.push(Z.x,Z.y,Z.z),Z.fromBufferAttribute(G,dt.index2),o.push(Z.x,Z.y,Z.z)}}else for(var ot=t.attributes.position,Mt=0,zt=ot.count/3;Mt<zt;Mt++)for(var Bt=0;Bt<3;Bt++){var en=3*Mt+Bt;Z.fromBufferAttribute(ot,en),o.push(Z.x,Z.y,Z.z);var on=3*Mt+(Bt+1)%3;Z.fromBufferAttribute(ot,on),o.push(Z.x,Z.y,Z.z)}}return a.setAttribute("position",new x(o,3)),a}return s}(Ae),Ea=Object.freeze({__proto__:null,BoxGeometry:Bv,BoxBufferGeometry:ns,CircleGeometry:_x,CircleBufferGeometry:Uv,ConeGeometry:xx,ConeBufferGeometry:bx,CylinderGeometry:Gv,CylinderBufferGeometry:Sd,DodecahedronGeometry:wx,DodecahedronBufferGeometry:zv,EdgesGeometry:kv,ExtrudeGeometry:qv,ExtrudeBufferGeometry:Ld,IcosahedronGeometry:Rx,IcosahedronBufferGeometry:Xv,LatheGeometry:Cx,LatheBufferGeometry:Yv,OctahedronGeometry:Px,OctahedronBufferGeometry:Tm,ParametricGeometry:Rd,ParametricBufferGeometry:Wh,PlaneGeometry:Ix,PlaneBufferGeometry:nm,PolyhedronGeometry:Dx,PolyhedronBufferGeometry:fu,RingGeometry:Ox,RingBufferGeometry:jv,ShapeGeometry:Jv,ShapeBufferGeometry:Zv,SphereGeometry:Nx,SphereBufferGeometry:Em,TetrahedronGeometry:Fx,TetrahedronBufferGeometry:Kv,TextGeometry:Bx,TextBufferGeometry:Qv,TorusGeometry:Ux,TorusBufferGeometry:$v,TorusKnotGeometry:Gx,TorusKnotBufferGeometry:ey,TubeGeometry:zx,TubeBufferGeometry:ty,WireframeGeometry:ny});function du(e){an.call(this),this.type="ShadowMaterial",this.color=new qt(0),this.transparent=!0,this.setValues(e)}du.prototype=Object.create(an.prototype),du.prototype.constructor=du,du.prototype.isShadowMaterial=!0,du.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this};function Al(e){qr.call(this,e),this.type="RawShaderMaterial"}Al.prototype=Object.create(qr.prototype),Al.prototype.constructor=Al,Al.prototype.isRawShaderMaterial=!0;function ko(e){an.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ml,this.normalScale=new _t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(e)}ko.prototype=Object.create(an.prototype),ko.prototype.constructor=ko,ko.prototype.isMeshStandardMaterial=!0,ko.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this};function Rc(e){ko.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new _t(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(s){this.reflectivity=Mn.clamp(2.5*(s-1)/(s+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}Rc.prototype=Object.create(ko.prototype),Rc.prototype.constructor=Rc,Rc.prototype.isMeshPhysicalMaterial=!0,Rc.prototype.copy=function(e){return ko.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new qt).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};function Cc(e){an.call(this),this.type="MeshPhongMaterial",this.color=new qt(16777215),this.specular=new qt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ml,this.normalScale=new _t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Cc.prototype=Object.create(an.prototype),Cc.prototype.constructor=Cc,Cc.prototype.isMeshPhongMaterial=!0,Cc.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function pu(e){an.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ml,this.normalScale=new _t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}pu.prototype=Object.create(an.prototype),pu.prototype.constructor=pu,pu.prototype.isMeshToonMaterial=!0,pu.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function mu(e){an.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ml,this.normalScale=new _t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}mu.prototype=Object.create(an.prototype),mu.prototype.constructor=mu,mu.prototype.isMeshNormalMaterial=!0,mu.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function gu(e){an.call(this),this.type="MeshLambertMaterial",this.color=new qt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=de,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}gu.prototype=Object.create(an.prototype),gu.prototype.constructor=gu,gu.prototype.isMeshLambertMaterial=!0,gu.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function vu(e){an.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ml,this.normalScale=new _t(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}vu.prototype=Object.create(an.prototype),vu.prototype.constructor=vu,vu.prototype.isMeshMatcapMaterial=!0,vu.prototype.copy=function(e){return an.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function yu(e){lr.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}yu.prototype=Object.create(lr.prototype),yu.prototype.constructor=yu,yu.prototype.isLineDashedMaterial=!0,yu.prototype.copy=function(e){return lr.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var cR=Object.freeze({__proto__:null,ShadowMaterial:du,SpriteMaterial:Ac,RawShaderMaterial:Al,ShaderMaterial:qr,PointsMaterial:no,MeshPhysicalMaterial:Rc,MeshStandardMaterial:ko,MeshPhongMaterial:Cc,MeshToonMaterial:pu,MeshNormalMaterial:mu,MeshLambertMaterial:gu,MeshDepthMaterial:Mc,MeshDistanceMaterial:Sc,MeshBasicMaterial:Pr,MeshMatcapMaterial:vu,LineDashedMaterial:yu,LineBasicMaterial:lr,Material:an}),nr={arraySlice:function(e,s,t){return nr.isTypedArray(e)?new e.constructor(e.subarray(s,t!==void 0?t:e.length)):e.slice(s,t)},convertArray:function(e,s,t){return!e||!t&&e.constructor===s?e:typeof s.BYTES_PER_ELEMENT=="number"?new s(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function s(c,f){return e[c]-e[f]}for(var t=e.length,a=new Array(t),o=0;o!==t;++o)a[o]=o;return a.sort(s),a},sortedArray:function(e,s,t){for(var a=e.length,o=new e.constructor(a),c=0,f=0;f!==a;++c)for(var d=t[c]*s,m=0;m!==s;++m)o[f++]=e[d+m];return o},flattenJSON:function(e,s,t,a){for(var o=1,c=e[0];c!==void 0&&c[a]===void 0;)c=e[o++];if(c!==void 0){var f=c[a];if(f!==void 0)if(Array.isArray(f))do f=c[a],f!==void 0&&(s.push(c.time),t.push.apply(t,f)),c=e[o++];while(c!==void 0);else if(f.toArray!==void 0)do f=c[a],f!==void 0&&(s.push(c.time),f.toArray(t,t.length)),c=e[o++];while(c!==void 0);else do f=c[a],f!==void 0&&(s.push(c.time),t.push(f)),c=e[o++];while(c!==void 0)}},subclip:function(e,s,t,a,o){o=o||30;var c=e.clone();c.name=s;for(var f=[],d=0;d<c.tracks.length;++d){for(var m=c.tracks[d],y=m.getValueSize(),w=[],M=[],D=0;D<m.times.length;++D){var P=m.times[D]*o;if(!(P<t||P>=a)){w.push(m.times[D]);for(var F=0;F<y;++F)M.push(m.values[D*y+F])}}w.length!==0&&(m.times=nr.convertArray(w,m.times.constructor),m.values=nr.convertArray(M,m.values.constructor),f.push(m))}c.tracks=f;for(var C=1/0,I=0;I<c.tracks.length;++I)C>c.tracks[I].times[0]&&(C=c.tracks[I].times[0]);for(var q=0;q<c.tracks.length;++q)c.tracks[q].shift(-1*C);return c.resetDuration(),c},makeClipAdditive:function(e,s,t,a){s===void 0&&(s=0),t===void 0&&(t=e),(a===void 0||a<=0)&&(a=30);for(var o=t.tracks.length,c=s/a,f=function(y){var w=t.tracks[y],M=w.ValueTypeName;if(M==="bool"||M==="string")return"continue";var D=e.tracks.find(function(et){return et.name===w.name&&et.ValueTypeName===M});if(D===void 0)return"continue";var P=0,F=w.getValueSize();w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(P=F/3);var C=0,I=D.getValueSize();D.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(C=I/3);var q=w.times.length-1,J=void 0;if(c<=w.times[0]){var Z=P,G=F-P;J=nr.arraySlice(w.values,Z,G)}else if(c>=w.times[q]){var Y=q*F+P,ne=Y+F-P;J=nr.arraySlice(w.values,Y,ne)}else{var se=w.createInterpolant(),Ee=P,Be=F-P;se.evaluate(c),J=nr.arraySlice(se.resultBuffer,Ee,Be)}if(M==="quaternion"){var ce=new Wr().fromArray(J).normalize().conjugate();ce.toArray(J)}for(var oe=D.times.length,ie=0;ie<oe;++ie){var Ce=ie*I+C;if(M==="quaternion")Wr.multiplyQuaternionsFlat(D.values,Ce,J,0,D.values,Ce);else for(var De=I-C*2,Oe=0;Oe<De;++Oe)D.values[Ce+Oe]-=J[Oe]}},d=0;d<o;++d)var m=f(d);return e.blendMode=Zs,e}};function as(e,s,t,a){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=a!==void 0?a:new s.constructor(t),this.sampleValues=s,this.valueSize=t}Object.assign(as.prototype,{evaluate:function(e){var s=this.parameterPositions,t=this._cachedIndex,a=s[t],o=s[t-1];e:{t:{var c;n:{i:if(!(e<a)){for(var f=t+2;;){if(a===void 0){if(e<o)break i;return t=s.length,this._cachedIndex=t,this.afterEnd_(t-1,e,o)}if(t===f)break;if(o=a,a=s[++t],e<a)break t}c=s.length;break n}if(!(e>=o)){var d=s[1];e<d&&(t=2,o=d);for(var m=t-2;;){if(o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(t===m)break;if(a=o,o=s[--t-1],e>=o)break t}c=t,t=0;break n}break e}for(;t<c;){var y=t+c>>>1;e<s[y]?c=y:t=y+1}if(a=s[t],o=s[t-1],o===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,a);if(a===void 0)return t=s.length,this._cachedIndex=t,this.afterEnd_(t-1,o,e)}this._cachedIndex=t,this.intervalChanged_(t,o,a)}return this.interpolate_(t,o,e,a)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var s=this.resultBuffer,t=this.sampleValues,a=this.valueSize,o=0;o!==a;++o)s[o]=t[e*a+o];return s},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(as.prototype,{beforeStart_:as.prototype.copySampleValue_,afterEnd_:as.prototype.copySampleValue_});function Am(e,s,t,a){as.call(this,e,s,t,a),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Am.prototype=Object.assign(Object.create(as.prototype),{constructor:Am,DefaultSettings_:{endingStart:dl,endingEnd:dl},intervalChanged_:function(e,s,t){var a=this.parameterPositions,o=e-2,c=e+1,f=a[o],d=a[c];if(f===void 0)switch(this.getSettings_().endingStart){case Lo:o=e,f=2*s-t;break;case lc:o=a.length-2,f=s+a[o]-a[o+1];break;default:o=e,f=t}if(d===void 0)switch(this.getSettings_().endingEnd){case Lo:c=e,d=2*t-s;break;case lc:c=1,d=t+a[1]-a[0];break;default:c=e-1,d=s}var m=(t-s)*.5,y=this.valueSize;this._weightPrev=m/(s-f),this._weightNext=m/(d-t),this._offsetPrev=o*y,this._offsetNext=c*y},interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=this._offsetPrev,y=this._offsetNext,w=this._weightPrev,M=this._weightNext,D=(t-s)/(a-s),P=D*D,F=P*D,C=0;C!==f;++C)o[C]=(-w*F+2*w*P-w*D)*c[m+C]+((1+w)*F+(-1.5-2*w)*P+(-.5+w)*D+1)*c[d-f+C]+((-1-M)*F+(1.5+M)*P+.5*D)*c[d+C]+(M*F-M*P)*c[y+C];return o}});function Cd(e,s,t,a){as.call(this,e,s,t,a)}Cd.prototype=Object.assign(Object.create(as.prototype),{constructor:Cd,interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=(t-s)/(a-s),y=0;y!==f;++y)o[y]=c[d-f+y]*(1-m)+c[d+y]*m;return o}});function Lm(e,s,t,a){as.call(this,e,s,t,a)}Lm.prototype=Object.assign(Object.create(as.prototype),{constructor:Lm,interpolate_:function(e){return this.copySampleValue_(e-1)}});function ra(e,s,t,a){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(s===void 0||s.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=nr.convertArray(s,this.TimeBufferType),this.values=nr.convertArray(t,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}Object.assign(ra,{toJSON:function(e){var s=e.constructor,t;if(s.toJSON!==void 0)t=s.toJSON(e);else{t={name:e.name,times:nr.convertArray(e.times,Array),values:nr.convertArray(e.values,Array)};var a=e.getInterpolation();a!==e.DefaultInterpolation&&(t.interpolation=a)}return t.type=e.ValueTypeName,t}}),Object.assign(ra.prototype,{constructor:ra,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Kc,InterpolantFactoryMethodDiscrete:function(e){return new Lm(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Cd(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Am(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var s;switch(e){case Jc:s=this.InterpolantFactoryMethodDiscrete;break;case Kc:s=this.InterpolantFactoryMethodLinear;break;case _h:s=this.InterpolantFactoryMethodSmooth;break}if(s===void 0){var t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(t);return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=s,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Jc;case this.InterpolantFactoryMethodLinear:return Kc;case this.InterpolantFactoryMethodSmooth:return _h}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var s=this.times,t=0,a=s.length;t!==a;++t)s[t]+=e;return this},scale:function(e){if(e!==1)for(var s=this.times,t=0,a=s.length;t!==a;++t)s[t]*=e;return this},trim:function(e,s){for(var t=this.times,a=t.length,o=0,c=a-1;o!==a&&t[o]<e;)++o;for(;c!==-1&&t[c]>s;)--c;if(++c,o!==0||c!==a){o>=c&&(c=Math.max(c,1),o=c-1);var f=this.getValueSize();this.times=nr.arraySlice(t,o,c),this.values=nr.arraySlice(this.values,o*f,c*f)}return this},validate:function(){var e=!0,s=this.getValueSize();s-Math.floor(s)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var t=this.times,a=this.values,o=t.length;o===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var c=null,f=0;f!==o;f++){var d=t[f];if(typeof d=="number"&&isNaN(d)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,f,d),e=!1;break}if(c!==null&&c>d){console.error("THREE.KeyframeTrack: Out of order keys.",this,f,d,c),e=!1;break}c=d}if(a!==void 0&&nr.isTypedArray(a))for(var m=0,y=a.length;m!==y;++m){var w=a[m];if(isNaN(w)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,w),e=!1;break}}return e},optimize:function(){for(var e=nr.arraySlice(this.times),s=nr.arraySlice(this.values),t=this.getValueSize(),a=this.getInterpolation()===_h,o=e.length-1,c=1,f=1;f<o;++f){var d=!1,m=e[f],y=e[f+1];if(m!==y&&(f!==1||m!==m[0]))if(a)d=!0;else for(var w=f*t,M=0;M!==t;++M){var D=s[w+M];if(D!==s[w-t+M]||D!==s[w+t+M]){d=!0;break}}if(d){if(f!==c){e[c]=e[f];for(var P=f*t,F=c*t,C=0;C!==t;++C)s[F+C]=s[P+C]}++c}}if(o>0){e[c]=e[o];for(var I=c*t,q=0;q!==t;++q)s[I+q]=s[o*t+q];++c}return c!==e.length?(this.times=nr.arraySlice(e,0,c),this.values=nr.arraySlice(s,0,c*t)):(this.times=e,this.values=s),this},clone:function(){var e=nr.arraySlice(this.times,0),s=nr.arraySlice(this.values,0),t=this.constructor,a=new t(this.name,e,s);return a.createInterpolant=this.createInterpolant,a}});function Rm(e,s,t){ra.call(this,e,s,t)}Rm.prototype=Object.assign(Object.create(ra.prototype),{constructor:Rm,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:Jc,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Cm(e,s,t,a){ra.call(this,e,s,t,a)}Cm.prototype=Object.assign(Object.create(ra.prototype),{constructor:Cm,ValueTypeName:"color"});function qh(e,s,t,a){ra.call(this,e,s,t,a)}qh.prototype=Object.assign(Object.create(ra.prototype),{constructor:qh,ValueTypeName:"number"});function Pm(e,s,t,a){as.call(this,e,s,t,a)}Pm.prototype=Object.assign(Object.create(as.prototype),{constructor:Pm,interpolate_:function(e,s,t,a){for(var o=this.resultBuffer,c=this.sampleValues,f=this.valueSize,d=e*f,m=d+f;d!==m;d+=4)Wr.slerpFlat(o,0,c,d-f,c,d,(t-s)/(a-s));return o}});function Pd(e,s,t,a){ra.call(this,e,s,t,a)}Pd.prototype=Object.assign(Object.create(ra.prototype),{constructor:Pd,ValueTypeName:"quaternion",DefaultInterpolation:Kc,InterpolantFactoryMethodLinear:function(e){return new Pm(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function Im(e,s,t,a){ra.call(this,e,s,t,a)}Im.prototype=Object.assign(Object.create(ra.prototype),{constructor:Im,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:Jc,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Xh(e,s,t,a){ra.call(this,e,s,t,a)}Xh.prototype=Object.assign(Object.create(ra.prototype),{constructor:Xh,ValueTypeName:"vector"});function Ts(e,s,t,a){this.name=e,this.tracks=t,this.duration=s!==void 0?s:-1,this.blendMode=a!==void 0?a:js,this.uuid=Mn.generateUUID(),this.duration<0&&this.resetDuration()}function uR(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return qh;case"vector":case"vector2":case"vector3":case"vector4":return Xh;case"color":return Cm;case"quaternion":return Pd;case"bool":case"boolean":return Rm;case"string":return Im}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function hR(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var s=uR(e.type);if(e.times===void 0){var t=[],a=[];nr.flattenJSON(e.keys,t,a,"value"),e.times=t,e.values=a}return s.parse!==void 0?s.parse(e):new s(e.name,e.times,e.values,e.interpolation)}Object.assign(Ts,{parse:function(e){for(var s=[],t=e.tracks,a=1/(e.fps||1),o=0,c=t.length;o!==c;++o)s.push(hR(t[o]).scale(a));return new Ts(e.name,e.duration,s,e.blendMode)},toJSON:function(e){for(var s=[],t=e.tracks,a={name:e.name,duration:e.duration,tracks:s,uuid:e.uuid,blendMode:e.blendMode},o=0,c=t.length;o!==c;++o)s.push(ra.toJSON(t[o]));return a},CreateFromMorphTargetSequence:function(e,s,t,a){for(var o=s.length,c=[],f=0;f<o;f++){var d=[],m=[];d.push((f+o-1)%o,f,(f+1)%o),m.push(0,1,0);var y=nr.getKeyframeOrder(d);d=nr.sortedArray(d,1,y),m=nr.sortedArray(m,1,y),!a&&d[0]===0&&(d.push(o),m.push(m[0])),c.push(new qh(".morphTargetInfluences["+s[f].name+"]",d,m).scale(1/t))}return new Ts(e,-1,c)},findByName:function(e,s){var t=e;if(!Array.isArray(e)){var a=e;t=a.geometry&&a.geometry.animations||a.animations}for(var o=0;o<t.length;o++)if(t[o].name===s)return t[o];return null},CreateClipsFromMorphTargetSequences:function(e,s,t){for(var a={},o=0,c=e.length;o<c;o++){var f=e[o],d=f.name.match(/^([\w-]*?)([\d]+)$/);if(d&&d.length>1){var m=d[1],y=a[m];y||(a[m]=y=[]),y.push(f)}}var w=[];for(var M in a)w.push(Ts.CreateFromMorphTargetSequence(M,a[M],s,t));return w},parseAnimation:function(e,s){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var t=function(Y,ne,se,Ee,Be){if(se.length!==0){var ce=[],oe=[];nr.flattenJSON(se,ce,oe,Ee),ce.length!==0&&Be.push(new Y(ne,ce,oe))}},a=[],o=e.name||"default",c=e.fps||30,f=e.blendMode,d=e.length||-1,m=e.hierarchy||[],y=0;y<m.length;y++){var w=m[y].keys;if(!(!w||w.length===0))if(w[0].morphTargets){var M={},D=void 0;for(D=0;D<w.length;D++)if(w[D].morphTargets)for(var P=0;P<w[D].morphTargets.length;P++)M[w[D].morphTargets[P]]=-1;for(var F in M){for(var C=[],I=[],q=0;q!==w[D].morphTargets.length;++q){var J=w[D];C.push(J.time),I.push(J.morphTarget===F?1:0)}a.push(new qh(".morphTargetInfluence["+F+"]",C,I))}d=M.length*(c||1)}else{var Z=".bones["+s[y].name+"]";t(Xh,Z+".position",w,"pos",a),t(Pd,Z+".quaternion",w,"rot",a),t(Xh,Z+".scale",w,"scl",a)}}if(a.length===0)return null;var G=new Ts(o,d,a,f);return G}}),Object.assign(Ts.prototype,{resetDuration:function(){for(var e=this.tracks,s=0,t=0,a=e.length;t!==a;++t){var o=this.tracks[t];s=Math.max(s,o.times[o.times.length-1])}return this.duration=s,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,s=0;s<this.tracks.length;s++)e=e&&this.tracks[s].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],s=0;s<this.tracks.length;s++)e.push(this.tracks[s].clone());return new Ts(this.name,this.duration,e,this.blendMode)}});var _u={enabled:!1,files:{},add:function(e,s){this.enabled!==!1&&(this.files[e]=s)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function iy(e,s,t){var a=this,o=!1,c=0,f=0,d=void 0,m=[];this.onStart=void 0,this.onLoad=e,this.onProgress=s,this.onError=t,this.itemStart=function(y){f++,o===!1&&a.onStart!==void 0&&a.onStart(y,c,f),o=!0},this.itemEnd=function(y){c++,a.onProgress!==void 0&&a.onProgress(y,c,f),c===f&&(o=!1,a.onLoad!==void 0&&a.onLoad())},this.itemError=function(y){a.onError!==void 0&&a.onError(y)},this.resolveURL=function(y){return d?d(y):y},this.setURLModifier=function(y){return d=y,this},this.addHandler=function(y,w){return m.push(y,w),this},this.removeHandler=function(y){var w=m.indexOf(y);return w!==-1&&m.splice(w,2),this},this.getHandler=function(y){for(var w=0,M=m.length;w<M;w+=2){var D=m[w],P=m[w+1];if(D.global&&(D.lastIndex=0),D.test(y))return P}return null}}var Hx=new iy;function Pi(e){this.manager=e!==void 0?e:Hx,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Pi.prototype,{load:function(){},loadAsync:function(e,s){var t=this;return new Promise(function(a,o){t.load(e,a,s,o)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var io={};function Es(e){Pi.call(this,e)}Es.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Es,load:function(e,s,t,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=_u.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;if(io[e]!==void 0){io[e].push({onLoad:s,onProgress:t,onError:a});return}var f=e.match(/^data:(.*?)(;base64)?,(.*)$/),d;if(f){var m=f[1],y=!!f[2],w=f[3];w=decodeURIComponent(w),y&&(w=atob(w));try{var M,D=(this.responseType||"").toLowerCase();switch(D){case"arraybuffer":case"blob":for(var P=new Uint8Array(w.length),F=0;F<w.length;F++)P[F]=w.charCodeAt(F);D==="blob"?M=new Blob([P.buffer],{type:m}):M=P.buffer;break;case"document":var C=new DOMParser;M=C.parseFromString(w,m);break;case"json":M=JSON.parse(w);break;default:M=w;break}setTimeout(function(){s&&s(M),o.manager.itemEnd(e)},0)}catch(q){setTimeout(function(){a&&a(q),o.manager.itemError(e),o.manager.itemEnd(e)},0)}}else{io[e]=[],io[e].push({onLoad:s,onProgress:t,onError:a}),d=new XMLHttpRequest,d.open("GET",e,!0),d.addEventListener("load",function(q){var J=this.response,Z=io[e];if(delete io[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),_u.add(e,J);for(var G=0,Y=Z.length;G<Y;G++){var ne=Z[G];ne.onLoad&&ne.onLoad(J)}o.manager.itemEnd(e)}else{for(var se=0,Ee=Z.length;se<Ee;se++){var Be=Z[se];Be.onError&&Be.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)}},!1),d.addEventListener("progress",function(q){for(var J=io[e],Z=0,G=J.length;Z<G;Z++){var Y=J[Z];Y.onProgress&&Y.onProgress(q)}},!1),d.addEventListener("error",function(q){var J=io[e];delete io[e];for(var Z=0,G=J.length;Z<G;Z++){var Y=J[Z];Y.onError&&Y.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),d.addEventListener("abort",function(q){var J=io[e];delete io[e];for(var Z=0,G=J.length;Z<G;Z++){var Y=J[Z];Y.onError&&Y.onError(q)}o.manager.itemError(e),o.manager.itemEnd(e)},!1),this.responseType!==void 0&&(d.responseType=this.responseType),this.withCredentials!==void 0&&(d.withCredentials=this.withCredentials),d.overrideMimeType&&d.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var I in this.requestHeader)d.setRequestHeader(I,this.requestHeader[I]);d.send(null)}return o.manager.itemStart(e),d},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});function ry(e){Pi.call(this,e)}ry.prototype=Object.assign(Object.create(Pi.prototype),{constructor:ry,load:function(e,s,t,a){var o=this,c=new Es(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){for(var s=[],t=0;t<e.length;t++){var a=Ts.parse(e[t]);s.push(a)}return s}});function ay(e){Pi.call(this,e)}ay.prototype=Object.assign(Object.create(Pi.prototype),{constructor:ay,load:function(e,s,t,a){var o=this,c=[],f=new Hh;f.image=c;var d=new Es(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(o.withCredentials);var m=0;function y(D){d.load(e[D],function(P){var F=o.parse(P,!0);c[D]={width:F.width,height:F.height,format:F.format,mipmaps:F.mipmaps},m+=1,m===6&&(F.mipmapCount===1&&(f.minFilter=Dt),f.format=F.format,f.needsUpdate=!0,s&&s(f))},t,a)}if(Array.isArray(e))for(var w=0,M=e.length;w<M;++w)y(w);else d.load(e,function(D){var P=o.parse(D,!0);if(P.isCubemap)for(var F=P.mipmaps.length/P.mipmapCount,C=0;C<F;C++){c[C]={mipmaps:[]};for(var I=0;I<P.mipmapCount;I++)c[C].mipmaps.push(P.mipmaps[C*P.mipmapCount+I]),c[C].format=P.format,c[C].width=P.width,c[C].height=P.height}else f.image.width=P.width,f.image.height=P.height,f.mipmaps=P.mipmaps;P.mipmapCount===1&&(f.minFilter=Dt),f.format=P.format,f.needsUpdate=!0,s&&s(f)},t,a);return f}});function Yh(e){Pi.call(this,e)}Yh.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Yh,load:function(e,s,t,a){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=_u.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;var f=document.createElementNS("http://www.w3.org/1999/xhtml","img");function d(){f.removeEventListener("load",d,!1),f.removeEventListener("error",m,!1),_u.add(e,this),s&&s(this),o.manager.itemEnd(e)}function m(y){f.removeEventListener("load",d,!1),f.removeEventListener("error",m,!1),a&&a(y),o.manager.itemError(e),o.manager.itemEnd(e)}return f.addEventListener("load",d,!1),f.addEventListener("error",m,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(f.crossOrigin=this.crossOrigin),o.manager.itemStart(e),f.src=e,f}});function Dm(e){Pi.call(this,e)}Dm.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Dm,load:function(e,s,t,a){var o=new zo,c=new Yh(this.manager);c.setCrossOrigin(this.crossOrigin),c.setPath(this.path);var f=0;function d(y){c.load(e[y],function(w){o.images[y]=w,f++,f===6&&(o.needsUpdate=!0,s&&s(o))},void 0,a)}for(var m=0;m<e.length;++m)d(m);return o}});function Om(e){Pi.call(this,e)}Om.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Om,load:function(e,s,t,a){var o=this,c=new uu,f=new Es(this.manager);return f.setResponseType("arraybuffer"),f.setRequestHeader(this.requestHeader),f.setPath(this.path),f.setWithCredentials(o.withCredentials),f.load(e,function(d){var m=o.parse(d);!m||(m.image!==void 0?c.image=m.image:m.data!==void 0&&(c.image.width=m.width,c.image.height=m.height,c.image.data=m.data),c.wrapS=m.wrapS!==void 0?m.wrapS:ct,c.wrapT=m.wrapT!==void 0?m.wrapT:ct,c.magFilter=m.magFilter!==void 0?m.magFilter:Dt,c.minFilter=m.minFilter!==void 0?m.minFilter:Dt,c.anisotropy=m.anisotropy!==void 0?m.anisotropy:1,m.format!==void 0&&(c.format=m.format),m.type!==void 0&&(c.type=m.type),m.mipmaps!==void 0&&(c.mipmaps=m.mipmaps,c.minFilter=pi),m.mipmapCount===1&&(c.minFilter=Dt),c.needsUpdate=!0,s&&s(c,m))},t,a),c}});function Nm(e){Pi.call(this,e)}Nm.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Nm,load:function(e,s,t,a){var o=new Ti,c=new Yh(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(e,function(f){o.image=f;var d=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;o.format=d?Ka:re,o.needsUpdate=!0,s!==void 0&&s(o)},t,a),o}});function sn(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(sn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,s){var t=this.getUtoTmapping(e);return this.getPoint(t,s)},getPoints:function(e){e===void 0&&(e=5);for(var s=[],t=0;t<=e;t++)s.push(this.getPoint(t/e));return s},getSpacedPoints:function(e){e===void 0&&(e=5);for(var s=[],t=0;t<=e;t++)s.push(this.getPointAt(t/e));return s},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var s=[],t,a=this.getPoint(0),o=0;s.push(0);for(var c=1;c<=e;c++)t=this.getPoint(c/e),o+=t.distanceTo(a),s.push(o),a=t;return this.cacheArcLengths=s,s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,s){var t=this.getLengths(),a=0,o=t.length,c;s?c=s:c=e*t[o-1];for(var f=0,d=o-1,m;f<=d;)if(a=Math.floor(f+(d-f)/2),m=t[a]-c,m<0)f=a+1;else if(m>0)d=a-1;else{d=a;break}if(a=d,t[a]===c)return a/(o-1);var y=t[a],w=t[a+1],M=(c-y)/(w-y),D=(a+M)/(o-1);return D},getTangent:function(e,s){var t=1e-4,a=e-t,o=e+t;a<0&&(a=0),o>1&&(o=1);var c=this.getPoint(a),f=this.getPoint(o),d=s||(c.isVector2?new _t:new ee);return d.copy(f).sub(c).normalize(),d},getTangentAt:function(e,s){var t=this.getUtoTmapping(e);return this.getTangent(t,s)},computeFrenetFrames:function(e,s){for(var t=new ee,a=[],o=[],c=[],f=new ee,d=new Hn,m=0;m<=e;m++){var y=m/e;a[m]=this.getTangentAt(y,new ee),a[m].normalize()}o[0]=new ee,c[0]=new ee;var w=Number.MAX_VALUE,M=Math.abs(a[0].x),D=Math.abs(a[0].y),P=Math.abs(a[0].z);M<=w&&(w=M,t.set(1,0,0)),D<=w&&(w=D,t.set(0,1,0)),P<=w&&t.set(0,0,1),f.crossVectors(a[0],t).normalize(),o[0].crossVectors(a[0],f),c[0].crossVectors(a[0],o[0]);for(var F=1;F<=e;F++){if(o[F]=o[F-1].clone(),c[F]=c[F-1].clone(),f.crossVectors(a[F-1],a[F]),f.length()>Number.EPSILON){f.normalize();var C=Math.acos(Mn.clamp(a[F-1].dot(a[F]),-1,1));o[F].applyMatrix4(d.makeRotationAxis(f,C))}c[F].crossVectors(a[F],o[F])}if(s===!0){var I=Math.acos(Mn.clamp(o[0].dot(o[e]),-1,1));I/=e,a[0].dot(f.crossVectors(o[0],o[e]))>0&&(I=-I);for(var q=1;q<=e;q++)o[q].applyMatrix4(d.makeRotationAxis(a[q],I*q)),c[q].crossVectors(a[q],o[q])}return{tangents:a,normals:o,binormals:c}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function ss(e,s,t,a,o,c,f,d){sn.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=s||0,this.xRadius=t||1,this.yRadius=a||1,this.aStartAngle=o||0,this.aEndAngle=c||2*Math.PI,this.aClockwise=f||!1,this.aRotation=d||0}ss.prototype=Object.create(sn.prototype),ss.prototype.constructor=ss,ss.prototype.isEllipseCurve=!0,ss.prototype.getPoint=function(e,s){for(var t=s||new _t,a=Math.PI*2,o=this.aEndAngle-this.aStartAngle,c=Math.abs(o)<Number.EPSILON;o<0;)o+=a;for(;o>a;)o-=a;o<Number.EPSILON&&(c?o=0:o=a),this.aClockwise===!0&&!c&&(o===a?o=-a:o=o-a);var f=this.aStartAngle+e*o,d=this.aX+this.xRadius*Math.cos(f),m=this.aY+this.yRadius*Math.sin(f);if(this.aRotation!==0){var y=Math.cos(this.aRotation),w=Math.sin(this.aRotation),M=d-this.aX,D=m-this.aY;d=M*y-D*w+this.aX,m=M*w+D*y+this.aY}return t.set(d,m)},ss.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ss.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},ss.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function jh(e,s,t,a,o,c){ss.call(this,e,s,t,t,a,o,c),this.type="ArcCurve"}jh.prototype=Object.create(ss.prototype),jh.prototype.constructor=jh,jh.prototype.isArcCurve=!0;function sy(){var e=0,s=0,t=0,a=0;function o(c,f,d,m){e=c,s=d,t=-3*c+3*f-2*d-m,a=2*c-2*f+d+m}return{initCatmullRom:function(c,f,d,m,y){o(f,d,y*(d-c),y*(m-f))},initNonuniformCatmullRom:function(c,f,d,m,y,w,M){var D=(f-c)/y-(d-c)/(y+w)+(d-f)/w,P=(d-f)/w-(m-f)/(w+M)+(m-d)/M;D*=w,P*=w,o(f,d,D,P)},calc:function(c){var f=c*c;return e+s*c+t*f+a*(f*c)}}}var Fm=new ee,oy=new sy,ly=new sy,cy=new sy;function ga(e,s,t,a){sn.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=s||!1,this.curveType=t||"centripetal",this.tension=a!==void 0?a:.5}ga.prototype=Object.create(sn.prototype),ga.prototype.constructor=ga,ga.prototype.isCatmullRomCurve3=!0,ga.prototype.getPoint=function(e,s){var t=s||new ee,a=this.points,o=a.length,c=(o-(this.closed?0:1))*e,f=Math.floor(c),d=c-f;this.closed?f+=f>0?0:(Math.floor(Math.abs(f)/o)+1)*o:d===0&&f===o-1&&(f=o-2,d=1);var m,y;this.closed||f>0?m=a[(f-1)%o]:(Fm.subVectors(a[0],a[1]).add(a[0]),m=Fm);var w=a[f%o],M=a[(f+1)%o];if(this.closed||f+2<o?y=a[(f+2)%o]:(Fm.subVectors(a[o-1],a[o-2]).add(a[o-1]),y=Fm),this.curveType==="centripetal"||this.curveType==="chordal"){var D=this.curveType==="chordal"?.5:.25,P=Math.pow(m.distanceToSquared(w),D),F=Math.pow(w.distanceToSquared(M),D),C=Math.pow(M.distanceToSquared(y),D);F<1e-4&&(F=1),P<1e-4&&(P=F),C<1e-4&&(C=F),oy.initNonuniformCatmullRom(m.x,w.x,M.x,y.x,P,F,C),ly.initNonuniformCatmullRom(m.y,w.y,M.y,y.y,P,F,C),cy.initNonuniformCatmullRom(m.z,w.z,M.z,y.z,P,F,C)}else this.curveType==="catmullrom"&&(oy.initCatmullRom(m.x,w.x,M.x,y.x,this.tension),ly.initCatmullRom(m.y,w.y,M.y,y.y,this.tension),cy.initCatmullRom(m.z,w.z,M.z,y.z,this.tension));return t.set(oy.calc(d),ly.calc(d),cy.calc(d)),t},ga.prototype.copy=function(e){sn.prototype.copy.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},ga.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);e.points=[];for(var s=0,t=this.points.length;s<t;s++){var a=this.points[s];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},ga.prototype.fromJSON=function(e){sn.prototype.fromJSON.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(new ee().fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function kx(e,s,t,a,o){var c=(a-s)*.5,f=(o-t)*.5,d=e*e;return(2*t-2*a+c+f)*(e*d)+(-3*t+3*a-2*c-f)*d+c*e+t}function fR(e,s){var t=1-e;return t*t*s}function dR(e,s){return 2*(1-e)*e*s}function pR(e,s){return e*e*s}function Id(e,s,t,a){return fR(e,s)+dR(e,t)+pR(e,a)}function mR(e,s){var t=1-e;return t*t*t*s}function gR(e,s){var t=1-e;return 3*t*t*e*s}function vR(e,s){return 3*(1-e)*e*e*s}function yR(e,s){return e*e*e*s}function Dd(e,s,t,a,o){return mR(e,s)+gR(e,t)+vR(e,a)+yR(e,o)}function ro(e,s,t,a){sn.call(this),this.type="CubicBezierCurve",this.v0=e||new _t,this.v1=s||new _t,this.v2=t||new _t,this.v3=a||new _t}ro.prototype=Object.create(sn.prototype),ro.prototype.constructor=ro,ro.prototype.isCubicBezierCurve=!0,ro.prototype.getPoint=function(e,s){var t=s||new _t,a=this.v0,o=this.v1,c=this.v2,f=this.v3;return t.set(Dd(e,a.x,o.x,c.x,f.x),Dd(e,a.y,o.y,c.y,f.y)),t},ro.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ro.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ro.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Vo(e,s,t,a){sn.call(this),this.type="CubicBezierCurve3",this.v0=e||new ee,this.v1=s||new ee,this.v2=t||new ee,this.v3=a||new ee}Vo.prototype=Object.create(sn.prototype),Vo.prototype.constructor=Vo,Vo.prototype.isCubicBezierCurve3=!0,Vo.prototype.getPoint=function(e,s){var t=s||new ee,a=this.v0,o=this.v1,c=this.v2,f=this.v3;return t.set(Dd(e,a.x,o.x,c.x,f.x),Dd(e,a.y,o.y,c.y,f.y),Dd(e,a.z,o.z,c.z,f.z)),t},Vo.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},Vo.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},Vo.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Fa(e,s){sn.call(this),this.type="LineCurve",this.v1=e||new _t,this.v2=s||new _t}Fa.prototype=Object.create(sn.prototype),Fa.prototype.constructor=Fa,Fa.prototype.isLineCurve=!0,Fa.prototype.getPoint=function(e,s){var t=s||new _t;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},Fa.prototype.getPointAt=function(e,s){return this.getPoint(e,s)},Fa.prototype.getTangent=function(e,s){var t=s||new _t;return t.copy(this.v2).sub(this.v1).normalize(),t},Fa.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Fa.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Fa.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function ao(e,s){sn.call(this),this.type="LineCurve3",this.v1=e||new ee,this.v2=s||new ee}ao.prototype=Object.create(sn.prototype),ao.prototype.constructor=ao,ao.prototype.isLineCurve3=!0,ao.prototype.getPoint=function(e,s){var t=s||new ee;return e===1?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t},ao.prototype.getPointAt=function(e,s){return this.getPoint(e,s)},ao.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},ao.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},ao.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function so(e,s,t){sn.call(this),this.type="QuadraticBezierCurve",this.v0=e||new _t,this.v1=s||new _t,this.v2=t||new _t}so.prototype=Object.create(sn.prototype),so.prototype.constructor=so,so.prototype.isQuadraticBezierCurve=!0,so.prototype.getPoint=function(e,s){var t=s||new _t,a=this.v0,o=this.v1,c=this.v2;return t.set(Id(e,a.x,o.x,c.x),Id(e,a.y,o.y,c.y)),t},so.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},so.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},so.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function Wo(e,s,t){sn.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new ee,this.v1=s||new ee,this.v2=t||new ee}Wo.prototype=Object.create(sn.prototype),Wo.prototype.constructor=Wo,Wo.prototype.isQuadraticBezierCurve3=!0,Wo.prototype.getPoint=function(e,s){var t=s||new ee,a=this.v0,o=this.v1,c=this.v2;return t.set(Id(e,a.x,o.x,c.x),Id(e,a.y,o.y,c.y),Id(e,a.z,o.z,c.z)),t},Wo.prototype.copy=function(e){return sn.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Wo.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Wo.prototype.fromJSON=function(e){return sn.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function oo(e){sn.call(this),this.type="SplineCurve",this.points=e||[]}oo.prototype=Object.create(sn.prototype),oo.prototype.constructor=oo,oo.prototype.isSplineCurve=!0,oo.prototype.getPoint=function(e,s){var t=s||new _t,a=this.points,o=(a.length-1)*e,c=Math.floor(o),f=o-c,d=a[c===0?c:c-1],m=a[c],y=a[c>a.length-2?a.length-1:c+1],w=a[c>a.length-3?a.length-1:c+2];return t.set(kx(f,d.x,m.x,y.x,w.x),kx(f,d.y,m.y,y.y,w.y)),t},oo.prototype.copy=function(e){sn.prototype.copy.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(a.clone())}return this},oo.prototype.toJSON=function(){var e=sn.prototype.toJSON.call(this);e.points=[];for(var s=0,t=this.points.length;s<t;s++){var a=this.points[s];e.points.push(a.toArray())}return e},oo.prototype.fromJSON=function(e){sn.prototype.fromJSON.call(this,e),this.points=[];for(var s=0,t=e.points.length;s<t;s++){var a=e.points[s];this.points.push(new _t().fromArray(a))}return this};var uy=Object.freeze({__proto__:null,ArcCurve:jh,CatmullRomCurve3:ga,CubicBezierCurve:ro,CubicBezierCurve3:Vo,EllipseCurve:ss,LineCurve:Fa,LineCurve3:ao,QuadraticBezierCurve:so,QuadraticBezierCurve3:Wo,SplineCurve:oo});function Ll(){sn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Ll.prototype=Object.assign(Object.create(sn.prototype),{constructor:Ll,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);e.equals(s)||this.curves.push(new Fa(s,e))},getPoint:function(e){for(var s=e*this.getLength(),t=this.getCurveLengths(),a=0;a<t.length;){if(t[a]>=s){var o=t[a]-s,c=this.curves[a],f=c.getLength(),d=f===0?0:1-o/f;return c.getPointAt(d)}a++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],s=0,t=0,a=this.curves.length;t<a;t++)s+=this.curves[t].getLength(),e.push(s);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var s=[],t=0;t<=e;t++)s.push(this.getPoint(t/e));return this.autoClose&&s.push(s[0]),s},getPoints:function(e){e=e||12;for(var s=[],t,a=0,o=this.curves;a<o.length;a++)for(var c=o[a],f=c&&c.isEllipseCurve?e*2:c&&(c.isLineCurve||c.isLineCurve3)?1:c&&c.isSplineCurve?e*c.points.length:e,d=c.getPoints(f),m=0;m<d.length;m++){var y=d[m];t&&t.equals(y)||(s.push(y),t=y)}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s},copy:function(e){sn.prototype.copy.call(this,e),this.curves=[];for(var s=0,t=e.curves.length;s<t;s++){var a=e.curves[s];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=sn.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var s=0,t=this.curves.length;s<t;s++){var a=this.curves[s];e.curves.push(a.toJSON())}return e},fromJSON:function(e){sn.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var s=0,t=e.curves.length;s<t;s++){var a=e.curves[s];this.curves.push(new uy[a.type]().fromJSON(a))}return this}});function lo(e){Ll.call(this),this.type="Path",this.currentPoint=new _t,e&&this.setFromPoints(e)}lo.prototype=Object.assign(Object.create(Ll.prototype),{constructor:lo,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var s=1,t=e.length;s<t;s++)this.lineTo(e[s].x,e[s].y);return this},moveTo:function(e,s){return this.currentPoint.set(e,s),this},lineTo:function(e,s){var t=new Fa(this.currentPoint.clone(),new _t(e,s));return this.curves.push(t),this.currentPoint.set(e,s),this},quadraticCurveTo:function(e,s,t,a){var o=new so(this.currentPoint.clone(),new _t(e,s),new _t(t,a));return this.curves.push(o),this.currentPoint.set(t,a),this},bezierCurveTo:function(e,s,t,a,o,c){var f=new ro(this.currentPoint.clone(),new _t(e,s),new _t(t,a),new _t(o,c));return this.curves.push(f),this.currentPoint.set(o,c),this},splineThru:function(e){var s=[this.currentPoint.clone()].concat(e),t=new oo(s);return this.curves.push(t),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,s,t,a,o,c){var f=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+f,s+d,t,a,o,c),this},absarc:function(e,s,t,a,o,c){return this.absellipse(e,s,t,t,a,o,c),this},ellipse:function(e,s,t,a,o,c,f,d){var m=this.currentPoint.x,y=this.currentPoint.y;return this.absellipse(e+m,s+y,t,a,o,c,f,d),this},absellipse:function(e,s,t,a,o,c,f,d){var m=new ss(e,s,t,a,o,c,f,d);if(this.curves.length>0){var y=m.getPoint(0);y.equals(this.currentPoint)||this.lineTo(y.x,y.y)}this.curves.push(m);var w=m.getPoint(1);return this.currentPoint.copy(w),this},copy:function(e){return Ll.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Ll.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Ll.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function Pc(e){lo.call(this,e),this.uuid=Mn.generateUUID(),this.type="Shape",this.holes=[]}Pc.prototype=Object.assign(Object.create(lo.prototype),{constructor:Pc,getPointsHoles:function(e){for(var s=[],t=0,a=this.holes.length;t<a;t++)s[t]=this.holes[t].getPoints(e);return s},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){lo.prototype.copy.call(this,e),this.holes=[];for(var s=0,t=e.holes.length;s<t;s++){var a=e.holes[s];this.holes.push(a.clone())}return this},toJSON:function(){var e=lo.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var s=0,t=this.holes.length;s<t;s++){var a=this.holes[s];e.holes.push(a.toJSON())}return e},fromJSON:function(e){lo.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var s=0,t=e.holes.length;s<t;s++){var a=e.holes[s];this.holes.push(new lo().fromJSON(a))}return this}});function Zi(e,s){Jt.call(this),this.type="Light",this.color=new qt(e),this.intensity=s!==void 0?s:1}Zi.prototype=Object.assign(Object.create(Jt.prototype),{constructor:Zi,isLight:!0,copy:function(e){return Jt.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var s=Jt.prototype.toJSON.call(this,e);return s.object.color=this.color.getHex(),s.object.intensity=this.intensity,this.groundColor!==void 0&&(s.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(s.object.distance=this.distance),this.angle!==void 0&&(s.object.angle=this.angle),this.decay!==void 0&&(s.object.decay=this.decay),this.penumbra!==void 0&&(s.object.penumbra=this.penumbra),this.shadow!==void 0&&(s.object.shadow=this.shadow.toJSON()),s}});function Bm(e,s,t){Zi.call(this,e,t),this.type="HemisphereLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.groundColor=new qt(s)}Bm.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Bm,isHemisphereLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function Rl(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new _t(512,512),this.map=null,this.mapPass=null,this.matrix=new Hn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new hd,this._frameExtents=new _t(1,1),this._viewportCount=1,this._viewports=[new Ei(0,0,1,1)]}Object.assign(Rl.prototype,{_projScreenMatrix:new Hn,_lightPositionWorld:new ee,_lookTarget:new ee,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var s=this.camera,t=this.matrix,a=this._projScreenMatrix,o=this._lookTarget,c=this._lightPositionWorld;c.setFromMatrixPosition(e.matrixWorld),s.position.copy(c),o.setFromMatrixPosition(e.target.matrixWorld),s.lookAt(o),s.updateMatrixWorld(),a.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a),t.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),t.multiply(s.projectionMatrix),t.multiply(s.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function hy(){Rl.call(this,new Ni(50,1,.5,500)),this.focus=1}hy.prototype=Object.assign(Object.create(Rl.prototype),{constructor:hy,isSpotLightShadow:!0,updateMatrices:function(e){var s=this.camera,t=Mn.RAD2DEG*2*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,o=e.distance||s.far;(t!==s.fov||a!==s.aspect||o!==s.far)&&(s.fov=t,s.aspect=a,s.far=o,s.updateProjectionMatrix()),Rl.prototype.updateMatrices.call(this,e)}});function Um(e,s,t,a,o,c){Zi.call(this,e,s),this.type="SpotLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.target=new Jt,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(f){this.intensity=f/Math.PI}}),this.distance=t!==void 0?t:0,this.angle=a!==void 0?a:Math.PI/3,this.penumbra=o!==void 0?o:0,this.decay=c!==void 0?c:1,this.shadow=new hy}Um.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Um,isSpotLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function fy(){Rl.call(this,new Ni(90,1,.5,500)),this._frameExtents=new _t(4,2),this._viewportCount=6,this._viewports=[new Ei(2,1,1,1),new Ei(0,1,1,1),new Ei(3,1,1,1),new Ei(1,1,1,1),new Ei(3,0,1,1),new Ei(1,0,1,1)],this._cubeDirections=[new ee(1,0,0),new ee(-1,0,0),new ee(0,0,1),new ee(0,0,-1),new ee(0,1,0),new ee(0,-1,0)],this._cubeUps=[new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,1,0),new ee(0,0,1),new ee(0,0,-1)]}fy.prototype=Object.assign(Object.create(Rl.prototype),{constructor:fy,isPointLightShadow:!0,updateMatrices:function(e,s){s===void 0&&(s=0);var t=this.camera,a=this.matrix,o=this._lightPositionWorld,c=this._lookTarget,f=this._projScreenMatrix;o.setFromMatrixPosition(e.matrixWorld),t.position.copy(o),c.copy(t.position),c.add(this._cubeDirections[s]),t.up.copy(this._cubeUps[s]),t.lookAt(c),t.updateMatrixWorld(),a.makeTranslation(-o.x,-o.y,-o.z),f.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(f)}});function Gm(e,s,t,a){Zi.call(this,e,s),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(o){this.intensity=o/(4*Math.PI)}}),this.distance=t!==void 0?t:0,this.decay=a!==void 0?a:1,this.shadow=new fy}Gm.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Gm,isPointLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function Zh(e,s,t,a,o,c){Dr.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=s!==void 0?s:1,this.top=t!==void 0?t:1,this.bottom=a!==void 0?a:-1,this.near=o!==void 0?o:.1,this.far=c!==void 0?c:2e3,this.updateProjectionMatrix()}Zh.prototype=Object.assign(Object.create(Dr.prototype),{constructor:Zh,isOrthographicCamera:!0,copy:function(e,s){return Dr.prototype.copy.call(this,e,s),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,s,t,a,o,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=s,this.view.offsetX=t,this.view.offsetY=a,this.view.width=o,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),t=(this.right+this.left)/2,a=(this.top+this.bottom)/2,o=t-e,c=t+e,f=a+s,d=a-s;if(this.view!==null&&this.view.enabled){var m=(this.right-this.left)/this.view.fullWidth/this.zoom,y=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=m*this.view.offsetX,c=o+m*this.view.width,f-=y*this.view.offsetY,d=f-y*this.view.height}this.projectionMatrix.makeOrthographic(o,c,f,d,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var s=Jt.prototype.toJSON.call(this,e);return s.object.zoom=this.zoom,s.object.left=this.left,s.object.right=this.right,s.object.top=this.top,s.object.bottom=this.bottom,s.object.near=this.near,s.object.far=this.far,this.view!==null&&(s.object.view=Object.assign({},this.view)),s}});function dy(){Rl.call(this,new Zh(-5,5,5,-5,.5,500))}dy.prototype=Object.assign(Object.create(Rl.prototype),{constructor:dy,isDirectionalLightShadow:!0,updateMatrices:function(e){Rl.prototype.updateMatrices.call(this,e)}});function zm(e,s){Zi.call(this,e,s),this.type="DirectionalLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.target=new Jt,this.shadow=new dy}zm.prototype=Object.assign(Object.create(Zi.prototype),{constructor:zm,isDirectionalLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function Hm(e,s){Zi.call(this,e,s),this.type="AmbientLight"}Hm.prototype=Object.assign(Object.create(Zi.prototype),{constructor:Hm,isAmbientLight:!0});function km(e,s,t,a){Zi.call(this,e,s),this.type="RectAreaLight",this.width=t!==void 0?t:10,this.height=a!==void 0?a:10}km.prototype=Object.assign(Object.create(Zi.prototype),{constructor:km,isRectAreaLight:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var s=Zi.prototype.toJSON.call(this,e);return s.object.width=this.width,s.object.height=this.height,s}});var Vx=function(){function e(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new ee)}var s=e.prototype;return s.set=function(t){for(var a=0;a<9;a++)this.coefficients[a].copy(t[a]);return this},s.zero=function(){for(var t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},s.getAt=function(t,a){var o=t.x,c=t.y,f=t.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.282095),a.addScaledVector(d[1],.488603*c),a.addScaledVector(d[2],.488603*f),a.addScaledVector(d[3],.488603*o),a.addScaledVector(d[4],1.092548*(o*c)),a.addScaledVector(d[5],1.092548*(c*f)),a.addScaledVector(d[6],.315392*(3*f*f-1)),a.addScaledVector(d[7],1.092548*(o*f)),a.addScaledVector(d[8],.546274*(o*o-c*c)),a},s.getIrradianceAt=function(t,a){var o=t.x,c=t.y,f=t.z,d=this.coefficients;return a.copy(d[0]).multiplyScalar(.886227),a.addScaledVector(d[1],2*.511664*c),a.addScaledVector(d[2],2*.511664*f),a.addScaledVector(d[3],2*.511664*o),a.addScaledVector(d[4],2*.429043*o*c),a.addScaledVector(d[5],2*.429043*c*f),a.addScaledVector(d[6],.743125*f*f-.247708),a.addScaledVector(d[7],2*.429043*o*f),a.addScaledVector(d[8],.429043*(o*o-c*c)),a},s.add=function(t){for(var a=0;a<9;a++)this.coefficients[a].add(t.coefficients[a]);return this},s.addScaledSH=function(t,a){for(var o=0;o<9;o++)this.coefficients[o].addScaledVector(t.coefficients[o],a);return this},s.scale=function(t){for(var a=0;a<9;a++)this.coefficients[a].multiplyScalar(t);return this},s.lerp=function(t,a){for(var o=0;o<9;o++)this.coefficients[o].lerp(t.coefficients[o],a);return this},s.equals=function(t){for(var a=0;a<9;a++)if(!this.coefficients[a].equals(t.coefficients[a]))return!1;return!0},s.copy=function(t){return this.set(t.coefficients)},s.clone=function(){return new this.constructor().copy(this)},s.fromArray=function(t,a){a===void 0&&(a=0);for(var o=this.coefficients,c=0;c<9;c++)o[c].fromArray(t,a+c*3);return this},s.toArray=function(t,a){t===void 0&&(t=[]),a===void 0&&(a=0);for(var o=this.coefficients,c=0;c<9;c++)o[c].toArray(t,a+c*3);return t},e.getBasisAt=function(t,a){var o=t.x,c=t.y,f=t.z;a[0]=.282095,a[1]=.488603*c,a[2]=.488603*f,a[3]=.488603*o,a[4]=1.092548*o*c,a[5]=1.092548*c*f,a[6]=.315392*(3*f*f-1),a[7]=1.092548*o*f,a[8]=.546274*(o*o-c*c)},e}();function As(e,s){Zi.call(this,void 0,s),this.type="LightProbe",this.sh=e!==void 0?e:new Vx}As.prototype=Object.assign(Object.create(Zi.prototype),{constructor:As,isLightProbe:!0,copy:function(e){return Zi.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){var s=Zi.prototype.toJSON.call(this,e);return s.object.sh=this.sh.toArray(),s}});function Vm(e){Pi.call(this,e),this.textures={}}Vm.prototype=Object.assign(Object.create(Pi.prototype),{constructor:Vm,load:function(e,s,t,a){var o=this,c=new Es(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){var s=this.textures;function t(m){return s[m]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",m),s[m]}var a=new cR[e.type];if(e.uuid!==void 0&&(a.uuid=e.uuid),e.name!==void 0&&(a.name=e.name),e.color!==void 0&&a.color.setHex(e.color),e.roughness!==void 0&&(a.roughness=e.roughness),e.metalness!==void 0&&(a.metalness=e.metalness),e.sheen!==void 0&&(a.sheen=new qt().setHex(e.sheen)),e.emissive!==void 0&&a.emissive.setHex(e.emissive),e.specular!==void 0&&a.specular.setHex(e.specular),e.shininess!==void 0&&(a.shininess=e.shininess),e.clearcoat!==void 0&&(a.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(a.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(a.fog=e.fog),e.flatShading!==void 0&&(a.flatShading=e.flatShading),e.blending!==void 0&&(a.blending=e.blending),e.combine!==void 0&&(a.combine=e.combine),e.side!==void 0&&(a.side=e.side),e.opacity!==void 0&&(a.opacity=e.opacity),e.transparent!==void 0&&(a.transparent=e.transparent),e.alphaTest!==void 0&&(a.alphaTest=e.alphaTest),e.depthTest!==void 0&&(a.depthTest=e.depthTest),e.depthWrite!==void 0&&(a.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(a.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(a.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(a.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(a.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(a.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(a.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(a.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(a.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(a.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(a.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(a.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(a.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(a.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(a.rotation=e.rotation),e.linewidth!==1&&(a.linewidth=e.linewidth),e.dashSize!==void 0&&(a.dashSize=e.dashSize),e.gapSize!==void 0&&(a.gapSize=e.gapSize),e.scale!==void 0&&(a.scale=e.scale),e.polygonOffset!==void 0&&(a.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(a.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(a.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(a.skinning=e.skinning),e.morphTargets!==void 0&&(a.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(a.morphNormals=e.morphNormals),e.dithering!==void 0&&(a.dithering=e.dithering),e.vertexTangents!==void 0&&(a.vertexTangents=e.vertexTangents),e.visible!==void 0&&(a.visible=e.visible),e.toneMapped!==void 0&&(a.toneMapped=e.toneMapped),e.userData!==void 0&&(a.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?a.vertexColors=e.vertexColors>0:a.vertexColors=e.vertexColors),e.uniforms!==void 0)for(var o in e.uniforms){var c=e.uniforms[o];switch(a.uniforms[o]={},c.type){case"t":a.uniforms[o].value=t(c.value);break;case"c":a.uniforms[o].value=new qt().setHex(c.value);break;case"v2":a.uniforms[o].value=new _t().fromArray(c.value);break;case"v3":a.uniforms[o].value=new ee().fromArray(c.value);break;case"v4":a.uniforms[o].value=new Ei().fromArray(c.value);break;case"m3":a.uniforms[o].value=new ta().fromArray(c.value);break;case"m4":a.uniforms[o].value=new Hn().fromArray(c.value);break;default:a.uniforms[o].value=c.value}}if(e.defines!==void 0&&(a.defines=e.defines),e.vertexShader!==void 0&&(a.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(a.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var f in e.extensions)a.extensions[f]=e.extensions[f];if(e.shading!==void 0&&(a.flatShading=e.shading===1),e.size!==void 0&&(a.size=e.size),e.sizeAttenuation!==void 0&&(a.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(a.map=t(e.map)),e.matcap!==void 0&&(a.matcap=t(e.matcap)),e.alphaMap!==void 0&&(a.alphaMap=t(e.alphaMap)),e.bumpMap!==void 0&&(a.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(a.bumpScale=e.bumpScale),e.normalMap!==void 0&&(a.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(a.normalMapType=e.normalMapType),e.normalScale!==void 0){var d=e.normalScale;Array.isArray(d)===!1&&(d=[d,d]),a.normalScale=new _t().fromArray(d)}return e.displacementMap!==void 0&&(a.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(a.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(a.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(a.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(a.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(a.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(a.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(a.specularMap=t(e.specularMap)),e.envMap!==void 0&&(a.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(a.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(a.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(a.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(a.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(a.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(a.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(a.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(a.gradientMap=t(e.gradientMap)),e.clearcoatMap!==void 0&&(a.clearcoatMap=t(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(a.clearcoatRoughnessMap=t(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(a.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(a.clearcoatNormalScale=new _t().fromArray(e.clearcoatNormalScale)),e.transmission!==void 0&&(a.transmission=e.transmission),e.transmissionMap!==void 0&&(a.transmissionMap=t(e.transmissionMap)),a},setTextures:function(e){return this.textures=e,this}});var py={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var s="",t=0,a=e.length;t<a;t++)s+=String.fromCharCode(e[t]);try{return decodeURIComponent(escape(s))}catch{return s}},extractUrlBase:function(e){var s=e.lastIndexOf("/");return s===-1?"./":e.substr(0,s+1)}};function Od(){Ae.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Od.prototype=Object.assign(Object.create(Ae.prototype),{constructor:Od,isInstancedBufferGeometry:!0,copy:function(e){return Ae.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=Ae.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}});function Wm(e,s,t,a){typeof t=="number"&&(a=t,t=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),fn.call(this,e,s,t),this.meshPerAttribute=a||1}Wm.prototype=Object.assign(Object.create(fn.prototype),{constructor:Wm,isInstancedBufferAttribute:!0,copy:function(e){return fn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=fn.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function qm(e){Pi.call(this,e)}qm.prototype=Object.assign(Object.create(Pi.prototype),{constructor:qm,load:function(e,s,t,a){var o=this,c=new Es(o.manager);c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{s(o.parse(JSON.parse(f)))}catch(d){a?a(d):console.error(d),o.manager.itemError(e)}},t,a)},parse:function(e){var s={},t={};function a(et,mt){if(s[mt]!==void 0)return s[mt];var dt=et.interleavedBuffers,ot=dt[mt],Mt=o(et,ot.buffer),zt=new Xm[ot.type](Mt),Bt=new rs(zt,ot.stride);return Bt.uuid=ot.uuid,s[mt]=Bt,Bt}function o(et,mt){if(t[mt]!==void 0)return t[mt];var dt=et.arrayBuffers,ot=dt[mt],Mt=new Uint32Array(ot).buffer;return t[mt]=Mt,Mt}var c=e.isInstancedBufferGeometry?new Od:new Ae,f=e.data.index;if(f!==void 0){var d=new Xm[f.type](f.array);c.setIndex(new fn(d,1))}var m=e.data.attributes;for(var y in m){var w=m[y],M=void 0;if(w.isInterleavedBufferAttribute){var D=a(e.data,w.data);M=new Ec(D,w.itemSize,w.offset,w.normalized)}else{var P=new Xm[w.type](w.array),F=w.isInstancedBufferAttribute?Wm:fn;M=new F(P,w.itemSize,w.normalized)}w.name!==void 0&&(M.name=w.name),c.setAttribute(y,M)}var C=e.data.morphAttributes;if(C)for(var I in C){for(var q=C[I],J=[],Z=0,G=q.length;Z<G;Z++){var Y=q[Z],ne=void 0;if(Y.isInterleavedBufferAttribute){var se=a(e.data,Y.data);ne=new Ec(se,Y.itemSize,Y.offset,Y.normalized)}else{var Ee=new Xm[Y.type](Y.array);ne=new fn(Ee,Y.itemSize,Y.normalized)}Y.name!==void 0&&(ne.name=Y.name),J.push(ne)}c.morphAttributes[I]=J}var Be=e.data.morphTargetsRelative;Be&&(c.morphTargetsRelative=!0);var ce=e.data.groups||e.data.drawcalls||e.data.offsets;if(ce!==void 0)for(var oe=0,ie=ce.length;oe!==ie;++oe){var Ce=ce[oe];c.addGroup(Ce.start,Ce.count,Ce.materialIndex)}var De=e.data.boundingSphere;if(De!==void 0){var Oe=new ee;De.center!==void 0&&Oe.fromArray(De.center),c.boundingSphere=new da(Oe,De.radius)}return e.name&&(c.name=e.name),e.userData&&(c.userData=e.userData),c}});var Xm={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},_R=function(e){Qt(s,e);function s(a){return e.call(this,a)||this}var t=s.prototype;return t.load=function(a,o,c,f){var d=this,m=this.path===""?py.extractUrlBase(a):this.path;this.resourcePath=this.resourcePath||m;var y=new Es(this.manager);y.setPath(this.path),y.setRequestHeader(this.requestHeader),y.setWithCredentials(this.withCredentials),y.load(a,function(w){var M=null;try{M=JSON.parse(w)}catch(P){f!==void 0&&f(P),console.error("THREE:ObjectLoader: Can't parse "+a+".",P.message);return}var D=M.metadata;if(D===void 0||D.type===void 0||D.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+a);return}d.parse(M,o)},c,f)},t.parse=function(a,o){var c=this.parseShape(a.shapes),f=this.parseGeometries(a.geometries,c),d=this.parseImages(a.images,function(){o!==void 0&&o(w)}),m=this.parseTextures(a.textures,d),y=this.parseMaterials(a.materials,m),w=this.parseObject(a.object,f,y);return a.animations&&(w.animations=this.parseAnimations(a.animations)),(a.images===void 0||a.images.length===0)&&o!==void 0&&o(w),w},t.parseShape=function(a){var o={};if(a!==void 0)for(var c=0,f=a.length;c<f;c++){var d=new Pc().fromJSON(a[c]);o[d.uuid]=d}return o},t.parseGeometries=function(a,o){var c={},f;if(a!==void 0)for(var d=new qm,m=0,y=a.length;m<y;m++){var w=void 0,M=a[m];switch(M.type){case"PlaneGeometry":case"PlaneBufferGeometry":w=new Ea[M.type](M.width,M.height,M.widthSegments,M.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":w=new Ea[M.type](M.width,M.height,M.depth,M.widthSegments,M.heightSegments,M.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":w=new Ea[M.type](M.radius,M.segments,M.thetaStart,M.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":w=new Ea[M.type](M.radiusTop,M.radiusBottom,M.height,M.radialSegments,M.heightSegments,M.openEnded,M.thetaStart,M.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":w=new Ea[M.type](M.radius,M.height,M.radialSegments,M.heightSegments,M.openEnded,M.thetaStart,M.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":w=new Ea[M.type](M.radius,M.widthSegments,M.heightSegments,M.phiStart,M.phiLength,M.thetaStart,M.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":w=new Ea[M.type](M.radius,M.detail);break;case"RingGeometry":case"RingBufferGeometry":w=new Ea[M.type](M.innerRadius,M.outerRadius,M.thetaSegments,M.phiSegments,M.thetaStart,M.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":w=new Ea[M.type](M.radius,M.tube,M.radialSegments,M.tubularSegments,M.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":w=new Ea[M.type](M.radius,M.tube,M.tubularSegments,M.radialSegments,M.p,M.q);break;case"TubeGeometry":case"TubeBufferGeometry":w=new Ea[M.type](new uy[M.path.type]().fromJSON(M.path),M.tubularSegments,M.radius,M.radialSegments,M.closed);break;case"LatheGeometry":case"LatheBufferGeometry":w=new Ea[M.type](M.points,M.segments,M.phiStart,M.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":w=new Ea[M.type](M.vertices,M.indices,M.radius,M.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":f=[];for(var D=0,P=M.shapes.length;D<P;D++){var F=o[M.shapes[D]];f.push(F)}w=new Ea[M.type](f,M.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":f=[];for(var C=0,I=M.shapes.length;C<I;C++){var q=o[M.shapes[C]];f.push(q)}var J=M.options.extrudePath;J!==void 0&&(M.options.extrudePath=new uy[J.type]().fromJSON(J)),w=new Ea[M.type](f,M.options);break;case"BufferGeometry":case"InstancedBufferGeometry":w=d.parse(M);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+M.type+'"');continue}w.uuid=M.uuid,M.name!==void 0&&(w.name=M.name),w.isBufferGeometry===!0&&M.userData!==void 0&&(w.userData=M.userData),c[M.uuid]=w}return c},t.parseMaterials=function(a,o){var c={},f={};if(a!==void 0){var d=new Vm;d.setTextures(o);for(var m=0,y=a.length;m<y;m++){var w=a[m];if(w.type==="MultiMaterial"){for(var M=[],D=0;D<w.materials.length;D++){var P=w.materials[D];c[P.uuid]===void 0&&(c[P.uuid]=d.parse(P)),M.push(c[P.uuid])}f[w.uuid]=M}else c[w.uuid]===void 0&&(c[w.uuid]=d.parse(w)),f[w.uuid]=c[w.uuid]}}return f},t.parseAnimations=function(a){for(var o=[],c=0;c<a.length;c++){var f=a[c],d=Ts.parse(f);f.uuid!==void 0&&(d.uuid=f.uuid),o.push(d)}return o},t.parseImages=function(a,o){var c=this,f={},d;function m(Z){return c.manager.itemStart(Z),d.load(Z,function(){c.manager.itemEnd(Z)},void 0,function(){c.manager.itemError(Z),c.manager.itemEnd(Z)})}if(a!==void 0&&a.length>0){var y=new iy(o);d=new Yh(y),d.setCrossOrigin(this.crossOrigin);for(var w=0,M=a.length;w<M;w++){var D=a[w],P=D.url;if(Array.isArray(P)){f[D.uuid]=[];for(var F=0,C=P.length;F<C;F++){var I=P[F],q=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(I)?I:c.resourcePath+I;f[D.uuid].push(m(q))}}else{var J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(D.url)?D.url:c.resourcePath+D.url;f[D.uuid]=m(J)}}}return f},t.parseTextures=function(a,o){function c(M,D){return typeof M=="number"?M:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",M),D[M])}var f={};if(a!==void 0)for(var d=0,m=a.length;d<m;d++){var y=a[d];y.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',y.uuid),o[y.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",y.image);var w=void 0;Array.isArray(o[y.image])?w=new zo(o[y.image]):w=new Ti(o[y.image]),w.needsUpdate=!0,w.uuid=y.uuid,y.name!==void 0&&(w.name=y.name),y.mapping!==void 0&&(w.mapping=c(y.mapping,xR)),y.offset!==void 0&&w.offset.fromArray(y.offset),y.repeat!==void 0&&w.repeat.fromArray(y.repeat),y.center!==void 0&&w.center.fromArray(y.center),y.rotation!==void 0&&(w.rotation=y.rotation),y.wrap!==void 0&&(w.wrapS=c(y.wrap[0],Wx),w.wrapT=c(y.wrap[1],Wx)),y.format!==void 0&&(w.format=y.format),y.type!==void 0&&(w.type=y.type),y.encoding!==void 0&&(w.encoding=y.encoding),y.minFilter!==void 0&&(w.minFilter=c(y.minFilter,qx)),y.magFilter!==void 0&&(w.magFilter=c(y.magFilter,qx)),y.anisotropy!==void 0&&(w.anisotropy=y.anisotropy),y.flipY!==void 0&&(w.flipY=y.flipY),y.premultiplyAlpha!==void 0&&(w.premultiplyAlpha=y.premultiplyAlpha),y.unpackAlignment!==void 0&&(w.unpackAlignment=y.unpackAlignment),f[y.uuid]=w}return f},t.parseObject=function(a,o,c){var f;function d(Z){return o[Z]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",Z),o[Z]}function m(Z){if(Z!==void 0){if(Array.isArray(Z)){for(var G=[],Y=0,ne=Z.length;Y<ne;Y++){var se=Z[Y];c[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",se),G.push(c[se])}return G}return c[Z]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Z),c[Z]}}var y,w;switch(a.type){case"Scene":f=new Cv,a.background!==void 0&&Number.isInteger(a.background)&&(f.background=new qt(a.background)),a.fog!==void 0&&(a.fog.type==="Fog"?f.fog=new ox(a.fog.color,a.fog.near,a.fog.far):a.fog.type==="FogExp2"&&(f.fog=new sx(a.fog.color,a.fog.density)));break;case"PerspectiveCamera":f=new Ni(a.fov,a.aspect,a.near,a.far),a.focus!==void 0&&(f.focus=a.focus),a.zoom!==void 0&&(f.zoom=a.zoom),a.filmGauge!==void 0&&(f.filmGauge=a.filmGauge),a.filmOffset!==void 0&&(f.filmOffset=a.filmOffset),a.view!==void 0&&(f.view=Object.assign({},a.view));break;case"OrthographicCamera":f=new Zh(a.left,a.right,a.top,a.bottom,a.near,a.far),a.zoom!==void 0&&(f.zoom=a.zoom),a.view!==void 0&&(f.view=Object.assign({},a.view));break;case"AmbientLight":f=new Hm(a.color,a.intensity);break;case"DirectionalLight":f=new zm(a.color,a.intensity);break;case"PointLight":f=new Gm(a.color,a.intensity,a.distance,a.decay);break;case"RectAreaLight":f=new km(a.color,a.intensity,a.width,a.height);break;case"SpotLight":f=new Um(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":f=new Bm(a.color,a.groundColor,a.intensity);break;case"LightProbe":f=new As().fromJSON(a);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":y=d(a.geometry),w=m(a.material),f=new Fn(y,w);break;case"InstancedMesh":y=d(a.geometry),w=m(a.material);var M=a.count,D=a.instanceMatrix;f=new hm(y,w,M),f.instanceMatrix=new fn(new Float32Array(D.array),16);break;case"LOD":f=new xd;break;case"Line":f=new Ss(d(a.geometry),m(a.material),a.mode);break;case"LineLoop":f=new gm(d(a.geometry),m(a.material));break;case"LineSegments":f=new Ta(d(a.geometry),m(a.material));break;case"PointCloud":case"Points":f=new zh(d(a.geometry),m(a.material));break;case"Sprite":f=new _d(m(a.material));break;case"Group":f=new Tc;break;default:f=new Jt}if(f.uuid=a.uuid,a.name!==void 0&&(f.name=a.name),a.matrix!==void 0?(f.matrix.fromArray(a.matrix),a.matrixAutoUpdate!==void 0&&(f.matrixAutoUpdate=a.matrixAutoUpdate),f.matrixAutoUpdate&&f.matrix.decompose(f.position,f.quaternion,f.scale)):(a.position!==void 0&&f.position.fromArray(a.position),a.rotation!==void 0&&f.rotation.fromArray(a.rotation),a.quaternion!==void 0&&f.quaternion.fromArray(a.quaternion),a.scale!==void 0&&f.scale.fromArray(a.scale)),a.castShadow!==void 0&&(f.castShadow=a.castShadow),a.receiveShadow!==void 0&&(f.receiveShadow=a.receiveShadow),a.shadow&&(a.shadow.bias!==void 0&&(f.shadow.bias=a.shadow.bias),a.shadow.normalBias!==void 0&&(f.shadow.normalBias=a.shadow.normalBias),a.shadow.radius!==void 0&&(f.shadow.radius=a.shadow.radius),a.shadow.mapSize!==void 0&&f.shadow.mapSize.fromArray(a.shadow.mapSize),a.shadow.camera!==void 0&&(f.shadow.camera=this.parseObject(a.shadow.camera))),a.visible!==void 0&&(f.visible=a.visible),a.frustumCulled!==void 0&&(f.frustumCulled=a.frustumCulled),a.renderOrder!==void 0&&(f.renderOrder=a.renderOrder),a.userData!==void 0&&(f.userData=a.userData),a.layers!==void 0&&(f.layers.mask=a.layers),a.children!==void 0)for(var P=a.children,F=0;F<P.length;F++)f.add(this.parseObject(P[F],o,c));if(a.type==="LOD"){a.autoUpdate!==void 0&&(f.autoUpdate=a.autoUpdate);for(var C=a.levels,I=0;I<C.length;I++){var q=C[I],J=f.getObjectByProperty("uuid",q.object);J!==void 0&&f.addLevel(J,q.distance)}}return f},t.setTexturePath=function(a){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(a)},s}(Pi),xR={UVMapping:$,CubeReflectionMapping:j,CubeRefractionMapping:He,EquirectangularReflectionMapping:Ge,EquirectangularRefractionMapping:ue,CubeUVReflectionMapping:Je,CubeUVRefractionMapping:lt},Wx={RepeatWrapping:Nt,ClampToEdgeWrapping:ct,MirroredRepeatWrapping:me},qx={NearestFilter:it,NearestMipmapNearestFilter:Lt,NearestMipmapLinearFilter:pt,LinearFilter:Dt,LinearMipmapNearestFilter:cn,LinearMipmapLinearFilter:pi};function my(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Pi.call(this,e),this.options={premultiplyAlpha:"none"}}my.prototype=Object.assign(Object.create(Pi.prototype),{constructor:my,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,s,t,a){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,c=_u.get(e);if(c!==void 0)return o.manager.itemStart(e),setTimeout(function(){s&&s(c),o.manager.itemEnd(e)},0),c;var f={};f.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(e,f).then(function(d){return d.blob()}).then(function(d){return createImageBitmap(d,o.options)}).then(function(d){_u.add(e,d),s&&s(d),o.manager.itemEnd(e)}).catch(function(d){a&&a(d),o.manager.itemError(e),o.manager.itemEnd(e)}),o.manager.itemStart(e)}});function gy(){this.type="ShapePath",this.color=new qt,this.subPaths=[],this.currentPath=null}Object.assign(gy.prototype,{moveTo:function(e,s){return this.currentPath=new lo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,s),this},lineTo:function(e,s){return this.currentPath.lineTo(e,s),this},quadraticCurveTo:function(e,s,t,a){return this.currentPath.quadraticCurveTo(e,s,t,a),this},bezierCurveTo:function(e,s,t,a,o,c){return this.currentPath.bezierCurveTo(e,s,t,a,o,c),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,s){function t(dt){for(var ot=[],Mt=0,zt=dt.length;Mt<zt;Mt++){var Bt=dt[Mt],en=new Pc;en.curves=Bt.curves,ot.push(en)}return ot}function a(dt,ot){for(var Mt=ot.length,zt=!1,Bt=Mt-1,en=0;en<Mt;Bt=en++){var on=ot[Bt],ft=ot[en],Bn=ft.x-on.x,Rn=ft.y-on.y;if(Math.abs(Rn)>Number.EPSILON){if(Rn<0&&(on=ot[en],Bn=-Bn,ft=ot[Bt],Rn=-Rn),dt.y<on.y||dt.y>ft.y)continue;if(dt.y===on.y){if(dt.x===on.x)return!0}else{var mn=Rn*(dt.x-on.x)-Bn*(dt.y-on.y);if(mn===0)return!0;if(mn<0)continue;zt=!zt}}else{if(dt.y!==on.y)continue;if(ft.x<=dt.x&&dt.x<=on.x||on.x<=dt.x&&dt.x<=ft.x)return!0}}return zt}var o=El.isClockWise,c=this.subPaths;if(c.length===0)return[];if(s===!0)return t(c);var f,d,m,y=[];if(c.length===1)return d=c[0],m=new Pc,m.curves=d.curves,y.push(m),y;var w=!o(c[0].getPoints());w=e?!w:w;var M=[],D=[],P=[],F=0,C;D[F]=void 0,P[F]=[];for(var I=0,q=c.length;I<q;I++)d=c[I],C=d.getPoints(),f=o(C),f=e?!f:f,f?(!w&&D[F]&&F++,D[F]={s:new Pc,p:C},D[F].s.curves=d.curves,w&&F++,P[F]=[]):P[F].push({h:d,p:C[0]});if(!D[0])return t(c);if(D.length>1){for(var J=!1,Z=[],G=0,Y=D.length;G<Y;G++)M[G]=[];for(var ne=0,se=D.length;ne<se;ne++)for(var Ee=P[ne],Be=0;Be<Ee.length;Be++){for(var ce=Ee[Be],oe=!0,ie=0;ie<D.length;ie++)a(ce.p,D[ie].p)&&(ne!==ie&&Z.push({froms:ne,tos:ie,hole:Be}),oe?(oe=!1,M[ie].push(ce)):J=!0);oe&&M[ne].push(ce)}Z.length>0&&(J||(P=M))}for(var Ce,De=0,Oe=D.length;De<Oe;De++){m=D[De].s,y.push(m),Ce=P[De];for(var et=0,mt=Ce.length;et<mt;et++)m.holes.push(Ce[et].h)}return y}});function vy(e){this.type="Font",this.data=e}Object.assign(vy.prototype,{isFont:!0,generateShapes:function(e,s){s===void 0&&(s=100);for(var t=[],a=bR(e,s,this.data),o=0,c=a.length;o<c;o++)Array.prototype.push.apply(t,a[o].toShapes());return t}});function bR(e,s,t){for(var a=Array.from?Array.from(e):String(e).split(""),o=s/t.resolution,c=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*o,f=[],d=0,m=0,y=0;y<a.length;y++){var w=a[y];if(w===`
`)d=0,m-=c;else{var M=wR(w,o,d,m,t);d+=M.offsetX,f.push(M.path)}}return f}function wR(e,s,t,a,o){var c=o.glyphs[e]||o.glyphs["?"];if(!c){console.error('THREE.Font: character "'+e+'" does not exists in font family '+o.familyName+".");return}var f=new gy,d,m,y,w,M,D,P,F;if(c.o)for(var C=c._cachedOutline||(c._cachedOutline=c.o.split(" ")),I=0,q=C.length;I<q;){var J=C[I++];switch(J){case"m":d=C[I++]*s+t,m=C[I++]*s+a,f.moveTo(d,m);break;case"l":d=C[I++]*s+t,m=C[I++]*s+a,f.lineTo(d,m);break;case"q":y=C[I++]*s+t,w=C[I++]*s+a,M=C[I++]*s+t,D=C[I++]*s+a,f.quadraticCurveTo(M,D,y,w);break;case"b":y=C[I++]*s+t,w=C[I++]*s+a,M=C[I++]*s+t,D=C[I++]*s+a,P=C[I++]*s+t,F=C[I++]*s+a,f.bezierCurveTo(M,D,P,F,y,w);break}}return{offsetX:c.ha*s,path:f}}function yy(e){Pi.call(this,e)}yy.prototype=Object.assign(Object.create(Pi.prototype),{constructor:yy,load:function(e,s,t,a){var o=this,c=new Es(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){var d;try{d=JSON.parse(f)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),d=JSON.parse(f.substring(65,f.length-2))}var m=o.parse(d);s&&s(m)},t,a)},parse:function(e){return new vy(e)}});var Ym,_y={getContext:function(){return Ym===void 0&&(Ym=new(window.AudioContext||window.webkitAudioContext)),Ym},setContext:function(e){Ym=e}};function jm(e){Pi.call(this,e)}jm.prototype=Object.assign(Object.create(Pi.prototype),{constructor:jm,load:function(e,s,t,a){var o=this,c=new Es(o.manager);c.setResponseType("arraybuffer"),c.setPath(o.path),c.setRequestHeader(o.requestHeader),c.setWithCredentials(o.withCredentials),c.load(e,function(f){try{var d=f.slice(0),m=_y.getContext();m.decodeAudioData(d,function(y){s(y)})}catch(y){a?a(y):console.error(y),o.manager.itemError(e)}},t,a)}});function xy(e,s,t){As.call(this,void 0,t);var a=new qt().set(e),o=new qt().set(s),c=new ee(a.r,a.g,a.b),f=new ee(o.r,o.g,o.b),d=Math.sqrt(Math.PI),m=d*Math.sqrt(.75);this.sh.coefficients[0].copy(c).add(f).multiplyScalar(d),this.sh.coefficients[1].copy(c).sub(f).multiplyScalar(m)}xy.prototype=Object.assign(Object.create(As.prototype),{constructor:xy,isHemisphereLightProbe:!0,copy:function(e){return As.prototype.copy.call(this,e),this},toJSON:function(e){var s=As.prototype.toJSON.call(this,e);return s}});function by(e,s){As.call(this,void 0,s);var t=new qt().set(e);this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}by.prototype=Object.assign(Object.create(As.prototype),{constructor:by,isAmbientLightProbe:!0,copy:function(e){return As.prototype.copy.call(this,e),this},toJSON:function(e){var s=As.prototype.toJSON.call(this,e);return s}});var Xx=new Hn,Yx=new Hn;function jx(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ni,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ni,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(jx.prototype,{update:function(e){var s=this._cache,t=s.focus!==e.focus||s.fov!==e.fov||s.aspect!==e.aspect*this.aspect||s.near!==e.near||s.far!==e.far||s.zoom!==e.zoom||s.eyeSep!==this.eyeSep;if(t){s.focus=e.focus,s.fov=e.fov,s.aspect=e.aspect*this.aspect,s.near=e.near,s.far=e.far,s.zoom=e.zoom,s.eyeSep=this.eyeSep;var a=e.projectionMatrix.clone(),o=s.eyeSep/2,c=o*s.near/s.focus,f=s.near*Math.tan(Mn.DEG2RAD*s.fov*.5)/s.zoom,d,m;Yx.elements[12]=-o,Xx.elements[12]=o,d=-f*s.aspect+c,m=f*s.aspect+c,a.elements[0]=2*s.near/(m-d),a.elements[8]=(m+d)/(m-d),this.cameraL.projectionMatrix.copy(a),d=-f*s.aspect-c,m=f*s.aspect-c,a.elements[0]=2*s.near/(m-d),a.elements[8]=(m+d)/(m-d),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Yx),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Xx)}});var Zx=function(){function e(t){this.autoStart=t!==void 0?t:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}var s=e.prototype;return s.start=function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},s.stop=function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},s.getElapsedTime=function(){return this.getDelta(),this.elapsedTime},s.getDelta=function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var a=(typeof performance>"u"?Date:performance).now();t=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=t}return t},e}(),xu=new ee,Jx=new Wr,MR=new ee,bu=new ee,SR=function(e){Qt(s,e);function s(){var a=e.call(this)||this;return a.type="AudioListener",a.context=_y.getContext(),a.gain=a.context.createGain(),a.gain.connect(a.context.destination),a.filter=null,a.timeDelta=0,a._clock=new Zx,a}var t=s.prototype;return t.getInput=function(){return this.gain},t.removeFilter=function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},t.getFilter=function(){return this.filter},t.setFilter=function(a){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=a,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},t.getMasterVolume=function(){return this.gain.gain.value},t.setMasterVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},t.updateMatrixWorld=function(a){e.prototype.updateMatrixWorld.call(this,a);var o=this.context.listener,c=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(xu,Jx,MR),bu.set(0,0,-1).applyQuaternion(Jx),o.positionX){var f=this.context.currentTime+this.timeDelta;o.positionX.linearRampToValueAtTime(xu.x,f),o.positionY.linearRampToValueAtTime(xu.y,f),o.positionZ.linearRampToValueAtTime(xu.z,f),o.forwardX.linearRampToValueAtTime(bu.x,f),o.forwardY.linearRampToValueAtTime(bu.y,f),o.forwardZ.linearRampToValueAtTime(bu.z,f),o.upX.linearRampToValueAtTime(c.x,f),o.upY.linearRampToValueAtTime(c.y,f),o.upZ.linearRampToValueAtTime(c.z,f)}else o.setPosition(xu.x,xu.y,xu.z),o.setOrientation(bu.x,bu.y,bu.z,c.x,c.y,c.z)},s}(Jt),wy=function(e){Qt(s,e);function s(a){var o=e.call(this)||this;return o.type="Audio",o.listener=a,o.context=a.context,o.gain=o.context.createGain(),o.gain.connect(a.getInput()),o.autoplay=!1,o.buffer=null,o.detune=0,o.loop=!1,o.loopStart=0,o.loopEnd=0,o.offset=0,o.duration=void 0,o.playbackRate=1,o.isPlaying=!1,o.hasPlaybackControl=!0,o.source=null,o.sourceType="empty",o._startedAt=0,o._progress=0,o._connected=!1,o.filters=[],o}var t=s.prototype;return t.getOutput=function(){return this.gain},t.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},t.setMediaElementSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(a),this.connect(),this},t.setMediaStreamSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(a),this.connect(),this},t.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",this.autoplay&&this.play(),this},t.play=function(a){if(a===void 0&&(a=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+a;var o=this.context.createBufferSource();return o.buffer=this.buffer,o.loop=this.loop,o.loopStart=this.loopStart,o.loopEnd=this.loopEnd,o.onended=this.onEnded.bind(this),o.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=o,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},t.pause=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},t.stop=function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},t.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,o=this.filters.length;a<o;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this},t.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,o=this.filters.length;a<o;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this},t.getFilters=function(){return this.filters},t.setFilters=function(a){return a||(a=[]),this._connected===!0?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},t.setDetune=function(a){if(this.detune=a,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},t.getDetune=function(){return this.detune},t.getFilter=function(){return this.getFilters()[0]},t.setFilter=function(a){return this.setFilters(a?[a]:[])},t.setPlaybackRate=function(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=a,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},t.getPlaybackRate=function(){return this.playbackRate},t.onEnded=function(){this.isPlaying=!1},t.getLoop=function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},t.setLoop=function(a){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=a,this.isPlaying===!0&&(this.source.loop=this.loop),this},t.setLoopStart=function(a){return this.loopStart=a,this},t.setLoopEnd=function(a){return this.loopEnd=a,this},t.getVolume=function(){return this.gain.gain.value},t.setVolume=function(a){return this.gain.gain.setTargetAtTime(a,this.context.currentTime,.01),this},s}(Jt),wu=new ee,Kx=new Wr,TR=new ee,Mu=new ee,ER=function(e){Qt(s,e);function s(a){var o=e.call(this,a)||this;return o.panner=o.context.createPanner(),o.panner.panningModel="HRTF",o.panner.connect(o.gain),o}var t=s.prototype;return t.getOutput=function(){return this.panner},t.getRefDistance=function(){return this.panner.refDistance},t.setRefDistance=function(a){return this.panner.refDistance=a,this},t.getRolloffFactor=function(){return this.panner.rolloffFactor},t.setRolloffFactor=function(a){return this.panner.rolloffFactor=a,this},t.getDistanceModel=function(){return this.panner.distanceModel},t.setDistanceModel=function(a){return this.panner.distanceModel=a,this},t.getMaxDistance=function(){return this.panner.maxDistance},t.setMaxDistance=function(a){return this.panner.maxDistance=a,this},t.setDirectionalCone=function(a,o,c){return this.panner.coneInnerAngle=a,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=c,this},t.updateMatrixWorld=function(a){if(e.prototype.updateMatrixWorld.call(this,a),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(wu,Kx,TR),Mu.set(0,0,1).applyQuaternion(Kx);var o=this.panner;if(o.positionX){var c=this.context.currentTime+this.listener.timeDelta;o.positionX.linearRampToValueAtTime(wu.x,c),o.positionY.linearRampToValueAtTime(wu.y,c),o.positionZ.linearRampToValueAtTime(wu.z,c),o.orientationX.linearRampToValueAtTime(Mu.x,c),o.orientationY.linearRampToValueAtTime(Mu.y,c),o.orientationZ.linearRampToValueAtTime(Mu.z,c)}else o.setPosition(wu.x,wu.y,wu.z),o.setOrientation(Mu.x,Mu.y,Mu.z)}},s}(wy),Qx=function(){function e(t,a){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=a!==void 0?a:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}var s=e.prototype;return s.getFrequencyData=function(){return this.analyser.getByteFrequencyData(this.data),this.data},s.getAverageFrequency=function(){for(var t=0,a=this.getFrequencyData(),o=0;o<a.length;o++)t+=a[o];return t/a.length},e}();function My(e,s,t){this.binding=e,this.valueSize=t;var a,o,c;switch(s){case"quaternion":a=this._slerp,o=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(t*6),this._workIndex=5;break;case"string":case"bool":a=this._select,o=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(t*5);break;default:a=this._lerp,o=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(t*5)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=o,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(My.prototype,{accumulate:function(e,s){var t=this.buffer,a=this.valueSize,o=e*a+a,c=this.cumulativeWeight;if(c===0){for(var f=0;f!==a;++f)t[o+f]=t[f];c=s}else{c+=s;var d=s/c;this._mixBufferRegion(t,o,0,d,a)}this.cumulativeWeight=c},accumulateAdditive:function(e){var s=this.buffer,t=this.valueSize,a=t*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(s,a,0,e,t),this.cumulativeWeightAdditive+=e},apply:function(e){var s=this.valueSize,t=this.buffer,a=e*s+s,o=this.cumulativeWeight,c=this.cumulativeWeightAdditive,f=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var d=s*this._origIndex;this._mixBufferRegion(t,a,d,1-o,s)}c>0&&this._mixBufferRegionAdditive(t,a,this._addIndex*s,1,s);for(var m=s;m!==s+s;++m)if(t[m]!==t[m+s]){f.setValue(t,a);break}},saveOriginalState:function(){var e=this.binding,s=this.buffer,t=this.valueSize,a=t*this._origIndex;e.getValue(s,a);for(var o=t;o!==a;++o)s[o]=s[a+o%t];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,s=e+this.valueSize,t=e;t<s;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,s=this._addIndex*this.valueSize,t=0;t<this.valueSize;t++)this.buffer[s+t]=this.buffer[e+t]},_select:function(e,s,t,a,o){if(a>=.5)for(var c=0;c!==o;++c)e[s+c]=e[t+c]},_slerp:function(e,s,t,a){Wr.slerpFlat(e,s,e,s,e,t,a)},_slerpAdditive:function(e,s,t,a,o){var c=this._workIndex*o;Wr.multiplyQuaternionsFlat(e,c,e,s,e,t),Wr.slerpFlat(e,s,e,s,e,c,a)},_lerp:function(e,s,t,a,o){for(var c=0;c!==o;++c){var f=s+c;e[f]=e[f]*(1-a)+e[t+c]*a}},_lerpAdditive:function(e,s,t,a,o){for(var c=0;c!==o;++c){var f=s+c;e[f]=e[f]+e[t+c]*a}}});var Sy="\\[\\]\\.:\\/",AR=new RegExp("["+Sy+"]","g"),Ty="[^"+Sy+"]",LR="[^"+Sy.replace("\\.","")+"]",RR=/((?:WC+[\/:])*)/.source.replace("WC",Ty),CR=/(WCOD+)?/.source.replace("WCOD",LR),PR=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Ty),IR=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Ty),DR=new RegExp("^"+RR+CR+PR+IR+"$"),OR=["material","materials","bones"];function $x(e,s,t){var a=t||va.parseTrackName(s);this._targetGroup=e,this._bindings=e.subscribe_(s,a)}Object.assign($x.prototype,{getValue:function(e,s){this.bind();var t=this._targetGroup.nCachedObjects_,a=this._bindings[t];a!==void 0&&a.getValue(e,s)},setValue:function(e,s){for(var t=this._bindings,a=this._targetGroup.nCachedObjects_,o=t.length;a!==o;++a)t[a].setValue(e,s)},bind:function(){for(var e=this._bindings,s=this._targetGroup.nCachedObjects_,t=e.length;s!==t;++s)e[s].bind()},unbind:function(){for(var e=this._bindings,s=this._targetGroup.nCachedObjects_,t=e.length;s!==t;++s)e[s].unbind()}});function va(e,s,t){this.path=s,this.parsedPath=t||va.parseTrackName(s),this.node=va.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(va,{Composite:$x,create:function(e,s,t){return e&&e.isAnimationObjectGroup?new va.Composite(e,s,t):new va(e,s,t)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(AR,"")},parseTrackName:function(e){var s=DR.exec(e);if(!s)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var t={nodeName:s[2],objectName:s[3],objectIndex:s[4],propertyName:s[5],propertyIndex:s[6]},a=t.nodeName&&t.nodeName.lastIndexOf(".");if(a!==void 0&&a!==-1){var o=t.nodeName.substring(a+1);OR.indexOf(o)!==-1&&(t.nodeName=t.nodeName.substring(0,a),t.objectName=o)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return t},findNode:function(e,s){if(!s||s===""||s==="."||s===-1||s===e.name||s===e.uuid)return e;if(e.skeleton){var t=e.skeleton.getBoneByName(s);if(t!==void 0)return t}if(e.children){var a=function c(f){for(var d=0;d<f.length;d++){var m=f[d];if(m.name===s||m.uuid===s)return m;var y=c(m.children);if(y)return y}return null},o=a(e.children);if(o)return o}return null}}),Object.assign(va.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,s){e[s]=this.node[this.propertyName]},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)e[s++]=t[a]},function(e,s){e[s]=this.resolvedProperty[this.propertyIndex]},function(e,s){this.resolvedProperty.toArray(e,s)}],SetterByBindingTypeAndVersioning:[[function(e,s){this.targetObject[this.propertyName]=e[s]},function(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.needsUpdate=!0},function(e,s){this.targetObject[this.propertyName]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++]},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++];this.targetObject.needsUpdate=!0},function(e,s){for(var t=this.resolvedProperty,a=0,o=t.length;a!==o;++a)t[a]=e[s++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){this.resolvedProperty[this.propertyIndex]=e[s]},function(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.needsUpdate=!0},function(e,s){this.resolvedProperty[this.propertyIndex]=e[s],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,s){this.resolvedProperty.fromArray(e,s)},function(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.needsUpdate=!0},function(e,s){this.resolvedProperty.fromArray(e,s),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,s){this.bind(),this.getValue(e,s)},setValue:function(e,s){this.bind(),this.setValue(e,s)},bind:function(){var e=this.node,s=this.parsedPath,t=s.objectName,a=s.propertyName,o=s.propertyIndex;if(e||(e=va.findNode(this.rootNode,s.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(t){var c=s.objectIndex;switch(t){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var f=0;f<e.length;f++)if(e[f].name===c){c=f;break}break;default:if(e[t]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[t]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}var d=e[a];if(d===void 0){var m=s.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+m+"."+a+" but it wasn't found.",e);return}var y=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?y=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(y=this.Versioning.MatrixWorldNeedsUpdate);var w=this.BindingType.Direct;if(o!==void 0){if(a==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[o]!==void 0&&(o=e.morphTargetDictionary[o])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}w=this.BindingType.ArrayElement,this.resolvedProperty=d,this.propertyIndex=o}else d.fromArray!==void 0&&d.toArray!==void 0?(w=this.BindingType.HasFromToArray,this.resolvedProperty=d):Array.isArray(d)?(w=this.BindingType.EntireArray,this.resolvedProperty=d):this.propertyName=a;this.getValue=this.GetterByBindingType[w],this.setValue=this.SetterByBindingTypeAndVersioning[w][y]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(va.prototype,{_getValue_unbound:va.prototype.getValue,_setValue_unbound:va.prototype.setValue});function eb(){this.uuid=Mn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var s=0,t=arguments.length;s!==t;++s)e[arguments[s].uuid]=s;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}Object.assign(eb.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._paths,a=this._parsedPaths,o=this._bindings,c=o.length,f=void 0,d=e.length,m=this.nCachedObjects_,y=0,w=arguments.length;y!==w;++y){var M=arguments[y],D=M.uuid,P=s[D];if(P===void 0){P=d++,s[D]=P,e.push(M);for(var F=0;F!==c;++F)o[F].push(new va(M,t[F],a[F]))}else if(P<m){f=e[P];var C=--m,I=e[C];s[I.uuid]=P,e[P]=I,s[D]=C,e[C]=M;for(var q=0;q!==c;++q){var J=o[q],Z=J[C],G=J[P];J[P]=Z,G===void 0&&(G=new va(M,t[q],a[q])),J[C]=G}}else e[P]!==f&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=m},remove:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._bindings,a=t.length,o=this.nCachedObjects_,c=0,f=arguments.length;c!==f;++c){var d=arguments[c],m=d.uuid,y=s[m];if(y!==void 0&&y>=o){var w=o++,M=e[w];s[M.uuid]=y,e[y]=M,s[m]=w,e[w]=d;for(var D=0;D!==a;++D){var P=t[D],F=P[w],C=P[y];P[y]=F,P[w]=C}}}this.nCachedObjects_=o},uncache:function(){for(var e=this._objects,s=this._indicesByUUID,t=this._bindings,a=t.length,o=this.nCachedObjects_,c=e.length,f=0,d=arguments.length;f!==d;++f){var m=arguments[f],y=m.uuid,w=s[y];if(w!==void 0)if(delete s[y],w<o){var M=--o,D=e[M],P=--c,F=e[P];s[D.uuid]=w,e[w]=D,s[F.uuid]=M,e[M]=F,e.pop();for(var C=0;C!==a;++C){var I=t[C],q=I[M],J=I[P];I[w]=q,I[M]=J,I.pop()}}else{var Z=--c,G=e[Z];s[G.uuid]=w,e[w]=G,e.pop();for(var Y=0;Y!==a;++Y){var ne=t[Y];ne[w]=ne[Z],ne.pop()}}}this.nCachedObjects_=o},subscribe_:function(e,s){var t=this._bindingsIndicesByPath,a=t[e],o=this._bindings;if(a!==void 0)return o[a];var c=this._paths,f=this._parsedPaths,d=this._objects,m=d.length,y=this.nCachedObjects_,w=new Array(m);a=o.length,t[e]=a,c.push(e),f.push(s),o.push(w);for(var M=y,D=d.length;M!==D;++M){var P=d[M];w[M]=new va(P,e,s)}return w},unsubscribe_:function(e){var s=this._bindingsIndicesByPath,t=s[e];if(t!==void 0){var a=this._paths,o=this._parsedPaths,c=this._bindings,f=c.length-1,d=c[f],m=e[f];s[m]=t,c[t]=d,c.pop(),o[t]=o[f],o.pop(),a[t]=a[f],a.pop()}}});var NR=function(){function e(t,a,o,c){this._mixer=t,this._clip=a,this._localRoot=o||null,this.blendMode=c||a.blendMode;for(var f=a.tracks,d=f.length,m=new Array(d),y={endingStart:dl,endingEnd:dl},w=0;w!==d;++w){var M=f[w].createInterpolant(null);m[w]=M,M.settings=y}this._interpolantSettings=y,this._interpolants=m,this._propertyBindings=new Array(d),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=$n,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}var s=e.prototype;return s.play=function(){return this._mixer._activateAction(this),this},s.stop=function(){return this._mixer._deactivateAction(this),this.reset()},s.reset=function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},s.isRunning=function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},s.isScheduled=function(){return this._mixer._isActiveAction(this)},s.startAt=function(t){return this._startTime=t,this},s.setLoop=function(t,a){return this.loop=t,this.repetitions=a,this},s.setEffectiveWeight=function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},s.getEffectiveWeight=function(){return this._effectiveWeight},s.fadeIn=function(t){return this._scheduleFading(t,0,1)},s.fadeOut=function(t){return this._scheduleFading(t,1,0)},s.crossFadeFrom=function(t,a,o){if(t.fadeOut(a),this.fadeIn(a),o){var c=this._clip.duration,f=t._clip.duration;t.warp(1,f/c,a),this.warp(c/f,1,a)}return this},s.crossFadeTo=function(t,a,o){return t.crossFadeFrom(this,a,o)},s.stopFading=function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},s.setEffectiveTimeScale=function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},s.getEffectiveTimeScale=function(){return this._effectiveTimeScale},s.setDuration=function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},s.syncWith=function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},s.halt=function(t){return this.warp(this._effectiveTimeScale,0,t)},s.warp=function(t,a,o){var c=this._mixer,f=c.time,d=this.timeScale,m=this._timeScaleInterpolant;m===null&&(m=c._lendControlInterpolant(),this._timeScaleInterpolant=m);var y=m.parameterPositions,w=m.sampleValues;return y[0]=f,y[1]=f+o,w[0]=t/d,w[1]=a/d,this},s.stopWarping=function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},s.getMixer=function(){return this._mixer},s.getClip=function(){return this._clip},s.getRoot=function(){return this._localRoot||this._mixer._root},s._update=function(t,a,o,c){if(!this.enabled){this._updateWeight(t);return}var f=this._startTime;if(f!==null){var d=(t-f)*o;if(d<0||o===0)return;this._startTime=null,a=o*d}a*=this._updateTimeScale(t);var m=this._updateTime(a),y=this._updateWeight(t);if(y>0){var w=this._interpolants,M=this._propertyBindings;switch(this.blendMode){case Zs:for(var D=0,P=w.length;D!==P;++D)w[D].evaluate(m),M[D].accumulateAdditive(y);break;case js:default:for(var F=0,C=w.length;F!==C;++F)w[F].evaluate(m),M[F].accumulate(c,y)}}},s._updateWeight=function(t){var a=0;if(this.enabled){a=this.weight;var o=this._weightInterpolant;if(o!==null){var c=o.evaluate(t)[0];a*=c,t>o.parameterPositions[1]&&(this.stopFading(),c===0&&(this.enabled=!1))}}return this._effectiveWeight=a,a},s._updateTimeScale=function(t){var a=0;if(!this.paused){a=this.timeScale;var o=this._timeScaleInterpolant;if(o!==null){var c=o.evaluate(t)[0];a*=c,t>o.parameterPositions[1]&&(this.stopWarping(),a===0?this.paused=!0:this.timeScale=a)}}return this._effectiveTimeScale=a,a},s._updateTime=function(t){var a=this._clip.duration,o=this.loop,c=this.time+t,f=this._loopCount,d=o===Xp;if(t===0)return f===-1?c:d&&(f&1)===1?a-c:c;if(o===fl){f===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(c>=a)c=a;else if(c<0)c=0;else{this.time=c;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(f===-1&&(t>=0?(f=0,this._setEndings(!0,this.repetitions===0,d)):this._setEndings(this.repetitions===0,!0,d)),c>=a||c<0){var m=Math.floor(c/a);c-=a*m,f+=Math.abs(m);var y=this.repetitions-f;if(y<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,c=t>0?a:0,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(y===1){var w=t<0;this._setEndings(w,!w,d)}else this._setEndings(!1,!1,d);this._loopCount=f,this.time=c,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m})}}else this.time=c;if(d&&(f&1)===1)return a-c}return c},s._setEndings=function(t,a,o){var c=this._interpolantSettings;o?(c.endingStart=Lo,c.endingEnd=Lo):(t?c.endingStart=this.zeroSlopeAtStart?Lo:dl:c.endingStart=lc,a?c.endingEnd=this.zeroSlopeAtEnd?Lo:dl:c.endingEnd=lc)},s._scheduleFading=function(t,a,o){var c=this._mixer,f=c.time,d=this._weightInterpolant;d===null&&(d=c._lendControlInterpolant(),this._weightInterpolant=d);var m=d.parameterPositions,y=d.sampleValues;return m[0]=f,y[0]=a,m[1]=f+t,y[1]=o,this},e}();function Ey(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}Ey.prototype=Object.assign(Object.create(Qa.prototype),{constructor:Ey,_bindAction:function(e,s){var t=e._localRoot||this._root,a=e._clip.tracks,o=a.length,c=e._propertyBindings,f=e._interpolants,d=t.uuid,m=this._bindingsByRootAndName,y=m[d];y===void 0&&(y={},m[d]=y);for(var w=0;w!==o;++w){var M=a[w],D=M.name,P=y[D];if(P!==void 0)c[w]=P;else{if(P=c[w],P!==void 0){P._cacheIndex===null&&(++P.referenceCount,this._addInactiveBinding(P,d,D));continue}var F=s&&s._propertyBindings[w].binding.parsedPath;P=new My(va.create(t,D,F),M.ValueTypeName,M.getValueSize()),++P.referenceCount,this._addInactiveBinding(P,d,D),c[w]=P}f[w].resultBuffer=P.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var s=(e._localRoot||this._root).uuid,t=e._clip.uuid,a=this._actionsByClip[t];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,t,s)}for(var o=e._propertyBindings,c=0,f=o.length;c!==f;++c){var d=o[c];d.useCount++===0&&(this._lendBinding(d),d.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var s=e._propertyBindings,t=0,a=s.length;t!==a;++t){var o=s[t];--o.useCount===0&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var s=e._cacheIndex;return s!==null&&s<this._nActiveActions},_addInactiveAction:function(e,s,t){var a=this._actions,o=this._actionsByClip,c=o[s];if(c===void 0)c={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[s]=c;else{var f=c.knownActions;e._byClipCacheIndex=f.length,f.push(e)}e._cacheIndex=a.length,a.push(e),c.actionByRoot[t]=e},_removeInactiveAction:function(e){var s=this._actions,t=s[s.length-1],a=e._cacheIndex;t._cacheIndex=a,s[a]=t,s.pop(),e._cacheIndex=null;var o=e._clip.uuid,c=this._actionsByClip,f=c[o],d=f.knownActions,m=d[d.length-1],y=e._byClipCacheIndex;m._byClipCacheIndex=y,d[y]=m,d.pop(),e._byClipCacheIndex=null;var w=f.actionByRoot,M=(e._localRoot||this._root).uuid;delete w[M],d.length===0&&delete c[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var s=e._propertyBindings,t=0,a=s.length;t!==a;++t){var o=s[t];--o.referenceCount===0&&this._removeInactiveBinding(o)}},_lendAction:function(e){var s=this._actions,t=e._cacheIndex,a=this._nActiveActions++,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_takeBackAction:function(e){var s=this._actions,t=e._cacheIndex,a=--this._nActiveActions,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_addInactiveBinding:function(e,s,t){var a=this._bindingsByRootAndName,o=this._bindings,c=a[s];c===void 0&&(c={},a[s]=c),c[t]=e,e._cacheIndex=o.length,o.push(e)},_removeInactiveBinding:function(e){var s=this._bindings,t=e.binding,a=t.rootNode.uuid,o=t.path,c=this._bindingsByRootAndName,f=c[a],d=s[s.length-1],m=e._cacheIndex;d._cacheIndex=m,s[m]=d,s.pop(),delete f[o],Object.keys(f).length===0&&delete c[a]},_lendBinding:function(e){var s=this._bindings,t=e._cacheIndex,a=this._nActiveBindings++,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_takeBackBinding:function(e){var s=this._bindings,t=e._cacheIndex,a=--this._nActiveBindings,o=s[a];e._cacheIndex=a,s[a]=e,o._cacheIndex=t,s[t]=o},_lendControlInterpolant:function(){var e=this._controlInterpolants,s=this._nActiveControlInterpolants++,t=e[s];return t===void 0&&(t=new Cd(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),t.__cacheIndex=s,e[s]=t),t},_takeBackControlInterpolant:function(e){var s=this._controlInterpolants,t=e.__cacheIndex,a=--this._nActiveControlInterpolants,o=s[a];e.__cacheIndex=a,s[a]=e,o.__cacheIndex=t,s[t]=o},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,s,t){var a=s||this._root,o=a.uuid,c=typeof e=="string"?Ts.findByName(a,e):e,f=c!==null?c.uuid:e,d=this._actionsByClip[f],m=null;if(t===void 0&&(c!==null?t=c.blendMode:t=js),d!==void 0){var y=d.actionByRoot[o];if(y!==void 0&&y.blendMode===t)return y;m=d.knownActions[0],c===null&&(c=m._clip)}if(c===null)return null;var w=new NR(this,c,s,t);return this._bindAction(w,m),this._addInactiveAction(w,f,o),w},existingAction:function(e,s){var t=s||this._root,a=t.uuid,o=typeof e=="string"?Ts.findByName(t,e):e,c=o?o.uuid:e,f=this._actionsByClip[c];return f!==void 0&&f.actionByRoot[a]||null},stopAllAction:function(){for(var e=this._actions,s=this._nActiveActions,t=s-1;t>=0;--t)e[t].stop();return this},update:function(e){e*=this.timeScale;for(var s=this._actions,t=this._nActiveActions,a=this.time+=e,o=Math.sign(e),c=this._accuIndex^=1,f=0;f!==t;++f){var d=s[f];d._update(a,e,o,c)}for(var m=this._bindings,y=this._nActiveBindings,w=0;w!==y;++w)m[w].apply(c);return this},setTime:function(e){this.time=0;for(var s=0;s<this._actions.length;s++)this._actions[s].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var s=this._actions,t=e.uuid,a=this._actionsByClip,o=a[t];if(o!==void 0){for(var c=o.knownActions,f=0,d=c.length;f!==d;++f){var m=c[f];this._deactivateAction(m);var y=m._cacheIndex,w=s[s.length-1];m._cacheIndex=null,m._byClipCacheIndex=null,w._cacheIndex=y,s[y]=w,s.pop(),this._removeInactiveBindingsForAction(m)}delete a[t]}},uncacheRoot:function(e){var s=e.uuid,t=this._actionsByClip;for(var a in t){var o=t[a].actionByRoot,c=o[s];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}var f=this._bindingsByRootAndName,d=f[s];if(d!==void 0)for(var m in d){var y=d[m];y.restoreOriginalState(),this._removeInactiveBinding(y)}},uncacheAction:function(e,s){var t=this.existingAction(e,s);t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}});var tb=function(){function e(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}var s=e.prototype;return s.clone=function(){return new e(this.value.clone===void 0?this.value:this.value.clone())},e}();function Ay(e,s,t){rs.call(this,e,s),this.meshPerAttribute=t||1}Ay.prototype=Object.assign(Object.create(rs.prototype),{constructor:Ay,isInstancedInterleavedBuffer:!0,copy:function(e){return rs.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var s=rs.prototype.clone.call(this,e);return s.meshPerAttribute=this.meshPerAttribute,s},toJSON:function(e){var s=rs.prototype.toJSON.call(this,e);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}});function Ly(e,s,t,a,o){this.buffer=e,this.type=s,this.itemSize=t,this.elementSize=a,this.count=o,this.version=0}Object.defineProperty(Ly.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Object.assign(Ly.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,s){return this.type=e,this.elementSize=s,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}});function Ry(e,s,t,a){this.ray=new es(e,s),this.near=t||0,this.far=a||1/0,this.camera=null,this.layers=new sd,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function nb(e,s){return e.distance-s.distance}function Cy(e,s,t,a){if(e.layers.test(s.layers)&&e.raycast(s,t),a===!0)for(var o=e.children,c=0,f=o.length;c<f;c++)Cy(o[c],s,t,!0)}Object.assign(Ry.prototype,{set:function(e,s){this.ray.set(e,s)},setFromCamera:function(e,s){s&&s.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(s.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(s).sub(this.ray.origin).normalize(),this.camera=s):s&&s.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(s.near+s.far)/(s.near-s.far)).unproject(s),this.ray.direction.set(0,0,-1).transformDirection(s.matrixWorld),this.camera=s):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,s,t){var a=t||[];return Cy(e,this,a,s),a.sort(nb),a},intersectObjects:function(e,s,t){var a=t||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),a;for(var o=0,c=e.length;o<c;o++)Cy(e[o],this,a,s);return a.sort(nb),a}});var FR=function(){function e(t,a,o){return t===void 0&&(t=1),a===void 0&&(a=0),o===void 0&&(o=0),this.radius=t,this.phi=a,this.theta=o,this}var s=e.prototype;return s.set=function(t,a,o){return this.radius=t,this.phi=a,this.theta=o,this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},s.makeSafe=function(){var t=1e-6;return this.phi=Math.max(t,Math.min(Math.PI-t,this.phi)),this},s.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},s.setFromCartesianCoords=function(t,a,o){return this.radius=Math.sqrt(t*t+a*a+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,o),this.phi=Math.acos(Mn.clamp(a/this.radius,-1,1))),this},e}(),BR=function(){function e(t,a,o){return this.radius=t!==void 0?t:1,this.theta=a!==void 0?a:0,this.y=o!==void 0?o:0,this}var s=e.prototype;return s.set=function(t,a,o){return this.radius=t,this.theta=a,this.y=o,this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},s.setFromVector3=function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},s.setFromCartesianCoords=function(t,a,o){return this.radius=Math.sqrt(t*t+o*o),this.theta=Math.atan2(t,o),this.y=a,this},e}(),ib=new _t,rb=function(){function e(t,a){Object.defineProperty(this,"isBox2",{value:!0}),this.min=t!==void 0?t:new _t(1/0,1/0),this.max=a!==void 0?a:new _t(-1/0,-1/0)}var s=e.prototype;return s.set=function(t,a){return this.min.copy(t),this.max.copy(a),this},s.setFromPoints=function(t){this.makeEmpty();for(var a=0,o=t.length;a<o;a++)this.expandByPoint(t[a]);return this},s.setFromCenterAndSize=function(t,a){var o=ib.copy(a).multiplyScalar(.5);return this.min.copy(t).sub(o),this.max.copy(t).add(o),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.min.copy(t.min),this.max.copy(t.max),this},s.makeEmpty=function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},s.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new _t),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},s.getSize=function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new _t),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},s.expandByPoint=function(t){return this.min.min(t),this.max.max(t),this},s.expandByVector=function(t){return this.min.sub(t),this.max.add(t),this},s.expandByScalar=function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},s.containsPoint=function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},s.containsBox=function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},s.getParameter=function(t,a){return a===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),a=new _t),a.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},s.intersectsBox=function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},s.clampPoint=function(t,a){return a===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),a=new _t),a.copy(t).clamp(this.min,this.max)},s.distanceToPoint=function(t){var a=ib.copy(t).clamp(this.min,this.max);return a.sub(t).length()},s.intersect=function(t){return this.min.max(t.min),this.max.min(t.max),this},s.union=function(t){return this.min.min(t.min),this.max.max(t.max),this},s.translate=function(t){return this.min.add(t),this.max.add(t),this},s.equals=function(t){return t.min.equals(this.min)&&t.max.equals(this.max)},e}(),ab=new ee,Zm=new ee,sb=function(){function e(t,a){this.start=t!==void 0?t:new ee,this.end=a!==void 0?a:new ee}var s=e.prototype;return s.set=function(t,a){return this.start.copy(t),this.end.copy(a),this},s.clone=function(){return new this.constructor().copy(this)},s.copy=function(t){return this.start.copy(t.start),this.end.copy(t.end),this},s.getCenter=function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ee),t.addVectors(this.start,this.end).multiplyScalar(.5)},s.delta=function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ee),t.subVectors(this.end,this.start)},s.distanceSq=function(){return this.start.distanceToSquared(this.end)},s.distance=function(){return this.start.distanceTo(this.end)},s.at=function(t,a){return a===void 0&&(console.warn("THREE.Line3: .at() target is now required"),a=new ee),this.delta(a).multiplyScalar(t).add(this.start)},s.closestPointToPointParameter=function(t,a){ab.subVectors(t,this.start),Zm.subVectors(this.end,this.start);var o=Zm.dot(Zm),c=Zm.dot(ab),f=c/o;return a&&(f=Mn.clamp(f,0,1)),f},s.closestPointToPoint=function(t,a,o){var c=this.closestPointToPointParameter(t,a);return o===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),o=new ee),this.delta(o).multiplyScalar(c).add(this.start)},s.applyMatrix4=function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},s.equals=function(t){return t.start.equals(this.start)&&t.end.equals(this.end)},e}();function Nd(e){Jt.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Nd.prototype=Object.create(Jt.prototype),Nd.prototype.constructor=Nd,Nd.prototype.isImmediateRenderObject=!0;var ob=new ee,UR=function(e){Qt(s,e);function s(a,o){var c=e.call(this)||this;c.light=a,c.light.updateMatrixWorld(),c.matrix=a.matrixWorld,c.matrixAutoUpdate=!1,c.color=o;for(var f=new Ae,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],m=0,y=1,w=32;m<w;m++,y++){var M=m/w*Math.PI*2,D=y/w*Math.PI*2;d.push(Math.cos(M),Math.sin(M),1,Math.cos(D),Math.sin(D),1)}f.setAttribute("position",new x(d,3));var P=new lr({fog:!1,toneMapped:!1});return c.cone=new Ta(f,P),c.add(c.cone),c.update(),c}var t=s.prototype;return t.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},t.update=function(){this.light.updateMatrixWorld();var a=this.light.distance?this.light.distance:1e3,o=a*Math.tan(this.light.angle);this.cone.scale.set(o,o,a),ob.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ob),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},s}(Jt),Ic=new ee,Jm=new Hn,Py=new Hn,lb=function(e){Qt(s,e);function s(a){for(var o,c=cb(a),f=new Ae,d=[],m=[],y=new qt(0,0,1),w=new qt(0,1,0),M=0;M<c.length;M++){var D=c[M];D.parent&&D.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),m.push(y.r,y.g,y.b),m.push(w.r,w.g,w.b))}f.setAttribute("position",new x(d,3)),f.setAttribute("color",new x(m,3));var P=new lr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return o=e.call(this,f,P)||this,o.type="SkeletonHelper",o.isSkeletonHelper=!0,o.root=a,o.bones=c,o.matrix=a.matrixWorld,o.matrixAutoUpdate=!1,o}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=this.bones,c=this.geometry,f=c.getAttribute("position");Py.getInverse(this.root.matrixWorld);for(var d=0,m=0;d<o.length;d++){var y=o[d];y.parent&&y.parent.isBone&&(Jm.multiplyMatrices(Py,y.matrixWorld),Ic.setFromMatrixPosition(Jm),f.setXYZ(m,Ic.x,Ic.y,Ic.z),Jm.multiplyMatrices(Py,y.parent.matrixWorld),Ic.setFromMatrixPosition(Jm),f.setXYZ(m+1,Ic.x,Ic.y,Ic.z),m+=2)}c.getAttribute("position").needsUpdate=!0,e.prototype.updateMatrixWorld.call(this,a)},s}(Ta);function cb(e){var s=[];e&&e.isBone&&s.push(e);for(var t=0;t<e.children.length;t++)s.push.apply(s,cb(e.children[t]));return s}var GR=function(e){Qt(s,e);function s(a,o,c){var f,d=new Em(o,4,2),m=new Pr({wireframe:!0,fog:!1,toneMapped:!1});return f=e.call(this,d,m)||this,f.light=a,f.light.updateMatrixWorld(),f.color=c,f.type="PointLightHelper",f.matrix=f.light.matrixWorld,f.matrixAutoUpdate=!1,f.update(),f}var t=s.prototype;return t.dispose=function(){this.geometry.dispose(),this.material.dispose()},t.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)},s}(Fn),zR=new ee,ub=new qt,hb=new qt,HR=function(e){Qt(s,e);function s(a,o,c){var f=e.call(this)||this;f.light=a,f.light.updateMatrixWorld(),f.matrix=a.matrixWorld,f.matrixAutoUpdate=!1,f.color=c;var d=new Tm(o);d.rotateY(Math.PI*.5),f.material=new Pr({wireframe:!0,fog:!1,toneMapped:!1}),f.color===void 0&&(f.material.vertexColors=!0);var m=d.getAttribute("position"),y=new Float32Array(m.count*3);return d.setAttribute("color",new fn(y,3)),f.add(new Fn(d,f.material)),f.update(),f}var t=s.prototype;return t.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},t.update=function(){var a=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=a.geometry.getAttribute("color");ub.copy(this.light.color),hb.copy(this.light.groundColor);for(var c=0,f=o.count;c<f;c++){var d=c<f/2?ub:hb;o.setXYZ(c,d.r,d.g,d.b)}o.needsUpdate=!0}a.lookAt(zR.setFromMatrixPosition(this.light.matrixWorld).negate())},s}(Jt),fb=function(e){Qt(s,e);function s(t,a,o,c){var f;t=t||10,a=a||10,o=new qt(o!==void 0?o:4473924),c=new qt(c!==void 0?c:8947848);for(var d=a/2,m=t/a,y=t/2,w=[],M=[],D=0,P=0,F=-y;D<=a;D++,F+=m){w.push(-y,0,F,y,0,F),w.push(F,0,-y,F,0,y);var C=D===d?o:c;C.toArray(M,P),P+=3,C.toArray(M,P),P+=3,C.toArray(M,P),P+=3,C.toArray(M,P),P+=3}var I=new Ae;I.setAttribute("position",new x(w,3)),I.setAttribute("color",new x(M,3));var q=new lr({vertexColors:!0,toneMapped:!1});return f=e.call(this,I,q)||this,f.type="GridHelper",f}return s}(Ta),kR=function(e){Qt(s,e);function s(t,a,o,c,f,d){var m;t=t||10,a=a||16,o=o||8,c=c||64,f=new qt(f!==void 0?f:4473924),d=new qt(d!==void 0?d:8947848);for(var y=[],w=[],M=0;M<=a;M++){var D=M/a*(Math.PI*2),P=Math.sin(D)*t,F=Math.cos(D)*t;y.push(0,0,0),y.push(P,0,F);var C=M&1?f:d;w.push(C.r,C.g,C.b),w.push(C.r,C.g,C.b)}for(var I=0;I<=o;I++)for(var q=I&1?f:d,J=t-t/o*I,Z=0;Z<c;Z++){var G=Z/c*(Math.PI*2),Y=Math.sin(G)*J,ne=Math.cos(G)*J;y.push(Y,0,ne),w.push(q.r,q.g,q.b),G=(Z+1)/c*(Math.PI*2),Y=Math.sin(G)*J,ne=Math.cos(G)*J,y.push(Y,0,ne),w.push(q.r,q.g,q.b)}var se=new Ae;se.setAttribute("position",new x(y,3)),se.setAttribute("color",new x(w,3));var Ee=new lr({vertexColors:!0,toneMapped:!1});return m=e.call(this,se,Ee)||this,m.type="PolarGridHelper",m}return s}(Ta),db=new ee,Km=new ee,pb=new ee,VR=function(e){Qt(s,e);function s(a,o,c){var f=e.call(this)||this;f.light=a,f.light.updateMatrixWorld(),f.matrix=a.matrixWorld,f.matrixAutoUpdate=!1,f.color=c,o===void 0&&(o=1);var d=new Ae;d.setAttribute("position",new x([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3));var m=new lr({fog:!1,toneMapped:!1});return f.lightPlane=new Ss(d,m),f.add(f.lightPlane),d=new Ae,d.setAttribute("position",new x([0,0,0,0,0,1],3)),f.targetLine=new Ss(d,m),f.add(f.targetLine),f.update(),f}var t=s.prototype;return t.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},t.update=function(){db.setFromMatrixPosition(this.light.matrixWorld),Km.setFromMatrixPosition(this.light.target.matrixWorld),pb.subVectors(Km,db),this.lightPlane.lookAt(Km),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Km),this.targetLine.scale.z=pb.length()},s}(Jt),Qm=new ee,br=new Dr,WR=function(e){Qt(s,e);function s(a){var o,c=new Ae,f=new lr({color:16777215,vertexColors:!0,toneMapped:!1}),d=[],m=[],y={},w=new qt(16755200),M=new qt(16711680),D=new qt(43775),P=new qt(16777215),F=new qt(3355443);C("n1","n2",w),C("n2","n4",w),C("n4","n3",w),C("n3","n1",w),C("f1","f2",w),C("f2","f4",w),C("f4","f3",w),C("f3","f1",w),C("n1","f1",w),C("n2","f2",w),C("n3","f3",w),C("n4","f4",w),C("p","n1",M),C("p","n2",M),C("p","n3",M),C("p","n4",M),C("u1","u2",D),C("u2","u3",D),C("u3","u1",D),C("c","t",P),C("p","c",F),C("cn1","cn2",F),C("cn3","cn4",F),C("cf1","cf2",F),C("cf3","cf4",F);function C(q,J,Z){I(q,Z),I(J,Z)}function I(q,J){d.push(0,0,0),m.push(J.r,J.g,J.b),y[q]===void 0&&(y[q]=[]),y[q].push(d.length/3-1)}return c.setAttribute("position",new x(d,3)),c.setAttribute("color",new x(m,3)),o=e.call(this,c,f)||this,o.type="CameraHelper",o.camera=a,o.camera.updateProjectionMatrix&&o.camera.updateProjectionMatrix(),o.matrix=a.matrixWorld,o.matrixAutoUpdate=!1,o.pointMap=y,o.update(),o}var t=s.prototype;return t.update=function(){var a=this.geometry,o=this.pointMap,c=1,f=1;br.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Tr("c",o,a,br,0,0,-1),Tr("t",o,a,br,0,0,1),Tr("n1",o,a,br,-c,-f,-1),Tr("n2",o,a,br,c,-f,-1),Tr("n3",o,a,br,-c,f,-1),Tr("n4",o,a,br,c,f,-1),Tr("f1",o,a,br,-c,-f,1),Tr("f2",o,a,br,c,-f,1),Tr("f3",o,a,br,-c,f,1),Tr("f4",o,a,br,c,f,1),Tr("u1",o,a,br,c*.7,f*1.1,-1),Tr("u2",o,a,br,-c*.7,f*1.1,-1),Tr("u3",o,a,br,0,f*2,-1),Tr("cf1",o,a,br,-c,0,1),Tr("cf2",o,a,br,c,0,1),Tr("cf3",o,a,br,0,-f,1),Tr("cf4",o,a,br,0,f,1),Tr("cn1",o,a,br,-c,0,-1),Tr("cn2",o,a,br,c,0,-1),Tr("cn3",o,a,br,0,-f,-1),Tr("cn4",o,a,br,0,f,-1),a.getAttribute("position").needsUpdate=!0},s}(Ta);function Tr(e,s,t,a,o,c,f){Qm.set(o,c,f).unproject(a);var d=s[e];if(d!==void 0)for(var m=t.getAttribute("position"),y=0,w=d.length;y<w;y++)m.setXYZ(d[y],Qm.x,Qm.y,Qm.z)}var $m=new vs,mb=function(e){Qt(s,e);function s(a,o){var c;o===void 0&&(o=16776960);var f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(8*3),m=new Ae;return m.setIndex(new fn(f,1)),m.setAttribute("position",new fn(d,3)),c=e.call(this,m,new lr({color:o,toneMapped:!1}))||this,c.object=a,c.type="BoxHelper",c.matrixAutoUpdate=!1,c.update(),c}var t=s.prototype;return t.update=function(a){if(a!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&$m.setFromObject(this.object),!$m.isEmpty()){var o=$m.min,c=$m.max,f=this.geometry.attributes.position,d=f.array;d[0]=c.x,d[1]=c.y,d[2]=c.z,d[3]=o.x,d[4]=c.y,d[5]=c.z,d[6]=o.x,d[7]=o.y,d[8]=c.z,d[9]=c.x,d[10]=o.y,d[11]=c.z,d[12]=c.x,d[13]=c.y,d[14]=o.z,d[15]=o.x,d[16]=c.y,d[17]=o.z,d[18]=o.x,d[19]=o.y,d[20]=o.z,d[21]=c.x,d[22]=o.y,d[23]=o.z,f.needsUpdate=!0,this.geometry.computeBoundingSphere()}},t.setFromObject=function(a){return this.object=a,this.update(),this},t.copy=function(a){return Ta.prototype.copy.call(this,a),this.object=a.object,this},s}(Ta),qR=function(e){Qt(s,e);function s(a,o){var c;o===void 0&&(o=16776960);var f=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Ae;return d.setIndex(new fn(f,1)),d.setAttribute("position",new x([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),c=e.call(this,d,new lr({color:o,toneMapped:!1}))||this,c.box=a,c.type="Box3Helper",c.geometry.computeBoundingSphere(),c}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),e.prototype.updateMatrixWorld.call(this,a))},s}(Ta),XR=function(e){Qt(s,e);function s(a,o,c){var f,d=c!==void 0?c:16776960,m=new Ae;m.setAttribute("position",new x([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),m.computeBoundingSphere(),f=e.call(this,m,new lr({color:d,toneMapped:!1}))||this,f.type="PlaneHelper",f.plane=a,f.size=o===void 0?1:o;var y=new Ae;return y.setAttribute("position",new x([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),y.computeBoundingSphere(),f.add(new Fn(y,new Pr({color:d,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),f}var t=s.prototype;return t.updateMatrixWorld=function(a){var o=-this.plane.constant;Math.abs(o)<1e-8&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=o<0?S:A,this.lookAt(this.plane.normal),e.prototype.updateMatrixWorld.call(this,a)},s}(Ss),gb=new ee,eg,Iy,YR=function(e){Qt(s,e);function s(a,o,c,f,d,m){var y=e.call(this)||this;return y.type="ArrowHelper",a===void 0&&(a=new ee(0,0,1)),o===void 0&&(o=new ee(0,0,0)),c===void 0&&(c=1),f===void 0&&(f=16776960),d===void 0&&(d=.2*c),m===void 0&&(m=.2*d),eg===void 0&&(eg=new Ae,eg.setAttribute("position",new x([0,0,0,0,1,0],3)),Iy=new Sd(0,.5,1,5,1),Iy.translate(0,-.5,0)),y.position.copy(o),y.line=new Ss(eg,new lr({color:f,toneMapped:!1})),y.line.matrixAutoUpdate=!1,y.add(y.line),y.cone=new Fn(Iy,new Pr({color:f,toneMapped:!1})),y.cone.matrixAutoUpdate=!1,y.add(y.cone),y.setDirection(a),y.setLength(c,d,m),y}var t=s.prototype;return t.setDirection=function(a){if(a.y>.99999)this.quaternion.set(0,0,0,1);else if(a.y<-.99999)this.quaternion.set(1,0,0,0);else{gb.set(a.z,0,-a.x).normalize();var o=Math.acos(a.y);this.quaternion.setFromAxisAngle(gb,o)}},t.setLength=function(a,o,c){o===void 0&&(o=.2*a),c===void 0&&(c=.2*o),this.line.scale.set(1,Math.max(1e-4,a-o),1),this.line.updateMatrix(),this.cone.scale.set(c,o,c),this.cone.position.y=a,this.cone.updateMatrix()},t.setColor=function(a){this.line.material.color.set(a),this.cone.material.color.set(a)},t.copy=function(a){return e.prototype.copy.call(this,a,!1),this.line.copy(a.line),this.cone.copy(a.cone),this},s}(Jt),vb=function(e){Qt(s,e);function s(t){var a;t===void 0&&(t=1);var o=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],c=new Ae;c.setAttribute("position",new x(o,3)),c.setAttribute("color",new x([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var f=new lr({vertexColors:!0,toneMapped:!1});return a=e.call(this,c,f)||this,a.type="AxesHelper",a}return s}(Ta),Cl,Jh=4,Dc=8,qo=Math.pow(2,Dc),yb=[.125,.215,.35,.446,.526,.582],_b=Dc-Jh+1+yb.length,Kh=20,Xo=(Cl={},Cl[Ur]=0,Cl[pl]=1,Cl[Ro]=2,Cl[Kf]=3,Cl[$c]=4,Cl[Qf]=5,Cl[Qc]=6,Cl),Dy=new Zh,Oy=JR(),Fd=Oy._lodPlanes,xb=Oy._sizeLods,tg=Oy._sigmas,Ny=null,Su=(1+Math.sqrt(5))/2,Qh=1/Su,bb=[new ee(1,1,1),new ee(-1,1,1),new ee(1,1,-1),new ee(-1,1,-1),new ee(0,Su,Qh),new ee(0,Su,-Qh),new ee(Qh,0,Su),new ee(-Qh,0,Su),new ee(Su,Qh,0),new ee(-Su,Qh,0)],jR=function(){function e(t){this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=KR(Kh),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}var s=e.prototype;return s.fromScene=function(t,a,o,c){a===void 0&&(a=0),o===void 0&&(o=.1),c===void 0&&(c=100),Ny=this._renderer.getRenderTarget();var f=this._allocateTargets();return this._sceneToCubeUV(t,o,c,f),a>0&&this._blur(f,0,0,a),this._applyPMREM(f),this._cleanup(f),f},s.fromEquirectangular=function(t){return this._fromTexture(t)},s.fromCubemap=function(t){return this._fromTexture(t)},s.compileCubemapShader=function(){this._cubemapShader===null&&(this._cubemapShader=Sb(),this._compileMaterial(this._cubemapShader))},s.compileEquirectangularShader=function(){this._equirectShader===null&&(this._equirectShader=Mb(),this._compileMaterial(this._equirectShader))},s.dispose=function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var t=0;t<Fd.length;t++)Fd[t].dispose()},s._cleanup=function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Ny),t.scissorTest=!1,ng(t,0,0,t.width,t.height)},s._fromTexture=function(t){Ny=this._renderer.getRenderTarget();var a=this._allocateTargets(t);return this._textureToCubeUV(t,a),this._applyPMREM(a),this._cleanup(a),a},s._allocateTargets=function(t){var a={magFilter:it,minFilter:it,generateMipmaps:!1,type:Rr,format:ut,encoding:ZR(t)?t.encoding:Ro,depthBuffer:!1},o=wb(a);return o.depthBuffer=!t,this._pingPongRenderTarget=wb(a),o},s._compileMaterial=function(t){var a=new Fn(Fd[0],t);this._renderer.compile(a,Dy)},s._sceneToCubeUV=function(t,a,o,c){var f=new Ni(90,1,a,o),d=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],y=this._renderer,w=y.outputEncoding,M=y.toneMapping,D=y.getClearColor(),P=y.getClearAlpha();y.toneMapping=we,y.outputEncoding=Ur;var F=t.background;if(F&&F.isColor){F.convertSRGBToLinear();var C=Math.max(F.r,F.g,F.b),I=Math.min(Math.max(Math.ceil(Math.log2(C)),-128),127);F=F.multiplyScalar(Math.pow(2,-I)),y.setClearColor(F,(I+128)/255),t.background=null}for(var q=0;q<6;q++){var J=q%3;J==0?(f.up.set(0,d[q],0),f.lookAt(m[q],0,0)):J==1?(f.up.set(0,0,d[q]),f.lookAt(0,m[q],0)):(f.up.set(0,d[q],0),f.lookAt(0,0,m[q])),ng(c,J*qo,q>2?qo:0,qo,qo),y.setRenderTarget(c),y.render(t,f)}y.toneMapping=M,y.outputEncoding=w,y.setClearColor(D,P)},s._textureToCubeUV=function(t,a){var o=this._renderer;t.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=Sb()):this._equirectShader==null&&(this._equirectShader=Mb());var c=t.isCubeTexture?this._cubemapShader:this._equirectShader,f=new Fn(Fd[0],c),d=c.uniforms;d.envMap.value=t,t.isCubeTexture||d.texelSize.value.set(1/t.image.width,1/t.image.height),d.inputEncoding.value=Xo[t.encoding],d.outputEncoding.value=Xo[a.texture.encoding],ng(a,0,0,3*qo,2*qo),o.setRenderTarget(a),o.render(f,Dy)},s._applyPMREM=function(t){var a=this._renderer,o=a.autoClear;a.autoClear=!1;for(var c=1;c<_b;c++){var f=Math.sqrt(tg[c]*tg[c]-tg[c-1]*tg[c-1]),d=bb[(c-1)%bb.length];this._blur(t,c-1,c,f,d)}a.autoClear=o},s._blur=function(t,a,o,c,f){var d=this._pingPongRenderTarget;this._halfBlur(t,d,a,o,c,"latitudinal",f),this._halfBlur(d,t,o,o,c,"longitudinal",f)},s._halfBlur=function(t,a,o,c,f,d,m){var y=this._renderer,w=this._blurMaterial;d!=="latitudinal"&&d!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var M=new Fn(Fd[c],w),D=w.uniforms,P=xb[o]-1,F=isFinite(f)?Math.PI/(2*P):2*Math.PI/(2*Kh-1),C=f/F,I=isFinite(f)?1+Math.floor(3*C):Kh;I>Kh&&console.warn("sigmaRadians, "+f+", is too large and will clip, as it requested "+I+" samples when the maximum is set to "+Kh);for(var q=[],J=0,Z=0;Z<Kh;++Z){var G=Z/C,Y=Math.exp(-G*G/2);q.push(Y),Z==0?J+=Y:Z<I&&(J+=2*Y)}for(var ne=0;ne<q.length;ne++)q[ne]=q[ne]/J;D.envMap.value=t.texture,D.samples.value=I,D.weights.value=q,D.latitudinal.value=d==="latitudinal",m&&(D.poleAxis.value=m),D.dTheta.value=F,D.mipInt.value=Dc-o,D.inputEncoding.value=Xo[t.texture.encoding],D.outputEncoding.value=Xo[t.texture.encoding];var se=xb[c],Ee=3*Math.max(0,qo-2*se),Be=(c===0?0:2*qo)+2*se*(c>Dc-Jh?c-Dc+Jh:0);ng(a,Ee,Be,3*se,2*se),y.setRenderTarget(a),y.render(M,Dy)},e}();function ZR(e){return e===void 0||e.type!==Rr?!1:e.encoding===Ur||e.encoding===pl||e.encoding===Qc}function JR(){for(var e=[],s=[],t=[],a=Dc,o=0;o<_b;o++){var c=Math.pow(2,a);s.push(c);var f=1/c;o>Dc-Jh?f=yb[o-Dc+Jh-1]:o==0&&(f=0),t.push(f);for(var d=1/(c-1),m=-d/2,y=1+d/2,w=[m,m,y,m,y,y,m,m,y,y,m,y],M=6,D=6,P=3,F=2,C=1,I=new Float32Array(P*D*M),q=new Float32Array(F*D*M),J=new Float32Array(C*D*M),Z=0;Z<M;Z++){var G=Z%3*2/3-1,Y=Z>2?0:-1;I.set([G,Y,0,G+2/3,Y,0,G+2/3,Y+1,0,G,Y,0,G+2/3,Y+1,0,G,Y+1,0],P*D*Z),q.set(w,F*D*Z);var ne=[Z,Z,Z,Z,Z,Z];J.set(ne,C*D*Z)}var se=new Ae;se.setAttribute("position",new fn(I,P)),se.setAttribute("uv",new fn(q,F)),se.setAttribute("faceIndex",new fn(J,C)),e.push(se),a>Jh&&a--}return{_lodPlanes:e,_sizeLods:s,_sigmas:t}}function wb(e){var s=new na(3*qo,3*qo,e);return s.texture.mapping=Je,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function ng(e,s,t,a,o){e.viewport.set(s,t,a,o),e.scissor.set(s,t,a,o)}function KR(e){var s=new Float32Array(e),t=new ee(0,1,0),a=new Al({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:t},inputEncoding:{value:Xo[Ur]},outputEncoding:{value:Xo[Ur]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			`+By()+`

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return a}function Mb(){var e=new _t(1,1),s=new Al({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Xo[Ur]},outputEncoding:{value:Xo[Ur]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			`+By()+`

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return s}function Sb(){var e=new Al({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Xo[Ur]},outputEncoding:{value:Xo[Ur]}},vertexShader:Fy(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			`+By()+`

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:N,depthTest:!1,depthWrite:!1});return e}function Fy(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function By(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}sn.create=function(e,s){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(sn.prototype),e.prototype.constructor=e,e.prototype.getPoint=s,e},Object.assign(Ll.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var s=this.getPoints(e);return this.createGeometry(s)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var s=this.getSpacedPoints(e);return this.createGeometry(s)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var s=new Fi,t=0,a=e.length;t<a;t++){var o=e[t];s.vertices.push(new ee(o.x,o.y,o.z||0))}return s}}),Object.assign(lo.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}});function Tb(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ga.call(this,e),this.type="catmullrom",this.closed=!0}Tb.prototype=Object.create(ga.prototype);function Eb(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),ga.call(this,e),this.type="catmullrom"}Eb.prototype=Object.create(ga.prototype);function Uy(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ga.call(this,e),this.type="catmullrom"}Uy.prototype=Object.create(ga.prototype),Object.assign(Uy.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),fb.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},lb.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Pi.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),py.extractUrlBase(e)}}),Pi.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(rb.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(vs.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),Object.assign(da.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),hd.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},sb.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Object.assign(Mn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Mn.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Mn.ceilPowerOfTwo(e)}}),Object.assign(ta.prototype,{flattenToArrayOffset:function(e,s){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,s)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Hn.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,s){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,s)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new ee().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,s,t,a,o,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,s,a,t,o,c)}}),pa.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},Wr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Object.assign(es.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),Object.assign(Da.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,s)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),Object.assign(Da,{barycoordFromPoint:function(e,s,t,a,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Da.getBarycoord(e,s,t,a,o)},normal:function(e,s,t,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Da.getNormal(e,s,t,a)}}),Object.assign(Pc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new qv(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jv(this,e)}}),Object.assign(_t.prototype,{fromAttribute:function(e,s,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ee.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,s){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(s,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,s,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ei.prototype,{fromAttribute:function(e,s,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,s,t)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fi.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.assign(Jt.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,s){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(s,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Jt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Fn.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Fn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Jf},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(xd.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(cm.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),lm.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(sn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ni.prototype.setLens=function(e,s){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),s!==void 0&&(this.filmGauge=s),this.setFocalLength(e)},Object.defineProperties(Zi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(fn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===zi},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(zi)}}}),Object.assign(fn.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?zi:eu),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ae.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,s){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(s&&s.isBufferAttribute)&&!(s&&s.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new fn(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(s),this):this.setAttribute(e,s)},addDrawCall:function(e,s,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,s)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Object.defineProperties(Ae.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Od.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(Ry.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(rs.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===zi},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Object.assign(rs.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?zi:eu),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Ld.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(Cv.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(tb.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(an.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new qt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===E}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(Cc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(Rc.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(qr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Object.assign(md.prototype,{clearTarget:function(e,s,t,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(s,t,a)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(md.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?pl:Ur}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ix.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(na.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Object.defineProperties(wy.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var s=this,t=new jm;return t.load(e,function(a){s.setBuffer(a)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Qx.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ph.prototype.updateCubeMap=function(e,s){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,s)},pr.crossOrigin=void 0,pr.loadTexture=function(e,s,t,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var o=new Nm;o.setCrossOrigin(this.crossOrigin);var c=o.load(e,t,void 0,a);return s&&(c.mapping=s),c},pr.loadTextureCube=function(e,s,t,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var o=new Dm;o.setCrossOrigin(this.crossOrigin);var c=o.load(e,t,void 0,a);return s&&(c.mapping=s),c},pr.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},pr.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l}})),n.ACESFilmicToneMapping=Ze,n.AddEquation=ge,n.AddOperation=Re,n.AdditiveAnimationBlendMode=Zs,n.AdditiveBlending=V,n.AlphaFormat=ba,n.AlwaysDepth=Et,n.AlwaysStencilFunc=ed,n.AmbientLight=Hm,n.AmbientLightProbe=by,n.AnimationClip=Ts,n.AnimationLoader=ry,n.AnimationMixer=Ey,n.AnimationObjectGroup=eb,n.AnimationUtils=nr,n.ArcCurve=jh,n.ArrayCamera=im,n.ArrowHelper=YR,n.Audio=wy,n.AudioAnalyser=Qx,n.AudioContext=_y,n.AudioListener=SR,n.AudioLoader=jm,n.AxesHelper=vb,n.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new vb(e)},n.BackSide=S,n.BasicDepthPacking=$f,n.BasicShadowMap=0,n.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Om(e)},n.Bone=Iv,n.BooleanKeyframeTrack=Rm,n.BoundingBoxHelper=function(e,s){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new mb(e,s)},n.Box2=rb,n.Box3=vs,n.Box3Helper=qR,n.BoxBufferGeometry=ns,n.BoxGeometry=Bv,n.BoxHelper=mb,n.BufferAttribute=fn,n.BufferGeometry=Ae,n.BufferGeometryLoader=qm,n.ByteType=$i,n.Cache=_u,n.Camera=Dr,n.CameraHelper=WR,n.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},n.CanvasTexture=wd,n.CatmullRomCurve3=ga,n.CineonToneMapping=ze,n.CircleBufferGeometry=Uv,n.CircleGeometry=_x,n.ClampToEdgeWrapping=ct,n.Clock=Zx,n.ClosedSplineCurve3=Tb,n.Color=qt,n.ColorKeyframeTrack=Cm,n.CompressedTexture=Hh,n.CompressedTextureLoader=ay,n.ConeBufferGeometry=bx,n.ConeGeometry=xx,n.CubeCamera=Ph,n.CubeGeometry=Bv,n.CubeReflectionMapping=j,n.CubeRefractionMapping=He,n.CubeTexture=zo,n.CubeTextureLoader=Dm,n.CubeUVReflectionMapping=Je,n.CubeUVRefractionMapping=lt,n.CubicBezierCurve=ro,n.CubicBezierCurve3=Vo,n.CubicInterpolant=Am,n.CullFaceBack=h,n.CullFaceFront=p,n.CullFaceFrontBack=3,n.CullFaceNone=u,n.Curve=sn,n.CurvePath=Ll,n.CustomBlending=pe,n.CustomToneMapping=Xe,n.CylinderBufferGeometry=Sd,n.CylinderGeometry=Gv,n.Cylindrical=BR,n.DataTexture=uu,n.DataTexture2DArray=Dh,n.DataTexture3D=Oh,n.DataTextureLoader=Om,n.DecrementStencilOp=7683,n.DecrementWrapStencilOp=34056,n.DefaultLoadingManager=Hx,n.DepthFormat=Ft,n.DepthStencilFormat=Tn,n.DepthTexture=Md,n.DirectionalLight=zm,n.DirectionalLightHelper=VR,n.DiscreteInterpolant=Lm,n.DodecahedronBufferGeometry=zv,n.DodecahedronGeometry=wx,n.DoubleSide=R,n.DstAlphaFactor=Te,n.DstColorFactor=We,n.DynamicBufferAttribute=function(e,s){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new fn(e,s).setUsage(zi)},n.DynamicCopyUsage=35050,n.DynamicDrawUsage=zi,n.DynamicReadUsage=35049,n.EdgesGeometry=kv,n.EdgesHelper=function(e,s){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ta(new kv(e.geometry),new lr({color:s!==void 0?s:16777215}))},n.EllipseCurve=ss,n.EqualDepth=K,n.EqualStencilFunc=514,n.EquirectangularReflectionMapping=Ge,n.EquirectangularRefractionMapping=ue,n.Euler=Sh,n.EventDispatcher=Qa,n.ExtrudeBufferGeometry=Ld,n.ExtrudeGeometry=qv,n.Face3=lu,n.Face4=function(e,s,t,a,o,c,f){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new lu(e,s,t,o,c,f)},n.FaceColors=1,n.FileLoader=Es,n.FlatShading=E,n.Float32Attribute=function(e,s){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new x(e,s)},n.Float32BufferAttribute=x,n.Float64Attribute=function(e,s){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new T(e,s)},n.Float64BufferAttribute=T,n.FloatType=Ri,n.Fog=ox,n.FogExp2=sx,n.Font=vy,n.FontLoader=yy,n.FrontSide=A,n.Frustum=hd,n.GLBufferAttribute=Ly,n.GLSL1="100",n.GLSL3=tu,n.GammaEncoding=Qc,n.Geometry=Fi,n.GeometryUtils={merge:function(e,s,t){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var a;s.isMesh&&(s.matrixAutoUpdate&&s.updateMatrix(),a=s.matrix,s=s.geometry),e.merge(s,a,t)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},n.GreaterDepth=xe,n.GreaterEqualDepth=H,n.GreaterEqualStencilFunc=518,n.GreaterStencilFunc=516,n.GridHelper=fb,n.Group=Tc,n.HalfFloatType=Ja,n.HemisphereLight=Bm,n.HemisphereLightHelper=HR,n.HemisphereLightProbe=xy,n.IcosahedronBufferGeometry=Xv,n.IcosahedronGeometry=Rx,n.ImageBitmapLoader=my,n.ImageLoader=Yh,n.ImageUtils=pr,n.ImmediateRenderObject=Nd,n.IncrementStencilOp=7682,n.IncrementWrapStencilOp=34055,n.InstancedBufferAttribute=Wm,n.InstancedBufferGeometry=Od,n.InstancedInterleavedBuffer=Ay,n.InstancedMesh=hm,n.Int16Attribute=function(e,s){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Sl(e,s)},n.Int16BufferAttribute=Sl,n.Int32Attribute=function(e,s){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new ae(e,s)},n.Int32BufferAttribute=ae,n.Int8Attribute=function(e,s){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new xc(e,s)},n.Int8BufferAttribute=xc,n.IntType=ua,n.InterleavedBuffer=rs,n.InterleavedBufferAttribute=Ec,n.Interpolant=as,n.InterpolateDiscrete=Jc,n.InterpolateLinear=Kc,n.InterpolateSmooth=_h,n.InvertStencilOp=5386,n.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},n.KeepStencilOp=Co,n.KeyframeTrack=ra,n.LOD=xd,n.LatheBufferGeometry=Yv,n.LatheGeometry=Cx,n.Layers=sd,n.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},n.LessDepth=$t,n.LessEqualDepth=Yt,n.LessEqualStencilFunc=515,n.LessStencilFunc=513,n.Light=Zi,n.LightProbe=As,n.Line=Ss,n.Line3=sb,n.LineBasicMaterial=lr,n.LineCurve=Fa,n.LineCurve3=ao,n.LineDashedMaterial=yu,n.LineLoop=gm,n.LinePieces=1,n.LineSegments=Ta,n.LineStrip=0,n.LinearEncoding=Ur,n.LinearFilter=Dt,n.LinearInterpolant=Cd,n.LinearMipMapLinearFilter=1008,n.LinearMipMapNearestFilter=1007,n.LinearMipmapLinearFilter=pi,n.LinearMipmapNearestFilter=cn,n.LinearToneMapping=Se,n.Loader=Pi,n.LoaderUtils=py,n.LoadingManager=iy,n.LogLuvEncoding=Gr,n.LoopOnce=fl,n.LoopPingPong=Xp,n.LoopRepeat=$n,n.LuminanceAlphaFormat=Ke,n.LuminanceFormat=Qe,n.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},n.Material=an,n.MaterialLoader=Vm,n.Math=Mn,n.MathUtils=Mn,n.Matrix3=ta,n.Matrix4=Hn,n.MaxEquation=tt,n.Mesh=Fn,n.MeshBasicMaterial=Pr,n.MeshDepthMaterial=Mc,n.MeshDistanceMaterial=Sc,n.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},n.MeshLambertMaterial=gu,n.MeshMatcapMaterial=vu,n.MeshNormalMaterial=mu,n.MeshPhongMaterial=Cc,n.MeshPhysicalMaterial=Rc,n.MeshStandardMaterial=ko,n.MeshToonMaterial=pu,n.MinEquation=Ie,n.MirroredRepeatWrapping=me,n.MixOperation=be,n.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},n.MultiplyBlending=O,n.MultiplyOperation=de,n.NearestFilter=it,n.NearestMipMapLinearFilter=1005,n.NearestMipMapNearestFilter=1004,n.NearestMipmapLinearFilter=pt,n.NearestMipmapNearestFilter=Lt,n.NeverDepth=nt,n.NeverStencilFunc=512,n.NoBlending=N,n.NoColors=0,n.NoToneMapping=we,n.NormalAnimationBlendMode=js,n.NormalBlending=W,n.NotEqualDepth=te,n.NotEqualStencilFunc=517,n.NumberKeyframeTrack=qh,n.Object3D=Jt,n.ObjectLoader=_R,n.ObjectSpaceNormalMap=Yp,n.OctahedronBufferGeometry=Tm,n.OctahedronGeometry=Px,n.OneFactor=ht,n.OneMinusDstAlphaFactor=Ve,n.OneMinusDstColorFactor=rt,n.OneMinusSrcAlphaFactor=Le,n.OneMinusSrcColorFactor=Ne,n.OrthographicCamera=Zh,n.PCFShadowMap=g,n.PCFSoftShadowMap=_,n.PMREMGenerator=jR,n.ParametricBufferGeometry=Wh,n.ParametricGeometry=Rd,n.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new _d(e)},n.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new no(e)},n.ParticleSystem=function(e,s){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new zh(e,s)},n.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new no(e)},n.Path=lo,n.PerspectiveCamera=Ni,n.Plane=pa,n.PlaneBufferGeometry=nm,n.PlaneGeometry=Ix,n.PlaneHelper=XR,n.PointCloud=function(e,s){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new zh(e,s)},n.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new no(e)},n.PointLight=Gm,n.PointLightHelper=GR,n.Points=zh,n.PointsMaterial=no,n.PolarGridHelper=kR,n.PolyhedronBufferGeometry=fu,n.PolyhedronGeometry=Dx,n.PositionalAudio=ER,n.PropertyBinding=va,n.PropertyMixer=My,n.QuadraticBezierCurve=so,n.QuadraticBezierCurve3=Wo,n.Quaternion=Wr,n.QuaternionKeyframeTrack=Pd,n.QuaternionLinearInterpolant=Pm,n.REVISION=l,n.RGBADepthPacking=Js,n.RGBAFormat=re,n.RGBAIntegerFormat=nn,n.RGBA_ASTC_10x10_Format=Wf,n.RGBA_ASTC_10x5_Format=Hp,n.RGBA_ASTC_10x6_Format=kp,n.RGBA_ASTC_10x8_Format=ac,n.RGBA_ASTC_12x10_Format=Vp,n.RGBA_ASTC_12x12_Format=qf,n.RGBA_ASTC_4x4_Format=zf,n.RGBA_ASTC_5x4_Format=vh,n.RGBA_ASTC_5x5_Format=Hf,n.RGBA_ASTC_6x5_Format=kf,n.RGBA_ASTC_6x6_Format=Up,n.RGBA_ASTC_8x5_Format=Gp,n.RGBA_ASTC_8x6_Format=zp,n.RGBA_ASTC_8x8_Format=Vf,n.RGBA_BPTC_Format=wa,n.RGBA_ETC2_EAC_Format=gh,n.RGBA_PVRTC_2BPPV1_Format=qs,n.RGBA_PVRTC_4BPPV1_Format=Sr,n.RGBA_S3TC_DXT1_Format=yr,n.RGBA_S3TC_DXT3_Format=ii,n.RGBA_S3TC_DXT5_Format=er,n.RGBDEncoding=Qf,n.RGBEEncoding=Ro,n.RGBEFormat=ut,n.RGBFormat=Ka,n.RGBIntegerFormat=Yi,n.RGBM16Encoding=$c,n.RGBM7Encoding=Kf,n.RGB_ETC1_Format=_r,n.RGB_ETC2_Format=Xs,n.RGB_PVRTC_2BPPV1_Format=Ws,n.RGB_PVRTC_4BPPV1_Format=or,n.RGB_S3TC_DXT1_Format=ni,n.RGFormat=wn,n.RGIntegerFormat=Xi,n.RawShaderMaterial=Al,n.Ray=es,n.Raycaster=Ry,n.RectAreaLight=km,n.RedFormat=Ln,n.RedIntegerFormat=Vn,n.ReinhardToneMapping=Pe,n.RepeatWrapping=Nt,n.ReplaceStencilOp=7681,n.ReverseSubtractEquation=Q,n.RingBufferGeometry=jv,n.RingGeometry=Ox,n.SRGB8_ALPHA8_ASTC_10x10_Format=Zf,n.SRGB8_ALPHA8_ASTC_10x5_Format=jf,n.SRGB8_ALPHA8_ASTC_10x6_Format=Ys,n.SRGB8_ALPHA8_ASTC_10x8_Format=qp,n.SRGB8_ALPHA8_ASTC_12x10_Format=Zc,n.SRGB8_ALPHA8_ASTC_12x12_Format=Ma,n.SRGB8_ALPHA8_ASTC_4x4_Format=sc,n.SRGB8_ALPHA8_ASTC_5x4_Format=hl,n.SRGB8_ALPHA8_ASTC_5x5_Format=Wp,n.SRGB8_ALPHA8_ASTC_6x5_Format=Si,n.SRGB8_ALPHA8_ASTC_6x6_Format=oc,n.SRGB8_ALPHA8_ASTC_8x5_Format=yh,n.SRGB8_ALPHA8_ASTC_8x6_Format=Xf,n.SRGB8_ALPHA8_ASTC_8x8_Format=Yf,n.Scene=Cv,n.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},n.ShaderChunk=Zn,n.ShaderLib=to,n.ShaderMaterial=qr,n.ShadowMaterial=du,n.Shape=Pc,n.ShapeBufferGeometry=Zv,n.ShapeGeometry=Jv,n.ShapePath=gy,n.ShapeUtils=El,n.ShortType=Br,n.Skeleton=cm,n.SkeletonHelper=lb,n.SkinnedMesh=lm,n.SmoothShading=2,n.Sphere=da,n.SphereBufferGeometry=Em,n.SphereGeometry=Nx,n.Spherical=FR,n.SphericalHarmonics3=Vx,n.Spline=Uy,n.SplineCurve=oo,n.SplineCurve3=Eb,n.SpotLight=Um,n.SpotLightHelper=UR,n.Sprite=_d,n.SpriteMaterial=Ac,n.SrcAlphaFactor=Ue,n.SrcAlphaSaturateFactor=Tt,n.SrcColorFactor=Ye,n.StaticCopyUsage=35046,n.StaticDrawUsage=eu,n.StaticReadUsage=35045,n.StereoCamera=jx,n.StreamCopyUsage=35042,n.StreamDrawUsage=35040,n.StreamReadUsage=35041,n.StringKeyframeTrack=Im,n.SubtractEquation=ye,n.SubtractiveBlending=B,n.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},n.TangentSpaceNormalMap=ml,n.TetrahedronBufferGeometry=Kv,n.TetrahedronGeometry=Fx,n.TextBufferGeometry=Qv,n.TextGeometry=Bx,n.Texture=Ti,n.TextureLoader=Nm,n.TorusBufferGeometry=$v,n.TorusGeometry=Ux,n.TorusKnotBufferGeometry=ey,n.TorusKnotGeometry=Gx,n.Triangle=Da,n.TriangleFanDrawMode=2,n.TriangleStripDrawMode=1,n.TrianglesDrawMode=Jf,n.TubeBufferGeometry=ty,n.TubeGeometry=zx,n.UVMapping=$,n.Uint16Attribute=function(e,s){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Tl(e,s)},n.Uint16BufferAttribute=Tl,n.Uint32Attribute=function(e,s){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new v(e,s)},n.Uint32BufferAttribute=v,n.Uint8Attribute=function(e,s){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new cu(e,s)},n.Uint8BufferAttribute=cu,n.Uint8ClampedAttribute=function(e,s){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ml(e,s)},n.Uint8ClampedBufferAttribute=Ml,n.Uniform=tb,n.UniformsLib=Vt,n.UniformsUtils=Go,n.UnsignedByteType=Rr,n.UnsignedInt248Type=fa,n.UnsignedIntType=qi,n.UnsignedShort4444Type=ha,n.UnsignedShort5551Type=gs,n.UnsignedShort565Type=dr,n.UnsignedShortType=Vs,n.VSMShadowMap=b,n.Vector2=_t,n.Vector3=ee,n.Vector4=Ei,n.VectorKeyframeTrack=Xh,n.Vertex=function(e,s,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ee(e,s,t)},n.VertexColors=2,n.VideoTexture=Nv,n.WebGL1Renderer=Rv,n.WebGLCubeRenderTarget=bc,n.WebGLMultisampleRenderTarget=Ia,n.WebGLRenderTarget=na,n.WebGLRenderTargetCube=function(e,s,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new bc(e,t)},n.WebGLRenderer=md,n.WebGLUtils=rx,n.WireframeGeometry=ny,n.WireframeHelper=function(e,s){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ta(new ny(e.geometry),new lr({color:s!==void 0?s:16777215}))},n.WrapAroundEnding=lc,n.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Es(e)},n.ZeroCurvatureEnding=dl,n.ZeroFactor=qe,n.ZeroSlopeEnding=Lo,n.ZeroStencilOp=0,n.sRGBEncoding=pl,Object.defineProperty(n,"__esModule",{value:!0})})}),ci=ls(fo);fo.GLTFLoader;const Nl="121",si={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},yn={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},In=0,Xn=1,_n=2,Ot=1,ki=2,di=3,Ui=0,ui=1,Dn=2,Zr=1,Kn=0,wr=1,Ar=2,yi=3,Ii=4,Jr=5,rr=100,aa=101,pn=102,En=103,Fr=104,Di=200,Lr=201,Ha=202,Rs=203,Yo=204,ka=205,Fl=206,po=207,jo=208,Bl=209,Ul=210,Kr=0,ar=1,Cs=2,Va=3,Zo=4,xn=5,wi=6,mo=7,Ps=0,cs=1,us=2,kn=0,Lu=1,Gl=2,hs=3,go=4,Jo=5,zl=300,vo=301,Ko=302,Ru=303,Gd=304,nf=306,Hl=307,kl=1e3,Qr=1001,bt=1002,St=1003,On=1004,_i=1005,Sn=1006,Mr=1007,Cu=1008,Nc=1009,Db=1010,Ob=1011,zd=1012,Nb=1013,Hd=1014,Is=1015,Fc=1016,Fb=1017,Bb=1018,Ub=1019,rf=1020,Gb=1021,yo=1022,fs=1023,zb=1024,Hb=1025,kb=fs,Pu=1026,af=1027,Vb=1028,Wb=1029,qb=1030,Xb=1031,Yb=1032,jb=1033,zy=33776,Hy=33777,ky=33778,Vy=33779,Wy=35840,qy=35841,Xy=35842,Yy=35843,Zb=36196,jy=37492,Zy=37496,Jb=37808,Kb=37809,Qb=37810,$b=37811,ew=37812,tw=37813,nw=37814,iw=37815,rw=37816,aw=37817,sw=37818,ow=37819,lw=37820,cw=37821,uw=36492,hw=37840,fw=37841,dw=37842,pw=37843,mw=37844,gw=37845,vw=37846,yw=37847,_w=37848,xw=37849,bw=37850,ww=37851,Mw=37852,Sw=37853,Tw=2200,Ew=2201,Aw=2202,sf=2300,Iu=2301,sg=2302,Du=2400,Ou=2401,kd=2402,og=2500,Jy=2501,Lw=0,Rw=1,Ky=2,Bc=3e3,Vd=3001,Cw=3007,Qy=3002,Pw=3003,Iw=3004,Dw=3005,Ow=3006,Nw=3200,Fw=3201,Uc=0,Bw=1,lg=7680,Uw=519,Wd=35044,of=35048,$y="300 es";function Ds(){}Object.assign(Ds.prototype,{addEventListener:function(r,i){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[r]===void 0&&(n[r]=[]),n[r].indexOf(i)===-1&&n[r].push(i)},hasEventListener:function(r,i){if(this._listeners===void 0)return!1;const n=this._listeners;return n[r]!==void 0&&n[r].indexOf(i)!==-1},removeEventListener:function(r,i){if(this._listeners===void 0)return;const l=this._listeners[r];if(l!==void 0){const u=l.indexOf(i);u!==-1&&l.splice(u,1)}},dispatchEvent:function(r){if(this._listeners===void 0)return;const n=this._listeners[r.type];if(n!==void 0){r.target=this;const l=n.slice(0);for(let u=0,h=l.length;u<h;u++)l[u].call(this,r)}}});const $r=[];for(let r=0;r<256;r++)$r[r]=(r<16?"0":"")+r.toString(16);let qd=1234567;const Gn={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const r=Math.random()*4294967295|0,i=Math.random()*4294967295|0,n=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return($r[r&255]+$r[r>>8&255]+$r[r>>16&255]+$r[r>>24&255]+"-"+$r[i&255]+$r[i>>8&255]+"-"+$r[i>>16&15|64]+$r[i>>24&255]+"-"+$r[n&63|128]+$r[n>>8&255]+"-"+$r[n>>16&255]+$r[n>>24&255]+$r[l&255]+$r[l>>8&255]+$r[l>>16&255]+$r[l>>24&255]).toUpperCase()},clamp:function(r,i,n){return Math.max(i,Math.min(n,r))},euclideanModulo:function(r,i){return(r%i+i)%i},mapLinear:function(r,i,n,l,u){return l+(r-i)*(u-l)/(n-i)},lerp:function(r,i,n){return(1-n)*r+n*i},smoothstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*(3-2*r))},smootherstep:function(r,i,n){return r<=i?0:r>=n?1:(r=(r-i)/(n-i),r*r*r*(r*(r*6-15)+10))},randInt:function(r,i){return r+Math.floor(Math.random()*(i-r+1))},randFloat:function(r,i){return r+Math.random()*(i-r)},randFloatSpread:function(r){return r*(.5-Math.random())},seededRandom:function(r){return r!==void 0&&(qd=r%2147483647),qd=qd*16807%2147483647,(qd-1)/2147483646},degToRad:function(r){return r*Gn.DEG2RAD},radToDeg:function(r){return r*Gn.RAD2DEG},isPowerOfTwo:function(r){return(r&r-1)===0&&r!==0},ceilPowerOfTwo:function(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))},floorPowerOfTwo:function(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},setQuaternionFromProperEuler:function(r,i,n,l,u){const h=Math.cos,p=Math.sin,g=h(n/2),_=p(n/2),b=h((i+l)/2),A=p((i+l)/2),S=h((i-l)/2),R=p((i-l)/2),E=h((l-i)/2),N=p((l-i)/2);switch(u){case"XYX":r.set(g*A,_*S,_*R,g*b);break;case"YZY":r.set(_*R,g*A,_*S,g*b);break;case"ZXZ":r.set(_*S,_*R,g*A,g*b);break;case"XZX":r.set(g*A,_*N,_*E,g*b);break;case"YXY":r.set(_*E,g*A,_*N,g*b);break;case"ZYZ":r.set(_*N,_*E,g*A,g*b);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+u)}}};class xt{constructor(i=0,n=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=i,this.y=n}get width(){return this.x}set width(i){this.x=i}get height(){return this.y}set height(i){this.y=i}set(i,n){return this.x=i,this.y=n,this}setScalar(i){return this.x=i,this.y=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y)}copy(i){return this.x=i.x,this.y=i.y,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this)}addScalar(i){return this.x+=i,this.y+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this)}subScalar(i){return this.x-=i,this.y-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this}multiply(i){return this.x*=i.x,this.y*=i.y,this}multiplyScalar(i){return this.x*=i,this.y*=i,this}divide(i){return this.x/=i.x,this.y/=i.y,this}divideScalar(i){return this.multiplyScalar(1/i)}applyMatrix3(i){const n=this.x,l=this.y,u=i.elements;return this.x=u[0]*n+u[3]*l+u[6],this.y=u[1]*n+u[4]*l+u[7],this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(i){return this.x*i.x+this.y*i.y}cross(i){return this.x*i.y-this.y*i.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,l=this.y-i.y;return n*n+l*l}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this}equals(i){return i.x===this.x&&i.y===this.y}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this}rotateAround(i,n){const l=Math.cos(n),u=Math.sin(n),h=this.x-i.x,p=this.y-i.y;return this.x=h*l-p*u+i.x,this.y=h*u+p*l+i.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class La{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(i,n,l,u,h,p,g,_,b){const A=this.elements;return A[0]=i,A[1]=u,A[2]=g,A[3]=n,A[4]=h,A[5]=_,A[6]=l,A[7]=p,A[8]=b,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return new this.constructor().fromArray(this.elements)}copy(i){const n=this.elements,l=i.elements;return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],this}extractBasis(i,n,l){return i.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),l.setFromMatrix3Column(this,2),this}setFromMatrix4(i){const n=i.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(i){return this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const l=i.elements,u=n.elements,h=this.elements,p=l[0],g=l[3],_=l[6],b=l[1],A=l[4],S=l[7],R=l[2],E=l[5],N=l[8],W=u[0],V=u[3],B=u[6],O=u[1],pe=u[4],ge=u[7],ye=u[2],Q=u[5],Ie=u[8];return h[0]=p*W+g*O+_*ye,h[3]=p*V+g*pe+_*Q,h[6]=p*B+g*ge+_*Ie,h[1]=b*W+A*O+S*ye,h[4]=b*V+A*pe+S*Q,h[7]=b*B+A*ge+S*Ie,h[2]=R*W+E*O+N*ye,h[5]=R*V+E*pe+N*Q,h[8]=R*B+E*ge+N*Ie,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[3]*=i,n[6]*=i,n[1]*=i,n[4]*=i,n[7]*=i,n[2]*=i,n[5]*=i,n[8]*=i,this}determinant(){const i=this.elements,n=i[0],l=i[1],u=i[2],h=i[3],p=i[4],g=i[5],_=i[6],b=i[7],A=i[8];return n*p*A-n*g*b-l*h*A+l*g*_+u*h*b-u*p*_}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const l=i.elements,u=this.elements,h=l[0],p=l[1],g=l[2],_=l[3],b=l[4],A=l[5],S=l[6],R=l[7],E=l[8],N=E*b-A*R,W=A*S-E*_,V=R*_-b*S,B=h*N+p*W+g*V;if(B===0)return this.set(0,0,0,0,0,0,0,0,0);const O=1/B;return u[0]=N*O,u[1]=(g*R-E*p)*O,u[2]=(A*p-g*b)*O,u[3]=W*O,u[4]=(E*h-g*S)*O,u[5]=(g*_-A*h)*O,u[6]=V*O,u[7]=(p*S-R*h)*O,u[8]=(b*h-p*_)*O,this}transpose(){let i;const n=this.elements;return i=n[1],n[1]=n[3],n[3]=i,i=n[2],n[2]=n[6],n[6]=i,i=n[5],n[5]=n[7],n[7]=i,this}getNormalMatrix(i){return this.setFromMatrix4(i).getInverse(this).transpose()}transposeIntoArray(i){const n=this.elements;return i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8],this}setUvTransform(i,n,l,u,h,p,g){const _=Math.cos(h),b=Math.sin(h);this.set(l*_,l*b,-l*(_*p+b*g)+p+i,-u*b,u*_,-u*(-b*p+_*g)+g+n,0,0,1)}scale(i,n){const l=this.elements;return l[0]*=i,l[3]*=i,l[6]*=i,l[1]*=n,l[4]*=n,l[7]*=n,this}rotate(i){const n=Math.cos(i),l=Math.sin(i),u=this.elements,h=u[0],p=u[3],g=u[6],_=u[1],b=u[4],A=u[7];return u[0]=n*h+l*_,u[3]=n*p+l*b,u[6]=n*g+l*A,u[1]=-l*h+n*_,u[4]=-l*p+n*b,u[7]=-l*g+n*A,this}translate(i,n){const l=this.elements;return l[0]+=i*l[2],l[3]+=i*l[5],l[6]+=i*l[8],l[1]+=n*l[2],l[4]+=n*l[5],l[7]+=n*l[8],this}equals(i){const n=this.elements,l=i.elements;for(let u=0;u<9;u++)if(n[u]!==l[u])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let l=0;l<9;l++)this.elements[l]=i[l+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.elements;return i[n]=l[0],i[n+1]=l[1],i[n+2]=l[2],i[n+3]=l[3],i[n+4]=l[4],i[n+5]=l[5],i[n+6]=l[6],i[n+7]=l[7],i[n+8]=l[8],i}}let Nu;const Gc={getDataURL:function(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement>"u")return r.src;let i;if(r instanceof HTMLCanvasElement)i=r;else{Nu===void 0&&(Nu=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Nu.width=r.width,Nu.height=r.height;const n=Nu.getContext("2d");r instanceof ImageData?n.putImageData(r,0,0):n.drawImage(r,0,0,r.width,r.height),i=Nu}return i.width>2048||i.height>2048?i.toDataURL("image/jpeg",.6):i.toDataURL("image/png")}};let Gw=0;function Vi(r,i,n,l,u,h,p,g,_,b){Object.defineProperty(this,"id",{value:Gw++}),this.uuid=Gn.generateUUID(),this.name="",this.image=r!==void 0?r:Vi.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=i!==void 0?i:Vi.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:Qr,this.wrapT=l!==void 0?l:Qr,this.magFilter=u!==void 0?u:Sn,this.minFilter=h!==void 0?h:Cu,this.anisotropy=_!==void 0?_:1,this.format=p!==void 0?p:fs,this.internalFormat=null,this.type=g!==void 0?g:Nc,this.offset=new xt(0,0),this.repeat=new xt(1,1),this.center=new xt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new La,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=b!==void 0?b:Bc,this.version=0,this.onUpdate=null}Vi.DEFAULT_IMAGE=void 0,Vi.DEFAULT_MAPPING=zl,Vi.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Vi,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.name=r.name,this.image=r.image,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this},toJSON:function(r){const i=r===void 0||typeof r=="string";if(!i&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];const n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const l=this.image;if(l.uuid===void 0&&(l.uuid=Gn.generateUUID()),!i&&r.images[l.uuid]===void 0){let u;if(Array.isArray(l)){u=[];for(let h=0,p=l.length;h<p;h++)u.push(Gc.getDataURL(l[h]))}else u=Gc.getDataURL(l);r.images[l.uuid]={uuid:l.uuid,url:u}}n.image=l.uuid}return i||(r.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(r){if(this.mapping!==zl)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case kl:r.x=r.x-Math.floor(r.x);break;case Qr:r.x=r.x<0?0:1;break;case bt:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case kl:r.y=r.y-Math.floor(r.y);break;case Qr:r.y=r.y<0?0:1;break;case bt:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}}),Object.defineProperty(Vi.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});class Gi{constructor(i=0,n=0,l=0,u=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=i,this.y=n,this.z=l,this.w=u}get width(){return this.z}set width(i){this.z=i}get height(){return this.w}set height(i){this.w=i}set(i,n,l,u){return this.x=i,this.y=n,this.z=l,this.w=u,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this.w=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setW(i){return this.w=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w!==void 0?i.w:1,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this.w+=i.w,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this.w+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this.w=i.w+n.w,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this.w+=i.w*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this.w-=i.w,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this.w-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this.w=i.w-n.w,this}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this.w*=i,this}applyMatrix4(i){const n=this.x,l=this.y,u=this.z,h=this.w,p=i.elements;return this.x=p[0]*n+p[4]*l+p[8]*u+p[12]*h,this.y=p[1]*n+p[5]*l+p[9]*u+p[13]*h,this.z=p[2]*n+p[6]*l+p[10]*u+p[14]*h,this.w=p[3]*n+p[7]*l+p[11]*u+p[15]*h,this}divideScalar(i){return this.multiplyScalar(1/i)}setAxisAngleFromQuaternion(i){this.w=2*Math.acos(i.w);const n=Math.sqrt(1-i.w*i.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=i.x/n,this.y=i.y/n,this.z=i.z/n),this}setAxisAngleFromRotationMatrix(i){let n,l,u,h;const _=i.elements,b=_[0],A=_[4],S=_[8],R=_[1],E=_[5],N=_[9],W=_[2],V=_[6],B=_[10];if(Math.abs(A-R)<.01&&Math.abs(S-W)<.01&&Math.abs(N-V)<.01){if(Math.abs(A+R)<.1&&Math.abs(S+W)<.1&&Math.abs(N+V)<.1&&Math.abs(b+E+B-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const pe=(b+1)/2,ge=(E+1)/2,ye=(B+1)/2,Q=(A+R)/4,Ie=(S+W)/4,tt=(N+V)/4;return pe>ge&&pe>ye?pe<.01?(l=0,u=.707106781,h=.707106781):(l=Math.sqrt(pe),u=Q/l,h=Ie/l):ge>ye?ge<.01?(l=.707106781,u=0,h=.707106781):(u=Math.sqrt(ge),l=Q/u,h=tt/u):ye<.01?(l=.707106781,u=.707106781,h=0):(h=Math.sqrt(ye),l=Ie/h,u=tt/h),this.set(l,u,h,n),this}let O=Math.sqrt((V-N)*(V-N)+(S-W)*(S-W)+(R-A)*(R-A));return Math.abs(O)<.001&&(O=1),this.x=(V-N)/O,this.y=(S-W)/O,this.z=(R-A)/O,this.w=Math.acos((b+E+B-1)/2),this}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this.w=Math.min(this.w,i.w),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this.w=Math.max(this.w,i.w),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this.w=Math.max(i.w,Math.min(n.w,this.w)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this.w=Math.max(i,Math.min(n,this.w)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z+this.w*i.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this.w+=(i.w-this.w)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this.z=i.z+(n.z-i.z)*l,this.w=i.w+(n.w-i.w)*l,this}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z&&i.w===this.w}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this.w=i[n+3],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i[n+3]=this.w,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this.w=i.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}function Os(r,i,n){this.width=r,this.height=i,this.scissor=new Gi(0,0,r,i),this.scissorTest=!1,this.viewport=new Gi(0,0,r,i),n=n||{},this.texture=new Vi(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=r,this.texture.image.height=i,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Sn,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!1,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}Os.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Os,isWebGLRenderTarget:!0,setSize:function(r,i){(this.width!==r||this.height!==i)&&(this.width=r,this.height=i,this.texture.image.width=r,this.texture.image.height=i,this.dispose()),this.viewport.set(0,0,r,i),this.scissor.set(0,0,r,i)},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.width=r.width,this.height=r.height,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function e0(r,i,n){Os.call(this,r,i,n),this.samples=4}e0.prototype=Object.assign(Object.create(Os.prototype),{constructor:e0,isWebGLMultisampleRenderTarget:!0,copy:function(r){return Os.prototype.copy.call(this,r),this.samples=r.samples,this}});class xa{constructor(i=0,n=0,l=0,u=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=i,this._y=n,this._z=l,this._w=u}static slerp(i,n,l,u){return l.copy(i).slerp(n,u)}static slerpFlat(i,n,l,u,h,p,g){let _=l[u+0],b=l[u+1],A=l[u+2],S=l[u+3];const R=h[p+0],E=h[p+1],N=h[p+2],W=h[p+3];if(S!==W||_!==R||b!==E||A!==N){let V=1-g;const B=_*R+b*E+A*N+S*W,O=B>=0?1:-1,pe=1-B*B;if(pe>Number.EPSILON){const ye=Math.sqrt(pe),Q=Math.atan2(ye,B*O);V=Math.sin(V*Q)/ye,g=Math.sin(g*Q)/ye}const ge=g*O;if(_=_*V+R*ge,b=b*V+E*ge,A=A*V+N*ge,S=S*V+W*ge,V===1-g){const ye=1/Math.sqrt(_*_+b*b+A*A+S*S);_*=ye,b*=ye,A*=ye,S*=ye}}i[n]=_,i[n+1]=b,i[n+2]=A,i[n+3]=S}static multiplyQuaternionsFlat(i,n,l,u,h,p){const g=l[u],_=l[u+1],b=l[u+2],A=l[u+3],S=h[p],R=h[p+1],E=h[p+2],N=h[p+3];return i[n]=g*N+A*S+_*E-b*R,i[n+1]=_*N+A*R+b*S-g*E,i[n+2]=b*N+A*E+g*R-_*S,i[n+3]=A*N-g*S-_*R-b*E,i}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get w(){return this._w}set w(i){this._w=i,this._onChangeCallback()}set(i,n,l,u){return this._x=i,this._y=n,this._z=l,this._w=u,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(i){return this._x=i.x,this._y=i.y,this._z=i.z,this._w=i.w,this._onChangeCallback(),this}setFromEuler(i,n){if(!(i&&i.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const l=i._x,u=i._y,h=i._z,p=i._order,g=Math.cos,_=Math.sin,b=g(l/2),A=g(u/2),S=g(h/2),R=_(l/2),E=_(u/2),N=_(h/2);switch(p){case"XYZ":this._x=R*A*S+b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S-R*E*N;break;case"YXZ":this._x=R*A*S+b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S+R*E*N;break;case"ZXY":this._x=R*A*S-b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S-R*E*N;break;case"ZYX":this._x=R*A*S-b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S+R*E*N;break;case"YZX":this._x=R*A*S+b*E*N,this._y=b*E*S+R*A*N,this._z=b*A*N-R*E*S,this._w=b*A*S-R*E*N;break;case"XZY":this._x=R*A*S-b*E*N,this._y=b*E*S-R*A*N,this._z=b*A*N+R*E*S,this._w=b*A*S+R*E*N;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+p)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(i,n){const l=n/2,u=Math.sin(l);return this._x=i.x*u,this._y=i.y*u,this._z=i.z*u,this._w=Math.cos(l),this._onChangeCallback(),this}setFromRotationMatrix(i){const n=i.elements,l=n[0],u=n[4],h=n[8],p=n[1],g=n[5],_=n[9],b=n[2],A=n[6],S=n[10],R=l+g+S;if(R>0){const E=.5/Math.sqrt(R+1);this._w=.25/E,this._x=(A-_)*E,this._y=(h-b)*E,this._z=(p-u)*E}else if(l>g&&l>S){const E=2*Math.sqrt(1+l-g-S);this._w=(A-_)/E,this._x=.25*E,this._y=(u+p)/E,this._z=(h+b)/E}else if(g>S){const E=2*Math.sqrt(1+g-l-S);this._w=(h-b)/E,this._x=(u+p)/E,this._y=.25*E,this._z=(_+A)/E}else{const E=2*Math.sqrt(1+S-l-g);this._w=(p-u)/E,this._x=(h+b)/E,this._y=(_+A)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(i,n){let u=i.dot(n)+1;return u<1e-6?(u=0,Math.abs(i.x)>Math.abs(i.z)?(this._x=-i.y,this._y=i.x,this._z=0,this._w=u):(this._x=0,this._y=-i.z,this._z=i.y,this._w=u)):(this._x=i.y*n.z-i.z*n.y,this._y=i.z*n.x-i.x*n.z,this._z=i.x*n.y-i.y*n.x,this._w=u),this.normalize()}angleTo(i){return 2*Math.acos(Math.abs(Gn.clamp(this.dot(i),-1,1)))}rotateTowards(i,n){const l=this.angleTo(i);if(l===0)return this;const u=Math.min(1,n/l);return this.slerp(i,u),this}identity(){return this.set(0,0,0,1)}inverse(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(i){return this._x*i._x+this._y*i._y+this._z*i._z+this._w*i._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let i=this.length();return i===0?(this._x=0,this._y=0,this._z=0,this._w=1):(i=1/i,this._x=this._x*i,this._y=this._y*i,this._z=this._z*i,this._w=this._w*i),this._onChangeCallback(),this}multiply(i,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(i,n)):this.multiplyQuaternions(this,i)}premultiply(i){return this.multiplyQuaternions(i,this)}multiplyQuaternions(i,n){const l=i._x,u=i._y,h=i._z,p=i._w,g=n._x,_=n._y,b=n._z,A=n._w;return this._x=l*A+p*g+u*b-h*_,this._y=u*A+p*_+h*g-l*b,this._z=h*A+p*b+l*_-u*g,this._w=p*A-l*g-u*_-h*b,this._onChangeCallback(),this}slerp(i,n){if(n===0)return this;if(n===1)return this.copy(i);const l=this._x,u=this._y,h=this._z,p=this._w;let g=p*i._w+l*i._x+u*i._y+h*i._z;if(g<0?(this._w=-i._w,this._x=-i._x,this._y=-i._y,this._z=-i._z,g=-g):this.copy(i),g>=1)return this._w=p,this._x=l,this._y=u,this._z=h,this;const _=1-g*g;if(_<=Number.EPSILON){const E=1-n;return this._w=E*p+n*this._w,this._x=E*l+n*this._x,this._y=E*u+n*this._y,this._z=E*h+n*this._z,this.normalize(),this._onChangeCallback(),this}const b=Math.sqrt(_),A=Math.atan2(b,g),S=Math.sin((1-n)*A)/b,R=Math.sin(n*A)/b;return this._w=p*S+this._w*R,this._x=l*S+this._x*R,this._y=u*S+this._y*R,this._z=h*S+this._z*R,this._onChangeCallback(),this}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._w===this._w}fromArray(i,n){return n===void 0&&(n=0),this._x=i[n],this._y=i[n+1],this._z=i[n+2],this._w=i[n+3],this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._w,i}fromBufferAttribute(i,n){return this._x=i.getX(n),this._y=i.getY(n),this._z=i.getZ(n),this._w=i.getW(n),this}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}class _e{constructor(i=0,n=0,l=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=n,this.z=l}set(i,n,l){return l===void 0&&(l=this.z),this.x=i,this.y=n,this.z=l,this}setScalar(i){return this.x=i,this.y=i,this.z=i,this}setX(i){return this.x=i,this}setY(i){return this.y=i,this}setZ(i){return this.z=i,this}setComponent(i,n){switch(i){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+i)}return this}getComponent(i){switch(i){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+i)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(i){return this.x=i.x,this.y=i.y,this.z=i.z,this}add(i,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(i,n)):(this.x+=i.x,this.y+=i.y,this.z+=i.z,this)}addScalar(i){return this.x+=i,this.y+=i,this.z+=i,this}addVectors(i,n){return this.x=i.x+n.x,this.y=i.y+n.y,this.z=i.z+n.z,this}addScaledVector(i,n){return this.x+=i.x*n,this.y+=i.y*n,this.z+=i.z*n,this}sub(i,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(i,n)):(this.x-=i.x,this.y-=i.y,this.z-=i.z,this)}subScalar(i){return this.x-=i,this.y-=i,this.z-=i,this}subVectors(i,n){return this.x=i.x-n.x,this.y=i.y-n.y,this.z=i.z-n.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(i,n)):(this.x*=i.x,this.y*=i.y,this.z*=i.z,this)}multiplyScalar(i){return this.x*=i,this.y*=i,this.z*=i,this}multiplyVectors(i,n){return this.x=i.x*n.x,this.y=i.y*n.y,this.z=i.z*n.z,this}applyEuler(i){return i&&i.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t0.setFromEuler(i))}applyAxisAngle(i,n){return this.applyQuaternion(t0.setFromAxisAngle(i,n))}applyMatrix3(i){const n=this.x,l=this.y,u=this.z,h=i.elements;return this.x=h[0]*n+h[3]*l+h[6]*u,this.y=h[1]*n+h[4]*l+h[7]*u,this.z=h[2]*n+h[5]*l+h[8]*u,this}applyNormalMatrix(i){return this.applyMatrix3(i).normalize()}applyMatrix4(i){const n=this.x,l=this.y,u=this.z,h=i.elements,p=1/(h[3]*n+h[7]*l+h[11]*u+h[15]);return this.x=(h[0]*n+h[4]*l+h[8]*u+h[12])*p,this.y=(h[1]*n+h[5]*l+h[9]*u+h[13])*p,this.z=(h[2]*n+h[6]*l+h[10]*u+h[14])*p,this}applyQuaternion(i){const n=this.x,l=this.y,u=this.z,h=i.x,p=i.y,g=i.z,_=i.w,b=_*n+p*u-g*l,A=_*l+g*n-h*u,S=_*u+h*l-p*n,R=-h*n-p*l-g*u;return this.x=b*_+R*-h+A*-g-S*-p,this.y=A*_+R*-p+S*-h-b*-g,this.z=S*_+R*-g+b*-p-A*-h,this}project(i){return this.applyMatrix4(i.matrixWorldInverse).applyMatrix4(i.projectionMatrix)}unproject(i){return this.applyMatrix4(i.projectionMatrixInverse).applyMatrix4(i.matrixWorld)}transformDirection(i){const n=this.x,l=this.y,u=this.z,h=i.elements;return this.x=h[0]*n+h[4]*l+h[8]*u,this.y=h[1]*n+h[5]*l+h[9]*u,this.z=h[2]*n+h[6]*l+h[10]*u,this.normalize()}divide(i){return this.x/=i.x,this.y/=i.y,this.z/=i.z,this}divideScalar(i){return this.multiplyScalar(1/i)}min(i){return this.x=Math.min(this.x,i.x),this.y=Math.min(this.y,i.y),this.z=Math.min(this.z,i.z),this}max(i){return this.x=Math.max(this.x,i.x),this.y=Math.max(this.y,i.y),this.z=Math.max(this.z,i.z),this}clamp(i,n){return this.x=Math.max(i.x,Math.min(n.x,this.x)),this.y=Math.max(i.y,Math.min(n.y,this.y)),this.z=Math.max(i.z,Math.min(n.z,this.z)),this}clampScalar(i,n){return this.x=Math.max(i,Math.min(n,this.x)),this.y=Math.max(i,Math.min(n,this.y)),this.z=Math.max(i,Math.min(n,this.z)),this}clampLength(i,n){const l=this.length();return this.divideScalar(l||1).multiplyScalar(Math.max(i,Math.min(n,l)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(i){return this.x*i.x+this.y*i.y+this.z*i.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(i){return this.normalize().multiplyScalar(i)}lerp(i,n){return this.x+=(i.x-this.x)*n,this.y+=(i.y-this.y)*n,this.z+=(i.z-this.z)*n,this}lerpVectors(i,n,l){return this.x=i.x+(n.x-i.x)*l,this.y=i.y+(n.y-i.y)*l,this.z=i.z+(n.z-i.z)*l,this}cross(i,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(i,n)):this.crossVectors(this,i)}crossVectors(i,n){const l=i.x,u=i.y,h=i.z,p=n.x,g=n.y,_=n.z;return this.x=u*_-h*g,this.y=h*p-l*_,this.z=l*g-u*p,this}projectOnVector(i){const n=i.lengthSq();if(n===0)return this.set(0,0,0);const l=i.dot(this)/n;return this.copy(i).multiplyScalar(l)}projectOnPlane(i){return cg.copy(this).projectOnVector(i),this.sub(cg)}reflect(i){return this.sub(cg.copy(i).multiplyScalar(2*this.dot(i)))}angleTo(i){const n=Math.sqrt(this.lengthSq()*i.lengthSq());if(n===0)return Math.PI/2;const l=this.dot(i)/n;return Math.acos(Gn.clamp(l,-1,1))}distanceTo(i){return Math.sqrt(this.distanceToSquared(i))}distanceToSquared(i){const n=this.x-i.x,l=this.y-i.y,u=this.z-i.z;return n*n+l*l+u*u}manhattanDistanceTo(i){return Math.abs(this.x-i.x)+Math.abs(this.y-i.y)+Math.abs(this.z-i.z)}setFromSpherical(i){return this.setFromSphericalCoords(i.radius,i.phi,i.theta)}setFromSphericalCoords(i,n,l){const u=Math.sin(n)*i;return this.x=u*Math.sin(l),this.y=Math.cos(n)*i,this.z=u*Math.cos(l),this}setFromCylindrical(i){return this.setFromCylindricalCoords(i.radius,i.theta,i.y)}setFromCylindricalCoords(i,n,l){return this.x=i*Math.sin(n),this.y=l,this.z=i*Math.cos(n),this}setFromMatrixPosition(i){const n=i.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(i){const n=this.setFromMatrixColumn(i,0).length(),l=this.setFromMatrixColumn(i,1).length(),u=this.setFromMatrixColumn(i,2).length();return this.x=n,this.y=l,this.z=u,this}setFromMatrixColumn(i,n){return this.fromArray(i.elements,n*4)}setFromMatrix3Column(i,n){return this.fromArray(i.elements,n*3)}equals(i){return i.x===this.x&&i.y===this.y&&i.z===this.z}fromArray(i,n){return n===void 0&&(n=0),this.x=i[n],this.y=i[n+1],this.z=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.x,i[n+1]=this.y,i[n+2]=this.z,i}fromBufferAttribute(i,n,l){return l!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=i.getX(n),this.y=i.getY(n),this.z=i.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const cg=new _e,t0=new xa;class Qo{constructor(i,n){Object.defineProperty(this,"isBox3",{value:!0}),this.min=i!==void 0?i:new _e(1/0,1/0,1/0),this.max=n!==void 0?n:new _e(-1/0,-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromArray(i){let n=1/0,l=1/0,u=1/0,h=-1/0,p=-1/0,g=-1/0;for(let _=0,b=i.length;_<b;_+=3){const A=i[_],S=i[_+1],R=i[_+2];A<n&&(n=A),S<l&&(l=S),R<u&&(u=R),A>h&&(h=A),S>p&&(p=S),R>g&&(g=R)}return this.min.set(n,l,u),this.max.set(h,p,g),this}setFromBufferAttribute(i){let n=1/0,l=1/0,u=1/0,h=-1/0,p=-1/0,g=-1/0;for(let _=0,b=i.count;_<b;_++){const A=i.getX(_),S=i.getY(_),R=i.getZ(_);A<n&&(n=A),S<l&&(l=S),R<u&&(u=R),A>h&&(h=A),S>p&&(p=S),R>g&&(g=R)}return this.min.set(n,l,u),this.max.set(h,p,g),this}setFromPoints(i){this.makeEmpty();for(let n=0,l=i.length;n<l;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const l=lf.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(l),this.max.copy(i).add(l),this}setFromObject(i){return this.makeEmpty(),this.expandByObject(i)}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(i){return i===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),i=new _e),this.isEmpty()?i.set(0,0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),i=new _e),this.isEmpty()?i.set(0,0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}expandByObject(i){i.updateWorldMatrix(!1,!1);const n=i.geometry;n!==void 0&&(n.boundingBox===null&&n.computeBoundingBox(),hg.copy(n.boundingBox),hg.applyMatrix4(i.matrixWorld),this.union(hg));const l=i.children;for(let u=0,h=l.length;u<h;u++)this.expandByObject(l[u]);return this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y||i.z<this.min.z||i.z>this.max.z)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y&&this.min.z<=i.min.z&&i.max.z<=this.max.z}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),n=new _e),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y),(i.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y||i.max.z<this.min.z||i.min.z>this.max.z)}intersectsSphere(i){return this.clampPoint(i.center,lf),lf.distanceToSquared(i.center)<=i.radius*i.radius}intersectsPlane(i){let n,l;return i.normal.x>0?(n=i.normal.x*this.min.x,l=i.normal.x*this.max.x):(n=i.normal.x*this.max.x,l=i.normal.x*this.min.x),i.normal.y>0?(n+=i.normal.y*this.min.y,l+=i.normal.y*this.max.y):(n+=i.normal.y*this.max.y,l+=i.normal.y*this.min.y),i.normal.z>0?(n+=i.normal.z*this.min.z,l+=i.normal.z*this.max.z):(n+=i.normal.z*this.max.z,l+=i.normal.z*this.min.z),n<=-i.constant&&l>=-i.constant}intersectsTriangle(i){if(this.isEmpty())return!1;this.getCenter(cf),Xd.subVectors(this.max,cf),Fu.subVectors(i.a,cf),Bu.subVectors(i.b,cf),Uu.subVectors(i.c,cf),Vl.subVectors(Bu,Fu),Wl.subVectors(Uu,Bu),zc.subVectors(Fu,Uu);let n=[0,-Vl.z,Vl.y,0,-Wl.z,Wl.y,0,-zc.z,zc.y,Vl.z,0,-Vl.x,Wl.z,0,-Wl.x,zc.z,0,-zc.x,-Vl.y,Vl.x,0,-Wl.y,Wl.x,0,-zc.y,zc.x,0];return!ug(n,Fu,Bu,Uu,Xd)||(n=[1,0,0,0,1,0,0,0,1],!ug(n,Fu,Bu,Uu,Xd))?!1:(Yd.crossVectors(Vl,Wl),n=[Yd.x,Yd.y,Yd.z],ug(n,Fu,Bu,Uu,Xd))}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),n=new _e),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return lf.copy(i).clamp(this.min,this.max).sub(i).length()}getBoundingSphere(i){return i===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(i.center),i.radius=this.getSize(lf).length()*.5,i}intersect(i){return this.min.max(i.min),this.max.min(i.max),this.isEmpty()&&this.makeEmpty(),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}applyMatrix4(i){return this.isEmpty()?this:($o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(i),$o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(i),$o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(i),$o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(i),$o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(i),$o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(i),$o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(i),$o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(i),this.setFromPoints($o),this)}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function ug(r,i,n,l,u){for(let h=0,p=r.length-3;h<=p;h+=3){Hc.fromArray(r,h);const g=u.x*Math.abs(Hc.x)+u.y*Math.abs(Hc.y)+u.z*Math.abs(Hc.z),_=i.dot(Hc),b=n.dot(Hc),A=l.dot(Hc);if(Math.max(-Math.max(_,b,A),Math.min(_,b,A))>g)return!1}return!0}const $o=[new _e,new _e,new _e,new _e,new _e,new _e,new _e,new _e],lf=new _e,hg=new Qo,Fu=new _e,Bu=new _e,Uu=new _e,Vl=new _e,Wl=new _e,zc=new _e,cf=new _e,Xd=new _e,Yd=new _e,Hc=new _e,zw=new Qo;class el{constructor(i,n){this.center=i!==void 0?i:new _e,this.radius=n!==void 0?n:-1}set(i,n){return this.center.copy(i),this.radius=n,this}setFromPoints(i,n){const l=this.center;n!==void 0?l.copy(n):zw.setFromPoints(i).getCenter(l);let u=0;for(let h=0,p=i.length;h<p;h++)u=Math.max(u,l.distanceToSquared(i[h]));return this.radius=Math.sqrt(u),this}clone(){return new this.constructor().copy(this)}copy(i){return this.center.copy(i.center),this.radius=i.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(i){return i.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(i){return i.distanceTo(this.center)-this.radius}intersectsSphere(i){const n=this.radius+i.radius;return i.center.distanceToSquared(this.center)<=n*n}intersectsBox(i){return i.intersectsSphere(this)}intersectsPlane(i){return Math.abs(i.distanceToPoint(this.center))<=this.radius}clampPoint(i,n){const l=this.center.distanceToSquared(i);return n===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),n=new _e),n.copy(i),l>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(i){return i===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),i=new Qo),this.isEmpty()?(i.makeEmpty(),i):(i.set(this.center,this.center),i.expandByScalar(this.radius),i)}applyMatrix4(i){return this.center.applyMatrix4(i),this.radius=this.radius*i.getMaxScaleOnAxis(),this}translate(i){return this.center.add(i),this}equals(i){return i.center.equals(this.center)&&i.radius===this.radius}}const tl=new _e,fg=new _e,jd=new _e,ql=new _e,dg=new _e,Zd=new _e,pg=new _e;class uf{constructor(i,n){this.origin=i!==void 0?i:new _e,this.direction=n!==void 0?n:new _e(0,0,-1)}set(i,n){return this.origin.copy(i),this.direction.copy(n),this}clone(){return new this.constructor().copy(this)}copy(i){return this.origin.copy(i.origin),this.direction.copy(i.direction),this}at(i,n){return n===void 0&&(console.warn("THREE.Ray: .at() target is now required"),n=new _e),n.copy(this.direction).multiplyScalar(i).add(this.origin)}lookAt(i){return this.direction.copy(i).sub(this.origin).normalize(),this}recast(i){return this.origin.copy(this.at(i,tl)),this}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),n=new _e),n.subVectors(i,this.origin);const l=n.dot(this.direction);return l<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(l).add(this.origin)}distanceToPoint(i){return Math.sqrt(this.distanceSqToPoint(i))}distanceSqToPoint(i){const n=tl.subVectors(i,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(i):(tl.copy(this.direction).multiplyScalar(n).add(this.origin),tl.distanceToSquared(i))}distanceSqToSegment(i,n,l,u){fg.copy(i).add(n).multiplyScalar(.5),jd.copy(n).sub(i).normalize(),ql.copy(this.origin).sub(fg);const h=i.distanceTo(n)*.5,p=-this.direction.dot(jd),g=ql.dot(this.direction),_=-ql.dot(jd),b=ql.lengthSq(),A=Math.abs(1-p*p);let S,R,E,N;if(A>0)if(S=p*_-g,R=p*g-_,N=h*A,S>=0)if(R>=-N)if(R<=N){const W=1/A;S*=W,R*=W,E=S*(S+p*R+2*g)+R*(p*S+R+2*_)+b}else R=h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;else R=-h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;else R<=-N?(S=Math.max(0,-(-p*h+g)),R=S>0?-h:Math.min(Math.max(-h,-_),h),E=-S*S+R*(R+2*_)+b):R<=N?(S=0,R=Math.min(Math.max(-h,-_),h),E=R*(R+2*_)+b):(S=Math.max(0,-(p*h+g)),R=S>0?h:Math.min(Math.max(-h,-_),h),E=-S*S+R*(R+2*_)+b);else R=p>0?-h:h,S=Math.max(0,-(p*R+g)),E=-S*S+R*(R+2*_)+b;return l&&l.copy(this.direction).multiplyScalar(S).add(this.origin),u&&u.copy(jd).multiplyScalar(R).add(fg),E}intersectSphere(i,n){tl.subVectors(i.center,this.origin);const l=tl.dot(this.direction),u=tl.dot(tl)-l*l,h=i.radius*i.radius;if(u>h)return null;const p=Math.sqrt(h-u),g=l-p,_=l+p;return g<0&&_<0?null:g<0?this.at(_,n):this.at(g,n)}intersectsSphere(i){return this.distanceSqToPoint(i.center)<=i.radius*i.radius}distanceToPlane(i){const n=i.normal.dot(this.direction);if(n===0)return i.distanceToPoint(this.origin)===0?0:null;const l=-(this.origin.dot(i.normal)+i.constant)/n;return l>=0?l:null}intersectPlane(i,n){const l=this.distanceToPlane(i);return l===null?null:this.at(l,n)}intersectsPlane(i){const n=i.distanceToPoint(this.origin);return n===0||i.normal.dot(this.direction)*n<0}intersectBox(i,n){let l,u,h,p,g,_;const b=1/this.direction.x,A=1/this.direction.y,S=1/this.direction.z,R=this.origin;return b>=0?(l=(i.min.x-R.x)*b,u=(i.max.x-R.x)*b):(l=(i.max.x-R.x)*b,u=(i.min.x-R.x)*b),A>=0?(h=(i.min.y-R.y)*A,p=(i.max.y-R.y)*A):(h=(i.max.y-R.y)*A,p=(i.min.y-R.y)*A),l>p||h>u||((h>l||l!==l)&&(l=h),(p<u||u!==u)&&(u=p),S>=0?(g=(i.min.z-R.z)*S,_=(i.max.z-R.z)*S):(g=(i.max.z-R.z)*S,_=(i.min.z-R.z)*S),l>_||g>u)||((g>l||l!==l)&&(l=g),(_<u||u!==u)&&(u=_),u<0)?null:this.at(l>=0?l:u,n)}intersectsBox(i){return this.intersectBox(i,tl)!==null}intersectTriangle(i,n,l,u,h){dg.subVectors(n,i),Zd.subVectors(l,i),pg.crossVectors(dg,Zd);let p=this.direction.dot(pg),g;if(p>0){if(u)return null;g=1}else if(p<0)g=-1,p=-p;else return null;ql.subVectors(this.origin,i);const _=g*this.direction.dot(Zd.crossVectors(ql,Zd));if(_<0)return null;const b=g*this.direction.dot(dg.cross(ql));if(b<0||_+b>p)return null;const A=-g*ql.dot(pg);return A<0?null:this.at(A/p,h)}applyMatrix4(i){return this.origin.applyMatrix4(i),this.direction.transformDirection(i),this}equals(i){return i.origin.equals(this.origin)&&i.direction.equals(this.direction)}}class zn{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(i,n,l,u,h,p,g,_,b,A,S,R,E,N,W,V){const B=this.elements;return B[0]=i,B[4]=n,B[8]=l,B[12]=u,B[1]=h,B[5]=p,B[9]=g,B[13]=_,B[2]=b,B[6]=A,B[10]=S,B[14]=R,B[3]=E,B[7]=N,B[11]=W,B[15]=V,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zn().fromArray(this.elements)}copy(i){const n=this.elements,l=i.elements;return n[0]=l[0],n[1]=l[1],n[2]=l[2],n[3]=l[3],n[4]=l[4],n[5]=l[5],n[6]=l[6],n[7]=l[7],n[8]=l[8],n[9]=l[9],n[10]=l[10],n[11]=l[11],n[12]=l[12],n[13]=l[13],n[14]=l[14],n[15]=l[15],this}copyPosition(i){const n=this.elements,l=i.elements;return n[12]=l[12],n[13]=l[13],n[14]=l[14],this}extractBasis(i,n,l){return i.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),l.setFromMatrixColumn(this,2),this}makeBasis(i,n,l){return this.set(i.x,n.x,l.x,0,i.y,n.y,l.y,0,i.z,n.z,l.z,0,0,0,0,1),this}extractRotation(i){const n=this.elements,l=i.elements,u=1/Gu.setFromMatrixColumn(i,0).length(),h=1/Gu.setFromMatrixColumn(i,1).length(),p=1/Gu.setFromMatrixColumn(i,2).length();return n[0]=l[0]*u,n[1]=l[1]*u,n[2]=l[2]*u,n[3]=0,n[4]=l[4]*h,n[5]=l[5]*h,n[6]=l[6]*h,n[7]=0,n[8]=l[8]*p,n[9]=l[9]*p,n[10]=l[10]*p,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(i){i&&i.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,l=i.x,u=i.y,h=i.z,p=Math.cos(l),g=Math.sin(l),_=Math.cos(u),b=Math.sin(u),A=Math.cos(h),S=Math.sin(h);if(i.order==="XYZ"){const R=p*A,E=p*S,N=g*A,W=g*S;n[0]=_*A,n[4]=-_*S,n[8]=b,n[1]=E+N*b,n[5]=R-W*b,n[9]=-g*_,n[2]=W-R*b,n[6]=N+E*b,n[10]=p*_}else if(i.order==="YXZ"){const R=_*A,E=_*S,N=b*A,W=b*S;n[0]=R+W*g,n[4]=N*g-E,n[8]=p*b,n[1]=p*S,n[5]=p*A,n[9]=-g,n[2]=E*g-N,n[6]=W+R*g,n[10]=p*_}else if(i.order==="ZXY"){const R=_*A,E=_*S,N=b*A,W=b*S;n[0]=R-W*g,n[4]=-p*S,n[8]=N+E*g,n[1]=E+N*g,n[5]=p*A,n[9]=W-R*g,n[2]=-p*b,n[6]=g,n[10]=p*_}else if(i.order==="ZYX"){const R=p*A,E=p*S,N=g*A,W=g*S;n[0]=_*A,n[4]=N*b-E,n[8]=R*b+W,n[1]=_*S,n[5]=W*b+R,n[9]=E*b-N,n[2]=-b,n[6]=g*_,n[10]=p*_}else if(i.order==="YZX"){const R=p*_,E=p*b,N=g*_,W=g*b;n[0]=_*A,n[4]=W-R*S,n[8]=N*S+E,n[1]=S,n[5]=p*A,n[9]=-g*A,n[2]=-b*A,n[6]=E*S+N,n[10]=R-W*S}else if(i.order==="XZY"){const R=p*_,E=p*b,N=g*_,W=g*b;n[0]=_*A,n[4]=-S,n[8]=b*A,n[1]=R*S+W,n[5]=p*A,n[9]=E*S-N,n[2]=N*S-E,n[6]=g*A,n[10]=W*S+R}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(i){return this.compose(Hw,i,kw)}lookAt(i,n,l){const u=this.elements;return Wa.subVectors(i,n),Wa.lengthSq()===0&&(Wa.z=1),Wa.normalize(),Xl.crossVectors(l,Wa),Xl.lengthSq()===0&&(Math.abs(l.z)===1?Wa.x+=1e-4:Wa.z+=1e-4,Wa.normalize(),Xl.crossVectors(l,Wa)),Xl.normalize(),Jd.crossVectors(Wa,Xl),u[0]=Xl.x,u[4]=Jd.x,u[8]=Wa.x,u[1]=Xl.y,u[5]=Jd.y,u[9]=Wa.y,u[2]=Xl.z,u[6]=Jd.z,u[10]=Wa.z,this}multiply(i,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(i,n)):this.multiplyMatrices(this,i)}premultiply(i){return this.multiplyMatrices(i,this)}multiplyMatrices(i,n){const l=i.elements,u=n.elements,h=this.elements,p=l[0],g=l[4],_=l[8],b=l[12],A=l[1],S=l[5],R=l[9],E=l[13],N=l[2],W=l[6],V=l[10],B=l[14],O=l[3],pe=l[7],ge=l[11],ye=l[15],Q=u[0],Ie=u[4],tt=u[8],qe=u[12],ht=u[1],Ye=u[5],Ne=u[9],Ue=u[13],Le=u[2],Te=u[6],Ve=u[10],We=u[14],rt=u[3],Tt=u[7],nt=u[11],Et=u[15];return h[0]=p*Q+g*ht+_*Le+b*rt,h[4]=p*Ie+g*Ye+_*Te+b*Tt,h[8]=p*tt+g*Ne+_*Ve+b*nt,h[12]=p*qe+g*Ue+_*We+b*Et,h[1]=A*Q+S*ht+R*Le+E*rt,h[5]=A*Ie+S*Ye+R*Te+E*Tt,h[9]=A*tt+S*Ne+R*Ve+E*nt,h[13]=A*qe+S*Ue+R*We+E*Et,h[2]=N*Q+W*ht+V*Le+B*rt,h[6]=N*Ie+W*Ye+V*Te+B*Tt,h[10]=N*tt+W*Ne+V*Ve+B*nt,h[14]=N*qe+W*Ue+V*We+B*Et,h[3]=O*Q+pe*ht+ge*Le+ye*rt,h[7]=O*Ie+pe*Ye+ge*Te+ye*Tt,h[11]=O*tt+pe*Ne+ge*Ve+ye*nt,h[15]=O*qe+pe*Ue+ge*We+ye*Et,this}multiplyScalar(i){const n=this.elements;return n[0]*=i,n[4]*=i,n[8]*=i,n[12]*=i,n[1]*=i,n[5]*=i,n[9]*=i,n[13]*=i,n[2]*=i,n[6]*=i,n[10]*=i,n[14]*=i,n[3]*=i,n[7]*=i,n[11]*=i,n[15]*=i,this}determinant(){const i=this.elements,n=i[0],l=i[4],u=i[8],h=i[12],p=i[1],g=i[5],_=i[9],b=i[13],A=i[2],S=i[6],R=i[10],E=i[14],N=i[3],W=i[7],V=i[11],B=i[15];return N*(+h*_*S-u*b*S-h*g*R+l*b*R+u*g*E-l*_*E)+W*(+n*_*E-n*b*R+h*p*R-u*p*E+u*b*A-h*_*A)+V*(+n*b*S-n*g*E-h*p*S+l*p*E+h*g*A-l*b*A)+B*(-u*g*A-n*_*S+n*g*R+u*p*S-l*p*R+l*_*A)}transpose(){const i=this.elements;let n;return n=i[1],i[1]=i[4],i[4]=n,n=i[2],i[2]=i[8],i[8]=n,n=i[6],i[6]=i[9],i[9]=n,n=i[3],i[3]=i[12],i[12]=n,n=i[7],i[7]=i[13],i[13]=n,n=i[11],i[11]=i[14],i[14]=n,this}setPosition(i,n,l){const u=this.elements;return i.isVector3?(u[12]=i.x,u[13]=i.y,u[14]=i.z):(u[12]=i,u[13]=n,u[14]=l),this}getInverse(i,n){n!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const l=this.elements,u=i.elements,h=u[0],p=u[1],g=u[2],_=u[3],b=u[4],A=u[5],S=u[6],R=u[7],E=u[8],N=u[9],W=u[10],V=u[11],B=u[12],O=u[13],pe=u[14],ge=u[15],ye=N*pe*R-O*W*R+O*S*V-A*pe*V-N*S*ge+A*W*ge,Q=B*W*R-E*pe*R-B*S*V+b*pe*V+E*S*ge-b*W*ge,Ie=E*O*R-B*N*R+B*A*V-b*O*V-E*A*ge+b*N*ge,tt=B*N*S-E*O*S-B*A*W+b*O*W+E*A*pe-b*N*pe,qe=h*ye+p*Q+g*Ie+_*tt;if(qe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ht=1/qe;return l[0]=ye*ht,l[1]=(O*W*_-N*pe*_-O*g*V+p*pe*V+N*g*ge-p*W*ge)*ht,l[2]=(A*pe*_-O*S*_+O*g*R-p*pe*R-A*g*ge+p*S*ge)*ht,l[3]=(N*S*_-A*W*_-N*g*R+p*W*R+A*g*V-p*S*V)*ht,l[4]=Q*ht,l[5]=(E*pe*_-B*W*_+B*g*V-h*pe*V-E*g*ge+h*W*ge)*ht,l[6]=(B*S*_-b*pe*_-B*g*R+h*pe*R+b*g*ge-h*S*ge)*ht,l[7]=(b*W*_-E*S*_+E*g*R-h*W*R-b*g*V+h*S*V)*ht,l[8]=Ie*ht,l[9]=(B*N*_-E*O*_-B*p*V+h*O*V+E*p*ge-h*N*ge)*ht,l[10]=(b*O*_-B*A*_+B*p*R-h*O*R-b*p*ge+h*A*ge)*ht,l[11]=(E*A*_-b*N*_-E*p*R+h*N*R+b*p*V-h*A*V)*ht,l[12]=tt*ht,l[13]=(E*O*g-B*N*g+B*p*W-h*O*W-E*p*pe+h*N*pe)*ht,l[14]=(B*A*g-b*O*g-B*p*S+h*O*S+b*p*pe-h*A*pe)*ht,l[15]=(b*N*g-E*A*g+E*p*S-h*N*S-b*p*W+h*A*W)*ht,this}scale(i){const n=this.elements,l=i.x,u=i.y,h=i.z;return n[0]*=l,n[4]*=u,n[8]*=h,n[1]*=l,n[5]*=u,n[9]*=h,n[2]*=l,n[6]*=u,n[10]*=h,n[3]*=l,n[7]*=u,n[11]*=h,this}getMaxScaleOnAxis(){const i=this.elements,n=i[0]*i[0]+i[1]*i[1]+i[2]*i[2],l=i[4]*i[4]+i[5]*i[5]+i[6]*i[6],u=i[8]*i[8]+i[9]*i[9]+i[10]*i[10];return Math.sqrt(Math.max(n,l,u))}makeTranslation(i,n,l){return this.set(1,0,0,i,0,1,0,n,0,0,1,l,0,0,0,1),this}makeRotationX(i){const n=Math.cos(i),l=Math.sin(i);return this.set(1,0,0,0,0,n,-l,0,0,l,n,0,0,0,0,1),this}makeRotationY(i){const n=Math.cos(i),l=Math.sin(i);return this.set(n,0,l,0,0,1,0,0,-l,0,n,0,0,0,0,1),this}makeRotationZ(i){const n=Math.cos(i),l=Math.sin(i);return this.set(n,-l,0,0,l,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(i,n){const l=Math.cos(n),u=Math.sin(n),h=1-l,p=i.x,g=i.y,_=i.z,b=h*p,A=h*g;return this.set(b*p+l,b*g-u*_,b*_+u*g,0,b*g+u*_,A*g+l,A*_-u*p,0,b*_-u*g,A*_+u*p,h*_*_+l,0,0,0,0,1),this}makeScale(i,n,l){return this.set(i,0,0,0,0,n,0,0,0,0,l,0,0,0,0,1),this}makeShear(i,n,l){return this.set(1,n,l,0,i,1,l,0,i,n,1,0,0,0,0,1),this}compose(i,n,l){const u=this.elements,h=n._x,p=n._y,g=n._z,_=n._w,b=h+h,A=p+p,S=g+g,R=h*b,E=h*A,N=h*S,W=p*A,V=p*S,B=g*S,O=_*b,pe=_*A,ge=_*S,ye=l.x,Q=l.y,Ie=l.z;return u[0]=(1-(W+B))*ye,u[1]=(E+ge)*ye,u[2]=(N-pe)*ye,u[3]=0,u[4]=(E-ge)*Q,u[5]=(1-(R+B))*Q,u[6]=(V+O)*Q,u[7]=0,u[8]=(N+pe)*Ie,u[9]=(V-O)*Ie,u[10]=(1-(R+W))*Ie,u[11]=0,u[12]=i.x,u[13]=i.y,u[14]=i.z,u[15]=1,this}decompose(i,n,l){const u=this.elements;let h=Gu.set(u[0],u[1],u[2]).length();const p=Gu.set(u[4],u[5],u[6]).length(),g=Gu.set(u[8],u[9],u[10]).length();this.determinant()<0&&(h=-h),i.x=u[12],i.y=u[13],i.z=u[14],Ns.copy(this);const b=1/h,A=1/p,S=1/g;return Ns.elements[0]*=b,Ns.elements[1]*=b,Ns.elements[2]*=b,Ns.elements[4]*=A,Ns.elements[5]*=A,Ns.elements[6]*=A,Ns.elements[8]*=S,Ns.elements[9]*=S,Ns.elements[10]*=S,n.setFromRotationMatrix(Ns),l.x=h,l.y=p,l.z=g,this}makePerspective(i,n,l,u,h,p){p===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const g=this.elements,_=2*h/(n-i),b=2*h/(l-u),A=(n+i)/(n-i),S=(l+u)/(l-u),R=-(p+h)/(p-h),E=-2*p*h/(p-h);return g[0]=_,g[4]=0,g[8]=A,g[12]=0,g[1]=0,g[5]=b,g[9]=S,g[13]=0,g[2]=0,g[6]=0,g[10]=R,g[14]=E,g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this}makeOrthographic(i,n,l,u,h,p){const g=this.elements,_=1/(n-i),b=1/(l-u),A=1/(p-h),S=(n+i)*_,R=(l+u)*b,E=(p+h)*A;return g[0]=2*_,g[4]=0,g[8]=0,g[12]=-S,g[1]=0,g[5]=2*b,g[9]=0,g[13]=-R,g[2]=0,g[6]=0,g[10]=-2*A,g[14]=-E,g[3]=0,g[7]=0,g[11]=0,g[15]=1,this}equals(i){const n=this.elements,l=i.elements;for(let u=0;u<16;u++)if(n[u]!==l[u])return!1;return!0}fromArray(i,n){n===void 0&&(n=0);for(let l=0;l<16;l++)this.elements[l]=i[l+n];return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.elements;return i[n]=l[0],i[n+1]=l[1],i[n+2]=l[2],i[n+3]=l[3],i[n+4]=l[4],i[n+5]=l[5],i[n+6]=l[6],i[n+7]=l[7],i[n+8]=l[8],i[n+9]=l[9],i[n+10]=l[10],i[n+11]=l[11],i[n+12]=l[12],i[n+13]=l[13],i[n+14]=l[14],i[n+15]=l[15],i}}const Gu=new _e,Ns=new zn,Hw=new _e(0,0,0),kw=new _e(1,1,1),Xl=new _e,Jd=new _e,Wa=new _e;class hf{constructor(i=0,n=0,l=0,u=hf.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=i,this._y=n,this._z=l,this._order=u}get x(){return this._x}set x(i){this._x=i,this._onChangeCallback()}get y(){return this._y}set y(i){this._y=i,this._onChangeCallback()}get z(){return this._z}set z(i){this._z=i,this._onChangeCallback()}get order(){return this._order}set order(i){this._order=i,this._onChangeCallback()}set(i,n,l,u){return this._x=i,this._y=n,this._z=l,this._order=u||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(i){return this._x=i._x,this._y=i._y,this._z=i._z,this._order=i._order,this._onChangeCallback(),this}setFromRotationMatrix(i,n,l){const u=Gn.clamp,h=i.elements,p=h[0],g=h[4],_=h[8],b=h[1],A=h[5],S=h[9],R=h[2],E=h[6],N=h[10];switch(n=n||this._order,n){case"XYZ":this._y=Math.asin(u(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-S,N),this._z=Math.atan2(-g,p)):(this._x=Math.atan2(E,A),this._z=0);break;case"YXZ":this._x=Math.asin(-u(S,-1,1)),Math.abs(S)<.9999999?(this._y=Math.atan2(_,N),this._z=Math.atan2(b,A)):(this._y=Math.atan2(-R,p),this._z=0);break;case"ZXY":this._x=Math.asin(u(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-R,N),this._z=Math.atan2(-g,A)):(this._y=0,this._z=Math.atan2(b,p));break;case"ZYX":this._y=Math.asin(-u(R,-1,1)),Math.abs(R)<.9999999?(this._x=Math.atan2(E,N),this._z=Math.atan2(b,p)):(this._x=0,this._z=Math.atan2(-g,A));break;case"YZX":this._z=Math.asin(u(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(-S,A),this._y=Math.atan2(-R,p)):(this._x=0,this._y=Math.atan2(_,N));break;case"XZY":this._z=Math.asin(-u(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(E,A),this._y=Math.atan2(_,p)):(this._x=Math.atan2(-S,N),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,l!==!1&&this._onChangeCallback(),this}setFromQuaternion(i,n,l){return n0.makeRotationFromQuaternion(i),this.setFromRotationMatrix(n0,n,l)}setFromVector3(i,n){return this.set(i.x,i.y,i.z,n||this._order)}reorder(i){return i0.setFromEuler(this),this.setFromQuaternion(i0,i)}equals(i){return i._x===this._x&&i._y===this._y&&i._z===this._z&&i._order===this._order}fromArray(i){return this._x=i[0],this._y=i[1],this._z=i[2],i[3]!==void 0&&(this._order=i[3]),this._onChangeCallback(),this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this._x,i[n+1]=this._y,i[n+2]=this._z,i[n+3]=this._order,i}toVector3(i){return i?i.set(this._x,this._y,this._z):new _e(this._x,this._y,this._z)}_onChange(i){return this._onChangeCallback=i,this}_onChangeCallback(){}}hf.DefaultOrder="XYZ",hf.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const n0=new zn,i0=new xa;class r0{constructor(){this.mask=1}set(i){this.mask=1<<i|0}enable(i){this.mask|=1<<i|0}enableAll(){this.mask=-1}toggle(i){this.mask^=1<<i|0}disable(i){this.mask&=~(1<<i|0)}disableAll(){this.mask=0}test(i){return(this.mask&i.mask)!==0}}let Vw=0;const a0=new _e,zu=new xa,nl=new zn,Kd=new _e,ff=new _e,Ww=new _e,qw=new xa,s0=new _e(1,0,0),o0=new _e(0,1,0),l0=new _e(0,0,1),Xw={type:"added"},Yw={type:"removed"};function hn(){Object.defineProperty(this,"id",{value:Vw++}),this.uuid=Gn.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=hn.DefaultUp.clone();const r=new _e,i=new hf,n=new xa,l=new _e(1,1,1);function u(){n.setFromEuler(i,!1)}function h(){i.setFromQuaternion(n,void 0,!1)}i._onChange(u),n._onChange(h),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new zn},normalMatrix:{value:new La}}),this.matrix=new zn,this.matrixWorld=new zn,this.matrixAutoUpdate=hn.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new r0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}hn.DefaultUp=new _e(0,1,0),hn.DefaultMatrixAutoUpdate=!0,hn.prototype=Object.assign(Object.create(Ds.prototype),{constructor:hn,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(r){return this.quaternion.premultiply(r),this},setRotationFromAxisAngle:function(r,i){this.quaternion.setFromAxisAngle(r,i)},setRotationFromEuler:function(r){this.quaternion.setFromEuler(r,!0)},setRotationFromMatrix:function(r){this.quaternion.setFromRotationMatrix(r)},setRotationFromQuaternion:function(r){this.quaternion.copy(r)},rotateOnAxis:function(r,i){return zu.setFromAxisAngle(r,i),this.quaternion.multiply(zu),this},rotateOnWorldAxis:function(r,i){return zu.setFromAxisAngle(r,i),this.quaternion.premultiply(zu),this},rotateX:function(r){return this.rotateOnAxis(s0,r)},rotateY:function(r){return this.rotateOnAxis(o0,r)},rotateZ:function(r){return this.rotateOnAxis(l0,r)},translateOnAxis:function(r,i){return a0.copy(r).applyQuaternion(this.quaternion),this.position.add(a0.multiplyScalar(i)),this},translateX:function(r){return this.translateOnAxis(s0,r)},translateY:function(r){return this.translateOnAxis(o0,r)},translateZ:function(r){return this.translateOnAxis(l0,r)},localToWorld:function(r){return r.applyMatrix4(this.matrixWorld)},worldToLocal:function(r){return r.applyMatrix4(nl.getInverse(this.matrixWorld))},lookAt:function(r,i,n){r.isVector3?Kd.copy(r):Kd.set(r,i,n);const l=this.parent;this.updateWorldMatrix(!0,!1),ff.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?nl.lookAt(ff,Kd,this.up):nl.lookAt(Kd,ff,this.up),this.quaternion.setFromRotationMatrix(nl),l&&(nl.extractRotation(l.matrixWorld),zu.setFromRotationMatrix(nl),this.quaternion.premultiply(zu.inverse()))},add:function(r){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(Xw)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)},remove:function(r){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const i=this.children.indexOf(r);return i!==-1&&(r.parent=null,this.children.splice(i,1),r.dispatchEvent(Yw)),this},attach:function(r){return this.updateWorldMatrix(!0,!1),nl.getInverse(this.matrixWorld),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),nl.multiply(r.parent.matrixWorld)),r.applyMatrix4(nl),r.updateWorldMatrix(!1,!1),this.add(r),this},getObjectById:function(r){return this.getObjectByProperty("id",r)},getObjectByName:function(r){return this.getObjectByProperty("name",r)},getObjectByProperty:function(r,i){if(this[r]===i)return this;for(let n=0,l=this.children.length;n<l;n++){const h=this.children[n].getObjectByProperty(r,i);if(h!==void 0)return h}},getWorldPosition:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),r=new xa),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ff,r,Ww),r},getWorldScale:function(r){return r===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(ff,qw,r),r},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),r=new _e),this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return r.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(r){r(this);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].traverse(r)},traverseVisible:function(r){if(this.visible===!1)return;r(this);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].traverseVisible(r)},traverseAncestors:function(r){const i=this.parent;i!==null&&(r(i),i.traverseAncestors(r))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);const i=this.children;for(let n=0,l=i.length;n<l;n++)i[n].updateMatrixWorld(r)},updateWorldMatrix:function(r,i){const n=this.parent;if(r===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const l=this.children;for(let u=0,h=l.length;u<h;u++)l[u].updateWorldMatrix(!1,!0)}},toJSON:function(r){const i=r===void 0||typeof r=="string",n={};i&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.castShadow===!0&&(l.castShadow=!0),this.receiveShadow===!0&&(l.receiveShadow=!0),this.visible===!1&&(l.visible=!1),this.frustumCulled===!1&&(l.frustumCulled=!1),this.renderOrder!==0&&(l.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON());function u(p,g){return p[g.uuid]===void 0&&(p[g.uuid]=g.toJSON(r)),g.uuid}if(this.isMesh||this.isLine||this.isPoints){l.geometry=u(r.geometries,this.geometry);const p=this.geometry.parameters;if(p!==void 0&&p.shapes!==void 0){const g=p.shapes;if(Array.isArray(g))for(let _=0,b=g.length;_<b;_++){const A=g[_];u(r.shapes,A)}else u(r.shapes,g)}}if(this.material!==void 0)if(Array.isArray(this.material)){const p=[];for(let g=0,_=this.material.length;g<_;g++)p.push(u(r.materials,this.material[g]));l.material=p}else l.material=u(r.materials,this.material);if(this.children.length>0){l.children=[];for(let p=0;p<this.children.length;p++)l.children.push(this.children[p].toJSON(r).object)}if(i){const p=h(r.geometries),g=h(r.materials),_=h(r.textures),b=h(r.images),A=h(r.shapes);p.length>0&&(n.geometries=p),g.length>0&&(n.materials=g),_.length>0&&(n.textures=_),b.length>0&&(n.images=b),A.length>0&&(n.shapes=A)}return n.object=l,n;function h(p){const g=[];for(const _ in p){const b=p[_];delete b.metadata,g.push(b)}return g}},clone:function(r){return new this.constructor().copy(this,r)},copy:function(r,i){if(i===void 0&&(i=!0),this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),i===!0)for(let n=0;n<r.children.length;n++){const l=r.children[n];this.add(l.clone())}return this}});const mg=new _e,jw=new _e,Zw=new La;class il{constructor(i,n){Object.defineProperty(this,"isPlane",{value:!0}),this.normal=i!==void 0?i:new _e(1,0,0),this.constant=n!==void 0?n:0}set(i,n){return this.normal.copy(i),this.constant=n,this}setComponents(i,n,l,u){return this.normal.set(i,n,l),this.constant=u,this}setFromNormalAndCoplanarPoint(i,n){return this.normal.copy(i),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(i,n,l){const u=mg.subVectors(l,n).cross(jw.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(u,i),this}clone(){return new this.constructor().copy(this)}copy(i){return this.normal.copy(i.normal),this.constant=i.constant,this}normalize(){const i=1/this.normal.length();return this.normal.multiplyScalar(i),this.constant*=i,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(i){return this.normal.dot(i)+this.constant}distanceToSphere(i){return this.distanceToPoint(i.center)-i.radius}projectPoint(i,n){return n===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),n=new _e),n.copy(this.normal).multiplyScalar(-this.distanceToPoint(i)).add(i)}intersectLine(i,n){n===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new _e);const l=i.delta(mg),u=this.normal.dot(l);if(u===0)return this.distanceToPoint(i.start)===0?n.copy(i.start):void 0;const h=-(i.start.dot(this.normal)+this.constant)/u;if(!(h<0||h>1))return n.copy(l).multiplyScalar(h).add(i.start)}intersectsLine(i){const n=this.distanceToPoint(i.start),l=this.distanceToPoint(i.end);return n<0&&l>0||l<0&&n>0}intersectsBox(i){return i.intersectsPlane(this)}intersectsSphere(i){return i.intersectsPlane(this)}coplanarPoint(i){return i===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),i=new _e),i.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(i,n){const l=n||Zw.getNormalMatrix(i),u=this.coplanarPoint(mg).applyMatrix4(i),h=this.normal.applyMatrix3(l).normalize();return this.constant=-u.dot(h),this}translate(i){return this.constant-=i.dot(this.normal),this}equals(i){return i.normal.equals(this.normal)&&i.constant===this.constant}}const Fs=new _e,rl=new _e,gg=new _e,al=new _e,Hu=new _e,ku=new _e,c0=new _e,vg=new _e,yg=new _e,_g=new _e;class sa{constructor(i,n,l){this.a=i!==void 0?i:new _e,this.b=n!==void 0?n:new _e,this.c=l!==void 0?l:new _e}static getNormal(i,n,l,u){u===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),u=new _e),u.subVectors(l,n),Fs.subVectors(i,n),u.cross(Fs);const h=u.lengthSq();return h>0?u.multiplyScalar(1/Math.sqrt(h)):u.set(0,0,0)}static getBarycoord(i,n,l,u,h){Fs.subVectors(u,n),rl.subVectors(l,n),gg.subVectors(i,n);const p=Fs.dot(Fs),g=Fs.dot(rl),_=Fs.dot(gg),b=rl.dot(rl),A=rl.dot(gg),S=p*b-g*g;if(h===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),h=new _e),S===0)return h.set(-2,-1,-1);const R=1/S,E=(b*_-g*A)*R,N=(p*A-g*_)*R;return h.set(1-E-N,N,E)}static containsPoint(i,n,l,u){return this.getBarycoord(i,n,l,u,al),al.x>=0&&al.y>=0&&al.x+al.y<=1}static getUV(i,n,l,u,h,p,g,_){return this.getBarycoord(i,n,l,u,al),_.set(0,0),_.addScaledVector(h,al.x),_.addScaledVector(p,al.y),_.addScaledVector(g,al.z),_}static isFrontFacing(i,n,l,u){return Fs.subVectors(l,n),rl.subVectors(i,n),Fs.cross(rl).dot(u)<0}set(i,n,l){return this.a.copy(i),this.b.copy(n),this.c.copy(l),this}setFromPointsAndIndices(i,n,l,u){return this.a.copy(i[n]),this.b.copy(i[l]),this.c.copy(i[u]),this}clone(){return new this.constructor().copy(this)}copy(i){return this.a.copy(i.a),this.b.copy(i.b),this.c.copy(i.c),this}getArea(){return Fs.subVectors(this.c,this.b),rl.subVectors(this.a,this.b),Fs.cross(rl).length()*.5}getMidpoint(i){return i===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),i=new _e),i.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return sa.getNormal(this.a,this.b,this.c,i)}getPlane(i){return i===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),i=new il),i.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,n){return sa.getBarycoord(i,this.a,this.b,this.c,n)}getUV(i,n,l,u,h){return sa.getUV(i,this.a,this.b,this.c,n,l,u,h)}containsPoint(i){return sa.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return sa.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(i){return i.intersectsTriangle(this)}closestPointToPoint(i,n){n===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),n=new _e);const l=this.a,u=this.b,h=this.c;let p,g;Hu.subVectors(u,l),ku.subVectors(h,l),vg.subVectors(i,l);const _=Hu.dot(vg),b=ku.dot(vg);if(_<=0&&b<=0)return n.copy(l);yg.subVectors(i,u);const A=Hu.dot(yg),S=ku.dot(yg);if(A>=0&&S<=A)return n.copy(u);const R=_*S-A*b;if(R<=0&&_>=0&&A<=0)return p=_/(_-A),n.copy(l).addScaledVector(Hu,p);_g.subVectors(i,h);const E=Hu.dot(_g),N=ku.dot(_g);if(N>=0&&E<=N)return n.copy(h);const W=E*b-_*N;if(W<=0&&b>=0&&N<=0)return g=b/(b-N),n.copy(l).addScaledVector(ku,g);const V=A*N-E*S;if(V<=0&&S-A>=0&&E-N>=0)return c0.subVectors(h,u),g=(S-A)/(S-A+(E-N)),n.copy(u).addScaledVector(c0,g);const B=1/(V+W+R);return p=W*B,g=R*B,n.copy(l).addScaledVector(Hu,p).addScaledVector(ku,g)}equals(i){return i.a.equals(this.a)&&i.b.equals(this.b)&&i.c.equals(this.c)}}const u0={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Bs={h:0,s:0,l:0},Qd={h:0,s:0,l:0};function xg(r,i,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?r+(i-r)*6*n:n<1/2?i:n<2/3?r+(i-r)*6*(2/3-n):r}function bg(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function wg(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}class Kt{constructor(i,n,l){return Object.defineProperty(this,"isColor",{value:!0}),n===void 0&&l===void 0?this.set(i):this.setRGB(i,n,l)}set(i){return i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i),this}setScalar(i){return this.r=i,this.g=i,this.b=i,this}setHex(i){return i=Math.floor(i),this.r=(i>>16&255)/255,this.g=(i>>8&255)/255,this.b=(i&255)/255,this}setRGB(i,n,l){return this.r=i,this.g=n,this.b=l,this}setHSL(i,n,l){if(i=Gn.euclideanModulo(i,1),n=Gn.clamp(n,0,1),l=Gn.clamp(l,0,1),n===0)this.r=this.g=this.b=l;else{const u=l<=.5?l*(1+n):l+n-l*n,h=2*l-u;this.r=xg(h,u,i+1/3),this.g=xg(h,u,i),this.b=xg(h,u,i-1/3)}return this}setStyle(i){function n(u){u!==void 0&&parseFloat(u)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}let l;if(l=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(i)){let u;const h=l[1],p=l[2];switch(h){case"rgb":case"rgba":if(u=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p))return this.r=Math.min(255,parseInt(u[1],10))/255,this.g=Math.min(255,parseInt(u[2],10))/255,this.b=Math.min(255,parseInt(u[3],10))/255,n(u[5]),this;if(u=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p))return this.r=Math.min(100,parseInt(u[1],10))/100,this.g=Math.min(100,parseInt(u[2],10))/100,this.b=Math.min(100,parseInt(u[3],10))/100,n(u[5]),this;break;case"hsl":case"hsla":if(u=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(p)){const g=parseFloat(u[1])/360,_=parseInt(u[2],10)/100,b=parseInt(u[3],10)/100;return n(u[5]),this.setHSL(g,_,b)}break}}else if(l=/^\#([A-Fa-f0-9]+)$/.exec(i)){const u=l[1],h=u.length;if(h===3)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(h===6)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return i&&i.length>0?this.setColorName(i):this}setColorName(i){const n=u0[i];return n!==void 0?this.setHex(n):console.warn("THREE.Color: Unknown color "+i),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(i){return this.r=i.r,this.g=i.g,this.b=i.b,this}copyGammaToLinear(i,n){return n===void 0&&(n=2),this.r=Math.pow(i.r,n),this.g=Math.pow(i.g,n),this.b=Math.pow(i.b,n),this}copyLinearToGamma(i,n){n===void 0&&(n=2);const l=n>0?1/n:1;return this.r=Math.pow(i.r,l),this.g=Math.pow(i.g,l),this.b=Math.pow(i.b,l),this}convertGammaToLinear(i){return this.copyGammaToLinear(this,i),this}convertLinearToGamma(i){return this.copyLinearToGamma(this,i),this}copySRGBToLinear(i){return this.r=bg(i.r),this.g=bg(i.g),this.b=bg(i.b),this}copyLinearToSRGB(i){return this.r=wg(i.r),this.g=wg(i.g),this.b=wg(i.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(i){i===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),i={h:0,s:0,l:0});const n=this.r,l=this.g,u=this.b,h=Math.max(n,l,u),p=Math.min(n,l,u);let g,_;const b=(p+h)/2;if(p===h)g=0,_=0;else{const A=h-p;switch(_=b<=.5?A/(h+p):A/(2-h-p),h){case n:g=(l-u)/A+(l<u?6:0);break;case l:g=(u-n)/A+2;break;case u:g=(n-l)/A+4;break}g/=6}return i.h=g,i.s=_,i.l=b,i}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(i,n,l){return this.getHSL(Bs),Bs.h+=i,Bs.s+=n,Bs.l+=l,this.setHSL(Bs.h,Bs.s,Bs.l),this}add(i){return this.r+=i.r,this.g+=i.g,this.b+=i.b,this}addColors(i,n){return this.r=i.r+n.r,this.g=i.g+n.g,this.b=i.b+n.b,this}addScalar(i){return this.r+=i,this.g+=i,this.b+=i,this}sub(i){return this.r=Math.max(0,this.r-i.r),this.g=Math.max(0,this.g-i.g),this.b=Math.max(0,this.b-i.b),this}multiply(i){return this.r*=i.r,this.g*=i.g,this.b*=i.b,this}multiplyScalar(i){return this.r*=i,this.g*=i,this.b*=i,this}lerp(i,n){return this.r+=(i.r-this.r)*n,this.g+=(i.g-this.g)*n,this.b+=(i.b-this.b)*n,this}lerpHSL(i,n){this.getHSL(Bs),i.getHSL(Qd);const l=Gn.lerp(Bs.h,Qd.h,n),u=Gn.lerp(Bs.s,Qd.s,n),h=Gn.lerp(Bs.l,Qd.l,n);return this.setHSL(l,u,h),this}equals(i){return i.r===this.r&&i.g===this.g&&i.b===this.b}fromArray(i,n){return n===void 0&&(n=0),this.r=i[n],this.g=i[n+1],this.b=i[n+2],this}toArray(i,n){return i===void 0&&(i=[]),n===void 0&&(n=0),i[n]=this.r,i[n+1]=this.g,i[n+2]=this.b,i}fromBufferAttribute(i,n){return this.r=i.getX(n),this.g=i.getY(n),this.b=i.getZ(n),i.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Kt.NAMES=u0,Kt.prototype.r=1,Kt.prototype.g=1,Kt.prototype.b=1;class Mg{constructor(i,n,l,u,h,p){this.a=i,this.b=n,this.c=l,this.normal=u&&u.isVector3?u:new _e,this.vertexNormals=Array.isArray(u)?u:[],this.color=h&&h.isColor?h:new Kt,this.vertexColors=Array.isArray(h)?h:[],this.materialIndex=p!==void 0?p:0}clone(){return new this.constructor().copy(this)}copy(i){this.a=i.a,this.b=i.b,this.c=i.c,this.normal.copy(i.normal),this.color.copy(i.color),this.materialIndex=i.materialIndex;for(let n=0,l=i.vertexNormals.length;n<l;n++)this.vertexNormals[n]=i.vertexNormals[n].clone();for(let n=0,l=i.vertexColors.length;n<l;n++)this.vertexColors[n]=i.vertexColors[n].clone();return this}}let Jw=0;function bn(){Object.defineProperty(this,"id",{value:Jw++}),this.uuid=Gn.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=wr,this.side=Ui,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Yo,this.blendDst=ka,this.blendEquation=rr,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Va,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Uw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=lg,this.stencilZFail=lg,this.stencilZPass=lg,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}bn.prototype=Object.assign(Object.create(Ds.prototype),{constructor:bn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(r){if(r!==void 0)for(const i in r){const n=r[i];if(n===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}if(i==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Zr;continue}const l=this[i];if(l===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}l&&l.isColor?l.set(n):l&&l.isVector3&&n&&n.isVector3?l.copy(n):this[i]=n}},toJSON:function(r){const i=r===void 0||typeof r=="string";i&&(r={textures:{},images:{}});const n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(r).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(r).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(r).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(r).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(r).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(r).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(r).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==wr&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==Ui&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function l(u){const h=[];for(const p in u){const g=u[p];delete g.metadata,h.push(g)}return h}if(i){const u=l(r.textures),h=l(r.images);u.length>0&&(n.textures=u),h.length>0&&(n.images=h)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(r){this.name=r.name,this.fog=r.fog,this.blending=r.blending,this.side=r.side,this.flatShading=r.flatShading,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const i=r.clippingPlanes;let n=null;if(i!==null){const l=i.length;n=new Array(l);for(let u=0;u!==l;++u)n[u]=i[u].clone()}return this.clippingPlanes=n,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.premultipliedAlpha=r.premultipliedAlpha,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(bn.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}});function ds(r){bn.call(this),this.type="MeshBasicMaterial",this.color=new Kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ps,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(r)}ds.prototype=Object.create(bn.prototype),ds.prototype.constructor=ds,ds.prototype.isMeshBasicMaterial=!0,ds.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this};const Wi=new _e,$d=new xt;function Nn(r,i,n){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=r,this.itemSize=i,this.count=r!==void 0?r.length/i:0,this.normalized=n===!0,this.usage=Wd,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Nn.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Nn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.itemSize,n*=i.itemSize;for(let l=0,u=this.itemSize;l<u;l++)this.array[r+l]=i.array[n+l];return this},copyArray:function(r){return this.array.set(r),this},copyColorsArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",l),h=new Kt),i[n++]=h.r,i[n++]=h.g,i[n++]=h.b}return this},copyVector2sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",l),h=new xt),i[n++]=h.x,i[n++]=h.y}return this},copyVector3sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",l),h=new _e),i[n++]=h.x,i[n++]=h.y,i[n++]=h.z}return this},copyVector4sArray:function(r){const i=this.array;let n=0;for(let l=0,u=r.length;l<u;l++){let h=r[l];h===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",l),h=new Gi),i[n++]=h.x,i[n++]=h.y,i[n++]=h.z,i[n++]=h.w}return this},applyMatrix3:function(r){if(this.itemSize===2)for(let i=0,n=this.count;i<n;i++)$d.fromBufferAttribute(this,i),$d.applyMatrix3(r),this.setXY(i,$d.x,$d.y);else if(this.itemSize===3)for(let i=0,n=this.count;i<n;i++)Wi.fromBufferAttribute(this,i),Wi.applyMatrix3(r),this.setXYZ(i,Wi.x,Wi.y,Wi.z);return this},applyMatrix4:function(r){for(let i=0,n=this.count;i<n;i++)Wi.x=this.getX(i),Wi.y=this.getY(i),Wi.z=this.getZ(i),Wi.applyMatrix4(r),this.setXYZ(i,Wi.x,Wi.y,Wi.z);return this},applyNormalMatrix:function(r){for(let i=0,n=this.count;i<n;i++)Wi.x=this.getX(i),Wi.y=this.getY(i),Wi.z=this.getZ(i),Wi.applyNormalMatrix(r),this.setXYZ(i,Wi.x,Wi.y,Wi.z);return this},transformDirection:function(r){for(let i=0,n=this.count;i<n;i++)Wi.x=this.getX(i),Wi.y=this.getY(i),Wi.z=this.getZ(i),Wi.transformDirection(r),this.setXYZ(i,Wi.x,Wi.y,Wi.z);return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},getX:function(r){return this.array[r*this.itemSize]},setX:function(r,i){return this.array[r*this.itemSize]=i,this},getY:function(r){return this.array[r*this.itemSize+1]},setY:function(r,i){return this.array[r*this.itemSize+1]=i,this},getZ:function(r){return this.array[r*this.itemSize+2]},setZ:function(r,i){return this.array[r*this.itemSize+2]=i,this},getW:function(r){return this.array[r*this.itemSize+3]},setW:function(r,i){return this.array[r*this.itemSize+3]=i,this},setXY:function(r,i,n){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this},setXYZ:function(r,i,n,l){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=l,this},setXYZW:function(r,i,n,l,u){return r*=this.itemSize,this.array[r+0]=i,this.array[r+1]=n,this.array[r+2]=l,this.array[r+3]=u,this},onUpload:function(r){return this.onUploadCallback=r,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Sg(r,i,n){Nn.call(this,new Int8Array(r),i,n)}Sg.prototype=Object.create(Nn.prototype),Sg.prototype.constructor=Sg;function Tg(r,i,n){Nn.call(this,new Uint8Array(r),i,n)}Tg.prototype=Object.create(Nn.prototype),Tg.prototype.constructor=Tg;function Eg(r,i,n){Nn.call(this,new Uint8ClampedArray(r),i,n)}Eg.prototype=Object.create(Nn.prototype),Eg.prototype.constructor=Eg;function Ag(r,i,n){Nn.call(this,new Int16Array(r),i,n)}Ag.prototype=Object.create(Nn.prototype),Ag.prototype.constructor=Ag;function df(r,i,n){Nn.call(this,new Uint16Array(r),i,n)}df.prototype=Object.create(Nn.prototype),df.prototype.constructor=df;function Lg(r,i,n){Nn.call(this,new Int32Array(r),i,n)}Lg.prototype=Object.create(Nn.prototype),Lg.prototype.constructor=Lg;function pf(r,i,n){Nn.call(this,new Uint32Array(r),i,n)}pf.prototype=Object.create(Nn.prototype),pf.prototype.constructor=pf;function Mi(r,i,n){Nn.call(this,new Float32Array(r),i,n)}Mi.prototype=Object.create(Nn.prototype),Mi.prototype.constructor=Mi;function Rg(r,i,n){Nn.call(this,new Float64Array(r),i,n)}Rg.prototype=Object.create(Nn.prototype),Rg.prototype.constructor=Rg;class Kw{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(i){const n=[];let l,u,h;const p=i.faces;for(u=0;u<p.length;u++){const g=p[u];g.materialIndex!==h&&(h=g.materialIndex,l!==void 0&&(l.count=u*3-l.start,n.push(l)),l={start:u*3,materialIndex:h})}l!==void 0&&(l.count=u*3-l.start,n.push(l)),this.groups=n}fromGeometry(i){const n=i.faces,l=i.vertices,u=i.faceVertexUvs,h=u[0]&&u[0].length>0,p=u[1]&&u[1].length>0,g=i.morphTargets,_=g.length;let b;if(_>0){b=[];for(let B=0;B<_;B++)b[B]={name:g[B].name,data:[]};this.morphTargets.position=b}const A=i.morphNormals,S=A.length;let R;if(S>0){R=[];for(let B=0;B<S;B++)R[B]={name:A[B].name,data:[]};this.morphTargets.normal=R}const E=i.skinIndices,N=i.skinWeights,W=E.length===l.length,V=N.length===l.length;l.length>0&&n.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let B=0;B<n.length;B++){const O=n[B];this.vertices.push(l[O.a],l[O.b],l[O.c]);const pe=O.vertexNormals;if(pe.length===3)this.normals.push(pe[0],pe[1],pe[2]);else{const ye=O.normal;this.normals.push(ye,ye,ye)}const ge=O.vertexColors;if(ge.length===3)this.colors.push(ge[0],ge[1],ge[2]);else{const ye=O.color;this.colors.push(ye,ye,ye)}if(h===!0){const ye=u[0][B];ye!==void 0?this.uvs.push(ye[0],ye[1],ye[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",B),this.uvs.push(new xt,new xt,new xt))}if(p===!0){const ye=u[1][B];ye!==void 0?this.uvs2.push(ye[0],ye[1],ye[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",B),this.uvs2.push(new xt,new xt,new xt))}for(let ye=0;ye<_;ye++){const Q=g[ye].vertices;b[ye].data.push(Q[O.a],Q[O.b],Q[O.c])}for(let ye=0;ye<S;ye++){const Q=A[ye].vertexNormals[B];R[ye].data.push(Q.a,Q.b,Q.c)}W&&this.skinIndices.push(E[O.a],E[O.b],E[O.c]),V&&this.skinWeights.push(N[O.a],N[O.b],N[O.c])}return this.computeGroups(i),this.verticesNeedUpdate=i.verticesNeedUpdate,this.normalsNeedUpdate=i.normalsNeedUpdate,this.colorsNeedUpdate=i.colorsNeedUpdate,this.uvsNeedUpdate=i.uvsNeedUpdate,this.groupsNeedUpdate=i.groupsNeedUpdate,i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone()),this}}function h0(r){if(r.length===0)return-1/0;let i=r[0];for(let n=1,l=r.length;n<l;++n)r[n]>i&&(i=r[n]);return i}let Qw=1;const _o=new zn,Cg=new hn,Vu=new _e,qa=new Qo,mf=new Qo,kr=new _e;function Oi(){Object.defineProperty(this,"id",{value:Qw+=2}),this.uuid=Gn.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Oi.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Oi,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(r){return Array.isArray(r)?this.index=new(h0(r)>65535?pf:df)(r,1):this.index=r,this},getAttribute:function(r){return this.attributes[r]},setAttribute:function(r,i){return this.attributes[r]=i,this},deleteAttribute:function(r){return delete this.attributes[r],this},addGroup:function(r,i,n){this.groups.push({start:r,count:i,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(r,i){this.drawRange.start=r,this.drawRange.count=i},applyMatrix4:function(r){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(r),i.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const u=new La().getNormalMatrix(r);n.applyNormalMatrix(u),n.needsUpdate=!0}const l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(r),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(r){return _o.makeRotationX(r),this.applyMatrix4(_o),this},rotateY:function(r){return _o.makeRotationY(r),this.applyMatrix4(_o),this},rotateZ:function(r){return _o.makeRotationZ(r),this.applyMatrix4(_o),this},translate:function(r,i,n){return _o.makeTranslation(r,i,n),this.applyMatrix4(_o),this},scale:function(r,i,n){return _o.makeScale(r,i,n),this.applyMatrix4(_o),this},lookAt:function(r){return Cg.lookAt(r),Cg.updateMatrix(),this.applyMatrix4(Cg.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Vu).negate(),this.translate(Vu.x,Vu.y,Vu.z),this},setFromObject:function(r){const i=r.geometry;if(r.isPoints||r.isLine){const n=new Mi(i.vertices.length*3,3),l=new Mi(i.colors.length*3,3);if(this.setAttribute("position",n.copyVector3sArray(i.vertices)),this.setAttribute("color",l.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){const u=new Mi(i.lineDistances.length,1);this.setAttribute("lineDistance",u.copyArray(i.lineDistances))}i.boundingSphere!==null&&(this.boundingSphere=i.boundingSphere.clone()),i.boundingBox!==null&&(this.boundingBox=i.boundingBox.clone())}else r.isMesh&&i&&i.isGeometry&&this.fromGeometry(i);return this},setFromPoints:function(r){const i=[];for(let n=0,l=r.length;n<l;n++){const u=r[n];i.push(u.x,u.y,u.z||0)}return this.setAttribute("position",new Mi(i,3)),this},updateFromObject:function(r){let i=r.geometry;if(r.isMesh){let n=i.__directGeometry;if(i.elementsNeedUpdate===!0&&(n=void 0,i.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}if(i.verticesNeedUpdate===!0){const n=this.attributes.position;n!==void 0&&(n.copyVector3sArray(i.vertices),n.needsUpdate=!0),i.verticesNeedUpdate=!1}if(i.normalsNeedUpdate===!0){const n=this.attributes.normal;n!==void 0&&(n.copyVector3sArray(i.normals),n.needsUpdate=!0),i.normalsNeedUpdate=!1}if(i.colorsNeedUpdate===!0){const n=this.attributes.color;n!==void 0&&(n.copyColorsArray(i.colors),n.needsUpdate=!0),i.colorsNeedUpdate=!1}if(i.uvsNeedUpdate){const n=this.attributes.uv;n!==void 0&&(n.copyVector2sArray(i.uvs),n.needsUpdate=!0),i.uvsNeedUpdate=!1}if(i.lineDistancesNeedUpdate){const n=this.attributes.lineDistance;n!==void 0&&(n.copyArray(i.lineDistances),n.needsUpdate=!0),i.lineDistancesNeedUpdate=!1}return i.groupsNeedUpdate&&(i.computeGroups(r.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(r){return r.__directGeometry=new Kw().fromGeometry(r),this.fromDirectGeometry(r.__directGeometry)},fromDirectGeometry:function(r){const i=new Float32Array(r.vertices.length*3);if(this.setAttribute("position",new Nn(i,3).copyVector3sArray(r.vertices)),r.normals.length>0){const n=new Float32Array(r.normals.length*3);this.setAttribute("normal",new Nn(n,3).copyVector3sArray(r.normals))}if(r.colors.length>0){const n=new Float32Array(r.colors.length*3);this.setAttribute("color",new Nn(n,3).copyColorsArray(r.colors))}if(r.uvs.length>0){const n=new Float32Array(r.uvs.length*2);this.setAttribute("uv",new Nn(n,2).copyVector2sArray(r.uvs))}if(r.uvs2.length>0){const n=new Float32Array(r.uvs2.length*2);this.setAttribute("uv2",new Nn(n,2).copyVector2sArray(r.uvs2))}this.groups=r.groups;for(const n in r.morphTargets){const l=[],u=r.morphTargets[n];for(let h=0,p=u.length;h<p;h++){const g=u[h],_=new Mi(g.data.length*3,3);_.name=g.name,l.push(_.copyVector3sArray(g.data))}this.morphAttributes[n]=l}if(r.skinIndices.length>0){const n=new Mi(r.skinIndices.length*4,4);this.setAttribute("skinIndex",n.copyVector4sArray(r.skinIndices))}if(r.skinWeights.length>0){const n=new Mi(r.skinWeights.length*4,4);this.setAttribute("skinWeight",n.copyVector4sArray(r.skinWeights))}return r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Qo);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new _e(-1/0,-1/0,-1/0),new _e(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),i)for(let n=0,l=i.length;n<l;n++){const u=i[n];qa.setFromBufferAttribute(u),this.morphTargetsRelative?(kr.addVectors(this.boundingBox.min,qa.min),this.boundingBox.expandByPoint(kr),kr.addVectors(this.boundingBox.max,qa.max),this.boundingBox.expandByPoint(kr)):(this.boundingBox.expandByPoint(qa.min),this.boundingBox.expandByPoint(qa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new el);const r=this.attributes.position,i=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new _e,1/0);return}if(r){const n=this.boundingSphere.center;if(qa.setFromBufferAttribute(r),i)for(let u=0,h=i.length;u<h;u++){const p=i[u];mf.setFromBufferAttribute(p),this.morphTargetsRelative?(kr.addVectors(qa.min,mf.min),qa.expandByPoint(kr),kr.addVectors(qa.max,mf.max),qa.expandByPoint(kr)):(qa.expandByPoint(mf.min),qa.expandByPoint(mf.max))}qa.getCenter(n);let l=0;for(let u=0,h=r.count;u<h;u++)kr.fromBufferAttribute(r,u),l=Math.max(l,n.distanceToSquared(kr));if(i)for(let u=0,h=i.length;u<h;u++){const p=i[u],g=this.morphTargetsRelative;for(let _=0,b=p.count;_<b;_++)kr.fromBufferAttribute(p,_),g&&(Vu.fromBufferAttribute(r,_),kr.add(Vu)),l=Math.max(l,n.distanceToSquared(kr))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const r=this.index,i=this.getAttribute("position");if(i!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Nn(new Float32Array(i.count*3),3),this.setAttribute("normal",n);else for(let S=0,R=n.count;S<R;S++)n.setXYZ(S,0,0,0);const l=new _e,u=new _e,h=new _e,p=new _e,g=new _e,_=new _e,b=new _e,A=new _e;if(r)for(let S=0,R=r.count;S<R;S+=3){const E=r.getX(S+0),N=r.getX(S+1),W=r.getX(S+2);l.fromBufferAttribute(i,E),u.fromBufferAttribute(i,N),h.fromBufferAttribute(i,W),b.subVectors(h,u),A.subVectors(l,u),b.cross(A),p.fromBufferAttribute(n,E),g.fromBufferAttribute(n,N),_.fromBufferAttribute(n,W),p.add(b),g.add(b),_.add(b),n.setXYZ(E,p.x,p.y,p.z),n.setXYZ(N,g.x,g.y,g.z),n.setXYZ(W,_.x,_.y,_.z)}else for(let S=0,R=i.count;S<R;S+=3)l.fromBufferAttribute(i,S+0),u.fromBufferAttribute(i,S+1),h.fromBufferAttribute(i,S+2),b.subVectors(h,u),A.subVectors(l,u),b.cross(A),n.setXYZ(S+0,b.x,b.y,b.z),n.setXYZ(S+1,b.x,b.y,b.z),n.setXYZ(S+2,b.x,b.y,b.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(r,i){if(!(r&&r.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",r);return}i===void 0&&(i=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const n=this.attributes;for(const l in n){if(r.attributes[l]===void 0)continue;const h=n[l].array,p=r.attributes[l],g=p.array,_=p.itemSize*i,b=Math.min(g.length,h.length-_);for(let A=0,S=_;A<b;A++,S++)h[S]=g[A]}return this},normalizeNormals:function(){const r=this.attributes.normal;for(let i=0,n=r.count;i<n;i++)kr.fromBufferAttribute(r,i),kr.normalize(),r.setXYZ(i,kr.x,kr.y,kr.z)},toNonIndexed:function(){function r(p,g){const _=p.array,b=p.itemSize,A=p.normalized,S=new _.constructor(g.length*b);let R=0,E=0;for(let N=0,W=g.length;N<W;N++){R=g[N]*b;for(let V=0;V<b;V++)S[E++]=_[R++]}return new Nn(S,b,A)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const i=new Oi,n=this.index.array,l=this.attributes;for(const p in l){const g=l[p],_=r(g,n);i.setAttribute(p,_)}const u=this.morphAttributes;for(const p in u){const g=[],_=u[p];for(let b=0,A=_.length;b<A;b++){const S=_[b],R=r(S,n);g.push(R)}i.morphAttributes[p]=g}i.morphTargetsRelative=this.morphTargetsRelative;const h=this.groups;for(let p=0,g=h.length;p<g;p++){const _=h[p];i.addGroup(_.start,_.count,_.materialIndex)}return i},toJSON:function(){const r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){const g=this.parameters;for(const _ in g)g[_]!==void 0&&(r[_]=g[_]);return r}r.data={attributes:{}};const i=this.index;i!==null&&(r.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const n=this.attributes;for(const g in n){const _=n[g],b=_.toJSON(r.data);_.name!==""&&(b.name=_.name),r.data.attributes[g]=b}const l={};let u=!1;for(const g in this.morphAttributes){const _=this.morphAttributes[g],b=[];for(let A=0,S=_.length;A<S;A++){const R=_[A],E=R.toJSON(r.data);R.name!==""&&(E.name=R.name),b.push(E)}b.length>0&&(l[g]=b,u=!0)}u&&(r.data.morphAttributes=l,r.data.morphTargetsRelative=this.morphTargetsRelative);const h=this.groups;h.length>0&&(r.data.groups=JSON.parse(JSON.stringify(h)));const p=this.boundingSphere;return p!==null&&(r.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),r},clone:function(){return new Oi().copy(this)},copy:function(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=r.name;const n=r.index;n!==null&&this.setIndex(n.clone(i));const l=r.attributes;for(const _ in l){const b=l[_];this.setAttribute(_,b.clone(i))}const u=r.morphAttributes;for(const _ in u){const b=[],A=u[_];for(let S=0,R=A.length;S<R;S++)b.push(A[S].clone(i));this.morphAttributes[_]=b}this.morphTargetsRelative=r.morphTargetsRelative;const h=r.groups;for(let _=0,b=h.length;_<b;_++){const A=h[_];this.addGroup(A.start,A.count,A.materialIndex)}const p=r.boundingBox;p!==null&&(this.boundingBox=p.clone());const g=r.boundingSphere;return g!==null&&(this.boundingSphere=g.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const f0=new zn,kc=new uf,Pg=new el,Yl=new _e,jl=new _e,Zl=new _e,Ig=new _e,Dg=new _e,Og=new _e,ep=new _e,tp=new _e,np=new _e,Wu=new xt,qu=new xt,Xu=new xt,gf=new _e,ip=new _e;function ea(r,i){hn.call(this),this.type="Mesh",this.geometry=r!==void 0?r:new Oi,this.material=i!==void 0?i:new ds,this.updateMorphTargets()}ea.prototype=Object.assign(Object.create(hn.prototype),{constructor:ea,isMesh:!0,copy:function(r){return hn.prototype.copy.call(this,r),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=r.material,this.geometry=r.geometry,this},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(r,i){const n=this.geometry,l=this.material,u=this.matrixWorld;if(l===void 0||(n.boundingSphere===null&&n.computeBoundingSphere(),Pg.copy(n.boundingSphere),Pg.applyMatrix4(u),r.ray.intersectsSphere(Pg)===!1)||(f0.getInverse(u),kc.copy(r.ray).applyMatrix4(f0),n.boundingBox!==null&&kc.intersectsBox(n.boundingBox)===!1))return;let h;if(n.isBufferGeometry){const p=n.index,g=n.attributes.position,_=n.morphAttributes.position,b=n.morphTargetsRelative,A=n.attributes.uv,S=n.attributes.uv2,R=n.groups,E=n.drawRange;if(p!==null)if(Array.isArray(l))for(let N=0,W=R.length;N<W;N++){const V=R[N],B=l[V.materialIndex],O=Math.max(V.start,E.start),pe=Math.min(V.start+V.count,E.start+E.count);for(let ge=O,ye=pe;ge<ye;ge+=3){const Q=p.getX(ge),Ie=p.getX(ge+1),tt=p.getX(ge+2);h=rp(this,B,r,kc,g,_,b,A,S,Q,Ie,tt),h&&(h.faceIndex=Math.floor(ge/3),h.face.materialIndex=V.materialIndex,i.push(h))}}else{const N=Math.max(0,E.start),W=Math.min(p.count,E.start+E.count);for(let V=N,B=W;V<B;V+=3){const O=p.getX(V),pe=p.getX(V+1),ge=p.getX(V+2);h=rp(this,l,r,kc,g,_,b,A,S,O,pe,ge),h&&(h.faceIndex=Math.floor(V/3),i.push(h))}}else if(g!==void 0)if(Array.isArray(l))for(let N=0,W=R.length;N<W;N++){const V=R[N],B=l[V.materialIndex],O=Math.max(V.start,E.start),pe=Math.min(V.start+V.count,E.start+E.count);for(let ge=O,ye=pe;ge<ye;ge+=3){const Q=ge,Ie=ge+1,tt=ge+2;h=rp(this,B,r,kc,g,_,b,A,S,Q,Ie,tt),h&&(h.faceIndex=Math.floor(ge/3),h.face.materialIndex=V.materialIndex,i.push(h))}}else{const N=Math.max(0,E.start),W=Math.min(g.count,E.start+E.count);for(let V=N,B=W;V<B;V+=3){const O=V,pe=V+1,ge=V+2;h=rp(this,l,r,kc,g,_,b,A,S,O,pe,ge),h&&(h.faceIndex=Math.floor(V/3),i.push(h))}}}else if(n.isGeometry){const p=Array.isArray(l),g=n.vertices,_=n.faces;let b;const A=n.faceVertexUvs[0];A.length>0&&(b=A);for(let S=0,R=_.length;S<R;S++){const E=_[S],N=p?l[E.materialIndex]:l;if(N===void 0)continue;const W=g[E.a],V=g[E.b],B=g[E.c];if(h=d0(this,N,r,kc,W,V,B,gf),h){if(b&&b[S]){const O=b[S];Wu.copy(O[0]),qu.copy(O[1]),Xu.copy(O[2]),h.uv=sa.getUV(gf,W,V,B,Wu,qu,Xu,new xt)}h.face=E,h.faceIndex=S,i.push(h)}}}}});function d0(r,i,n,l,u,h,p,g){let _;if(i.side===ui?_=l.intersectTriangle(p,h,u,!0,g):_=l.intersectTriangle(u,h,p,i.side!==Dn,g),_===null)return null;ip.copy(g),ip.applyMatrix4(r.matrixWorld);const b=n.ray.origin.distanceTo(ip);return b<n.near||b>n.far?null:{distance:b,point:ip.clone(),object:r}}function rp(r,i,n,l,u,h,p,g,_,b,A,S){Yl.fromBufferAttribute(u,b),jl.fromBufferAttribute(u,A),Zl.fromBufferAttribute(u,S);const R=r.morphTargetInfluences;if(i.morphTargets&&h&&R){ep.set(0,0,0),tp.set(0,0,0),np.set(0,0,0);for(let N=0,W=h.length;N<W;N++){const V=R[N],B=h[N];V!==0&&(Ig.fromBufferAttribute(B,b),Dg.fromBufferAttribute(B,A),Og.fromBufferAttribute(B,S),p?(ep.addScaledVector(Ig,V),tp.addScaledVector(Dg,V),np.addScaledVector(Og,V)):(ep.addScaledVector(Ig.sub(Yl),V),tp.addScaledVector(Dg.sub(jl),V),np.addScaledVector(Og.sub(Zl),V)))}Yl.add(ep),jl.add(tp),Zl.add(np)}r.isSkinnedMesh&&(r.boneTransform(b,Yl),r.boneTransform(A,jl),r.boneTransform(S,Zl));const E=d0(r,i,n,l,Yl,jl,Zl,gf);if(E){g&&(Wu.fromBufferAttribute(g,b),qu.fromBufferAttribute(g,A),Xu.fromBufferAttribute(g,S),E.uv=sa.getUV(gf,Yl,jl,Zl,Wu,qu,Xu,new xt)),_&&(Wu.fromBufferAttribute(_,b),qu.fromBufferAttribute(_,A),Xu.fromBufferAttribute(_,S),E.uv2=sa.getUV(gf,Yl,jl,Zl,Wu,qu,Xu,new xt));const N=new Mg(b,A,S);sa.getNormal(Yl,jl,Zl,N.normal),E.face=N}return E}class p0 extends Oi{constructor(i=1,n=1,l=1,u=1,h=1,p=1){super(),this.type="BoxBufferGeometry",this.parameters={width:i,height:n,depth:l,widthSegments:u,heightSegments:h,depthSegments:p};const g=this;u=Math.floor(u),h=Math.floor(h),p=Math.floor(p);const _=[],b=[],A=[],S=[];let R=0,E=0;N("z","y","x",-1,-1,l,n,i,p,h,0),N("z","y","x",1,-1,l,n,-i,p,h,1),N("x","z","y",1,1,i,l,n,u,p,2),N("x","z","y",1,-1,i,l,-n,u,p,3),N("x","y","z",1,-1,i,n,l,u,h,4),N("x","y","z",-1,-1,i,n,-l,u,h,5),this.setIndex(_),this.setAttribute("position",new Mi(b,3)),this.setAttribute("normal",new Mi(A,3)),this.setAttribute("uv",new Mi(S,2));function N(W,V,B,O,pe,ge,ye,Q,Ie,tt,qe){const ht=ge/Ie,Ye=ye/tt,Ne=ge/2,Ue=ye/2,Le=Q/2,Te=Ie+1,Ve=tt+1;let We=0,rt=0;const Tt=new _e;for(let nt=0;nt<Ve;nt++){const Et=nt*Ye-Ue;for(let $t=0;$t<Te;$t++){const Yt=$t*ht-Ne;Tt[W]=Yt*O,Tt[V]=Et*pe,Tt[B]=Le,b.push(Tt.x,Tt.y,Tt.z),Tt[W]=0,Tt[V]=0,Tt[B]=Q>0?1:-1,A.push(Tt.x,Tt.y,Tt.z),S.push($t/Ie),S.push(1-nt/tt),We+=1}}for(let nt=0;nt<tt;nt++)for(let Et=0;Et<Ie;Et++){const $t=R+Et+Te*nt,Yt=R+Et+Te*(nt+1),K=R+(Et+1)+Te*(nt+1),H=R+(Et+1)+Te*nt;_.push($t,Yt,H),_.push(Yt,K,H),rt+=6}g.addGroup(E,rt,qe),E+=rt,R+=We}}}function Yu(r){const i={};for(const n in r){i[n]={};for(const l in r[n]){const u=r[n][l];u&&(u.isColor||u.isMatrix3||u.isMatrix4||u.isVector2||u.isVector3||u.isVector4||u.isTexture)?i[n][l]=u.clone():Array.isArray(u)?i[n][l]=u.slice():i[n][l]=u}}return i}function oa(r){const i={};for(let n=0;n<r.length;n++){const l=Yu(r[n]);for(const u in l)i[u]=l[u]}return i}const $w={clone:Yu,merge:oa};var eM=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,tM=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Ra(r){bn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=eM,this.fragmentShader=tM,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&(r.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(r))}Ra.prototype=Object.create(bn.prototype),Ra.prototype.constructor=Ra,Ra.prototype.isShaderMaterial=!0,Ra.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=Yu(r.uniforms),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.lights=r.lights,this.clipping=r.clipping,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this},Ra.prototype.toJSON=function(r){const i=bn.prototype.toJSON.call(this,r);i.glslVersion=this.glslVersion,i.uniforms={};for(const l in this.uniforms){const h=this.uniforms[l].value;h&&h.isTexture?i.uniforms[l]={type:"t",value:h.toJSON(r).uuid}:h&&h.isColor?i.uniforms[l]={type:"c",value:h.getHex()}:h&&h.isVector2?i.uniforms[l]={type:"v2",value:h.toArray()}:h&&h.isVector3?i.uniforms[l]={type:"v3",value:h.toArray()}:h&&h.isVector4?i.uniforms[l]={type:"v4",value:h.toArray()}:h&&h.isMatrix3?i.uniforms[l]={type:"m3",value:h.toArray()}:h&&h.isMatrix4?i.uniforms[l]={type:"m4",value:h.toArray()}:i.uniforms[l]={value:h}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const n={};for(const l in this.extensions)this.extensions[l]===!0&&(n[l]=!0);return Object.keys(n).length>0&&(i.extensions=n),i};function Jl(){hn.call(this),this.type="Camera",this.matrixWorldInverse=new zn,this.projectionMatrix=new zn,this.projectionMatrixInverse=new zn}Jl.prototype=Object.assign(Object.create(hn.prototype),{constructor:Jl,isCamera:!0,copy:function(r,i){return hn.prototype.copy.call(this,r,i),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this},getWorldDirection:function(r){r===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),r=new _e),this.updateMatrixWorld(!0);const i=this.matrixWorld.elements;return r.set(-i[8],-i[9],-i[10]).normalize()},updateMatrixWorld:function(r){hn.prototype.updateMatrixWorld.call(this,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(r,i){hn.prototype.updateWorldMatrix.call(this,r,i),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function Vr(r,i,n,l){Jl.call(this),this.type="PerspectiveCamera",this.fov=r!==void 0?r:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=l!==void 0?l:2e3,this.focus=10,this.aspect=i!==void 0?i:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Vr.prototype=Object.assign(Object.create(Jl.prototype),{constructor:Vr,isPerspectiveCamera:!0,copy:function(r,i){return Jl.prototype.copy.call(this,r,i),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this},setFocalLength:function(r){const i=.5*this.getFilmHeight()/r;this.fov=Gn.RAD2DEG*2*Math.atan(i),this.updateProjectionMatrix()},getFocalLength:function(){const r=Math.tan(Gn.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/r},getEffectiveFOV:function(){return Gn.RAD2DEG*2*Math.atan(Math.tan(Gn.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(r,i,n,l,u,h){this.aspect=r/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=l,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=this.near;let i=r*Math.tan(Gn.DEG2RAD*.5*this.fov)/this.zoom,n=2*i,l=this.aspect*n,u=-.5*l;const h=this.view;if(this.view!==null&&this.view.enabled){const g=h.fullWidth,_=h.fullHeight;u+=h.offsetX*l/g,i-=h.offsetY*n/_,l*=h.width/g,n*=h.height/_}const p=this.filmOffset;p!==0&&(u+=r*p/this.getFilmWidth()),this.projectionMatrix.makePerspective(u,u+l,i,i-n,r,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=hn.prototype.toJSON.call(this,r);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}});const ju=90,Zu=1;function vf(r,i,n){if(hn.call(this),this.type="CubeCamera",n.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=n;const l=new Vr(ju,Zu,r,i);l.layers=this.layers,l.up.set(0,-1,0),l.lookAt(new _e(1,0,0)),this.add(l);const u=new Vr(ju,Zu,r,i);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new _e(-1,0,0)),this.add(u);const h=new Vr(ju,Zu,r,i);h.layers=this.layers,h.up.set(0,0,1),h.lookAt(new _e(0,1,0)),this.add(h);const p=new Vr(ju,Zu,r,i);p.layers=this.layers,p.up.set(0,0,-1),p.lookAt(new _e(0,-1,0)),this.add(p);const g=new Vr(ju,Zu,r,i);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new _e(0,0,1)),this.add(g);const _=new Vr(ju,Zu,r,i);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new _e(0,0,-1)),this.add(_),this.update=function(b,A){this.parent===null&&this.updateMatrixWorld();const S=b.xr.enabled,R=b.getRenderTarget();b.xr.enabled=!1;const E=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,b.setRenderTarget(n,0),b.render(A,l),b.setRenderTarget(n,1),b.render(A,u),b.setRenderTarget(n,2),b.render(A,h),b.setRenderTarget(n,3),b.render(A,p),b.setRenderTarget(n,4),b.render(A,g),n.texture.generateMipmaps=E,b.setRenderTarget(n,5),b.render(A,_),b.setRenderTarget(R),b.xr.enabled=S},this.clear=function(b,A,S,R){const E=b.getRenderTarget();for(let N=0;N<6;N++)b.setRenderTarget(n,N),b.clear(A,S,R);b.setRenderTarget(E)}}vf.prototype=Object.create(hn.prototype),vf.prototype.constructor=vf;function Kl(r,i,n,l,u,h,p,g,_,b){r=r!==void 0?r:[],i=i!==void 0?i:vo,p=p!==void 0?p:yo,Vi.call(this,r,i,n,l,u,h,p,g,_,b),this.flipY=!1,this._needsFlipEnvMap=!0}Kl.prototype=Object.create(Vi.prototype),Kl.prototype.constructor=Kl,Kl.prototype.isCubeTexture=!0,Object.defineProperty(Kl.prototype,"images",{get:function(){return this.image},set:function(r){this.image=r}});function Ju(r,i,n){Number.isInteger(i)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),i=n),Os.call(this,r,r,i),i=i||{},this.texture=new Kl(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture._needsFlipEnvMap=!1}Ju.prototype=Object.create(Os.prototype),Ju.prototype.constructor=Ju,Ju.prototype.isWebGLCubeRenderTarget=!0,Ju.prototype.fromEquirectangularTexture=function(r,i){this.texture.type=i.type,this.texture.format=fs,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

			varying vec3 vWorldDirection;

			vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

				return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

			}

			void main() {

				vWorldDirection = transformDirection( position, modelMatrix );

				#include <begin_vertex>
				#include <project_vertex>

			}
		`,fragmentShader:`

			uniform sampler2D tEquirect;

			varying vec3 vWorldDirection;

			#include <common>

			void main() {

				vec3 direction = normalize( vWorldDirection );

				vec2 sampleUV = equirectUv( direction );

				gl_FragColor = texture2D( tEquirect, sampleUV );

			}
		`},l=new p0(5,5,5),u=new Ra({name:"CubemapFromEquirect",uniforms:Yu(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:ui,blending:Kn});u.uniforms.tEquirect.value=i;const h=new ea(l,u),p=i.minFilter;return i.minFilter===Cu&&(i.minFilter=Sn),new vf(1,10,this).update(r,h),i.minFilter=p,h.geometry.dispose(),h.material.dispose(),this};function Ku(r,i,n,l,u,h,p,g,_,b,A,S){Vi.call(this,null,h,p,g,_,b,l,u,A,S),this.image={data:r||null,width:i||1,height:n||1},this.magFilter=_!==void 0?_:St,this.minFilter=b!==void 0?b:St,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ku.prototype=Object.create(Vi.prototype),Ku.prototype.constructor=Ku,Ku.prototype.isDataTexture=!0;const Qu=new el,ap=new _e;class sp{constructor(i,n,l,u,h,p){this.planes=[i!==void 0?i:new il,n!==void 0?n:new il,l!==void 0?l:new il,u!==void 0?u:new il,h!==void 0?h:new il,p!==void 0?p:new il]}set(i,n,l,u,h,p){const g=this.planes;return g[0].copy(i),g[1].copy(n),g[2].copy(l),g[3].copy(u),g[4].copy(h),g[5].copy(p),this}clone(){return new this.constructor().copy(this)}copy(i){const n=this.planes;for(let l=0;l<6;l++)n[l].copy(i.planes[l]);return this}setFromProjectionMatrix(i){const n=this.planes,l=i.elements,u=l[0],h=l[1],p=l[2],g=l[3],_=l[4],b=l[5],A=l[6],S=l[7],R=l[8],E=l[9],N=l[10],W=l[11],V=l[12],B=l[13],O=l[14],pe=l[15];return n[0].setComponents(g-u,S-_,W-R,pe-V).normalize(),n[1].setComponents(g+u,S+_,W+R,pe+V).normalize(),n[2].setComponents(g+h,S+b,W+E,pe+B).normalize(),n[3].setComponents(g-h,S-b,W-E,pe-B).normalize(),n[4].setComponents(g-p,S-A,W-N,pe-O).normalize(),n[5].setComponents(g+p,S+A,W+N,pe+O).normalize(),this}intersectsObject(i){const n=i.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Qu.copy(n.boundingSphere).applyMatrix4(i.matrixWorld),this.intersectsSphere(Qu)}intersectsSprite(i){return Qu.center.set(0,0,0),Qu.radius=.7071067811865476,Qu.applyMatrix4(i.matrixWorld),this.intersectsSphere(Qu)}intersectsSphere(i){const n=this.planes,l=i.center,u=-i.radius;for(let h=0;h<6;h++)if(n[h].distanceToPoint(l)<u)return!1;return!0}intersectsBox(i){const n=this.planes;for(let l=0;l<6;l++){const u=n[l];if(ap.x=u.normal.x>0?i.max.x:i.min.x,ap.y=u.normal.y>0?i.max.y:i.min.y,ap.z=u.normal.z>0?i.max.z:i.min.z,u.distanceToPoint(ap)<0)return!1}return!0}containsPoint(i){const n=this.planes;for(let l=0;l<6;l++)if(n[l].distanceToPoint(i)<0)return!1;return!0}}function m0(){let r=null,i=!1,n=null,l=null;function u(h,p){n(h,p),l=r.requestAnimationFrame(u)}return{start:function(){i!==!0&&n!==null&&(l=r.requestAnimationFrame(u),i=!0)},stop:function(){r.cancelAnimationFrame(l),i=!1},setAnimationLoop:function(h){n=h},setContext:function(h){r=h}}}function nM(r,i){const n=i.isWebGL2,l=new WeakMap;function u(b,A){const S=b.array,R=b.usage,E=r.createBuffer();r.bindBuffer(A,E),r.bufferData(A,S,R),b.onUploadCallback();let N=5126;return S instanceof Float32Array?N=5126:S instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):S instanceof Uint16Array?N=5123:S instanceof Int16Array?N=5122:S instanceof Uint32Array?N=5125:S instanceof Int32Array?N=5124:S instanceof Int8Array?N=5120:S instanceof Uint8Array&&(N=5121),{buffer:E,type:N,bytesPerElement:S.BYTES_PER_ELEMENT,version:b.version}}function h(b,A,S){const R=A.array,E=A.updateRange;r.bindBuffer(S,b),E.count===-1?r.bufferSubData(S,0,R):(n?r.bufferSubData(S,E.offset*R.BYTES_PER_ELEMENT,R,E.offset,E.count):r.bufferSubData(S,E.offset*R.BYTES_PER_ELEMENT,R.subarray(E.offset,E.offset+E.count)),E.count=-1)}function p(b){return b.isInterleavedBufferAttribute&&(b=b.data),l.get(b)}function g(b){b.isInterleavedBufferAttribute&&(b=b.data);const A=l.get(b);A&&(r.deleteBuffer(A.buffer),l.delete(b))}function _(b,A){if(b.isGLBufferAttribute){var S=l.get(b);(!S||S.version<b.version)&&l.set(b,{buffer:b.buffer,type:b.type,bytesPerElement:b.elementSize,version:b.version});return}b.isInterleavedBufferAttribute&&(b=b.data);const R=l.get(b);R===void 0?l.set(b,u(b,A)):R.version<b.version&&(h(R.buffer,b,A),R.version=b.version)}return{get:p,remove:g,update:_}}class iM extends Oi{constructor(i,n,l,u){super(),this.type="PlaneBufferGeometry",this.parameters={width:i,height:n,widthSegments:l,heightSegments:u},i=i||1,n=n||1;const h=i/2,p=n/2,g=Math.floor(l)||1,_=Math.floor(u)||1,b=g+1,A=_+1,S=i/g,R=n/_,E=[],N=[],W=[],V=[];for(let B=0;B<A;B++){const O=B*R-p;for(let pe=0;pe<b;pe++){const ge=pe*S-h;N.push(ge,-O,0),W.push(0,0,1),V.push(pe/g),V.push(1-B/_)}}for(let B=0;B<_;B++)for(let O=0;O<g;O++){const pe=O+b*B,ge=O+b*(B+1),ye=O+1+b*(B+1),Q=O+1+b*B;E.push(pe,ge,Q),E.push(ge,ye,Q)}this.setIndex(E),this.setAttribute("position",new Mi(N,3)),this.setAttribute("normal",new Mi(W,3)),this.setAttribute("uv",new Mi(V,2))}}var rM=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,aM=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,sM=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,oM=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,lM=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cM="vec3 transformed = vec3( position );",uM=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,hM=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,fM=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dM=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,pM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,mM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,gM=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,vM=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,yM=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,_M=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,xM=`#if defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor.xyz *= color.xyz;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,bM=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,wM=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,MM=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,SM=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,TM=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,EM=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,AM=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,LM="gl_FragColor = linearToOutputTexel( gl_FragColor );",RM=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,CM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,PM=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,IM=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DM=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,OM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,NM=`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,FM=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,BM=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,UM=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,GM=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,zM=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,HM=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,kM=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,VM=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,WM=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,qM=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,XM=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,YM=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,jM=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,ZM=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,JM=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,KM=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,QM=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,$M=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,eS=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,tS=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nS=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,iS=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,rS=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,aS=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,sS=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,oS=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,lS=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,cS=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,uS=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,hS=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,fS=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,dS=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,pS=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,mS=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,gS=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,vS=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,yS=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,_S=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,xS=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,bS=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wS=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,MS=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,SS=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,TS=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ES=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,AS=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,LS=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,RS=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,CS=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,PS=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,IS=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,DS=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,OS=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,NS=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,FS=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,BS=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,US=`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,GS=`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,zS=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,HS=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,kS=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,VS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,WS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,qS=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,XS=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,YS=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,jS=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,ZS=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,JS=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KS=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,QS=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,$S=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,eT=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,tT=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,nT=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,iT=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,rT=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,aT=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sT=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,oT=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lT=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,cT=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uT=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,hT=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fT=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dT=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pT=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mT=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gT=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vT=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,yT=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_T=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,xT=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,bT=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,wT=`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,MT=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ST=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`;const Qn={alphamap_fragment:rM,alphamap_pars_fragment:aM,alphatest_fragment:sM,aomap_fragment:oM,aomap_pars_fragment:lM,begin_vertex:cM,beginnormal_vertex:uM,bsdfs:hM,bumpmap_pars_fragment:fM,clipping_planes_fragment:dM,clipping_planes_pars_fragment:pM,clipping_planes_pars_vertex:mM,clipping_planes_vertex:gM,color_fragment:vM,color_pars_fragment:yM,color_pars_vertex:_M,color_vertex:xM,common:bM,cube_uv_reflection_fragment:wM,defaultnormal_vertex:MM,displacementmap_pars_vertex:SM,displacementmap_vertex:TM,emissivemap_fragment:EM,emissivemap_pars_fragment:AM,encodings_fragment:LM,encodings_pars_fragment:RM,envmap_fragment:CM,envmap_common_pars_fragment:PM,envmap_pars_fragment:IM,envmap_pars_vertex:DM,envmap_physical_pars_fragment:WM,envmap_vertex:OM,fog_vertex:NM,fog_pars_vertex:FM,fog_fragment:BM,fog_pars_fragment:UM,gradientmap_pars_fragment:GM,lightmap_fragment:zM,lightmap_pars_fragment:HM,lights_lambert_vertex:kM,lights_pars_begin:VM,lights_toon_fragment:qM,lights_toon_pars_fragment:XM,lights_phong_fragment:YM,lights_phong_pars_fragment:jM,lights_physical_fragment:ZM,lights_physical_pars_fragment:JM,lights_fragment_begin:KM,lights_fragment_maps:QM,lights_fragment_end:$M,logdepthbuf_fragment:eS,logdepthbuf_pars_fragment:tS,logdepthbuf_pars_vertex:nS,logdepthbuf_vertex:iS,map_fragment:rS,map_pars_fragment:aS,map_particle_fragment:sS,map_particle_pars_fragment:oS,metalnessmap_fragment:lS,metalnessmap_pars_fragment:cS,morphnormal_vertex:uS,morphtarget_pars_vertex:hS,morphtarget_vertex:fS,normal_fragment_begin:dS,normal_fragment_maps:pS,normalmap_pars_fragment:mS,clearcoat_normal_fragment_begin:gS,clearcoat_normal_fragment_maps:vS,clearcoat_pars_fragment:yS,packing:_S,premultiplied_alpha_fragment:xS,project_vertex:bS,dithering_fragment:wS,dithering_pars_fragment:MS,roughnessmap_fragment:SS,roughnessmap_pars_fragment:TS,shadowmap_pars_fragment:ES,shadowmap_pars_vertex:AS,shadowmap_vertex:LS,shadowmask_pars_fragment:RS,skinbase_vertex:CS,skinning_pars_vertex:PS,skinning_vertex:IS,skinnormal_vertex:DS,specularmap_fragment:OS,specularmap_pars_fragment:NS,tonemapping_fragment:FS,tonemapping_pars_fragment:BS,transmissionmap_fragment:US,transmissionmap_pars_fragment:GS,uv_pars_fragment:zS,uv_pars_vertex:HS,uv_vertex:kS,uv2_pars_fragment:VS,uv2_pars_vertex:WS,uv2_vertex:qS,worldpos_vertex:XS,background_frag:YS,background_vert:jS,cube_frag:ZS,cube_vert:JS,depth_frag:KS,depth_vert:QS,distanceRGBA_frag:$S,distanceRGBA_vert:eT,equirect_frag:tT,equirect_vert:nT,linedashed_frag:iT,linedashed_vert:rT,meshbasic_frag:aT,meshbasic_vert:sT,meshlambert_frag:oT,meshlambert_vert:lT,meshmatcap_frag:cT,meshmatcap_vert:uT,meshtoon_frag:hT,meshtoon_vert:fT,meshphong_frag:dT,meshphong_vert:pT,meshphysical_frag:mT,meshphysical_vert:gT,normal_frag:vT,normal_vert:yT,points_frag:_T,points_vert:xT,shadow_frag:bT,shadow_vert:wT,sprite_frag:MT,sprite_vert:ST},Wt={common:{diffuse:{value:new Kt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new La},uv2Transform:{value:new La},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new xt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Kt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new La}},sprite:{diffuse:{value:new Kt(15658734)},opacity:{value:1},center:{value:new xt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new La}}},xo={basic:{uniforms:oa([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.fog]),vertexShader:Qn.meshbasic_vert,fragmentShader:Qn.meshbasic_frag},lambert:{uniforms:oa([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.fog,Wt.lights,{emissive:{value:new Kt(0)}}]),vertexShader:Qn.meshlambert_vert,fragmentShader:Qn.meshlambert_frag},phong:{uniforms:oa([Wt.common,Wt.specularmap,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,Wt.lights,{emissive:{value:new Kt(0)},specular:{value:new Kt(1118481)},shininess:{value:30}}]),vertexShader:Qn.meshphong_vert,fragmentShader:Qn.meshphong_frag},standard:{uniforms:oa([Wt.common,Wt.envmap,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.roughnessmap,Wt.metalnessmap,Wt.fog,Wt.lights,{emissive:{value:new Kt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag},toon:{uniforms:oa([Wt.common,Wt.aomap,Wt.lightmap,Wt.emissivemap,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.gradientmap,Wt.fog,Wt.lights,{emissive:{value:new Kt(0)}}]),vertexShader:Qn.meshtoon_vert,fragmentShader:Qn.meshtoon_frag},matcap:{uniforms:oa([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,Wt.fog,{matcap:{value:null}}]),vertexShader:Qn.meshmatcap_vert,fragmentShader:Qn.meshmatcap_frag},points:{uniforms:oa([Wt.points,Wt.fog]),vertexShader:Qn.points_vert,fragmentShader:Qn.points_frag},dashed:{uniforms:oa([Wt.common,Wt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Qn.linedashed_vert,fragmentShader:Qn.linedashed_frag},depth:{uniforms:oa([Wt.common,Wt.displacementmap]),vertexShader:Qn.depth_vert,fragmentShader:Qn.depth_frag},normal:{uniforms:oa([Wt.common,Wt.bumpmap,Wt.normalmap,Wt.displacementmap,{opacity:{value:1}}]),vertexShader:Qn.normal_vert,fragmentShader:Qn.normal_frag},sprite:{uniforms:oa([Wt.sprite,Wt.fog]),vertexShader:Qn.sprite_vert,fragmentShader:Qn.sprite_frag},background:{uniforms:{uvTransform:{value:new La},t2D:{value:null}},vertexShader:Qn.background_vert,fragmentShader:Qn.background_frag},cube:{uniforms:oa([Wt.envmap,{opacity:{value:1}}]),vertexShader:Qn.cube_vert,fragmentShader:Qn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Qn.equirect_vert,fragmentShader:Qn.equirect_frag},distanceRGBA:{uniforms:oa([Wt.common,Wt.displacementmap,{referencePosition:{value:new _e},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Qn.distanceRGBA_vert,fragmentShader:Qn.distanceRGBA_frag},shadow:{uniforms:oa([Wt.lights,Wt.fog,{color:{value:new Kt(0)},opacity:{value:1}}]),vertexShader:Qn.shadow_vert,fragmentShader:Qn.shadow_frag}};xo.physical={uniforms:oa([xo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new xt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Kt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Qn.meshphysical_vert,fragmentShader:Qn.meshphysical_frag};function TT(r,i,n,l,u){const h=new Kt(0);let p=0,g,_,b=null,A=0,S=null;function R(N,W,V,B){let O=W.isScene===!0?W.background:null;O&&O.isTexture&&(O=i.get(O));const pe=r.xr,ge=pe.getSession&&pe.getSession();ge&&ge.environmentBlendMode==="additive"&&(O=null),O===null?E(h,p):O&&O.isColor&&(E(O,1),B=!0),(r.autoClear||B)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),O&&(O.isCubeTexture||O.isWebGLCubeRenderTarget||O.mapping===nf)?(_===void 0&&(_=new ea(new p0(1,1,1),new Ra({name:"BackgroundCubeMaterial",uniforms:Yu(xo.cube.uniforms),vertexShader:xo.cube.vertexShader,fragmentShader:xo.cube.fragmentShader,side:ui,depthTest:!1,depthWrite:!1,fog:!1})),_.geometry.deleteAttribute("normal"),_.geometry.deleteAttribute("uv"),_.onBeforeRender=function(ye,Q,Ie){this.matrixWorld.copyPosition(Ie.matrixWorld)},Object.defineProperty(_.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),l.update(_)),O.isWebGLCubeRenderTarget&&(O=O.texture),_.material.uniforms.envMap.value=O,_.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O._needsFlipEnvMap?-1:1,(b!==O||A!==O.version||S!==r.toneMapping)&&(_.material.needsUpdate=!0,b=O,A=O.version,S=r.toneMapping),N.unshift(_,_.geometry,_.material,0,0,null)):O&&O.isTexture&&(g===void 0&&(g=new ea(new iM(2,2),new Ra({name:"BackgroundMaterial",uniforms:Yu(xo.background.uniforms),vertexShader:xo.background.vertexShader,fragmentShader:xo.background.fragmentShader,side:Ui,depthTest:!1,depthWrite:!1,fog:!1})),g.geometry.deleteAttribute("normal"),Object.defineProperty(g.material,"map",{get:function(){return this.uniforms.t2D.value}}),l.update(g)),g.material.uniforms.t2D.value=O,O.matrixAutoUpdate===!0&&O.updateMatrix(),g.material.uniforms.uvTransform.value.copy(O.matrix),(b!==O||A!==O.version||S!==r.toneMapping)&&(g.material.needsUpdate=!0,b=O,A=O.version,S=r.toneMapping),N.unshift(g,g.geometry,g.material,0,0,null))}function E(N,W){n.buffers.color.setClear(N.r,N.g,N.b,W,u)}return{getClearColor:function(){return h},setClearColor:function(N,W){h.set(N),p=W!==void 0?W:1,E(h,p)},getClearAlpha:function(){return p},setClearAlpha:function(N){p=N,E(h,p)},render:R}}function ET(r,i,n,l){const u=r.getParameter(34921),h=l.isWebGL2?null:i.get("OES_vertex_array_object"),p=l.isWebGL2||h!==null,g={},_=W(null);let b=_;function A(Ue,Le,Te,Ve,We){let rt=!1;if(p){const Tt=N(Ve,Te,Le);b!==Tt&&(b=Tt,R(b.object)),rt=V(Ve,We),rt&&B(Ve,We)}else{const Tt=Le.wireframe===!0;(b.geometry!==Ve.id||b.program!==Te.id||b.wireframe!==Tt)&&(b.geometry=Ve.id,b.program=Te.id,b.wireframe=Tt,rt=!0)}Ue.isInstancedMesh===!0&&(rt=!0),We!==null&&n.update(We,34963),rt&&(Ie(Ue,Le,Te,Ve),We!==null&&r.bindBuffer(34963,n.get(We).buffer))}function S(){return l.isWebGL2?r.createVertexArray():h.createVertexArrayOES()}function R(Ue){return l.isWebGL2?r.bindVertexArray(Ue):h.bindVertexArrayOES(Ue)}function E(Ue){return l.isWebGL2?r.deleteVertexArray(Ue):h.deleteVertexArrayOES(Ue)}function N(Ue,Le,Te){const Ve=Te.wireframe===!0;let We=g[Ue.id];We===void 0&&(We={},g[Ue.id]=We);let rt=We[Le.id];rt===void 0&&(rt={},We[Le.id]=rt);let Tt=rt[Ve];return Tt===void 0&&(Tt=W(S()),rt[Ve]=Tt),Tt}function W(Ue){const Le=[],Te=[],Ve=[];for(let We=0;We<u;We++)Le[We]=0,Te[We]=0,Ve[We]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Le,enabledAttributes:Te,attributeDivisors:Ve,object:Ue,attributes:{},index:null}}function V(Ue,Le){const Te=b.attributes,Ve=Ue.attributes;if(Object.keys(Te).length!==Object.keys(Ve).length)return!0;for(const We in Ve){const rt=Te[We],Tt=Ve[We];if(rt===void 0||rt.attribute!==Tt||rt.data!==Tt.data)return!0}return b.index!==Le}function B(Ue,Le){const Te={},Ve=Ue.attributes;for(const We in Ve){const rt=Ve[We],Tt={};Tt.attribute=rt,rt.data&&(Tt.data=rt.data),Te[We]=Tt}b.attributes=Te,b.index=Le}function O(){const Ue=b.newAttributes;for(let Le=0,Te=Ue.length;Le<Te;Le++)Ue[Le]=0}function pe(Ue){ge(Ue,0)}function ge(Ue,Le){const Te=b.newAttributes,Ve=b.enabledAttributes,We=b.attributeDivisors;Te[Ue]=1,Ve[Ue]===0&&(r.enableVertexAttribArray(Ue),Ve[Ue]=1),We[Ue]!==Le&&((l.isWebGL2?r:i.get("ANGLE_instanced_arrays"))[l.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ue,Le),We[Ue]=Le)}function ye(){const Ue=b.newAttributes,Le=b.enabledAttributes;for(let Te=0,Ve=Le.length;Te<Ve;Te++)Le[Te]!==Ue[Te]&&(r.disableVertexAttribArray(Te),Le[Te]=0)}function Q(Ue,Le,Te,Ve,We,rt){l.isWebGL2===!0&&(Te===5124||Te===5125)?r.vertexAttribIPointer(Ue,Le,Te,We,rt):r.vertexAttribPointer(Ue,Le,Te,Ve,We,rt)}function Ie(Ue,Le,Te,Ve){if(l.isWebGL2===!1&&(Ue.isInstancedMesh||Ve.isInstancedBufferGeometry)&&i.get("ANGLE_instanced_arrays")===null)return;O();const We=Ve.attributes,rt=Te.getAttributes(),Tt=Le.defaultAttributeValues;for(const nt in rt){const Et=rt[nt];if(Et>=0){const $t=We[nt];if($t!==void 0){const Yt=$t.normalized,K=$t.itemSize,H=n.get($t);if(H===void 0)continue;const xe=H.buffer,te=H.type,de=H.bytesPerElement;if($t.isInterleavedBufferAttribute){const be=$t.data,Re=be.stride,we=$t.offset;be&&be.isInstancedInterleavedBuffer?(ge(Et,be.meshPerAttribute),Ve._maxInstanceCount===void 0&&(Ve._maxInstanceCount=be.meshPerAttribute*be.count)):pe(Et),r.bindBuffer(34962,xe),Q(Et,K,te,Yt,Re*de,we*de)}else $t.isInstancedBufferAttribute?(ge(Et,$t.meshPerAttribute),Ve._maxInstanceCount===void 0&&(Ve._maxInstanceCount=$t.meshPerAttribute*$t.count)):pe(Et),r.bindBuffer(34962,xe),Q(Et,K,te,Yt,0,0)}else if(nt==="instanceMatrix"){const Yt=n.get(Ue.instanceMatrix);if(Yt===void 0)continue;const K=Yt.buffer,H=Yt.type;ge(Et+0,1),ge(Et+1,1),ge(Et+2,1),ge(Et+3,1),r.bindBuffer(34962,K),r.vertexAttribPointer(Et+0,4,H,!1,64,0),r.vertexAttribPointer(Et+1,4,H,!1,64,16),r.vertexAttribPointer(Et+2,4,H,!1,64,32),r.vertexAttribPointer(Et+3,4,H,!1,64,48)}else if(nt==="instanceColor"){const Yt=n.get(Ue.instanceColor);if(Yt===void 0)continue;const K=Yt.buffer,H=Yt.type;ge(Et,1),r.bindBuffer(34962,K),r.vertexAttribPointer(Et,3,H,!1,12,0)}else if(Tt!==void 0){const Yt=Tt[nt];if(Yt!==void 0)switch(Yt.length){case 2:r.vertexAttrib2fv(Et,Yt);break;case 3:r.vertexAttrib3fv(Et,Yt);break;case 4:r.vertexAttrib4fv(Et,Yt);break;default:r.vertexAttrib1fv(Et,Yt)}}}}ye()}function tt(){Ye();for(const Ue in g){const Le=g[Ue];for(const Te in Le){const Ve=Le[Te];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Le[Te]}delete g[Ue]}}function qe(Ue){if(g[Ue.id]===void 0)return;const Le=g[Ue.id];for(const Te in Le){const Ve=Le[Te];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Le[Te]}delete g[Ue.id]}function ht(Ue){for(const Le in g){const Te=g[Le];if(Te[Ue.id]===void 0)continue;const Ve=Te[Ue.id];for(const We in Ve)E(Ve[We].object),delete Ve[We];delete Te[Ue.id]}}function Ye(){Ne(),b!==_&&(b=_,R(b.object))}function Ne(){_.geometry=null,_.program=null,_.wireframe=!1}return{setup:A,reset:Ye,resetDefaultState:Ne,dispose:tt,releaseStatesOfGeometry:qe,releaseStatesOfProgram:ht,initAttributes:O,enableAttribute:pe,disableUnusedAttributes:ye}}function AT(r,i,n,l){const u=l.isWebGL2;let h;function p(b){h=b}function g(b,A){r.drawArrays(h,b,A),n.update(A,h,1)}function _(b,A,S){if(S===0)return;let R,E;if(u)R=r,E="drawArraysInstanced";else if(R=i.get("ANGLE_instanced_arrays"),E="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[E](h,b,A,S),n.update(A,h,S)}this.setMode=p,this.render=g,this.renderInstances=_}function LT(r,i,n){let l;function u(){if(l!==void 0)return l;const Q=i.get("EXT_texture_filter_anisotropic");return Q!==null?l=r.getParameter(Q.MAX_TEXTURE_MAX_ANISOTROPY_EXT):l=0,l}function h(Q){if(Q==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";Q="mediump"}return Q==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const p=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&r instanceof WebGL2ComputeRenderingContext;let g=n.precision!==void 0?n.precision:"highp";const _=h(g);_!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",_,"instead."),g=_);const b=n.logarithmicDepthBuffer===!0,A=r.getParameter(34930),S=r.getParameter(35660),R=r.getParameter(3379),E=r.getParameter(34076),N=r.getParameter(34921),W=r.getParameter(36347),V=r.getParameter(36348),B=r.getParameter(36349),O=S>0,pe=p||!!i.get("OES_texture_float"),ge=O&&pe,ye=p?r.getParameter(36183):0;return{isWebGL2:p,getMaxAnisotropy:u,getMaxPrecision:h,precision:g,logarithmicDepthBuffer:b,maxTextures:A,maxVertexTextures:S,maxTextureSize:R,maxCubemapSize:E,maxAttributes:N,maxVertexUniforms:W,maxVaryings:V,maxFragmentUniforms:B,vertexTextures:O,floatFragmentTextures:pe,floatVertexTextures:ge,maxSamples:ye}}function RT(r){const i=this;let n=null,l=0,u=!1,h=!1;const p=new il,g=new La,_={value:null,needsUpdate:!1};this.uniform=_,this.numPlanes=0,this.numIntersection=0,this.init=function(S,R,E){const N=S.length!==0||R||l!==0||u;return u=R,n=A(S,E,0),l=S.length,N},this.beginShadows=function(){h=!0,A(null)},this.endShadows=function(){h=!1,b()},this.setState=function(S,R,E){const N=S.clippingPlanes,W=S.clipIntersection,V=S.clipShadows,B=r.get(S);if(!u||N===null||N.length===0||h&&!V)h?A(null):b();else{const O=h?0:l,pe=O*4;let ge=B.clippingState||null;_.value=ge,ge=A(N,R,pe,E);for(let ye=0;ye!==pe;++ye)ge[ye]=n[ye];B.clippingState=ge,this.numIntersection=W?this.numPlanes:0,this.numPlanes+=O}};function b(){_.value!==n&&(_.value=n,_.needsUpdate=l>0),i.numPlanes=l,i.numIntersection=0}function A(S,R,E,N){const W=S!==null?S.length:0;let V=null;if(W!==0){if(V=_.value,N!==!0||V===null){const B=E+W*4,O=R.matrixWorldInverse;g.getNormalMatrix(O),(V===null||V.length<B)&&(V=new Float32Array(B));for(let pe=0,ge=E;pe!==W;++pe,ge+=4)p.copy(S[pe]).applyMatrix4(O,g),p.normal.toArray(V,ge),V[ge+3]=p.constant}_.value=V,_.needsUpdate=!0}return i.numPlanes=W,i.numIntersection=0,V}}function CT(r){let i=new WeakMap;function n(h,p){return p===Ru?h.mapping=vo:p===Gd&&(h.mapping=Ko),h}function l(h){if(h&&h.isTexture){const p=h.mapping;if(p===Ru||p===Gd)if(i.has(h)){const g=i.get(h).texture;return n(g,h.mapping)}else{const g=h.image;if(g&&g.height>0){const _=r.getRenderList(),b=r.getRenderTarget(),A=r.getRenderState(),S=new Ju(g.height/2);return S.fromEquirectangularTexture(r,h),i.set(h,S),r.setRenderTarget(b),r.setRenderList(_),r.setRenderState(A),n(S.texture,h.mapping)}else return null}}return h}function u(){i=new WeakMap}return{get:l,dispose:u}}function PT(r){const i={};return{has:function(n){if(i[n]!==void 0)return i[n]!==null;let l;switch(n){case"WEBGL_depth_texture":l=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":l=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":l=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":l=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=r.getExtension(n)}return i[n]=l,l!==null},get:function(n){return this.has(n)||console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),i[n]}}}function IT(r,i,n,l){const u=new WeakMap,h=new WeakMap;function p(S){const R=S.target,E=u.get(R);E.index!==null&&i.remove(E.index);for(const W in E.attributes)i.remove(E.attributes[W]);R.removeEventListener("dispose",p),u.delete(R);const N=h.get(E);N&&(i.remove(N),h.delete(E)),l.releaseStatesOfGeometry(R),R.isInstancedBufferGeometry===!0&&delete R._maxInstanceCount,n.memory.geometries--}function g(S,R){let E=u.get(R);return E||(R.addEventListener("dispose",p),R.isBufferGeometry?E=R:R.isGeometry&&(R._bufferGeometry===void 0&&(R._bufferGeometry=new Oi().setFromObject(S)),E=R._bufferGeometry),u.set(R,E),n.memory.geometries++,E)}function _(S){const R=S.attributes;for(const N in R)i.update(R[N],34962);const E=S.morphAttributes;for(const N in E){const W=E[N];for(let V=0,B=W.length;V<B;V++)i.update(W[V],34962)}}function b(S){const R=[],E=S.index,N=S.attributes.position;let W=0;if(E!==null){const O=E.array;W=E.version;for(let pe=0,ge=O.length;pe<ge;pe+=3){const ye=O[pe+0],Q=O[pe+1],Ie=O[pe+2];R.push(ye,Q,Q,Ie,Ie,ye)}}else{const O=N.array;W=N.version;for(let pe=0,ge=O.length/3-1;pe<ge;pe+=3){const ye=pe+0,Q=pe+1,Ie=pe+2;R.push(ye,Q,Q,Ie,Ie,ye)}}const V=new(h0(R)>65535?pf:df)(R,1);V.version=W;const B=h.get(S);B&&i.remove(B),h.set(S,V)}function A(S){const R=h.get(S);if(R){const E=S.index;E!==null&&R.version<E.version&&b(S)}else b(S);return h.get(S)}return{get:g,update:_,getWireframeAttribute:A}}function DT(r,i,n,l){const u=l.isWebGL2;let h;function p(R){h=R}let g,_;function b(R){g=R.type,_=R.bytesPerElement}function A(R,E){r.drawElements(h,E,g,R*_),n.update(E,h,1)}function S(R,E,N){if(N===0)return;let W,V;if(u)W=r,V="drawElementsInstanced";else if(W=i.get("ANGLE_instanced_arrays"),V="drawElementsInstancedANGLE",W===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}W[V](h,E,g,R*_,N),n.update(E,h,N)}this.setMode=p,this.setIndex=b,this.render=A,this.renderInstances=S}function OT(r){const i={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function l(h,p,g){switch(n.calls++,p){case 4:n.triangles+=g*(h/3);break;case 1:n.lines+=g*(h/2);break;case 3:n.lines+=g*(h-1);break;case 2:n.lines+=g*h;break;case 0:n.points+=g*h;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",p);break}}function u(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:i,render:n,programs:null,autoReset:!0,reset:u,update:l}}function NT(r,i){return r[0]-i[0]}function FT(r,i){return Math.abs(i[1])-Math.abs(r[1])}function BT(r){const i={},n=new Float32Array(8),l=[];for(let h=0;h<8;h++)l[h]=[h,0];function u(h,p,g,_){const b=h.morphTargetInfluences,A=b===void 0?0:b.length;let S=i[p.id];if(S===void 0){S=[];for(let V=0;V<A;V++)S[V]=[V,0];i[p.id]=S}for(let V=0;V<A;V++){const B=S[V];B[0]=V,B[1]=b[V]}S.sort(FT);for(let V=0;V<8;V++)V<A&&S[V][1]?(l[V][0]=S[V][0],l[V][1]=S[V][1]):(l[V][0]=Number.MAX_SAFE_INTEGER,l[V][1]=0);l.sort(NT);const R=g.morphTargets&&p.morphAttributes.position,E=g.morphNormals&&p.morphAttributes.normal;let N=0;for(let V=0;V<8;V++){const B=l[V],O=B[0],pe=B[1];O!==Number.MAX_SAFE_INTEGER&&pe?(R&&p.getAttribute("morphTarget"+V)!==R[O]&&p.setAttribute("morphTarget"+V,R[O]),E&&p.getAttribute("morphNormal"+V)!==E[O]&&p.setAttribute("morphNormal"+V,E[O]),n[V]=pe,N+=pe):(R&&p.getAttribute("morphTarget"+V)!==void 0&&p.deleteAttribute("morphTarget"+V),E&&p.getAttribute("morphNormal"+V)!==void 0&&p.deleteAttribute("morphNormal"+V),n[V]=0)}const W=p.morphTargetsRelative?1:1-N;_.getUniforms().setValue(r,"morphTargetBaseInfluence",W),_.getUniforms().setValue(r,"morphTargetInfluences",n)}return{update:u}}function UT(r,i,n,l){let u=new WeakMap;function h(g){const _=l.render.frame,b=g.geometry,A=i.get(g,b);return u.get(A)!==_&&(b.isGeometry&&A.updateFromObject(g),i.update(A),u.set(A,_)),g.isInstancedMesh&&(n.update(g.instanceMatrix,34962),g.instanceColor!==null&&n.update(g.instanceColor,34962)),A}function p(){u=new WeakMap}return{update:h,dispose:p}}function yf(r,i,n,l){Vi.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:l||1},this.magFilter=St,this.minFilter=St,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}yf.prototype=Object.create(Vi.prototype),yf.prototype.constructor=yf,yf.prototype.isDataTexture2DArray=!0;function _f(r,i,n,l){Vi.call(this,null),this.image={data:r||null,width:i||1,height:n||1,depth:l||1},this.magFilter=St,this.minFilter=St,this.wrapR=Qr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}_f.prototype=Object.create(Vi.prototype),_f.prototype.constructor=_f,_f.prototype.isDataTexture3D=!0;const g0=new Vi,GT=new yf,zT=new _f,v0=new Kl,y0=[],_0=[],x0=new Float32Array(16),b0=new Float32Array(9),w0=new Float32Array(4);function $u(r,i,n){const l=r[0];if(l<=0||l>0)return r;const u=i*n;let h=y0[u];if(h===void 0&&(h=new Float32Array(u),y0[u]=h),i!==0){l.toArray(h,0);for(let p=1,g=0;p!==i;++p)g+=n,r[p].toArray(h,g)}return h}function ps(r,i){if(r.length!==i.length)return!1;for(let n=0,l=r.length;n<l;n++)if(r[n]!==i[n])return!1;return!0}function Xa(r,i){for(let n=0,l=i.length;n<l;n++)r[n]=i[n]}function M0(r,i){let n=_0[i];n===void 0&&(n=new Int32Array(i),_0[i]=n);for(let l=0;l!==i;++l)n[l]=r.allocateTextureUnit();return n}function HT(r,i){const n=this.cache;n[0]!==i&&(r.uniform1f(this.addr,i),n[0]=i)}function kT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y)&&(r.uniform2f(this.addr,i.x,i.y),n[0]=i.x,n[1]=i.y);else{if(ps(n,i))return;r.uniform2fv(this.addr,i),Xa(n,i)}}function VT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z)&&(r.uniform3f(this.addr,i.x,i.y,i.z),n[0]=i.x,n[1]=i.y,n[2]=i.z);else if(i.r!==void 0)(n[0]!==i.r||n[1]!==i.g||n[2]!==i.b)&&(r.uniform3f(this.addr,i.r,i.g,i.b),n[0]=i.r,n[1]=i.g,n[2]=i.b);else{if(ps(n,i))return;r.uniform3fv(this.addr,i),Xa(n,i)}}function WT(r,i){const n=this.cache;if(i.x!==void 0)(n[0]!==i.x||n[1]!==i.y||n[2]!==i.z||n[3]!==i.w)&&(r.uniform4f(this.addr,i.x,i.y,i.z,i.w),n[0]=i.x,n[1]=i.y,n[2]=i.z,n[3]=i.w);else{if(ps(n,i))return;r.uniform4fv(this.addr,i),Xa(n,i)}}function qT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(ps(n,i))return;r.uniformMatrix2fv(this.addr,!1,i),Xa(n,i)}else{if(ps(n,l))return;w0.set(l),r.uniformMatrix2fv(this.addr,!1,w0),Xa(n,l)}}function XT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(ps(n,i))return;r.uniformMatrix3fv(this.addr,!1,i),Xa(n,i)}else{if(ps(n,l))return;b0.set(l),r.uniformMatrix3fv(this.addr,!1,b0),Xa(n,l)}}function YT(r,i){const n=this.cache,l=i.elements;if(l===void 0){if(ps(n,i))return;r.uniformMatrix4fv(this.addr,!1,i),Xa(n,i)}else{if(ps(n,l))return;x0.set(l),r.uniformMatrix4fv(this.addr,!1,x0),Xa(n,l)}}function jT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.safeSetTexture2D(i||g0,u)}function ZT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.setTexture2DArray(i||GT,u)}function JT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.setTexture3D(i||zT,u)}function KT(r,i,n){const l=this.cache,u=n.allocateTextureUnit();l[0]!==u&&(r.uniform1i(this.addr,u),l[0]=u),n.safeSetTextureCube(i||v0,u)}function QT(r,i){const n=this.cache;n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i)}function $T(r,i){const n=this.cache;ps(n,i)||(r.uniform2iv(this.addr,i),Xa(n,i))}function eE(r,i){const n=this.cache;ps(n,i)||(r.uniform3iv(this.addr,i),Xa(n,i))}function tE(r,i){const n=this.cache;ps(n,i)||(r.uniform4iv(this.addr,i),Xa(n,i))}function nE(r,i){const n=this.cache;n[0]!==i&&(r.uniform1ui(this.addr,i),n[0]=i)}function iE(r){switch(r){case 5126:return HT;case 35664:return kT;case 35665:return VT;case 35666:return WT;case 35674:return qT;case 35675:return XT;case 35676:return YT;case 5124:case 35670:return QT;case 35667:case 35671:return $T;case 35668:case 35672:return eE;case 35669:case 35673:return tE;case 5125:return nE;case 35678:case 36198:case 36298:case 36306:case 35682:return jT;case 35679:case 36299:case 36307:return JT;case 35680:case 36300:case 36308:case 36293:return KT;case 36289:case 36303:case 36311:case 36292:return ZT}}function rE(r,i){r.uniform1fv(this.addr,i)}function aE(r,i){r.uniform1iv(this.addr,i)}function sE(r,i){r.uniform2iv(this.addr,i)}function oE(r,i){r.uniform3iv(this.addr,i)}function lE(r,i){r.uniform4iv(this.addr,i)}function cE(r,i){const n=$u(i,this.size,2);r.uniform2fv(this.addr,n)}function uE(r,i){const n=$u(i,this.size,3);r.uniform3fv(this.addr,n)}function hE(r,i){const n=$u(i,this.size,4);r.uniform4fv(this.addr,n)}function fE(r,i){const n=$u(i,this.size,4);r.uniformMatrix2fv(this.addr,!1,n)}function dE(r,i){const n=$u(i,this.size,9);r.uniformMatrix3fv(this.addr,!1,n)}function pE(r,i){const n=$u(i,this.size,16);r.uniformMatrix4fv(this.addr,!1,n)}function mE(r,i,n){const l=i.length,u=M0(n,l);r.uniform1iv(this.addr,u);for(let h=0;h!==l;++h)n.safeSetTexture2D(i[h]||g0,u[h])}function gE(r,i,n){const l=i.length,u=M0(n,l);r.uniform1iv(this.addr,u);for(let h=0;h!==l;++h)n.safeSetTextureCube(i[h]||v0,u[h])}function vE(r){switch(r){case 5126:return rE;case 35664:return cE;case 35665:return uE;case 35666:return hE;case 35674:return fE;case 35675:return dE;case 35676:return pE;case 5124:case 35670:return aE;case 35667:case 35671:return sE;case 35668:case 35672:return oE;case 35669:case 35673:return lE;case 35678:case 36198:case 36298:case 36306:case 35682:return mE;case 35680:case 36300:case 36308:case 36293:return gE}}function yE(r,i,n){this.id=r,this.addr=n,this.cache=[],this.setValue=iE(i.type)}function S0(r,i,n){this.id=r,this.addr=n,this.cache=[],this.size=i.size,this.setValue=vE(i.type)}S0.prototype.updateCache=function(r){const i=this.cache;r instanceof Float32Array&&i.length!==r.length&&(this.cache=new Float32Array(r.length)),Xa(i,r)};function T0(r){this.id=r,this.seq=[],this.map={}}T0.prototype.setValue=function(r,i,n){const l=this.seq;for(let u=0,h=l.length;u!==h;++u){const p=l[u];p.setValue(r,i[p.id],n)}};const Ng=/([\w\d_]+)(\])?(\[|\.)?/g;function E0(r,i){r.seq.push(i),r.map[i.id]=i}function _E(r,i,n){const l=r.name,u=l.length;for(Ng.lastIndex=0;;){const h=Ng.exec(l),p=Ng.lastIndex;let g=h[1];const _=h[2]==="]",b=h[3];if(_&&(g=g|0),b===void 0||b==="["&&p+2===u){E0(n,b===void 0?new yE(g,r,i):new S0(g,r,i));break}else{let S=n.map[g];S===void 0&&(S=new T0(g),E0(n,S)),n=S}}}function Ql(r,i){this.seq=[],this.map={};const n=r.getProgramParameter(i,35718);for(let l=0;l<n;++l){const u=r.getActiveUniform(i,l),h=r.getUniformLocation(i,u.name);_E(u,h,this)}}Ql.prototype.setValue=function(r,i,n,l){const u=this.map[i];u!==void 0&&u.setValue(r,n,l)},Ql.prototype.setOptional=function(r,i,n){const l=i[n];l!==void 0&&this.setValue(r,n,l)},Ql.upload=function(r,i,n,l){for(let u=0,h=i.length;u!==h;++u){const p=i[u],g=n[p.id];g.needsUpdate!==!1&&p.setValue(r,g.value,l)}},Ql.seqWithValue=function(r,i){const n=[];for(let l=0,u=r.length;l!==u;++l){const h=r[l];h.id in i&&n.push(h)}return n};function A0(r,i,n){const l=r.createShader(i);return r.shaderSource(l,n),r.compileShader(l),l}let xE=0;function bE(r){const i=r.split(`
`);for(let n=0;n<i.length;n++)i[n]=n+1+": "+i[n];return i.join(`
`)}function L0(r){switch(r){case Bc:return["Linear","( value )"];case Vd:return["sRGB","( value )"];case Qy:return["RGBE","( value )"];case Iw:return["RGBM","( value, 7.0 )"];case Dw:return["RGBM","( value, 16.0 )"];case Ow:return["RGBD","( value, 256.0 )"];case Cw:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Pw:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function R0(r,i,n){const l=r.getShaderParameter(i,35713),u=r.getShaderInfoLog(i).trim();if(l&&u==="")return"";const h=r.getShaderSource(i);return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+u+bE(h)}function xf(r,i){const n=L0(i);return"vec4 "+r+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function wE(r,i){const n=L0(i);return"vec4 "+r+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function ME(r,i){let n;switch(i){case Lu:n="Linear";break;case Gl:n="Reinhard";break;case hs:n="OptimizedCineon";break;case go:n="ACESFilmic";break;case Jo:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",i),n="Linear"}return"vec3 "+r+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function SE(r){return[r.extensionDerivatives||r.envMapCubeUV||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(bf).join(`
`)}function TE(r){const i=[];for(const n in r){const l=r[n];l!==!1&&i.push("#define "+n+" "+l)}return i.join(`
`)}function EE(r,i){const n={},l=r.getProgramParameter(i,35721);for(let u=0;u<l;u++){const p=r.getActiveAttrib(i,u).name;n[p]=r.getAttribLocation(i,p)}return n}function bf(r){return r!==""}function C0(r,i){return r.replace(/NUM_DIR_LIGHTS/g,i.numDirLights).replace(/NUM_SPOT_LIGHTS/g,i.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,i.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,i.numPointLights).replace(/NUM_HEMI_LIGHTS/g,i.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,i.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,i.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,i.numPointLightShadows)}function P0(r,i){return r.replace(/NUM_CLIPPING_PLANES/g,i.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,i.numClippingPlanes-i.numClipIntersection)}const AE=/^[ \t]*#include +<([\w\d./]+)>/gm;function Fg(r){return r.replace(AE,LE)}function LE(r,i){const n=Qn[i];if(n===void 0)throw new Error("Can not resolve #include <"+i+">");return Fg(n)}const RE=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,CE=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function I0(r){return r.replace(CE,D0).replace(RE,PE)}function PE(r,i,n,l){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),D0(r,i,n,l)}function D0(r,i,n,l){let u="";for(let h=parseInt(i);h<parseInt(n);h++)u+=l.replace(/\[\s*i\s*\]/g,"[ "+h+" ]").replace(/UNROLLED_LOOP_INDEX/g,h);return u}function O0(r){let i="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?i+=`
#define HIGH_PRECISION`:r.precision==="mediump"?i+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(i+=`
#define LOW_PRECISION`),i}function IE(r){let i="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===Ot?i="SHADOWMAP_TYPE_PCF":r.shadowMapType===ki?i="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===di&&(i="SHADOWMAP_TYPE_VSM"),i}function DE(r){let i="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case vo:case Ko:i="ENVMAP_TYPE_CUBE";break;case nf:case Hl:i="ENVMAP_TYPE_CUBE_UV";break}return i}function OE(r){let i="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case Ko:case Hl:i="ENVMAP_MODE_REFRACTION";break}return i}function NE(r){let i="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case Ps:i="ENVMAP_BLENDING_MULTIPLY";break;case cs:i="ENVMAP_BLENDING_MIX";break;case us:i="ENVMAP_BLENDING_ADD";break}return i}function FE(r,i,n,l){const u=r.getContext(),h=n.defines;let p=n.vertexShader,g=n.fragmentShader;const _=IE(n),b=DE(n),A=OE(n),S=NE(n),R=r.gammaFactor>0?r.gammaFactor:1,E=n.isWebGL2?"":SE(n),N=TE(h),W=u.createProgram();let V,B,O=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(V=[N].filter(bf).join(`
`),V.length>0&&(V+=`
`),B=[E,N].filter(bf).join(`
`),B.length>0&&(B+=`
`)):(V=[O0(n),"#define SHADER_NAME "+n.shaderName,N,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+R,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+A:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(bf).join(`
`),B=[E,O0(n),"#define SHADER_NAME "+n.shaderName,N,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+R,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+b:"",n.envMap?"#define "+A:"",n.envMap?"#define "+S:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+_:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==kn?"#define TONE_MAPPING":"",n.toneMapping!==kn?Qn.tonemapping_pars_fragment:"",n.toneMapping!==kn?ME("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Qn.encodings_pars_fragment,n.map?xf("mapTexelToLinear",n.mapEncoding):"",n.matcap?xf("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?xf("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?xf("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?xf("lightMapTexelToLinear",n.lightMapEncoding):"",wE("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(bf).join(`
`)),p=Fg(p),p=C0(p,n),p=P0(p,n),g=Fg(g),g=C0(g,n),g=P0(g,n),p=I0(p),g=I0(g),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(O=`#version 300 es
`,V=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+V,B=["#define varying in",n.glslVersion===$y?"":"out highp vec4 pc_fragColor;",n.glslVersion===$y?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+B);const pe=O+V+p,ge=O+B+g,ye=A0(u,35633,pe),Q=A0(u,35632,ge);if(u.attachShader(W,ye),u.attachShader(W,Q),n.index0AttributeName!==void 0?u.bindAttribLocation(W,0,n.index0AttributeName):n.morphTargets===!0&&u.bindAttribLocation(W,0,"position"),u.linkProgram(W),r.debug.checkShaderErrors){const qe=u.getProgramInfoLog(W).trim(),ht=u.getShaderInfoLog(ye).trim(),Ye=u.getShaderInfoLog(Q).trim();let Ne=!0,Ue=!0;if(u.getProgramParameter(W,35714)===!1){Ne=!1;const Le=R0(u,ye,"vertex"),Te=R0(u,Q,"fragment");console.error("THREE.WebGLProgram: shader error: ",u.getError(),"35715",u.getProgramParameter(W,35715),"gl.getProgramInfoLog",qe,Le,Te)}else qe!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",qe):(ht===""||Ye==="")&&(Ue=!1);Ue&&(this.diagnostics={runnable:Ne,programLog:qe,vertexShader:{log:ht,prefix:V},fragmentShader:{log:Ye,prefix:B}})}u.deleteShader(ye),u.deleteShader(Q);let Ie;this.getUniforms=function(){return Ie===void 0&&(Ie=new Ql(u,W)),Ie};let tt;return this.getAttributes=function(){return tt===void 0&&(tt=EE(u,W)),tt},this.destroy=function(){l.releaseStatesOfProgram(this),u.deleteProgram(W),this.program=void 0},this.name=n.shaderName,this.id=xE++,this.cacheKey=i,this.usedTimes=1,this.program=W,this.vertexShader=ye,this.fragmentShader=Q,this}function BE(r,i,n,l,u,h){const p=[],g=l.isWebGL2,_=l.logarithmicDepthBuffer,b=l.floatVertexTextures,A=l.maxVertexUniforms,S=l.vertexTextures;let R=l.precision;const E={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},N=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function W(Q){const tt=Q.skeleton.bones;if(b)return 1024;{const ht=Math.floor((A-20)/4),Ye=Math.min(ht,tt.length);return Ye<tt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+tt.length+" bones. This GPU supports "+Ye+"."),0):Ye}}function V(Q){let Ie;return Q?Q.isTexture?Ie=Q.encoding:Q.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),Ie=Q.texture.encoding):Ie=Bc,Ie}function B(Q,Ie,tt,qe,ht){const Ye=qe.fog,Ne=Q.isMeshStandardMaterial?qe.environment:null,Ue=i.get(Q.envMap||Ne),Le=E[Q.type],Te=ht.isSkinnedMesh?W(ht):0;Q.precision!==null&&(R=l.getMaxPrecision(Q.precision),R!==Q.precision&&console.warn("THREE.WebGLProgram.getParameters:",Q.precision,"not supported, using",R,"instead."));let Ve,We;if(Le){const nt=xo[Le];Ve=nt.vertexShader,We=nt.fragmentShader}else Ve=Q.vertexShader,We=Q.fragmentShader;const rt=r.getRenderTarget();return{isWebGL2:g,shaderID:Le,shaderName:Q.type,vertexShader:Ve,fragmentShader:We,defines:Q.defines,isRawShaderMaterial:Q.isRawShaderMaterial===!0,glslVersion:Q.glslVersion,precision:R,instancing:ht.isInstancedMesh===!0,instancingColor:ht.isInstancedMesh===!0&&ht.instanceColor!==null,supportsVertexTextures:S,outputEncoding:rt!==null?V(rt.texture):r.outputEncoding,map:!!Q.map,mapEncoding:V(Q.map),matcap:!!Q.matcap,matcapEncoding:V(Q.matcap),envMap:!!Ue,envMapMode:Ue&&Ue.mapping,envMapEncoding:V(Ue),envMapCubeUV:!!Ue&&(Ue.mapping===nf||Ue.mapping===Hl),lightMap:!!Q.lightMap,lightMapEncoding:V(Q.lightMap),aoMap:!!Q.aoMap,emissiveMap:!!Q.emissiveMap,emissiveMapEncoding:V(Q.emissiveMap),bumpMap:!!Q.bumpMap,normalMap:!!Q.normalMap,objectSpaceNormalMap:Q.normalMapType===Bw,tangentSpaceNormalMap:Q.normalMapType===Uc,clearcoatMap:!!Q.clearcoatMap,clearcoatRoughnessMap:!!Q.clearcoatRoughnessMap,clearcoatNormalMap:!!Q.clearcoatNormalMap,displacementMap:!!Q.displacementMap,roughnessMap:!!Q.roughnessMap,metalnessMap:!!Q.metalnessMap,specularMap:!!Q.specularMap,alphaMap:!!Q.alphaMap,gradientMap:!!Q.gradientMap,sheen:!!Q.sheen,transmissionMap:!!Q.transmissionMap,combine:Q.combine,vertexTangents:Q.normalMap&&Q.vertexTangents,vertexColors:Q.vertexColors,vertexUvs:!!Q.map||!!Q.bumpMap||!!Q.normalMap||!!Q.specularMap||!!Q.alphaMap||!!Q.emissiveMap||!!Q.roughnessMap||!!Q.metalnessMap||!!Q.clearcoatMap||!!Q.clearcoatRoughnessMap||!!Q.clearcoatNormalMap||!!Q.displacementMap||!!Q.transmissionMap,uvsVertexOnly:!(!!Q.map||!!Q.bumpMap||!!Q.normalMap||!!Q.specularMap||!!Q.alphaMap||!!Q.emissiveMap||!!Q.roughnessMap||!!Q.metalnessMap||!!Q.clearcoatNormalMap||!!Q.transmissionMap)&&!!Q.displacementMap,fog:!!Ye,useFog:Q.fog,fogExp2:Ye&&Ye.isFogExp2,flatShading:Q.flatShading,sizeAttenuation:Q.sizeAttenuation,logarithmicDepthBuffer:_,skinning:Q.skinning&&Te>0,maxBones:Te,useVertexTexture:b,morphTargets:Q.morphTargets,morphNormals:Q.morphNormals,maxMorphTargets:r.maxMorphTargets,maxMorphNormals:r.maxMorphNormals,numDirLights:Ie.directional.length,numPointLights:Ie.point.length,numSpotLights:Ie.spot.length,numRectAreaLights:Ie.rectArea.length,numHemiLights:Ie.hemi.length,numDirLightShadows:Ie.directionalShadowMap.length,numPointLightShadows:Ie.pointShadowMap.length,numSpotLightShadows:Ie.spotShadowMap.length,numClippingPlanes:h.numPlanes,numClipIntersection:h.numIntersection,dithering:Q.dithering,shadowMapEnabled:r.shadowMap.enabled&&tt.length>0,shadowMapType:r.shadowMap.type,toneMapping:Q.toneMapped?r.toneMapping:kn,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:Q.premultipliedAlpha,alphaTest:Q.alphaTest,doubleSided:Q.side===Dn,flipSided:Q.side===ui,depthPacking:Q.depthPacking!==void 0?Q.depthPacking:!1,index0AttributeName:Q.index0AttributeName,extensionDerivatives:Q.extensions&&Q.extensions.derivatives,extensionFragDepth:Q.extensions&&Q.extensions.fragDepth,extensionDrawBuffers:Q.extensions&&Q.extensions.drawBuffers,extensionShaderTextureLOD:Q.extensions&&Q.extensions.shaderTextureLOD,rendererExtensionFragDepth:g||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:g||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:g||n.has("EXT_shader_texture_lod"),customProgramCacheKey:Q.customProgramCacheKey()}}function O(Q){const Ie=[];if(Q.shaderID?Ie.push(Q.shaderID):(Ie.push(Q.fragmentShader),Ie.push(Q.vertexShader)),Q.defines!==void 0)for(const tt in Q.defines)Ie.push(tt),Ie.push(Q.defines[tt]);if(Q.isRawShaderMaterial===!1){for(let tt=0;tt<N.length;tt++)Ie.push(Q[N[tt]]);Ie.push(r.outputEncoding),Ie.push(r.gammaFactor)}return Ie.push(Q.customProgramCacheKey),Ie.join()}function pe(Q){const Ie=E[Q.type];let tt;if(Ie){const qe=xo[Ie];tt=$w.clone(qe.uniforms)}else tt=Q.uniforms;return tt}function ge(Q,Ie){let tt;for(let qe=0,ht=p.length;qe<ht;qe++){const Ye=p[qe];if(Ye.cacheKey===Ie){tt=Ye,++tt.usedTimes;break}}return tt===void 0&&(tt=new FE(r,Ie,Q,u),p.push(tt)),tt}function ye(Q){if(--Q.usedTimes===0){const Ie=p.indexOf(Q);p[Ie]=p[p.length-1],p.pop(),Q.destroy()}}return{getParameters:B,getProgramCacheKey:O,getUniforms:pe,acquireProgram:ge,releaseProgram:ye,programs:p}}function UE(){let r=new WeakMap;function i(h){let p=r.get(h);return p===void 0&&(p={},r.set(h,p)),p}function n(h){r.delete(h)}function l(h,p,g){r.get(h)[p]=g}function u(){r=new WeakMap}return{get:i,remove:n,update:l,dispose:u}}function GE(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.program!==i.program?r.program.id-i.program.id:r.material.id!==i.material.id?r.material.id-i.material.id:r.z!==i.z?r.z-i.z:r.id-i.id}function zE(r,i){return r.groupOrder!==i.groupOrder?r.groupOrder-i.groupOrder:r.renderOrder!==i.renderOrder?r.renderOrder-i.renderOrder:r.z!==i.z?i.z-r.z:r.id-i.id}function N0(r){const i=[];let n=0;const l=[],u=[],h={id:-1};function p(){n=0,l.length=0,u.length=0}function g(R,E,N,W,V,B){let O=i[n];const pe=r.get(N);return O===void 0?(O={id:R.id,object:R,geometry:E,material:N,program:pe.program||h,groupOrder:W,renderOrder:R.renderOrder,z:V,group:B},i[n]=O):(O.id=R.id,O.object=R,O.geometry=E,O.material=N,O.program=pe.program||h,O.groupOrder=W,O.renderOrder=R.renderOrder,O.z=V,O.group=B),n++,O}function _(R,E,N,W,V,B){const O=g(R,E,N,W,V,B);(N.transparent===!0?u:l).push(O)}function b(R,E,N,W,V,B){const O=g(R,E,N,W,V,B);(N.transparent===!0?u:l).unshift(O)}function A(R,E){l.length>1&&l.sort(R||GE),u.length>1&&u.sort(E||zE)}function S(){for(let R=n,E=i.length;R<E;R++){const N=i[R];if(N.id===null)break;N.id=null,N.object=null,N.geometry=null,N.material=null,N.program=null,N.group=null}}return{opaque:l,transparent:u,init:p,push:_,unshift:b,finish:S,sort:A}}function HE(r){let i=new WeakMap;function n(u,h){const p=i.get(u);let g;return p===void 0?(g=new N0(r),i.set(u,new WeakMap),i.get(u).set(h,g)):(g=p.get(h),g===void 0&&(g=new N0(r),p.set(h,g))),g}function l(){i=new WeakMap}return{get:n,dispose:l}}function kE(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={direction:new _e,color:new Kt};break;case"SpotLight":n={position:new _e,direction:new _e,color:new Kt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new _e,color:new Kt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new _e,skyColor:new Kt,groundColor:new Kt};break;case"RectAreaLight":n={color:new Kt,position:new _e,halfWidth:new _e,halfHeight:new _e};break}return r[i.id]=n,n}}}function VE(){const r={};return{get:function(i){if(r[i.id]!==void 0)return r[i.id];let n;switch(i.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new xt,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[i.id]=n,n}}}let WE=0;function qE(r,i){return(i.castShadow?1:0)-(r.castShadow?1:0)}function XE(){const r=new kE,i=VE(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let g=0;g<9;g++)n.probe.push(new _e);const l=new _e,u=new zn,h=new zn;function p(g,_,b){let A=0,S=0,R=0;for(let Ie=0;Ie<9;Ie++)n.probe[Ie].set(0,0,0);let E=0,N=0,W=0,V=0,B=0,O=0,pe=0,ge=0;const ye=b.matrixWorldInverse;g.sort(qE);for(let Ie=0,tt=g.length;Ie<tt;Ie++){const qe=g[Ie],ht=qe.color,Ye=qe.intensity,Ne=qe.distance,Ue=qe.shadow&&qe.shadow.map?qe.shadow.map.texture:null;if(qe.isAmbientLight)A+=ht.r*Ye,S+=ht.g*Ye,R+=ht.b*Ye;else if(qe.isLightProbe)for(let Le=0;Le<9;Le++)n.probe[Le].addScaledVector(qe.sh.coefficients[Le],Ye);else if(qe.isDirectionalLight){const Le=r.get(qe);if(Le.color.copy(qe.color).multiplyScalar(qe.intensity),Le.direction.setFromMatrixPosition(qe.matrixWorld),l.setFromMatrixPosition(qe.target.matrixWorld),Le.direction.sub(l),Le.direction.transformDirection(ye),qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,n.directionalShadow[E]=Ve,n.directionalShadowMap[E]=Ue,n.directionalShadowMatrix[E]=qe.shadow.matrix,O++}n.directional[E]=Le,E++}else if(qe.isSpotLight){const Le=r.get(qe);if(Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),Le.color.copy(ht).multiplyScalar(Ye),Le.distance=Ne,Le.direction.setFromMatrixPosition(qe.matrixWorld),l.setFromMatrixPosition(qe.target.matrixWorld),Le.direction.sub(l),Le.direction.transformDirection(ye),Le.coneCos=Math.cos(qe.angle),Le.penumbraCos=Math.cos(qe.angle*(1-qe.penumbra)),Le.decay=qe.decay,qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,n.spotShadow[W]=Ve,n.spotShadowMap[W]=Ue,n.spotShadowMatrix[W]=qe.shadow.matrix,ge++}n.spot[W]=Le,W++}else if(qe.isRectAreaLight){const Le=r.get(qe);Le.color.copy(ht).multiplyScalar(Ye),Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),h.identity(),u.copy(qe.matrixWorld),u.premultiply(ye),h.extractRotation(u),Le.halfWidth.set(qe.width*.5,0,0),Le.halfHeight.set(0,qe.height*.5,0),Le.halfWidth.applyMatrix4(h),Le.halfHeight.applyMatrix4(h),n.rectArea[V]=Le,V++}else if(qe.isPointLight){const Le=r.get(qe);if(Le.position.setFromMatrixPosition(qe.matrixWorld),Le.position.applyMatrix4(ye),Le.color.copy(qe.color).multiplyScalar(qe.intensity),Le.distance=qe.distance,Le.decay=qe.decay,qe.castShadow){const Te=qe.shadow,Ve=i.get(qe);Ve.shadowBias=Te.bias,Ve.shadowNormalBias=Te.normalBias,Ve.shadowRadius=Te.radius,Ve.shadowMapSize=Te.mapSize,Ve.shadowCameraNear=Te.camera.near,Ve.shadowCameraFar=Te.camera.far,n.pointShadow[N]=Ve,n.pointShadowMap[N]=Ue,n.pointShadowMatrix[N]=qe.shadow.matrix,pe++}n.point[N]=Le,N++}else if(qe.isHemisphereLight){const Le=r.get(qe);Le.direction.setFromMatrixPosition(qe.matrixWorld),Le.direction.transformDirection(ye),Le.direction.normalize(),Le.skyColor.copy(qe.color).multiplyScalar(Ye),Le.groundColor.copy(qe.groundColor).multiplyScalar(Ye),n.hemi[B]=Le,B++}}V>0&&(n.rectAreaLTC1=Wt.LTC_1,n.rectAreaLTC2=Wt.LTC_2),n.ambient[0]=A,n.ambient[1]=S,n.ambient[2]=R;const Q=n.hash;(Q.directionalLength!==E||Q.pointLength!==N||Q.spotLength!==W||Q.rectAreaLength!==V||Q.hemiLength!==B||Q.numDirectionalShadows!==O||Q.numPointShadows!==pe||Q.numSpotShadows!==ge)&&(n.directional.length=E,n.spot.length=W,n.rectArea.length=V,n.point.length=N,n.hemi.length=B,n.directionalShadow.length=O,n.directionalShadowMap.length=O,n.pointShadow.length=pe,n.pointShadowMap.length=pe,n.spotShadow.length=ge,n.spotShadowMap.length=ge,n.directionalShadowMatrix.length=O,n.pointShadowMatrix.length=pe,n.spotShadowMatrix.length=ge,Q.directionalLength=E,Q.pointLength=N,Q.spotLength=W,Q.rectAreaLength=V,Q.hemiLength=B,Q.numDirectionalShadows=O,Q.numPointShadows=pe,Q.numSpotShadows=ge,n.version=WE++)}return{setup:p,state:n}}function F0(){const r=new XE,i=[],n=[];function l(){i.length=0,n.length=0}function u(_){i.push(_)}function h(_){n.push(_)}function p(_){r.setup(i,n,_)}return{init:l,state:{lightsArray:i,shadowsArray:n,lights:r},setupLights:p,pushLight:u,pushShadow:h}}function YE(){let r=new WeakMap;function i(l,u){let h;return r.has(l)===!1?(h=new F0,r.set(l,new WeakMap),r.get(l).set(u,h)):r.get(l).has(u)===!1?(h=new F0,r.get(l).set(u,h)):h=r.get(l).get(u),h}function n(){r=new WeakMap}return{get:i,dispose:n}}function Vc(r){bn.call(this),this.type="MeshDepthMaterial",this.depthPacking=Nw,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(r)}Vc.prototype=Object.create(bn.prototype),Vc.prototype.constructor=Vc,Vc.prototype.isMeshDepthMaterial=!0,Vc.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.depthPacking=r.depthPacking,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this};function Wc(r){bn.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new _e,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(r)}Wc.prototype=Object.create(bn.prototype),Wc.prototype.constructor=Wc,Wc.prototype.isMeshDistanceMaterial=!0,Wc.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.referencePosition.copy(r.referencePosition),this.nearDistance=r.nearDistance,this.farDistance=r.farDistance,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this};var jE=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,ZE=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function B0(r,i,n){let l=new sp;const u=new xt,h=new xt,p=new Gi,g=[],_=[],b={},A={0:ui,1:Ui,2:Dn},S=new Ra({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new xt},radius:{value:4}},vertexShader:ZE,fragmentShader:jE}),R=S.clone();R.defines.HORIZONAL_PASS=1;const E=new Oi;E.setAttribute("position",new Nn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const N=new ea(E,S),W=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Ot,this.render=function(ye,Q,Ie){if(W.enabled===!1||W.autoUpdate===!1&&W.needsUpdate===!1||ye.length===0)return;const tt=r.getRenderTarget(),qe=r.getActiveCubeFace(),ht=r.getActiveMipmapLevel(),Ye=r.state;Ye.setBlending(Kn),Ye.buffers.color.setClear(1,1,1,1),Ye.buffers.depth.setTest(!0),Ye.setScissorTest(!1);for(let Ne=0,Ue=ye.length;Ne<Ue;Ne++){const Le=ye[Ne],Te=Le.shadow;if(Te===void 0){console.warn("THREE.WebGLShadowMap:",Le,"has no shadow.");continue}if(Te.autoUpdate===!1&&Te.needsUpdate===!1)continue;u.copy(Te.mapSize);const Ve=Te.getFrameExtents();if(u.multiply(Ve),h.copy(Te.mapSize),(u.x>n||u.y>n)&&(u.x>n&&(h.x=Math.floor(n/Ve.x),u.x=h.x*Ve.x,Te.mapSize.x=h.x),u.y>n&&(h.y=Math.floor(n/Ve.y),u.y=h.y*Ve.y,Te.mapSize.y=h.y)),Te.map===null&&!Te.isPointLightShadow&&this.type===di){const rt={minFilter:Sn,magFilter:Sn,format:fs};Te.map=new Os(u.x,u.y,rt),Te.map.texture.name=Le.name+".shadowMap",Te.mapPass=new Os(u.x,u.y,rt),Te.camera.updateProjectionMatrix()}if(Te.map===null){const rt={minFilter:St,magFilter:St,format:fs};Te.map=new Os(u.x,u.y,rt),Te.map.texture.name=Le.name+".shadowMap",Te.camera.updateProjectionMatrix()}r.setRenderTarget(Te.map),r.clear();const We=Te.getViewportCount();for(let rt=0;rt<We;rt++){const Tt=Te.getViewport(rt);p.set(h.x*Tt.x,h.y*Tt.y,h.x*Tt.z,h.y*Tt.w),Ye.viewport(p),Te.updateMatrices(Le,rt),l=Te.getFrustum(),ge(Q,Ie,Te.camera,Le,this.type)}!Te.isPointLightShadow&&this.type===di&&V(Te,Ie),Te.needsUpdate=!1}W.needsUpdate=!1,r.setRenderTarget(tt,qe,ht)};function V(ye,Q){const Ie=i.update(N);S.uniforms.shadow_pass.value=ye.map.texture,S.uniforms.resolution.value=ye.mapSize,S.uniforms.radius.value=ye.radius,r.setRenderTarget(ye.mapPass),r.clear(),r.renderBufferDirect(Q,null,Ie,S,N,null),R.uniforms.shadow_pass.value=ye.mapPass.texture,R.uniforms.resolution.value=ye.mapSize,R.uniforms.radius.value=ye.radius,r.setRenderTarget(ye.map),r.clear(),r.renderBufferDirect(Q,null,Ie,R,N,null)}function B(ye,Q,Ie){const tt=ye<<0|Q<<1|Ie<<2;let qe=g[tt];return qe===void 0&&(qe=new Vc({depthPacking:Fw,morphTargets:ye,skinning:Q}),g[tt]=qe),qe}function O(ye,Q,Ie){const tt=ye<<0|Q<<1|Ie<<2;let qe=_[tt];return qe===void 0&&(qe=new Wc({morphTargets:ye,skinning:Q}),_[tt]=qe),qe}function pe(ye,Q,Ie,tt,qe,ht,Ye){let Ne=null,Ue=B,Le=ye.customDepthMaterial;if(tt.isPointLight===!0&&(Ue=O,Le=ye.customDistanceMaterial),Le===void 0){let Te=!1;Ie.morphTargets===!0&&(Te=Q.morphAttributes&&Q.morphAttributes.position&&Q.morphAttributes.position.length>0);let Ve=!1;ye.isSkinnedMesh===!0&&(Ie.skinning===!0?Ve=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",ye));const We=ye.isInstancedMesh===!0;Ne=Ue(Te,Ve,We)}else Ne=Le;if(r.localClippingEnabled&&Ie.clipShadows===!0&&Ie.clippingPlanes.length!==0){const Te=Ne.uuid,Ve=Ie.uuid;let We=b[Te];We===void 0&&(We={},b[Te]=We);let rt=We[Ve];rt===void 0&&(rt=Ne.clone(),We[Ve]=rt),Ne=rt}return Ne.visible=Ie.visible,Ne.wireframe=Ie.wireframe,Ye===di?Ne.side=Ie.shadowSide!==null?Ie.shadowSide:Ie.side:Ne.side=Ie.shadowSide!==null?Ie.shadowSide:A[Ie.side],Ne.clipShadows=Ie.clipShadows,Ne.clippingPlanes=Ie.clippingPlanes,Ne.clipIntersection=Ie.clipIntersection,Ne.wireframeLinewidth=Ie.wireframeLinewidth,Ne.linewidth=Ie.linewidth,tt.isPointLight===!0&&Ne.isMeshDistanceMaterial===!0&&(Ne.referencePosition.setFromMatrixPosition(tt.matrixWorld),Ne.nearDistance=qe,Ne.farDistance=ht),Ne}function ge(ye,Q,Ie,tt,qe){if(ye.visible===!1)return;if(ye.layers.test(Q.layers)&&(ye.isMesh||ye.isLine||ye.isPoints)&&(ye.castShadow||ye.receiveShadow&&qe===di)&&(!ye.frustumCulled||l.intersectsObject(ye))){ye.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,ye.matrixWorld);const Ne=i.update(ye),Ue=ye.material;if(Array.isArray(Ue)){const Le=Ne.groups;for(let Te=0,Ve=Le.length;Te<Ve;Te++){const We=Le[Te],rt=Ue[We.materialIndex];if(rt&&rt.visible){const Tt=pe(ye,Ne,rt,tt,Ie.near,Ie.far,qe);r.renderBufferDirect(Ie,null,Ne,Tt,ye,We)}}}else if(Ue.visible){const Le=pe(ye,Ne,Ue,tt,Ie.near,Ie.far,qe);r.renderBufferDirect(Ie,null,Ne,Le,ye,null)}}const Ye=ye.children;for(let Ne=0,Ue=Ye.length;Ne<Ue;Ne++)ge(Ye[Ne],Q,Ie,tt,qe)}}function JE(r,i,n){const l=n.isWebGL2;function u(){let ue=!1;const Je=new Gi;let lt=null;const Nt=new Gi(0,0,0,0);return{setMask:function(ct){lt!==ct&&!ue&&(r.colorMask(ct,ct,ct,ct),lt=ct)},setLocked:function(ct){ue=ct},setClear:function(ct,me,it,Lt,pt){pt===!0&&(ct*=Lt,me*=Lt,it*=Lt),Je.set(ct,me,it,Lt),Nt.equals(Je)===!1&&(r.clearColor(ct,me,it,Lt),Nt.copy(Je))},reset:function(){ue=!1,lt=null,Nt.set(-1,0,0,0)}}}function h(){let ue=!1,Je=null,lt=null,Nt=null;return{setTest:function(ct){ct?nt(2929):Et(2929)},setMask:function(ct){Je!==ct&&!ue&&(r.depthMask(ct),Je=ct)},setFunc:function(ct){if(lt!==ct){if(ct)switch(ct){case Kr:r.depthFunc(512);break;case ar:r.depthFunc(519);break;case Cs:r.depthFunc(513);break;case Va:r.depthFunc(515);break;case Zo:r.depthFunc(514);break;case xn:r.depthFunc(518);break;case wi:r.depthFunc(516);break;case mo:r.depthFunc(517);break;default:r.depthFunc(515)}else r.depthFunc(515);lt=ct}},setLocked:function(ct){ue=ct},setClear:function(ct){Nt!==ct&&(r.clearDepth(ct),Nt=ct)},reset:function(){ue=!1,Je=null,lt=null,Nt=null}}}function p(){let ue=!1,Je=null,lt=null,Nt=null,ct=null,me=null,it=null,Lt=null,pt=null;return{setTest:function(Dt){ue||(Dt?nt(2960):Et(2960))},setMask:function(Dt){Je!==Dt&&!ue&&(r.stencilMask(Dt),Je=Dt)},setFunc:function(Dt,cn,pi){(lt!==Dt||Nt!==cn||ct!==pi)&&(r.stencilFunc(Dt,cn,pi),lt=Dt,Nt=cn,ct=pi)},setOp:function(Dt,cn,pi){(me!==Dt||it!==cn||Lt!==pi)&&(r.stencilOp(Dt,cn,pi),me=Dt,it=cn,Lt=pi)},setLocked:function(Dt){ue=Dt},setClear:function(Dt){pt!==Dt&&(r.clearStencil(Dt),pt=Dt)},reset:function(){ue=!1,Je=null,lt=null,Nt=null,ct=null,me=null,it=null,Lt=null,pt=null}}}const g=new u,_=new h,b=new p;let A={},S=null,R=null,E=null,N=null,W=null,V=null,B=null,O=null,pe=null,ge=!1,ye=null,Q=null,Ie=null,tt=null,qe=null;const ht=r.getParameter(35661);let Ye=!1,Ne=0;const Ue=r.getParameter(7938);Ue.indexOf("WebGL")!==-1?(Ne=parseFloat(/^WebGL\ ([0-9])/.exec(Ue)[1]),Ye=Ne>=1):Ue.indexOf("OpenGL ES")!==-1&&(Ne=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Ue)[1]),Ye=Ne>=2);let Le=null,Te={};const Ve=new Gi,We=new Gi;function rt(ue,Je,lt){const Nt=new Uint8Array(4),ct=r.createTexture();r.bindTexture(ue,ct),r.texParameteri(ue,10241,9728),r.texParameteri(ue,10240,9728);for(let me=0;me<lt;me++)r.texImage2D(Je+me,0,6408,1,1,0,6408,5121,Nt);return ct}const Tt={};Tt[3553]=rt(3553,3553,1),Tt[34067]=rt(34067,34069,6),g.setClear(0,0,0,1),_.setClear(1),b.setClear(0),nt(2929),_.setFunc(Va),te(!1),de(Xn),nt(2884),H(Kn);function nt(ue){A[ue]!==!0&&(r.enable(ue),A[ue]=!0)}function Et(ue){A[ue]!==!1&&(r.disable(ue),A[ue]=!1)}function $t(ue){return S!==ue?(r.useProgram(ue),S=ue,!0):!1}const Yt={[rr]:32774,[aa]:32778,[pn]:32779};if(l)Yt[En]=32775,Yt[Fr]=32776;else{const ue=i.get("EXT_blend_minmax");ue!==null&&(Yt[En]=ue.MIN_EXT,Yt[Fr]=ue.MAX_EXT)}const K={[Di]:0,[Lr]:1,[Ha]:768,[Yo]:770,[Ul]:776,[jo]:774,[Fl]:772,[Rs]:769,[ka]:771,[Bl]:775,[po]:773};function H(ue,Je,lt,Nt,ct,me,it,Lt){if(ue===Kn){R&&(Et(3042),R=!1);return}if(R||(nt(3042),R=!0),ue!==Jr){if(ue!==E||Lt!==ge){if((N!==rr||B!==rr)&&(r.blendEquation(32774),N=rr,B=rr),Lt)switch(ue){case wr:r.blendFuncSeparate(1,771,1,771);break;case Ar:r.blendFunc(1,1);break;case yi:r.blendFuncSeparate(0,0,769,771);break;case Ii:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}else switch(ue){case wr:r.blendFuncSeparate(770,771,1,771);break;case Ar:r.blendFunc(770,1);break;case yi:r.blendFunc(0,769);break;case Ii:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ue);break}W=null,V=null,O=null,pe=null,E=ue,ge=Lt}return}ct=ct||Je,me=me||lt,it=it||Nt,(Je!==N||ct!==B)&&(r.blendEquationSeparate(Yt[Je],Yt[ct]),N=Je,B=ct),(lt!==W||Nt!==V||me!==O||it!==pe)&&(r.blendFuncSeparate(K[lt],K[Nt],K[me],K[it]),W=lt,V=Nt,O=me,pe=it),E=ue,ge=null}function xe(ue,Je){ue.side===Dn?Et(2884):nt(2884);let lt=ue.side===ui;Je&&(lt=!lt),te(lt),ue.blending===wr&&ue.transparent===!1?H(Kn):H(ue.blending,ue.blendEquation,ue.blendSrc,ue.blendDst,ue.blendEquationAlpha,ue.blendSrcAlpha,ue.blendDstAlpha,ue.premultipliedAlpha),_.setFunc(ue.depthFunc),_.setTest(ue.depthTest),_.setMask(ue.depthWrite),g.setMask(ue.colorWrite);const Nt=ue.stencilWrite;b.setTest(Nt),Nt&&(b.setMask(ue.stencilWriteMask),b.setFunc(ue.stencilFunc,ue.stencilRef,ue.stencilFuncMask),b.setOp(ue.stencilFail,ue.stencilZFail,ue.stencilZPass)),Re(ue.polygonOffset,ue.polygonOffsetFactor,ue.polygonOffsetUnits)}function te(ue){ye!==ue&&(ue?r.frontFace(2304):r.frontFace(2305),ye=ue)}function de(ue){ue!==In?(nt(2884),ue!==Q&&(ue===Xn?r.cullFace(1029):ue===_n?r.cullFace(1028):r.cullFace(1032))):Et(2884),Q=ue}function be(ue){ue!==Ie&&(Ye&&r.lineWidth(ue),Ie=ue)}function Re(ue,Je,lt){ue?(nt(32823),(tt!==Je||qe!==lt)&&(r.polygonOffset(Je,lt),tt=Je,qe=lt)):Et(32823)}function we(ue){ue?nt(3089):Et(3089)}function Se(ue){ue===void 0&&(ue=33984+ht-1),Le!==ue&&(r.activeTexture(ue),Le=ue)}function Pe(ue,Je){Le===null&&Se();let lt=Te[Le];lt===void 0&&(lt={type:void 0,texture:void 0},Te[Le]=lt),(lt.type!==ue||lt.texture!==Je)&&(r.bindTexture(ue,Je||Tt[ue]),lt.type=ue,lt.texture=Je)}function ze(){const ue=Te[Le];ue!==void 0&&ue.type!==void 0&&(r.bindTexture(ue.type,null),ue.type=void 0,ue.texture=void 0)}function Ze(){try{r.compressedTexImage2D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function Xe(){try{r.texImage2D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function $(){try{r.texImage3D.apply(r,arguments)}catch(ue){console.error("THREE.WebGLState:",ue)}}function j(ue){Ve.equals(ue)===!1&&(r.scissor(ue.x,ue.y,ue.z,ue.w),Ve.copy(ue))}function He(ue){We.equals(ue)===!1&&(r.viewport(ue.x,ue.y,ue.z,ue.w),We.copy(ue))}function Ge(){A={},Le=null,Te={},S=null,E=null,ye=null,Q=null,g.reset(),_.reset(),b.reset()}return{buffers:{color:g,depth:_,stencil:b},enable:nt,disable:Et,useProgram:$t,setBlending:H,setMaterial:xe,setFlipSided:te,setCullFace:de,setLineWidth:be,setPolygonOffset:Re,setScissorTest:we,activeTexture:Se,bindTexture:Pe,unbindTexture:ze,compressedTexImage2D:Ze,texImage2D:Xe,texImage3D:$,scissor:j,viewport:He,reset:Ge}}function KE(r,i,n,l,u,h,p){const g=u.isWebGL2,_=u.maxTextures,b=u.maxCubemapSize,A=u.maxTextureSize,S=u.maxSamples,R=new WeakMap;let E,N=!1;try{N=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function W($,j){return N?new OffscreenCanvas($,j):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function V($,j,He,Ge){let ue=1;if(($.width>Ge||$.height>Ge)&&(ue=Ge/Math.max($.width,$.height)),ue<1||j===!0)if(typeof HTMLImageElement<"u"&&$ instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&$ instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&$ instanceof ImageBitmap){const Je=j?Gn.floorPowerOfTwo:Math.floor,lt=Je(ue*$.width),Nt=Je(ue*$.height);E===void 0&&(E=W(lt,Nt));const ct=He?W(lt,Nt):E;return ct.width=lt,ct.height=Nt,ct.getContext("2d").drawImage($,0,0,lt,Nt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$.width+"x"+$.height+") to ("+lt+"x"+Nt+")."),ct}else return"data"in $&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$.width+"x"+$.height+")."),$;return $}function B($){return Gn.isPowerOfTwo($.width)&&Gn.isPowerOfTwo($.height)}function O($){return g?!1:$.wrapS!==Qr||$.wrapT!==Qr||$.minFilter!==St&&$.minFilter!==Sn}function pe($,j){return $.generateMipmaps&&j&&$.minFilter!==St&&$.minFilter!==Sn}function ge($,j,He,Ge){r.generateMipmap($);const ue=l.get(j);ue.__maxMipLevel=Math.log(Math.max(He,Ge))*Math.LOG2E}function ye($,j,He){if(g===!1)return j;if($!==null){if(r[$]!==void 0)return r[$];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+$+"'")}let Ge=j;return j===6403&&(He===5126&&(Ge=33326),He===5131&&(Ge=33325),He===5121&&(Ge=33321)),j===6407&&(He===5126&&(Ge=34837),He===5131&&(Ge=34843),He===5121&&(Ge=32849)),j===6408&&(He===5126&&(Ge=34836),He===5131&&(Ge=34842),He===5121&&(Ge=32856)),(Ge===33325||Ge===33326||Ge===34842||Ge===34836)&&i.get("EXT_color_buffer_float"),Ge}function Q($){return $===St||$===On||$===_i?9728:9729}function Ie($){const j=$.target;j.removeEventListener("dispose",Ie),qe(j),j.isVideoTexture&&R.delete(j),p.memory.textures--}function tt($){const j=$.target;j.removeEventListener("dispose",tt),ht(j),p.memory.textures--}function qe($){const j=l.get($);j.__webglInit!==void 0&&(r.deleteTexture(j.__webglTexture),l.remove($))}function ht($){const j=l.get($),He=l.get($.texture);if(!!$){if(He.__webglTexture!==void 0&&r.deleteTexture(He.__webglTexture),$.depthTexture&&$.depthTexture.dispose(),$.isWebGLCubeRenderTarget)for(let Ge=0;Ge<6;Ge++)r.deleteFramebuffer(j.__webglFramebuffer[Ge]),j.__webglDepthbuffer&&r.deleteRenderbuffer(j.__webglDepthbuffer[Ge]);else r.deleteFramebuffer(j.__webglFramebuffer),j.__webglDepthbuffer&&r.deleteRenderbuffer(j.__webglDepthbuffer),j.__webglMultisampledFramebuffer&&r.deleteFramebuffer(j.__webglMultisampledFramebuffer),j.__webglColorRenderbuffer&&r.deleteRenderbuffer(j.__webglColorRenderbuffer),j.__webglDepthRenderbuffer&&r.deleteRenderbuffer(j.__webglDepthRenderbuffer);l.remove($.texture),l.remove($)}}let Ye=0;function Ne(){Ye=0}function Ue(){const $=Ye;return $>=_&&console.warn("THREE.WebGLTextures: Trying to use "+$+" texture units while this GPU supports only "+_),Ye+=1,$}function Le($,j){const He=l.get($);if($.isVideoTexture&&Se($),$.version>0&&He.__version!==$.version){const Ge=$.image;if(Ge===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Ge.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{$t(He,$,j);return}}n.activeTexture(33984+j),n.bindTexture(3553,He.__webglTexture)}function Te($,j){const He=l.get($);if($.version>0&&He.__version!==$.version){$t(He,$,j);return}n.activeTexture(33984+j),n.bindTexture(35866,He.__webglTexture)}function Ve($,j){const He=l.get($);if($.version>0&&He.__version!==$.version){$t(He,$,j);return}n.activeTexture(33984+j),n.bindTexture(32879,He.__webglTexture)}function We($,j){const He=l.get($);if($.version>0&&He.__version!==$.version){Yt(He,$,j);return}n.activeTexture(33984+j),n.bindTexture(34067,He.__webglTexture)}const rt={[kl]:10497,[Qr]:33071,[bt]:33648},Tt={[St]:9728,[On]:9984,[_i]:9986,[Sn]:9729,[Mr]:9985,[Cu]:9987};function nt($,j,He){He?(r.texParameteri($,10242,rt[j.wrapS]),r.texParameteri($,10243,rt[j.wrapT]),($===32879||$===35866)&&r.texParameteri($,32882,rt[j.wrapR]),r.texParameteri($,10240,Tt[j.magFilter]),r.texParameteri($,10241,Tt[j.minFilter])):(r.texParameteri($,10242,33071),r.texParameteri($,10243,33071),($===32879||$===35866)&&r.texParameteri($,32882,33071),(j.wrapS!==Qr||j.wrapT!==Qr)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri($,10240,Q(j.magFilter)),r.texParameteri($,10241,Q(j.minFilter)),j.minFilter!==St&&j.minFilter!==Sn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Ge=i.get("EXT_texture_filter_anisotropic");if(Ge){if(j.type===Is&&i.get("OES_texture_float_linear")===null||j.type===Fc&&(g||i.get("OES_texture_half_float_linear"))===null)return;(j.anisotropy>1||l.get(j).__currentAnisotropy)&&(r.texParameterf($,Ge.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(j.anisotropy,u.getMaxAnisotropy())),l.get(j).__currentAnisotropy=j.anisotropy)}}function Et($,j){$.__webglInit===void 0&&($.__webglInit=!0,j.addEventListener("dispose",Ie),$.__webglTexture=r.createTexture(),p.memory.textures++)}function $t($,j,He){let Ge=3553;j.isDataTexture2DArray&&(Ge=35866),j.isDataTexture3D&&(Ge=32879),Et($,j),n.activeTexture(33984+He),n.bindTexture(Ge,$.__webglTexture),r.pixelStorei(37440,j.flipY),r.pixelStorei(37441,j.premultiplyAlpha),r.pixelStorei(3317,j.unpackAlignment);const ue=O(j)&&B(j.image)===!1,Je=V(j.image,ue,!1,A),lt=B(Je)||g,Nt=h.convert(j.format);let ct=h.convert(j.type),me=ye(j.internalFormat,Nt,ct);nt(Ge,j,lt);let it;const Lt=j.mipmaps;if(j.isDepthTexture)me=6402,g?j.type===Is?me=36012:j.type===Hd?me=33190:j.type===rf?me=35056:me=33189:j.type===Is&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),j.format===Pu&&me===6402&&j.type!==zd&&j.type!==Hd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),j.type=zd,ct=h.convert(j.type)),j.format===af&&me===6402&&(me=34041,j.type!==rf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),j.type=rf,ct=h.convert(j.type))),n.texImage2D(3553,0,me,Je.width,Je.height,0,Nt,ct,null);else if(j.isDataTexture)if(Lt.length>0&&lt){for(let pt=0,Dt=Lt.length;pt<Dt;pt++)it=Lt[pt],n.texImage2D(3553,pt,me,it.width,it.height,0,Nt,ct,it.data);j.generateMipmaps=!1,$.__maxMipLevel=Lt.length-1}else n.texImage2D(3553,0,me,Je.width,Je.height,0,Nt,ct,Je.data),$.__maxMipLevel=0;else if(j.isCompressedTexture){for(let pt=0,Dt=Lt.length;pt<Dt;pt++)it=Lt[pt],j.format!==fs&&j.format!==yo?Nt!==null?n.compressedTexImage2D(3553,pt,me,it.width,it.height,0,it.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,pt,me,it.width,it.height,0,Nt,ct,it.data);$.__maxMipLevel=Lt.length-1}else if(j.isDataTexture2DArray)n.texImage3D(35866,0,me,Je.width,Je.height,Je.depth,0,Nt,ct,Je.data),$.__maxMipLevel=0;else if(j.isDataTexture3D)n.texImage3D(32879,0,me,Je.width,Je.height,Je.depth,0,Nt,ct,Je.data),$.__maxMipLevel=0;else if(Lt.length>0&&lt){for(let pt=0,Dt=Lt.length;pt<Dt;pt++)it=Lt[pt],n.texImage2D(3553,pt,me,Nt,ct,it);j.generateMipmaps=!1,$.__maxMipLevel=Lt.length-1}else n.texImage2D(3553,0,me,Nt,ct,Je),$.__maxMipLevel=0;pe(j,lt)&&ge(Ge,j,Je.width,Je.height),$.__version=j.version,j.onUpdate&&j.onUpdate(j)}function Yt($,j,He){if(j.image.length!==6)return;Et($,j),n.activeTexture(33984+He),n.bindTexture(34067,$.__webglTexture),r.pixelStorei(37440,j.flipY);const Ge=j&&(j.isCompressedTexture||j.image[0].isCompressedTexture),ue=j.image[0]&&j.image[0].isDataTexture,Je=[];for(let pt=0;pt<6;pt++)!Ge&&!ue?Je[pt]=V(j.image[pt],!1,!0,b):Je[pt]=ue?j.image[pt].image:j.image[pt];const lt=Je[0],Nt=B(lt)||g,ct=h.convert(j.format),me=h.convert(j.type),it=ye(j.internalFormat,ct,me);nt(34067,j,Nt);let Lt;if(Ge){for(let pt=0;pt<6;pt++){Lt=Je[pt].mipmaps;for(let Dt=0;Dt<Lt.length;Dt++){const cn=Lt[Dt];j.format!==fs&&j.format!==yo?ct!==null?n.compressedTexImage2D(34069+pt,Dt,it,cn.width,cn.height,0,cn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+pt,Dt,it,cn.width,cn.height,0,ct,me,cn.data)}}$.__maxMipLevel=Lt.length-1}else{Lt=j.mipmaps;for(let pt=0;pt<6;pt++)if(ue){n.texImage2D(34069+pt,0,it,Je[pt].width,Je[pt].height,0,ct,me,Je[pt].data);for(let Dt=0;Dt<Lt.length;Dt++){const pi=Lt[Dt].image[pt].image;n.texImage2D(34069+pt,Dt+1,it,pi.width,pi.height,0,ct,me,pi.data)}}else{n.texImage2D(34069+pt,0,it,ct,me,Je[pt]);for(let Dt=0;Dt<Lt.length;Dt++){const cn=Lt[Dt];n.texImage2D(34069+pt,Dt+1,it,ct,me,cn.image[pt])}}$.__maxMipLevel=Lt.length}pe(j,Nt)&&ge(34067,j,lt.width,lt.height),$.__version=j.version,j.onUpdate&&j.onUpdate(j)}function K($,j,He,Ge){const ue=h.convert(j.texture.format),Je=h.convert(j.texture.type),lt=ye(j.texture.internalFormat,ue,Je);n.texImage2D(Ge,0,lt,j.width,j.height,0,ue,Je,null),r.bindFramebuffer(36160,$),r.framebufferTexture2D(36160,He,Ge,l.get(j.texture).__webglTexture,0),r.bindFramebuffer(36160,null)}function H($,j,He){if(r.bindRenderbuffer(36161,$),j.depthBuffer&&!j.stencilBuffer){let Ge=33189;if(He){const ue=j.depthTexture;ue&&ue.isDepthTexture&&(ue.type===Is?Ge=36012:ue.type===Hd&&(Ge=33190));const Je=we(j);r.renderbufferStorageMultisample(36161,Je,Ge,j.width,j.height)}else r.renderbufferStorage(36161,Ge,j.width,j.height);r.framebufferRenderbuffer(36160,36096,36161,$)}else if(j.depthBuffer&&j.stencilBuffer){if(He){const Ge=we(j);r.renderbufferStorageMultisample(36161,Ge,35056,j.width,j.height)}else r.renderbufferStorage(36161,34041,j.width,j.height);r.framebufferRenderbuffer(36160,33306,36161,$)}else{const Ge=h.convert(j.texture.format),ue=h.convert(j.texture.type),Je=ye(j.texture.internalFormat,Ge,ue);if(He){const lt=we(j);r.renderbufferStorageMultisample(36161,lt,Je,j.width,j.height)}else r.renderbufferStorage(36161,Je,j.width,j.height)}r.bindRenderbuffer(36161,null)}function xe($,j){if(j&&j.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(36160,$),!(j.depthTexture&&j.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!l.get(j.depthTexture).__webglTexture||j.depthTexture.image.width!==j.width||j.depthTexture.image.height!==j.height)&&(j.depthTexture.image.width=j.width,j.depthTexture.image.height=j.height,j.depthTexture.needsUpdate=!0),Le(j.depthTexture,0);const Ge=l.get(j.depthTexture).__webglTexture;if(j.depthTexture.format===Pu)r.framebufferTexture2D(36160,36096,3553,Ge,0);else if(j.depthTexture.format===af)r.framebufferTexture2D(36160,33306,3553,Ge,0);else throw new Error("Unknown depthTexture format")}function te($){const j=l.get($),He=$.isWebGLCubeRenderTarget===!0;if($.depthTexture){if(He)throw new Error("target.depthTexture not supported in Cube render targets");xe(j.__webglFramebuffer,$)}else if(He){j.__webglDepthbuffer=[];for(let Ge=0;Ge<6;Ge++)r.bindFramebuffer(36160,j.__webglFramebuffer[Ge]),j.__webglDepthbuffer[Ge]=r.createRenderbuffer(),H(j.__webglDepthbuffer[Ge],$,!1)}else r.bindFramebuffer(36160,j.__webglFramebuffer),j.__webglDepthbuffer=r.createRenderbuffer(),H(j.__webglDepthbuffer,$,!1);r.bindFramebuffer(36160,null)}function de($){const j=l.get($),He=l.get($.texture);$.addEventListener("dispose",tt),He.__webglTexture=r.createTexture(),p.memory.textures++;const Ge=$.isWebGLCubeRenderTarget===!0,ue=$.isWebGLMultisampleRenderTarget===!0,Je=B($)||g;if(g&&$.texture.format===yo&&($.texture.type===Is||$.texture.type===Fc)&&($.texture.format=fs,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Ge){j.__webglFramebuffer=[];for(let lt=0;lt<6;lt++)j.__webglFramebuffer[lt]=r.createFramebuffer()}else if(j.__webglFramebuffer=r.createFramebuffer(),ue)if(g){j.__webglMultisampledFramebuffer=r.createFramebuffer(),j.__webglColorRenderbuffer=r.createRenderbuffer(),r.bindRenderbuffer(36161,j.__webglColorRenderbuffer);const lt=h.convert($.texture.format),Nt=h.convert($.texture.type),ct=ye($.texture.internalFormat,lt,Nt),me=we($);r.renderbufferStorageMultisample(36161,me,ct,$.width,$.height),r.bindFramebuffer(36160,j.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064,36161,j.__webglColorRenderbuffer),r.bindRenderbuffer(36161,null),$.depthBuffer&&(j.__webglDepthRenderbuffer=r.createRenderbuffer(),H(j.__webglDepthRenderbuffer,$,!0)),r.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Ge){n.bindTexture(34067,He.__webglTexture),nt(34067,$.texture,Je);for(let lt=0;lt<6;lt++)K(j.__webglFramebuffer[lt],$,36064,34069+lt);pe($.texture,Je)&&ge(34067,$.texture,$.width,$.height),n.bindTexture(34067,null)}else n.bindTexture(3553,He.__webglTexture),nt(3553,$.texture,Je),K(j.__webglFramebuffer,$,36064,3553),pe($.texture,Je)&&ge(3553,$.texture,$.width,$.height),n.bindTexture(3553,null);$.depthBuffer&&te($)}function be($){const j=$.texture,He=B($)||g;if(pe(j,He)){const Ge=$.isWebGLCubeRenderTarget?34067:3553,ue=l.get(j).__webglTexture;n.bindTexture(Ge,ue),ge(Ge,j,$.width,$.height),n.bindTexture(Ge,null)}}function Re($){if($.isWebGLMultisampleRenderTarget)if(g){const j=l.get($);r.bindFramebuffer(36008,j.__webglMultisampledFramebuffer),r.bindFramebuffer(36009,j.__webglFramebuffer);const He=$.width,Ge=$.height;let ue=16384;$.depthBuffer&&(ue|=256),$.stencilBuffer&&(ue|=1024),r.blitFramebuffer(0,0,He,Ge,0,0,He,Ge,ue,9728),r.bindFramebuffer(36160,j.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function we($){return g&&$.isWebGLMultisampleRenderTarget?Math.min(S,$.samples):0}function Se($){const j=p.render.frame;R.get($)!==j&&(R.set($,j),$.update())}let Pe=!1,ze=!1;function Ze($,j){$&&$.isWebGLRenderTarget&&(Pe===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Pe=!0),$=$.texture),Le($,j)}function Xe($,j){$&&$.isWebGLCubeRenderTarget&&(ze===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),ze=!0),$=$.texture),We($,j)}this.allocateTextureUnit=Ue,this.resetTextureUnits=Ne,this.setTexture2D=Le,this.setTexture2DArray=Te,this.setTexture3D=Ve,this.setTextureCube=We,this.setupRenderTarget=de,this.updateRenderTargetMipmap=be,this.updateMultisampleRenderTarget=Re,this.safeSetTexture2D=Ze,this.safeSetTextureCube=Xe}function QE(r,i,n){const l=n.isWebGL2;function u(h){let p;if(h===Nc)return 5121;if(h===Fb)return 32819;if(h===Bb)return 32820;if(h===Ub)return 33635;if(h===Db)return 5120;if(h===Ob)return 5122;if(h===zd)return 5123;if(h===Nb)return 5124;if(h===Hd)return 5125;if(h===Is)return 5126;if(h===Fc)return l?5131:(p=i.get("OES_texture_half_float"),p!==null?p.HALF_FLOAT_OES:null);if(h===Gb)return 6406;if(h===yo)return 6407;if(h===fs)return 6408;if(h===zb)return 6409;if(h===Hb)return 6410;if(h===Pu)return 6402;if(h===af)return 34041;if(h===Vb)return 6403;if(h===Wb)return 36244;if(h===qb)return 33319;if(h===Xb)return 33320;if(h===Yb)return 36248;if(h===jb)return 36249;if(h===zy||h===Hy||h===ky||h===Vy)if(p=i.get("WEBGL_compressed_texture_s3tc"),p!==null){if(h===zy)return p.COMPRESSED_RGB_S3TC_DXT1_EXT;if(h===Hy)return p.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(h===ky)return p.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(h===Vy)return p.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(h===Wy||h===qy||h===Xy||h===Yy)if(p=i.get("WEBGL_compressed_texture_pvrtc"),p!==null){if(h===Wy)return p.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(h===qy)return p.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(h===Xy)return p.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(h===Yy)return p.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(h===Zb)return p=i.get("WEBGL_compressed_texture_etc1"),p!==null?p.COMPRESSED_RGB_ETC1_WEBGL:null;if((h===jy||h===Zy)&&(p=i.get("WEBGL_compressed_texture_etc"),p!==null)){if(h===jy)return p.COMPRESSED_RGB8_ETC2;if(h===Zy)return p.COMPRESSED_RGBA8_ETC2_EAC}if(h===Jb||h===Kb||h===Qb||h===$b||h===ew||h===tw||h===nw||h===iw||h===rw||h===aw||h===sw||h===ow||h===lw||h===cw||h===hw||h===fw||h===dw||h===pw||h===mw||h===gw||h===vw||h===yw||h===_w||h===xw||h===bw||h===ww||h===Mw||h===Sw)return p=i.get("WEBGL_compressed_texture_astc"),p!==null?h:null;if(h===uw)return p=i.get("EXT_texture_compression_bptc"),p!==null?h:null;if(h===rf)return l?34042:(p=i.get("WEBGL_depth_texture"),p!==null?p.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:u}}function Bg(r){Vr.call(this),this.cameras=r||[]}Bg.prototype=Object.assign(Object.create(Vr.prototype),{constructor:Bg,isArrayCamera:!0});function sl(){hn.call(this),this.type="Group"}sl.prototype=Object.assign(Object.create(hn.prototype),{constructor:sl,isGroup:!0});function wf(){this._targetRay=null,this._grip=null,this._hand=null}Object.assign(wf.prototype,{constructor:wf,getHandSpace:function(){if(this._hand===null&&(this._hand=new sl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let r=0;r<=window.XRHand.LITTLE_PHALANX_TIP;r++){const i=new sl;i.matrixAutoUpdate=!1,i.visible=!1,this._hand.joints.push(i),this._hand.add(i)}return this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new sl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new sl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this},disconnect:function(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(r,i,n){let l=null,u=null,h=null;const p=this._targetRay,g=this._grip,_=this._hand;if(r)if(_&&r.hand){h=!0;for(let b=0;b<=window.XRHand.LITTLE_PHALANX_TIP;b++)if(r.hand[b]){const A=i.getJointPose(r.hand[b],n),S=_.joints[b];A!==null&&(S.matrix.fromArray(A.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=A.radius),S.visible=A!==null;const R=_.joints[window.XRHand.INDEX_PHALANX_TIP],E=_.joints[window.XRHand.THUMB_PHALANX_TIP],N=R.position.distanceTo(E.position),W=.02,V=.005;_.inputState.pinching&&N>W+V?(_.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!_.inputState.pinching&&N<=W-V&&(_.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}}else p!==null&&(l=i.getPose(r.targetRaySpace,n),l!==null&&(p.matrix.fromArray(l.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale))),g!==null&&r.gripSpace&&(u=i.getPose(r.gripSpace,n),u!==null&&(g.matrix.fromArray(u.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale)));return p!==null&&(p.visible=l!==null),g!==null&&(g.visible=u!==null),_!==null&&(_.visible=h!==null),this}});function U0(r,i){const n=this;let l=null,u=1,h=null,p="local-floor",g=null;const _=[],b=new Map,A=new Vr;A.layers.enable(1),A.viewport=new Gi;const S=new Vr;S.layers.enable(2),S.viewport=new Gi;const R=[A,S],E=new Bg;E.layers.enable(1),E.layers.enable(2);let N=null,W=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(Ye){let Ne=_[Ye];return Ne===void 0&&(Ne=new wf,_[Ye]=Ne),Ne.getTargetRaySpace()},this.getControllerGrip=function(Ye){let Ne=_[Ye];return Ne===void 0&&(Ne=new wf,_[Ye]=Ne),Ne.getGripSpace()},this.getHand=function(Ye){let Ne=_[Ye];return Ne===void 0&&(Ne=new wf,_[Ye]=Ne),Ne.getHandSpace()};function V(Ye){const Ne=b.get(Ye.inputSource);Ne&&Ne.dispatchEvent({type:Ye.type,data:Ye.inputSource})}function B(){b.forEach(function(Ye,Ne){Ye.disconnect(Ne)}),b.clear(),r.setFramebuffer(null),r.setRenderTarget(r.getRenderTarget()),ht.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function O(Ye){h=Ye,ht.setContext(l),ht.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(Ye){u=Ye,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ye){p=Ye,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h},this.getSession=function(){return l},this.setSession=function(Ye){if(l=Ye,l!==null){l.addEventListener("select",V),l.addEventListener("selectstart",V),l.addEventListener("selectend",V),l.addEventListener("squeeze",V),l.addEventListener("squeezestart",V),l.addEventListener("squeezeend",V),l.addEventListener("end",B);const Ne=i.getContextAttributes();Ne.xrCompatible!==!0&&i.makeXRCompatible();const Ue={antialias:Ne.antialias,alpha:Ne.alpha,depth:Ne.depth,stencil:Ne.stencil,framebufferScaleFactor:u},Le=new XRWebGLLayer(l,i,Ue);l.updateRenderState({baseLayer:Le}),l.requestReferenceSpace(p).then(O),l.addEventListener("inputsourceschange",pe)}};function pe(Ye){const Ne=l.inputSources;for(let Ue=0;Ue<_.length;Ue++)b.set(Ne[Ue],_[Ue]);for(let Ue=0;Ue<Ye.removed.length;Ue++){const Le=Ye.removed[Ue],Te=b.get(Le);Te&&(Te.dispatchEvent({type:"disconnected",data:Le}),b.delete(Le))}for(let Ue=0;Ue<Ye.added.length;Ue++){const Le=Ye.added[Ue],Te=b.get(Le);Te&&Te.dispatchEvent({type:"connected",data:Le})}}const ge=new _e,ye=new _e;function Q(Ye,Ne,Ue){ge.setFromMatrixPosition(Ne.matrixWorld),ye.setFromMatrixPosition(Ue.matrixWorld);const Le=ge.distanceTo(ye),Te=Ne.projectionMatrix.elements,Ve=Ue.projectionMatrix.elements,We=Te[14]/(Te[10]-1),rt=Te[14]/(Te[10]+1),Tt=(Te[9]+1)/Te[5],nt=(Te[9]-1)/Te[5],Et=(Te[8]-1)/Te[0],$t=(Ve[8]+1)/Ve[0],Yt=We*Et,K=We*$t,H=Le/(-Et+$t),xe=H*-Et;Ne.matrixWorld.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.translateX(xe),Ye.translateZ(H),Ye.matrixWorld.compose(Ye.position,Ye.quaternion,Ye.scale),Ye.matrixWorldInverse.getInverse(Ye.matrixWorld);const te=We+H,de=rt+H,be=Yt-xe,Re=K+(Le-xe),we=Tt*rt/de*te,Se=nt*rt/de*te;Ye.projectionMatrix.makePerspective(be,Re,we,Se,te,de)}function Ie(Ye,Ne){Ne===null?Ye.matrixWorld.copy(Ye.matrix):Ye.matrixWorld.multiplyMatrices(Ne.matrixWorld,Ye.matrix),Ye.matrixWorldInverse.getInverse(Ye.matrixWorld)}this.getCamera=function(Ye){E.near=S.near=A.near=Ye.near,E.far=S.far=A.far=Ye.far,(N!==E.near||W!==E.far)&&(l.updateRenderState({depthNear:E.near,depthFar:E.far}),N=E.near,W=E.far);const Ne=Ye.parent,Ue=E.cameras;Ie(E,Ne);for(let Te=0;Te<Ue.length;Te++)Ie(Ue[Te],Ne);Ye.matrixWorld.copy(E.matrixWorld);const Le=Ye.children;for(let Te=0,Ve=Le.length;Te<Ve;Te++)Le[Te].updateMatrixWorld(!0);return Ue.length===2?Q(E,A,S):E.projectionMatrix.copy(A.projectionMatrix),E};let tt=null;function qe(Ye,Ne){if(g=Ne.getViewerPose(h),g!==null){const Le=g.views,Te=l.renderState.baseLayer;r.setFramebuffer(Te.framebuffer);let Ve=!1;Le.length!==E.cameras.length&&(E.cameras.length=0,Ve=!0);for(let We=0;We<Le.length;We++){const rt=Le[We],Tt=Te.getViewport(rt),nt=R[We];nt.matrix.fromArray(rt.transform.matrix),nt.projectionMatrix.fromArray(rt.projectionMatrix),nt.viewport.set(Tt.x,Tt.y,Tt.width,Tt.height),We===0&&E.matrix.copy(nt.matrix),Ve===!0&&E.cameras.push(nt)}}const Ue=l.inputSources;for(let Le=0;Le<_.length;Le++){const Te=_[Le],Ve=Ue[Le];Te.update(Ve,Ne,h)}tt&&tt(Ye,Ne)}const ht=new m0;ht.setAnimationLoop(qe),this.setAnimationLoop=function(Ye){tt=Ye},this.dispose=function(){}}Object.assign(U0.prototype,Ds.prototype);function $E(r){function i(B,O){B.fogColor.value.copy(O.color),O.isFog?(B.fogNear.value=O.near,B.fogFar.value=O.far):O.isFogExp2&&(B.fogDensity.value=O.density)}function n(B,O,pe,ge){O.isMeshBasicMaterial?l(B,O):O.isMeshLambertMaterial?(l(B,O),_(B,O)):O.isMeshToonMaterial?(l(B,O),A(B,O)):O.isMeshPhongMaterial?(l(B,O),b(B,O)):O.isMeshStandardMaterial?(l(B,O),O.isMeshPhysicalMaterial?R(B,O):S(B,O)):O.isMeshMatcapMaterial?(l(B,O),E(B,O)):O.isMeshDepthMaterial?(l(B,O),N(B,O)):O.isMeshDistanceMaterial?(l(B,O),W(B,O)):O.isMeshNormalMaterial?(l(B,O),V(B,O)):O.isLineBasicMaterial?(u(B,O),O.isLineDashedMaterial&&h(B,O)):O.isPointsMaterial?p(B,O,pe,ge):O.isSpriteMaterial?g(B,O):O.isShadowMaterial?(B.color.value.copy(O.color),B.opacity.value=O.opacity):O.isShaderMaterial&&(O.uniformsNeedUpdate=!1)}function l(B,O){B.opacity.value=O.opacity,O.color&&B.diffuse.value.copy(O.color),O.emissive&&B.emissive.value.copy(O.emissive).multiplyScalar(O.emissiveIntensity),O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap),O.specularMap&&(B.specularMap.value=O.specularMap);const pe=r.get(O).envMap;if(pe){B.envMap.value=pe,B.flipEnvMap.value=pe.isCubeTexture&&pe._needsFlipEnvMap?-1:1,B.reflectivity.value=O.reflectivity,B.refractionRatio.value=O.refractionRatio;const Q=r.get(pe).__maxMipLevel;Q!==void 0&&(B.maxMipLevel.value=Q)}O.lightMap&&(B.lightMap.value=O.lightMap,B.lightMapIntensity.value=O.lightMapIntensity),O.aoMap&&(B.aoMap.value=O.aoMap,B.aoMapIntensity.value=O.aoMapIntensity);let ge;O.map?ge=O.map:O.specularMap?ge=O.specularMap:O.displacementMap?ge=O.displacementMap:O.normalMap?ge=O.normalMap:O.bumpMap?ge=O.bumpMap:O.roughnessMap?ge=O.roughnessMap:O.metalnessMap?ge=O.metalnessMap:O.alphaMap?ge=O.alphaMap:O.emissiveMap?ge=O.emissiveMap:O.clearcoatMap?ge=O.clearcoatMap:O.clearcoatNormalMap?ge=O.clearcoatNormalMap:O.clearcoatRoughnessMap&&(ge=O.clearcoatRoughnessMap),ge!==void 0&&(ge.isWebGLRenderTarget&&(ge=ge.texture),ge.matrixAutoUpdate===!0&&ge.updateMatrix(),B.uvTransform.value.copy(ge.matrix));let ye;O.aoMap?ye=O.aoMap:O.lightMap&&(ye=O.lightMap),ye!==void 0&&(ye.isWebGLRenderTarget&&(ye=ye.texture),ye.matrixAutoUpdate===!0&&ye.updateMatrix(),B.uv2Transform.value.copy(ye.matrix))}function u(B,O){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity}function h(B,O){B.dashSize.value=O.dashSize,B.totalSize.value=O.dashSize+O.gapSize,B.scale.value=O.scale}function p(B,O,pe,ge){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity,B.size.value=O.size*pe,B.scale.value=ge*.5,O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap);let ye;O.map?ye=O.map:O.alphaMap&&(ye=O.alphaMap),ye!==void 0&&(ye.matrixAutoUpdate===!0&&ye.updateMatrix(),B.uvTransform.value.copy(ye.matrix))}function g(B,O){B.diffuse.value.copy(O.color),B.opacity.value=O.opacity,B.rotation.value=O.rotation,O.map&&(B.map.value=O.map),O.alphaMap&&(B.alphaMap.value=O.alphaMap);let pe;O.map?pe=O.map:O.alphaMap&&(pe=O.alphaMap),pe!==void 0&&(pe.matrixAutoUpdate===!0&&pe.updateMatrix(),B.uvTransform.value.copy(pe.matrix))}function _(B,O){O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap)}function b(B,O){B.specular.value.copy(O.specular),B.shininess.value=Math.max(O.shininess,1e-4),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ui&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ui&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function A(B,O){O.gradientMap&&(B.gradientMap.value=O.gradientMap),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ui&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ui&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function S(B,O){B.roughness.value=O.roughness,B.metalness.value=O.metalness,O.roughnessMap&&(B.roughnessMap.value=O.roughnessMap),O.metalnessMap&&(B.metalnessMap.value=O.metalnessMap),O.emissiveMap&&(B.emissiveMap.value=O.emissiveMap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ui&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ui&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias),r.get(O).envMap&&(B.envMapIntensity.value=O.envMapIntensity)}function R(B,O){S(B,O),B.reflectivity.value=O.reflectivity,B.clearcoat.value=O.clearcoat,B.clearcoatRoughness.value=O.clearcoatRoughness,O.sheen&&B.sheen.value.copy(O.sheen),O.clearcoatMap&&(B.clearcoatMap.value=O.clearcoatMap),O.clearcoatRoughnessMap&&(B.clearcoatRoughnessMap.value=O.clearcoatRoughnessMap),O.clearcoatNormalMap&&(B.clearcoatNormalScale.value.copy(O.clearcoatNormalScale),B.clearcoatNormalMap.value=O.clearcoatNormalMap,O.side===ui&&B.clearcoatNormalScale.value.negate()),B.transmission.value=O.transmission,O.transmissionMap&&(B.transmissionMap.value=O.transmissionMap)}function E(B,O){O.matcap&&(B.matcap.value=O.matcap),O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ui&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ui&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function N(B,O){O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}function W(B,O){O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias),B.referencePosition.value.copy(O.referencePosition),B.nearDistance.value=O.nearDistance,B.farDistance.value=O.farDistance}function V(B,O){O.bumpMap&&(B.bumpMap.value=O.bumpMap,B.bumpScale.value=O.bumpScale,O.side===ui&&(B.bumpScale.value*=-1)),O.normalMap&&(B.normalMap.value=O.normalMap,B.normalScale.value.copy(O.normalScale),O.side===ui&&B.normalScale.value.negate()),O.displacementMap&&(B.displacementMap.value=O.displacementMap,B.displacementScale.value=O.displacementScale,B.displacementBias.value=O.displacementBias)}return{refreshFogUniforms:i,refreshMaterialUniforms:n}}function op(r){r=r||{};const i=r.canvas!==void 0?r.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=r.context!==void 0?r.context:null,l=r.alpha!==void 0?r.alpha:!1,u=r.depth!==void 0?r.depth:!0,h=r.stencil!==void 0?r.stencil:!0,p=r.antialias!==void 0?r.antialias:!1,g=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,_=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,b=r.powerPreference!==void 0?r.powerPreference:"default",A=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let S=null,R=null;this.domElement=i,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Bc,this.physicallyCorrectLights=!1,this.toneMapping=kn,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const E=this;let N=!1,W=null,V=0,B=0,O=null,pe=null,ge=-1,ye=null,Q=null;const Ie=new Gi,tt=new Gi;let qe=null,ht=i.width,Ye=i.height,Ne=1,Ue=null,Le=null;const Te=new Gi(0,0,ht,Ye),Ve=new Gi(0,0,ht,Ye);let We=!1;const rt=new sp;let Tt=!1,nt=!1;const Et=new zn,$t=new _e,Yt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function K(){return O===null?Ne:1}let H=n;function xe(re,Qe){for(let Ke=0;Ke<re.length;Ke++){const ut=re[Ke],Ft=i.getContext(ut,Qe);if(Ft!==null)return Ft}return null}try{const re={alpha:l,depth:u,stencil:h,antialias:p,premultipliedAlpha:g,preserveDrawingBuffer:_,powerPreference:b,failIfMajorPerformanceCaveat:A};if(i.addEventListener("webglcontextlost",cn,!1),i.addEventListener("webglcontextrestored",pi,!1),H===null){const Qe=["webgl2","webgl","experimental-webgl"];if(E.isWebGL1Renderer===!0&&Qe.shift(),H=xe(Qe,re),H===null)throw xe(Qe)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(re){throw console.error("THREE.WebGLRenderer: "+re.message),re}let te,de,be,Re,we,Se,Pe,ze,Ze,Xe,$,j,He,Ge,ue,Je,lt,Nt,ct,me,it;function Lt(){te=new PT(H),de=new LT(H,te,r),de.isWebGL2===!1&&(te.get("WEBGL_depth_texture"),te.get("OES_texture_float"),te.get("OES_texture_half_float"),te.get("OES_texture_half_float_linear"),te.get("OES_standard_derivatives"),te.get("OES_element_index_uint"),te.get("OES_vertex_array_object"),te.get("ANGLE_instanced_arrays")),te.get("OES_texture_float_linear"),me=new QE(H,te,de),be=new JE(H,te,de),be.scissor(tt.copy(Ve).multiplyScalar(Ne).floor()),be.viewport(Ie.copy(Te).multiplyScalar(Ne).floor()),Re=new OT(H),we=new UE,Se=new KE(H,te,be,we,de,me,Re),Pe=new CT(E),ze=new nM(H,de),it=new ET(H,te,ze,de),Ze=new IT(H,ze,Re,it),Xe=new UT(H,Ze,ze,Re),lt=new BT(H),ue=new RT(we),$=new BE(E,Pe,te,de,it,ue),j=new $E(we),He=new HE(we),Ge=new YE,Je=new TT(E,Pe,be,Xe,g),Nt=new AT(H,te,Re,de),ct=new DT(H,te,Re,de),Re.programs=$.programs,E.capabilities=de,E.extensions=te,E.properties=we,E.renderLists=He,E.state=be,E.info=Re}Lt();const pt=new U0(E,H);this.xr=pt;const Dt=new B0(E,Xe,de.maxTextureSize);this.shadowMap=Dt,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const re=te.get("WEBGL_lose_context");re&&re.loseContext()},this.forceContextRestore=function(){const re=te.get("WEBGL_lose_context");re&&re.restoreContext()},this.getPixelRatio=function(){return Ne},this.setPixelRatio=function(re){re!==void 0&&(Ne=re,this.setSize(ht,Ye,!1))},this.getSize=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),re=new xt),re.set(ht,Ye)},this.setSize=function(re,Qe,Ke){if(pt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ht=re,Ye=Qe,i.width=Math.floor(re*Ne),i.height=Math.floor(Qe*Ne),Ke!==!1&&(i.style.width=re+"px",i.style.height=Qe+"px"),this.setViewport(0,0,re,Qe)},this.getDrawingBufferSize=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),re=new xt),re.set(ht*Ne,Ye*Ne).floor()},this.setDrawingBufferSize=function(re,Qe,Ke){ht=re,Ye=Qe,Ne=Ke,i.width=Math.floor(re*Ke),i.height=Math.floor(Qe*Ke),this.setViewport(0,0,re,Qe)},this.getCurrentViewport=function(re){return re===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),re=new Gi),re.copy(Ie)},this.getViewport=function(re){return re.copy(Te)},this.setViewport=function(re,Qe,Ke,ut){re.isVector4?Te.set(re.x,re.y,re.z,re.w):Te.set(re,Qe,Ke,ut),be.viewport(Ie.copy(Te).multiplyScalar(Ne).floor())},this.getScissor=function(re){return re.copy(Ve)},this.setScissor=function(re,Qe,Ke,ut){re.isVector4?Ve.set(re.x,re.y,re.z,re.w):Ve.set(re,Qe,Ke,ut),be.scissor(tt.copy(Ve).multiplyScalar(Ne).floor())},this.getScissorTest=function(){return We},this.setScissorTest=function(re){be.setScissorTest(We=re)},this.setOpaqueSort=function(re){Ue=re},this.setTransparentSort=function(re){Le=re},this.getClearColor=function(){return Je.getClearColor()},this.setClearColor=function(){Je.setClearColor.apply(Je,arguments)},this.getClearAlpha=function(){return Je.getClearAlpha()},this.setClearAlpha=function(){Je.setClearAlpha.apply(Je,arguments)},this.clear=function(re,Qe,Ke){let ut=0;(re===void 0||re)&&(ut|=16384),(Qe===void 0||Qe)&&(ut|=256),(Ke===void 0||Ke)&&(ut|=1024),H.clear(ut)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){i.removeEventListener("webglcontextlost",cn,!1),i.removeEventListener("webglcontextrestored",pi,!1),He.dispose(),Ge.dispose(),we.dispose(),Pe.dispose(),Xe.dispose(),it.dispose(),pt.dispose(),Ri.stop()};function cn(re){re.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),N=!0}function pi(){console.log("THREE.WebGLRenderer: Context Restored."),N=!1,Lt()}function Rr(re){const Qe=re.target;Qe.removeEventListener("dispose",Rr),$i(Qe)}function $i(re){Br(re),we.remove(re)}function Br(re){const Qe=we.get(re).program;Qe!==void 0&&$.releaseProgram(Qe)}function Vs(re,Qe){re.render(function(Ke){E.renderBufferImmediate(Ke,Qe)})}this.renderBufferImmediate=function(re,Qe){it.initAttributes();const Ke=we.get(re);re.hasPositions&&!Ke.position&&(Ke.position=H.createBuffer()),re.hasNormals&&!Ke.normal&&(Ke.normal=H.createBuffer()),re.hasUvs&&!Ke.uv&&(Ke.uv=H.createBuffer()),re.hasColors&&!Ke.color&&(Ke.color=H.createBuffer());const ut=Qe.getAttributes();re.hasPositions&&(H.bindBuffer(34962,Ke.position),H.bufferData(34962,re.positionArray,35048),it.enableAttribute(ut.position),H.vertexAttribPointer(ut.position,3,5126,!1,0,0)),re.hasNormals&&(H.bindBuffer(34962,Ke.normal),H.bufferData(34962,re.normalArray,35048),it.enableAttribute(ut.normal),H.vertexAttribPointer(ut.normal,3,5126,!1,0,0)),re.hasUvs&&(H.bindBuffer(34962,Ke.uv),H.bufferData(34962,re.uvArray,35048),it.enableAttribute(ut.uv),H.vertexAttribPointer(ut.uv,2,5126,!1,0,0)),re.hasColors&&(H.bindBuffer(34962,Ke.color),H.bufferData(34962,re.colorArray,35048),it.enableAttribute(ut.color),H.vertexAttribPointer(ut.color,3,5126,!1,0,0)),it.disableUnusedAttributes(),H.drawArrays(4,0,re.count),re.count=0},this.renderBufferDirect=function(re,Qe,Ke,ut,Ft,Tn){Qe===null&&(Qe=Yt);const Ln=Ft.isMesh&&Ft.matrixWorld.determinant()<0,Vn=fa(re,Qe,ut,Ft);be.setMaterial(ut,Ln);let wn=Ke.index;const Xi=Ke.attributes.position;if(wn===null){if(Xi===void 0||Xi.count===0)return}else if(wn.count===0)return;let Yi=1;ut.wireframe===!0&&(wn=Ze.getWireframeAttribute(Ke),Yi=2),(ut.morphTargets||ut.morphNormals)&&lt.update(Ft,Ke,ut,Vn),it.setup(Ft,ut,Vn,Ke,wn);let nn,ni=Nt;wn!==null&&(nn=ze.get(wn),ni=ct,ni.setIndex(nn));const yr=wn!==null?wn.count:Xi.count,ii=Ke.drawRange.start*Yi,er=Ke.drawRange.count*Yi,or=Tn!==null?Tn.start*Yi:0,Ws=Tn!==null?Tn.count*Yi:1/0,Sr=Math.max(ii,or),qs=Math.min(yr,ii+er,or+Ws)-1,_r=Math.max(0,qs-Sr+1);if(_r!==0){if(Ft.isMesh)ut.wireframe===!0?(be.setLineWidth(ut.wireframeLinewidth*K()),ni.setMode(1)):ni.setMode(4);else if(Ft.isLine){let Xs=ut.linewidth;Xs===void 0&&(Xs=1),be.setLineWidth(Xs*K()),Ft.isLineSegments?ni.setMode(1):Ft.isLineLoop?ni.setMode(2):ni.setMode(3)}else Ft.isPoints?ni.setMode(0):Ft.isSprite&&ni.setMode(4);if(Ft.isInstancedMesh)ni.renderInstances(Sr,_r,Ft.count);else if(Ke.isInstancedBufferGeometry){const Xs=Math.min(Ke.instanceCount,Ke._maxInstanceCount);ni.renderInstances(Sr,_r,Xs)}else ni.render(Sr,_r)}},this.compile=function(re,Qe){R=Ge.get(re,Qe),R.init(),re.traverse(function(ut){ut.isLight&&(R.pushLight(ut),ut.castShadow&&R.pushShadow(ut))}),R.setupLights(Qe);const Ke=new WeakMap;re.traverse(function(ut){const Ft=ut.material;if(Ft)if(Array.isArray(Ft))for(let Tn=0;Tn<Ft.length;Tn++){const Ln=Ft[Tn];Ke.has(Ln)===!1&&(dr(Ln,re,ut),Ke.set(Ln))}else Ke.has(Ft)===!1&&(dr(Ft,re,ut),Ke.set(Ft))})};let ua=null;function qi(re){pt.isPresenting||ua&&ua(re)}const Ri=new m0;Ri.setAnimationLoop(qi),typeof window<"u"&&Ri.setContext(window),this.setAnimationLoop=function(re){ua=re,pt.setAnimationLoop(re),re===null?Ri.stop():Ri.start()},this.render=function(re,Qe){let Ke,ut;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ke=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),ut=arguments[3]),Qe!==void 0&&Qe.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(N===!0)return;it.resetDefaultState(),ge=-1,ye=null,re.autoUpdate===!0&&re.updateMatrixWorld(),Qe.parent===null&&Qe.updateMatrixWorld(),pt.enabled===!0&&pt.isPresenting===!0&&(Qe=pt.getCamera(Qe)),re.isScene===!0&&re.onBeforeRender(E,re,Qe,Ke||O),R=Ge.get(re,Qe),R.init(),Et.multiplyMatrices(Qe.projectionMatrix,Qe.matrixWorldInverse),rt.setFromProjectionMatrix(Et),nt=this.localClippingEnabled,Tt=ue.init(this.clippingPlanes,nt,Qe),S=He.get(re,Qe),S.init(),Ja(re,Qe,0,E.sortObjects),S.finish(),E.sortObjects===!0&&S.sort(Ue,Le),Tt===!0&&ue.beginShadows();const Ft=R.state.shadowsArray;Dt.render(Ft,re,Qe),R.setupLights(Qe),Tt===!0&&ue.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ke!==void 0&&this.setRenderTarget(Ke),Je.render(S,re,Qe,ut);const Tn=S.opaque,Ln=S.transparent;Tn.length>0&&ha(Tn,re,Qe),Ln.length>0&&ha(Ln,re,Qe),re.isScene===!0&&re.onAfterRender(E,re,Qe),O!==null&&(Se.updateRenderTargetMipmap(O),Se.updateMultisampleRenderTarget(O)),be.buffers.depth.setTest(!0),be.buffers.depth.setMask(!0),be.buffers.color.setMask(!0),be.setPolygonOffset(!1),S=null,R=null};function Ja(re,Qe,Ke,ut){if(re.visible===!1)return;if(re.layers.test(Qe.layers)){if(re.isGroup)Ke=re.renderOrder;else if(re.isLOD)re.autoUpdate===!0&&re.update(Qe);else if(re.isLight)R.pushLight(re),re.castShadow&&R.pushShadow(re);else if(re.isSprite){if(!re.frustumCulled||rt.intersectsSprite(re)){ut&&$t.setFromMatrixPosition(re.matrixWorld).applyMatrix4(Et);const Ln=Xe.update(re),Vn=re.material;Vn.visible&&S.push(re,Ln,Vn,Ke,$t.z,null)}}else if(re.isImmediateRenderObject)ut&&$t.setFromMatrixPosition(re.matrixWorld).applyMatrix4(Et),S.push(re,null,re.material,Ke,$t.z,null);else if((re.isMesh||re.isLine||re.isPoints)&&(re.isSkinnedMesh&&re.skeleton.frame!==Re.render.frame&&(re.skeleton.update(),re.skeleton.frame=Re.render.frame),!re.frustumCulled||rt.intersectsObject(re))){ut&&$t.setFromMatrixPosition(re.matrixWorld).applyMatrix4(Et);const Ln=Xe.update(re),Vn=re.material;if(Array.isArray(Vn)){const wn=Ln.groups;for(let Xi=0,Yi=wn.length;Xi<Yi;Xi++){const nn=wn[Xi],ni=Vn[nn.materialIndex];ni&&ni.visible&&S.push(re,Ln,ni,Ke,$t.z,nn)}}else Vn.visible&&S.push(re,Ln,Vn,Ke,$t.z,null)}}const Tn=re.children;for(let Ln=0,Vn=Tn.length;Ln<Vn;Ln++)Ja(Tn[Ln],Qe,Ke,ut)}function ha(re,Qe,Ke){const ut=Qe.isScene===!0?Qe.overrideMaterial:null;for(let Ft=0,Tn=re.length;Ft<Tn;Ft++){const Ln=re[Ft],Vn=Ln.object,wn=Ln.geometry,Xi=ut===null?Ln.material:ut,Yi=Ln.group;if(Ke.isArrayCamera){Q=Ke;const nn=Ke.cameras;for(let ni=0,yr=nn.length;ni<yr;ni++){const ii=nn[ni];Vn.layers.test(ii.layers)&&(be.viewport(Ie.copy(ii.viewport)),R.setupLights(ii),gs(Vn,Qe,ii,wn,Xi,Yi))}}else Q=null,gs(Vn,Qe,Ke,wn,Xi,Yi)}}function gs(re,Qe,Ke,ut,Ft,Tn){if(re.onBeforeRender(E,Qe,Ke,ut,Ft,Tn),R=Ge.get(Qe,Q||Ke),re.modelViewMatrix.multiplyMatrices(Ke.matrixWorldInverse,re.matrixWorld),re.normalMatrix.getNormalMatrix(re.modelViewMatrix),re.isImmediateRenderObject){const Ln=fa(Ke,Qe,Ft,re);be.setMaterial(Ft),it.reset(),Vs(re,Ln)}else E.renderBufferDirect(Ke,Qe,ut,Ft,re,Tn);re.onAfterRender(E,Qe,Ke,ut,Ft,Tn),R=Ge.get(Qe,Q||Ke)}function dr(re,Qe,Ke){Qe.isScene!==!0&&(Qe=Yt);const ut=we.get(re),Ft=R.state.lights,Tn=R.state.shadowsArray,Ln=Ft.state.version,Vn=$.getParameters(re,Ft.state,Tn,Qe,Ke),wn=$.getProgramCacheKey(Vn);let Xi=ut.program,Yi=!0;if(Xi===void 0)re.addEventListener("dispose",Rr);else if(Xi.cacheKey!==wn)Br(re);else if(ut.lightsStateVersion!==Ln)Yi=!1;else if(Vn.shaderID!==void 0){const ii=re.isMeshStandardMaterial?Qe.environment:null;ut.envMap=Pe.get(re.envMap||ii);return}else Yi=!1;Yi&&(Vn.uniforms=$.getUniforms(re),re.onBeforeCompile(Vn,E),Xi=$.acquireProgram(Vn,wn),ut.program=Xi,ut.uniforms=Vn.uniforms,ut.outputEncoding=Vn.outputEncoding);const nn=ut.uniforms;(!re.isShaderMaterial&&!re.isRawShaderMaterial||re.clipping===!0)&&(ut.numClippingPlanes=ue.numPlanes,ut.numIntersection=ue.numIntersection,nn.clippingPlanes=ue.uniform),ut.environment=re.isMeshStandardMaterial?Qe.environment:null,ut.fog=Qe.fog,ut.envMap=Pe.get(re.envMap||ut.environment),ut.needsLights=Ka(re),ut.lightsStateVersion=Ln,ut.needsLights&&(nn.ambientLightColor.value=Ft.state.ambient,nn.lightProbe.value=Ft.state.probe,nn.directionalLights.value=Ft.state.directional,nn.directionalLightShadows.value=Ft.state.directionalShadow,nn.spotLights.value=Ft.state.spot,nn.spotLightShadows.value=Ft.state.spotShadow,nn.rectAreaLights.value=Ft.state.rectArea,nn.ltc_1.value=Ft.state.rectAreaLTC1,nn.ltc_2.value=Ft.state.rectAreaLTC2,nn.pointLights.value=Ft.state.point,nn.pointLightShadows.value=Ft.state.pointShadow,nn.hemisphereLights.value=Ft.state.hemi,nn.directionalShadowMap.value=Ft.state.directionalShadowMap,nn.directionalShadowMatrix.value=Ft.state.directionalShadowMatrix,nn.spotShadowMap.value=Ft.state.spotShadowMap,nn.spotShadowMatrix.value=Ft.state.spotShadowMatrix,nn.pointShadowMap.value=Ft.state.pointShadowMap,nn.pointShadowMatrix.value=Ft.state.pointShadowMatrix);const ni=ut.program.getUniforms(),yr=Ql.seqWithValue(ni.seq,nn);ut.uniformsList=yr}function fa(re,Qe,Ke,ut){Qe.isScene!==!0&&(Qe=Yt),Se.resetTextureUnits();const Ft=Qe.fog,Tn=Ke.isMeshStandardMaterial?Qe.environment:null,Ln=O===null?E.outputEncoding:O.texture.encoding,Vn=Pe.get(Ke.envMap||Tn),wn=we.get(Ke),Xi=R.state.lights;if(Tt===!0&&(nt===!0||re!==ye)){const or=re===ye&&Ke.id===ge;ue.setState(Ke,re,or)}Ke.version===wn.__version?(Ke.fog&&wn.fog!==Ft||wn.environment!==Tn||wn.needsLights&&wn.lightsStateVersion!==Xi.state.version||wn.numClippingPlanes!==void 0&&(wn.numClippingPlanes!==ue.numPlanes||wn.numIntersection!==ue.numIntersection)||wn.outputEncoding!==Ln||wn.envMap!==Vn)&&dr(Ke,Qe,ut):(dr(Ke,Qe,ut),wn.__version=Ke.version);let Yi=!1,nn=!1,ni=!1;const yr=wn.program,ii=yr.getUniforms(),er=wn.uniforms;if(be.useProgram(yr.program)&&(Yi=!0,nn=!0,ni=!0),Ke.id!==ge&&(ge=Ke.id,nn=!0),Yi||ye!==re){if(ii.setValue(H,"projectionMatrix",re.projectionMatrix),de.logarithmicDepthBuffer&&ii.setValue(H,"logDepthBufFC",2/(Math.log(re.far+1)/Math.LN2)),ye!==re&&(ye=re,nn=!0,ni=!0),Ke.isShaderMaterial||Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshStandardMaterial||Ke.envMap){const or=ii.map.cameraPosition;or!==void 0&&or.setValue(H,$t.setFromMatrixPosition(re.matrixWorld))}(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial)&&ii.setValue(H,"isOrthographic",re.isOrthographicCamera===!0),(Ke.isMeshPhongMaterial||Ke.isMeshToonMaterial||Ke.isMeshLambertMaterial||Ke.isMeshBasicMaterial||Ke.isMeshStandardMaterial||Ke.isShaderMaterial||Ke.isShadowMaterial||Ke.skinning)&&ii.setValue(H,"viewMatrix",re.matrixWorldInverse)}if(Ke.skinning){ii.setOptional(H,ut,"bindMatrix"),ii.setOptional(H,ut,"bindMatrixInverse");const or=ut.skeleton;if(or){const Ws=or.bones;if(de.floatVertexTextures){if(or.boneTexture===void 0){let Sr=Math.sqrt(Ws.length*4);Sr=Gn.ceilPowerOfTwo(Sr),Sr=Math.max(Sr,4);const qs=new Float32Array(Sr*Sr*4);qs.set(or.boneMatrices);const _r=new Ku(qs,Sr,Sr,fs,Is);or.boneMatrices=qs,or.boneTexture=_r,or.boneTextureSize=Sr}ii.setValue(H,"boneTexture",or.boneTexture,Se),ii.setValue(H,"boneTextureSize",or.boneTextureSize)}else ii.setOptional(H,or,"boneMatrices")}}return(nn||wn.receiveShadow!==ut.receiveShadow)&&(wn.receiveShadow=ut.receiveShadow,ii.setValue(H,"receiveShadow",ut.receiveShadow)),nn&&(ii.setValue(H,"toneMappingExposure",E.toneMappingExposure),wn.needsLights&&ba(er,ni),Ft&&Ke.fog&&j.refreshFogUniforms(er,Ft),j.refreshMaterialUniforms(er,Ke,Ne,Ye),Ql.upload(H,wn.uniformsList,er,Se)),Ke.isShaderMaterial&&Ke.uniformsNeedUpdate===!0&&(Ql.upload(H,wn.uniformsList,er,Se),Ke.uniformsNeedUpdate=!1),Ke.isSpriteMaterial&&ii.setValue(H,"center",ut.center),ii.setValue(H,"modelViewMatrix",ut.modelViewMatrix),ii.setValue(H,"normalMatrix",ut.normalMatrix),ii.setValue(H,"modelMatrix",ut.matrixWorld),yr}function ba(re,Qe){re.ambientLightColor.needsUpdate=Qe,re.lightProbe.needsUpdate=Qe,re.directionalLights.needsUpdate=Qe,re.directionalLightShadows.needsUpdate=Qe,re.pointLights.needsUpdate=Qe,re.pointLightShadows.needsUpdate=Qe,re.spotLights.needsUpdate=Qe,re.spotLightShadows.needsUpdate=Qe,re.rectAreaLights.needsUpdate=Qe,re.hemisphereLights.needsUpdate=Qe}function Ka(re){return re.isMeshLambertMaterial||re.isMeshToonMaterial||re.isMeshPhongMaterial||re.isMeshStandardMaterial||re.isShadowMaterial||re.isShaderMaterial&&re.lights===!0}this.setFramebuffer=function(re){W!==re&&O===null&&H.bindFramebuffer(36160,re),W=re},this.getActiveCubeFace=function(){return V},this.getActiveMipmapLevel=function(){return B},this.getRenderList=function(){return S},this.setRenderList=function(re){S=re},this.getRenderState=function(){return R},this.setRenderState=function(re){R=re},this.getRenderTarget=function(){return O},this.setRenderTarget=function(re,Qe=0,Ke=0){O=re,V=Qe,B=Ke,re&&we.get(re).__webglFramebuffer===void 0&&Se.setupRenderTarget(re);let ut=W,Ft=!1;if(re){const Tn=we.get(re).__webglFramebuffer;re.isWebGLCubeRenderTarget?(ut=Tn[Qe],Ft=!0):re.isWebGLMultisampleRenderTarget?ut=we.get(re).__webglMultisampledFramebuffer:ut=Tn,Ie.copy(re.viewport),tt.copy(re.scissor),qe=re.scissorTest}else Ie.copy(Te).multiplyScalar(Ne).floor(),tt.copy(Ve).multiplyScalar(Ne).floor(),qe=We;if(pe!==ut&&(H.bindFramebuffer(36160,ut),pe=ut),be.viewport(Ie),be.scissor(tt),be.setScissorTest(qe),Ft){const Tn=we.get(re.texture);H.framebufferTexture2D(36160,36064,34069+Qe,Tn.__webglTexture,Ke)}},this.readRenderTargetPixels=function(re,Qe,Ke,ut,Ft,Tn,Ln){if(!(re&&re.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Vn=we.get(re).__webglFramebuffer;if(re.isWebGLCubeRenderTarget&&Ln!==void 0&&(Vn=Vn[Ln]),Vn){let wn=!1;Vn!==pe&&(H.bindFramebuffer(36160,Vn),wn=!0);try{const Xi=re.texture,Yi=Xi.format,nn=Xi.type;if(Yi!==fs&&me.convert(Yi)!==H.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(nn!==Nc&&me.convert(nn)!==H.getParameter(35738)&&!(nn===Is&&(de.isWebGL2||te.get("OES_texture_float")||te.get("WEBGL_color_buffer_float")))&&!(nn===Fc&&(de.isWebGL2?te.get("EXT_color_buffer_float"):te.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}H.checkFramebufferStatus(36160)===36053?Qe>=0&&Qe<=re.width-ut&&Ke>=0&&Ke<=re.height-Ft&&H.readPixels(Qe,Ke,ut,Ft,me.convert(Yi),me.convert(nn),Tn):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{wn&&H.bindFramebuffer(36160,pe)}}},this.copyFramebufferToTexture=function(re,Qe,Ke){Ke===void 0&&(Ke=0);const ut=Math.pow(2,-Ke),Ft=Math.floor(Qe.image.width*ut),Tn=Math.floor(Qe.image.height*ut),Ln=me.convert(Qe.format);Se.setTexture2D(Qe,0),H.copyTexImage2D(3553,Ke,Ln,re.x,re.y,Ft,Tn,0),be.unbindTexture()},this.copyTextureToTexture=function(re,Qe,Ke,ut){ut===void 0&&(ut=0);const Ft=Qe.image.width,Tn=Qe.image.height,Ln=me.convert(Ke.format),Vn=me.convert(Ke.type);Se.setTexture2D(Ke,0),H.pixelStorei(37440,Ke.flipY),H.pixelStorei(37441,Ke.premultiplyAlpha),H.pixelStorei(3317,Ke.unpackAlignment),Qe.isDataTexture?H.texSubImage2D(3553,ut,re.x,re.y,Ft,Tn,Ln,Vn,Qe.image.data):Qe.isCompressedTexture?H.compressedTexSubImage2D(3553,ut,re.x,re.y,Qe.mipmaps[0].width,Qe.mipmaps[0].height,Ln,Qe.mipmaps[0].data):H.texSubImage2D(3553,ut,re.x,re.y,Ln,Vn,Qe.image),ut===0&&Ke.generateMipmaps&&H.generateMipmap(3553),be.unbindTexture()},this.initTexture=function(re){Se.setTexture2D(re,0),be.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function G0(r){op.call(this,r)}G0.prototype=Object.assign(Object.create(op.prototype),{constructor:G0,isWebGL1Renderer:!0});class e1 extends hn{constructor(){super(),Object.defineProperty(this,"isScene",{value:!0}),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(i,n){return super.copy(i,n),i.background!==null&&(this.background=i.background.clone()),i.environment!==null&&(this.environment=i.environment.clone()),i.fog!==null&&(this.fog=i.fog.clone()),i.overrideMaterial!==null&&(this.overrideMaterial=i.overrideMaterial.clone()),this.autoUpdate=i.autoUpdate,this.matrixAutoUpdate=i.matrixAutoUpdate,this}toJSON(i){const n=super.toJSON(i);return this.background!==null&&(n.object.background=this.background.toJSON(i)),this.environment!==null&&(n.object.environment=this.environment.toJSON(i)),this.fog!==null&&(n.object.fog=this.fog.toJSON()),n}}function Ya(r,i){this.array=r,this.stride=i,this.count=r!==void 0?r.length/i:0,this.usage=Wd,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Gn.generateUUID()}Object.defineProperty(Ya.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(Ya.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(r){return this.usage=r,this},copy:function(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this},copyAt:function(r,i,n){r*=this.stride,n*=i.stride;for(let l=0,u=this.stride;l<u;l++)this.array[r+l]=i.array[n+l];return this},set:function(r,i){return i===void 0&&(i=0),this.array.set(r,i),this},clone:function(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gn.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const i=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),n=new Ya(i,this.stride);return n.setUsage(this.usage),n},onUpload:function(r){return this.onUploadCallback=r,this},toJSON:function(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Gn.generateUUID()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const qc=new _e;function $l(r,i,n,l){this.name="",this.data=r,this.itemSize=i,this.offset=n,this.normalized=l===!0}Object.defineProperties($l.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(r){this.data.needsUpdate=r}}}),Object.assign($l.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(r){for(let i=0,n=this.data.count;i<n;i++)qc.x=this.getX(i),qc.y=this.getY(i),qc.z=this.getZ(i),qc.applyMatrix4(r),this.setXYZ(i,qc.x,qc.y,qc.z);return this},setX:function(r,i){return this.data.array[r*this.data.stride+this.offset]=i,this},setY:function(r,i){return this.data.array[r*this.data.stride+this.offset+1]=i,this},setZ:function(r,i){return this.data.array[r*this.data.stride+this.offset+2]=i,this},setW:function(r,i){return this.data.array[r*this.data.stride+this.offset+3]=i,this},getX:function(r){return this.data.array[r*this.data.stride+this.offset]},getY:function(r){return this.data.array[r*this.data.stride+this.offset+1]},getZ:function(r){return this.data.array[r*this.data.stride+this.offset+2]},getW:function(r){return this.data.array[r*this.data.stride+this.offset+3]},setXY:function(r,i,n){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this},setXYZ:function(r,i,n,l){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=l,this},setXYZW:function(r,i,n,l,u){return r=r*this.data.stride+this.offset,this.data.array[r+0]=i,this.data.array[r+1]=n,this.data.array[r+2]=l,this.data.array[r+3]=u,this},clone:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const l=n*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)i.push(this.data.array[l+u])}return new Nn(new this.array.constructor(i),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new $l(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const i=[];for(let n=0;n<this.count;n++){const l=n*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)i.push(this.data.array[l+u])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:i,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});function Xc(r){bn.call(this),this.type="SpriteMaterial",this.color=new Kt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(r)}Xc.prototype=Object.create(bn.prototype),Xc.prototype.constructor=Xc,Xc.prototype.isSpriteMaterial=!0,Xc.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this};let eh;const Mf=new _e,th=new _e,nh=new _e,ih=new xt,Sf=new xt,z0=new zn,lp=new _e,Tf=new _e,cp=new _e,H0=new xt,Ug=new xt,k0=new xt;function V0(r){if(hn.call(this),this.type="Sprite",eh===void 0){eh=new Oi;const i=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Ya(i,5);eh.setIndex([0,1,2,0,2,3]),eh.setAttribute("position",new $l(n,3,0,!1)),eh.setAttribute("uv",new $l(n,2,3,!1))}this.geometry=eh,this.material=r!==void 0?r:new Xc,this.center=new xt(.5,.5)}V0.prototype=Object.assign(Object.create(hn.prototype),{constructor:V0,isSprite:!0,raycast:function(r,i){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),th.setFromMatrixScale(this.matrixWorld),z0.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),nh.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&th.multiplyScalar(-nh.z);const n=this.material.rotation;let l,u;n!==0&&(u=Math.cos(n),l=Math.sin(n));const h=this.center;up(lp.set(-.5,-.5,0),nh,h,th,l,u),up(Tf.set(.5,-.5,0),nh,h,th,l,u),up(cp.set(.5,.5,0),nh,h,th,l,u),H0.set(0,0),Ug.set(1,0),k0.set(1,1);let p=r.ray.intersectTriangle(lp,Tf,cp,!1,Mf);if(p===null&&(up(Tf.set(-.5,.5,0),nh,h,th,l,u),Ug.set(0,1),p=r.ray.intersectTriangle(lp,cp,Tf,!1,Mf),p===null))return;const g=r.ray.origin.distanceTo(Mf);g<r.near||g>r.far||i.push({distance:g,point:Mf.clone(),uv:sa.getUV(Mf,lp,Tf,cp,H0,Ug,k0,new xt),face:null,object:this})},copy:function(r){return hn.prototype.copy.call(this,r),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}});function up(r,i,n,l,u,h){ih.subVectors(r,n).addScalar(.5).multiply(l),u!==void 0?(Sf.x=h*ih.x-u*ih.y,Sf.y=u*ih.x+h*ih.y):Sf.copy(ih),r.copy(i),r.x+=Sf.x,r.y+=Sf.y,r.applyMatrix4(z0)}const hp=new _e,W0=new _e;function Gg(){hn.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}Gg.prototype=Object.assign(Object.create(hn.prototype),{constructor:Gg,isLOD:!0,copy:function(r){hn.prototype.copy.call(this,r,!1);const i=r.levels;for(let n=0,l=i.length;n<l;n++){const u=i[n];this.addLevel(u.object.clone(),u.distance)}return this.autoUpdate=r.autoUpdate,this},addLevel:function(r,i){i===void 0&&(i=0),i=Math.abs(i);const n=this.levels;let l;for(l=0;l<n.length&&!(i<n[l].distance);l++);return n.splice(l,0,{distance:i,object:r}),this.add(r),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(r){const i=this.levels;if(i.length>0){let n,l;for(n=1,l=i.length;n<l&&!(r<i[n].distance);n++);return i[n-1].object}return null},raycast:function(r,i){if(this.levels.length>0){hp.setFromMatrixPosition(this.matrixWorld);const l=r.ray.origin.distanceTo(hp);this.getObjectForDistance(l).raycast(r,i)}},update:function(r){const i=this.levels;if(i.length>1){hp.setFromMatrixPosition(r.matrixWorld),W0.setFromMatrixPosition(this.matrixWorld);const n=hp.distanceTo(W0)/r.zoom;i[0].object.visible=!0;let l,u;for(l=1,u=i.length;l<u&&n>=i[l].distance;l++)i[l-1].object.visible=!1,i[l].object.visible=!0;for(this._currentLevel=l-1;l<u;l++)i[l].object.visible=!1}},toJSON:function(r){const i=hn.prototype.toJSON.call(this,r);this.autoUpdate===!1&&(i.object.autoUpdate=!1),i.object.levels=[];const n=this.levels;for(let l=0,u=n.length;l<u;l++){const h=n[l];i.object.levels.push({object:h.object.uuid,distance:h.distance})}return i}});function fp(r,i){r&&r.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),ea.call(this,r,i),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zn,this.bindMatrixInverse=new zn}fp.prototype=Object.assign(Object.create(ea.prototype),{constructor:fp,isSkinnedMesh:!0,copy:function(r){return ea.prototype.copy.call(this,r),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,this},bind:function(r,i){this.skeleton=r,i===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.getInverse(i)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const r=new Gi,i=this.geometry.attributes.skinWeight;for(let n=0,l=i.count;n<l;n++){r.x=i.getX(n),r.y=i.getY(n),r.z=i.getZ(n),r.w=i.getW(n);const u=1/r.manhattanLength();u!==1/0?r.multiplyScalar(u):r.set(1,0,0,0),i.setXYZW(n,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(r){ea.prototype.updateMatrixWorld.call(this,r),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const r=new _e,i=new Gi,n=new Gi,l=new _e,u=new zn;return function(h,p){const g=this.skeleton,_=this.geometry;i.fromBufferAttribute(_.attributes.skinIndex,h),n.fromBufferAttribute(_.attributes.skinWeight,h),r.fromBufferAttribute(_.attributes.position,h).applyMatrix4(this.bindMatrix),p.set(0,0,0);for(let b=0;b<4;b++){const A=n.getComponent(b);if(A!==0){const S=i.getComponent(b);u.multiplyMatrices(g.bones[S].matrixWorld,g.boneInverses[S]),p.addScaledVector(l.copy(r).applyMatrix4(u),A)}}return p.applyMatrix4(this.bindMatrixInverse)}}()});const q0=new zn,t1=new zn;function dp(r,i){if(r=r||[],this.bones=r.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,i===void 0)this.calculateInverses();else if(this.bones.length===i.length)this.boneInverses=i.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let n=0,l=this.bones.length;n<l;n++)this.boneInverses.push(new zn)}}Object.assign(dp.prototype,{calculateInverses:function(){this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++){const n=new zn;this.bones[r]&&n.getInverse(this.bones[r].matrixWorld),this.boneInverses.push(n)}},pose:function(){for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&n.matrixWorld.getInverse(this.boneInverses[r])}for(let r=0,i=this.bones.length;r<i;r++){const n=this.bones[r];n&&(n.parent&&n.parent.isBone?(n.matrix.getInverse(n.parent.matrixWorld),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}},update:function(){const r=this.bones,i=this.boneInverses,n=this.boneMatrices,l=this.boneTexture;for(let u=0,h=r.length;u<h;u++){const p=r[u]?r[u].matrixWorld:t1;q0.multiplyMatrices(p,i[u]),q0.toArray(n,u*16)}l!==void 0&&(l.needsUpdate=!0)},clone:function(){return new dp(this.bones,this.boneInverses)},getBoneByName:function(r){for(let i=0,n=this.bones.length;i<n;i++){const l=this.bones[i];if(l.name===r)return l}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}});function zg(){hn.call(this),this.type="Bone"}zg.prototype=Object.assign(Object.create(hn.prototype),{constructor:zg,isBone:!0});const X0=new zn,Y0=new zn,pp=[],Ef=new ea;function j0(r,i,n){ea.call(this,r,i),this.instanceMatrix=new Nn(new Float32Array(n*16),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}j0.prototype=Object.assign(Object.create(ea.prototype),{constructor:j0,isInstancedMesh:!0,copy:function(r){return ea.prototype.copy.call(this,r),this.instanceMatrix.copy(r.instanceMatrix),this.count=r.count,this},setColorAt:function(r,i){this.instanceColor===null&&(this.instanceColor=new Nn(new Float32Array(this.count*3),3)),i.toArray(this.instanceColor.array,r*3)},getMatrixAt:function(r,i){i.fromArray(this.instanceMatrix.array,r*16)},raycast:function(r,i){const n=this.matrixWorld,l=this.count;if(Ef.geometry=this.geometry,Ef.material=this.material,Ef.material!==void 0)for(let u=0;u<l;u++){this.getMatrixAt(u,X0),Y0.multiplyMatrices(n,X0),Ef.matrixWorld=Y0,Ef.raycast(r,pp);for(let h=0,p=pp.length;h<p;h++){const g=pp[h];g.instanceId=u,g.object=this,i.push(g)}pp.length=0}},setMatrixAt:function(r,i){i.toArray(this.instanceMatrix.array,r*16)},updateMorphTargets:function(){}});function ja(r){bn.call(this),this.type="LineBasicMaterial",this.color=new Kt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(r)}ja.prototype=Object.create(bn.prototype),ja.prototype.constructor=ja,ja.prototype.isLineBasicMaterial=!0,ja.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this.morphTargets=r.morphTargets,this};const Z0=new _e,J0=new _e,K0=new zn,mp=new uf,gp=new el;function Yc(r,i,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),hn.call(this),this.type="Line",this.geometry=r!==void 0?r:new Oi,this.material=i!==void 0?i:new ja,this.updateMorphTargets()}Yc.prototype=Object.assign(Object.create(hn.prototype),{constructor:Yc,isLine:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[0];for(let l=1,u=i.count;l<u;l++)Z0.fromBufferAttribute(i,l-1),J0.fromBufferAttribute(i,l),n[l]=n[l-1],n[l]+=Z0.distanceTo(J0);r.setAttribute("lineDistance",new Mi(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;n[0]=0;for(let l=1,u=i.length;l<u;l++)n[l]=n[l-1],n[l]+=i[l-1].distanceTo(i[l])}return this},raycast:function(r,i){const n=this.geometry,l=this.matrixWorld,u=r.params.Line.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),gp.copy(n.boundingSphere),gp.applyMatrix4(l),gp.radius+=u,r.ray.intersectsSphere(gp)===!1)return;K0.getInverse(l),mp.copy(r.ray).applyMatrix4(K0);const h=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h,g=new _e,_=new _e,b=new _e,A=new _e,S=this.isLineSegments?2:1;if(n.isBufferGeometry){const R=n.index,N=n.attributes.position;if(R!==null){const W=R.array;for(let V=0,B=W.length-1;V<B;V+=S){const O=W[V],pe=W[V+1];if(g.fromBufferAttribute(N,O),_.fromBufferAttribute(N,pe),mp.distanceSqToSegment(g,_,A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const ye=r.ray.origin.distanceTo(A);ye<r.near||ye>r.far||i.push({distance:ye,point:b.clone().applyMatrix4(this.matrixWorld),index:V,face:null,faceIndex:null,object:this})}}else for(let W=0,V=N.count-1;W<V;W+=S){if(g.fromBufferAttribute(N,W),_.fromBufferAttribute(N,W+1),mp.distanceSqToSegment(g,_,A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const O=r.ray.origin.distanceTo(A);O<r.near||O>r.far||i.push({distance:O,point:b.clone().applyMatrix4(this.matrixWorld),index:W,face:null,faceIndex:null,object:this})}}else if(n.isGeometry){const R=n.vertices,E=R.length;for(let N=0;N<E-1;N+=S){if(mp.distanceSqToSegment(R[N],R[N+1],A,b)>p)continue;A.applyMatrix4(this.matrixWorld);const V=r.ray.origin.distanceTo(A);V<r.near||V>r.far||i.push({distance:V,point:b.clone().applyMatrix4(this.matrixWorld),index:N,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const vp=new _e,yp=new _e;function Af(r,i){Yc.call(this,r,i),this.type="LineSegments"}Af.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Af,isLineSegments:!0,computeLineDistances:function(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const i=r.attributes.position,n=[];for(let l=0,u=i.count;l<u;l+=2)vp.fromBufferAttribute(i,l),yp.fromBufferAttribute(i,l+1),n[l]=l===0?0:n[l-1],n[l+1]=n[l]+vp.distanceTo(yp);r.setAttribute("lineDistance",new Mi(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(r.isGeometry){const i=r.vertices,n=r.lineDistances;for(let l=0,u=i.length;l<u;l+=2)vp.copy(i[l]),yp.copy(i[l+1]),n[l]=l===0?0:n[l-1],n[l+1]=n[l]+vp.distanceTo(yp)}return this}});function Hg(r,i){Yc.call(this,r,i),this.type="LineLoop"}Hg.prototype=Object.assign(Object.create(Yc.prototype),{constructor:Hg,isLineLoop:!0});function ec(r){bn.call(this),this.type="PointsMaterial",this.color=new Kt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(r)}ec.prototype=Object.create(bn.prototype),ec.prototype.constructor=ec,ec.prototype.isPointsMaterial=!0,ec.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this.morphTargets=r.morphTargets,this};const Q0=new zn,kg=new uf,_p=new el,xp=new _e;function Vg(r,i){hn.call(this),this.type="Points",this.geometry=r!==void 0?r:new Oi,this.material=i!==void 0?i:new ec,this.updateMorphTargets()}Vg.prototype=Object.assign(Object.create(hn.prototype),{constructor:Vg,isPoints:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.material=r.material,this.geometry=r.geometry,this},raycast:function(r,i){const n=this.geometry,l=this.matrixWorld,u=r.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),_p.copy(n.boundingSphere),_p.applyMatrix4(l),_p.radius+=u,r.ray.intersectsSphere(_p)===!1)return;Q0.getInverse(l),kg.copy(r.ray).applyMatrix4(Q0);const h=u/((this.scale.x+this.scale.y+this.scale.z)/3),p=h*h;if(n.isBufferGeometry){const g=n.index,b=n.attributes.position;if(g!==null){const A=g.array;for(let S=0,R=A.length;S<R;S++){const E=A[S];xp.fromBufferAttribute(b,E),Wg(xp,E,p,l,r,i,this)}}else for(let A=0,S=b.count;A<S;A++)xp.fromBufferAttribute(b,A),Wg(xp,A,p,l,r,i,this)}else{const g=n.vertices;for(let _=0,b=g.length;_<b;_++)Wg(g[_],_,p,l,r,i,this)}},updateMorphTargets:function(){const r=this.geometry;if(r.isBufferGeometry){const i=r.morphAttributes,n=Object.keys(i);if(n.length>0){const l=i[n[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,h=l.length;u<h;u++){const p=l[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[p]=u}}}}else{const i=r.morphTargets;i!==void 0&&i.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});function Wg(r,i,n,l,u,h,p){const g=kg.distanceSqToPoint(r);if(g<n){const _=new _e;kg.closestPointToPoint(r,_),_.applyMatrix4(l);const b=u.ray.origin.distanceTo(_);if(b<u.near||b>u.far)return;h.push({distance:b,distanceToRay:Math.sqrt(g),point:_,index:i,face:null,object:p})}}function $0(r,i,n,l,u,h,p,g,_){Vi.call(this,r,i,n,l,u,h,p,g,_),this.format=p!==void 0?p:yo,this.minFilter=h!==void 0?h:Sn,this.magFilter=u!==void 0?u:Sn,this.generateMipmaps=!1;const b=this;function A(){b.needsUpdate=!0,r.requestVideoFrameCallback(A)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(A)}$0.prototype=Object.assign(Object.create(Vi.prototype),{constructor:$0,isVideoTexture:!0,update:function(){const r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Lf(r,i,n,l,u,h,p,g,_,b,A,S){Vi.call(this,null,h,p,g,_,b,l,u,A,S),this.image={width:i,height:n},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}Lf.prototype=Object.create(Vi.prototype),Lf.prototype.constructor=Lf,Lf.prototype.isCompressedTexture=!0;function Rf(r,i,n,l,u,h,p,g,_){Vi.call(this,r,i,n,l,u,h,p,g,_),this.needsUpdate=!0}Rf.prototype=Object.create(Vi.prototype),Rf.prototype.constructor=Rf,Rf.prototype.isCanvasTexture=!0;function bp(r,i,n,l,u,h,p,g,_,b){if(b=b!==void 0?b:Pu,b!==Pu&&b!==af)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&b===Pu&&(n=zd),n===void 0&&b===af&&(n=rf),Vi.call(this,null,l,u,h,p,g,b,n,_),this.image={width:r,height:i},this.magFilter=p!==void 0?p:St,this.minFilter=g!==void 0?g:St,this.flipY=!1,this.generateMipmaps=!1}bp.prototype=Object.create(Vi.prototype),bp.prototype.constructor=bp,bp.prototype.isDepthTexture=!0;let n1=0;const bo=new zn,qg=new hn,wp=new _e;function Us(){Object.defineProperty(this,"id",{value:n1+=2}),this.uuid=Gn.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Us.prototype=Object.assign(Object.create(Ds.prototype),{constructor:Us,isGeometry:!0,applyMatrix4:function(r){const i=new La().getNormalMatrix(r);for(let n=0,l=this.vertices.length;n<l;n++)this.vertices[n].applyMatrix4(r);for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n];u.normal.applyMatrix3(i).normalize();for(let h=0,p=u.vertexNormals.length;h<p;h++)u.vertexNormals[h].applyMatrix3(i).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(r){return bo.makeRotationX(r),this.applyMatrix4(bo),this},rotateY:function(r){return bo.makeRotationY(r),this.applyMatrix4(bo),this},rotateZ:function(r){return bo.makeRotationZ(r),this.applyMatrix4(bo),this},translate:function(r,i,n){return bo.makeTranslation(r,i,n),this.applyMatrix4(bo),this},scale:function(r,i,n){return bo.makeScale(r,i,n),this.applyMatrix4(bo),this},lookAt:function(r){return qg.lookAt(r),qg.updateMatrix(),this.applyMatrix4(qg.matrix),this},fromBufferGeometry:function(r){const i=this,n=r.index!==null?r.index:void 0,l=r.attributes;if(l.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const u=l.position,h=l.normal,p=l.color,g=l.uv,_=l.uv2;_!==void 0&&(this.faceVertexUvs[1]=[]);for(let S=0;S<u.count;S++)i.vertices.push(new _e().fromBufferAttribute(u,S)),p!==void 0&&i.colors.push(new Kt().fromBufferAttribute(p,S));function b(S,R,E,N){const W=p===void 0?[]:[i.colors[S].clone(),i.colors[R].clone(),i.colors[E].clone()],V=h===void 0?[]:[new _e().fromBufferAttribute(h,S),new _e().fromBufferAttribute(h,R),new _e().fromBufferAttribute(h,E)],B=new Mg(S,R,E,V,W,N);i.faces.push(B),g!==void 0&&i.faceVertexUvs[0].push([new xt().fromBufferAttribute(g,S),new xt().fromBufferAttribute(g,R),new xt().fromBufferAttribute(g,E)]),_!==void 0&&i.faceVertexUvs[1].push([new xt().fromBufferAttribute(_,S),new xt().fromBufferAttribute(_,R),new xt().fromBufferAttribute(_,E)])}const A=r.groups;if(A.length>0)for(let S=0;S<A.length;S++){const R=A[S],E=R.start,N=R.count;for(let W=E,V=E+N;W<V;W+=3)n!==void 0?b(n.getX(W),n.getX(W+1),n.getX(W+2),R.materialIndex):b(W,W+1,W+2,R.materialIndex)}else if(n!==void 0)for(let S=0;S<n.count;S+=3)b(n.getX(S),n.getX(S+1),n.getX(S+2));else for(let S=0;S<u.count;S+=3)b(S,S+1,S+2);return this.computeFaceNormals(),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone()),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(wp).negate(),this.translate(wp.x,wp.y,wp.z),this},normalize:function(){this.computeBoundingSphere();const r=this.boundingSphere.center,i=this.boundingSphere.radius,n=i===0?1:1/i,l=new zn;return l.set(n,0,0,-n*r.x,0,n,0,-n*r.y,0,0,n,-n*r.z,0,0,0,1),this.applyMatrix4(l),this},computeFaceNormals:function(){const r=new _e,i=new _e;for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n],h=this.vertices[u.a],p=this.vertices[u.b],g=this.vertices[u.c];r.subVectors(g,p),i.subVectors(h,p),r.cross(i),r.normalize(),u.normal.copy(r)}},computeVertexNormals:function(r){r===void 0&&(r=!0);const i=new Array(this.vertices.length);for(let n=0,l=this.vertices.length;n<l;n++)i[n]=new _e;if(r){const n=new _e,l=new _e;for(let u=0,h=this.faces.length;u<h;u++){const p=this.faces[u],g=this.vertices[p.a],_=this.vertices[p.b],b=this.vertices[p.c];n.subVectors(b,_),l.subVectors(g,_),n.cross(l),i[p.a].add(n),i[p.b].add(n),i[p.c].add(n)}}else{this.computeFaceNormals();for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n];i[u.a].add(u.normal),i[u.b].add(u.normal),i[u.c].add(u.normal)}}for(let n=0,l=this.vertices.length;n<l;n++)i[n].normalize();for(let n=0,l=this.faces.length;n<l;n++){const u=this.faces[n],h=u.vertexNormals;h.length===3?(h[0].copy(i[u.a]),h[1].copy(i[u.b]),h[2].copy(i[u.c])):(h[0]=i[u.a].clone(),h[1]=i[u.b].clone(),h[2]=i[u.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let r=0,i=this.faces.length;r<i;r++){const n=this.faces[r],l=n.vertexNormals;l.length===3?(l[0].copy(n.normal),l[1].copy(n.normal),l[2].copy(n.normal)):(l[0]=n.normal.clone(),l[1]=n.normal.clone(),l[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let i=0,n=this.faces.length;i<n;i++){const l=this.faces[i];l.__originalFaceNormal?l.__originalFaceNormal.copy(l.normal):l.__originalFaceNormal=l.normal.clone(),l.__originalVertexNormals||(l.__originalVertexNormals=[]);for(let u=0,h=l.vertexNormals.length;u<h;u++)l.__originalVertexNormals[u]?l.__originalVertexNormals[u].copy(l.vertexNormals[u]):l.__originalVertexNormals[u]=l.vertexNormals[u].clone()}const r=new Us;r.faces=this.faces;for(let i=0,n=this.morphTargets.length;i<n;i++){if(!this.morphNormals[i]){this.morphNormals[i]={},this.morphNormals[i].faceNormals=[],this.morphNormals[i].vertexNormals=[];const u=this.morphNormals[i].faceNormals,h=this.morphNormals[i].vertexNormals;for(let p=0,g=this.faces.length;p<g;p++){const _=new _e,b={a:new _e,b:new _e,c:new _e};u.push(_),h.push(b)}}const l=this.morphNormals[i];r.vertices=this.morphTargets[i].vertices,r.computeFaceNormals(),r.computeVertexNormals();for(let u=0,h=this.faces.length;u<h;u++){const p=this.faces[u],g=l.faceNormals[u],_=l.vertexNormals[u];g.copy(p.normal),_.a.copy(p.vertexNormals[0]),_.b.copy(p.vertexNormals[1]),_.c.copy(p.vertexNormals[2])}}for(let i=0,n=this.faces.length;i<n;i++){const l=this.faces[i];l.normal=l.__originalFaceNormal,l.vertexNormals=l.__originalVertexNormals}},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Qo),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new el),this.boundingSphere.setFromPoints(this.vertices)},merge:function(r,i,n){if(!(r&&r.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",r);return}let l;const u=this.vertices.length,h=this.vertices,p=r.vertices,g=this.faces,_=r.faces,b=this.colors,A=r.colors;n===void 0&&(n=0),i!==void 0&&(l=new La().getNormalMatrix(i));for(let S=0,R=p.length;S<R;S++){const N=p[S].clone();i!==void 0&&N.applyMatrix4(i),h.push(N)}for(let S=0,R=A.length;S<R;S++)b.push(A[S].clone());for(let S=0,R=_.length;S<R;S++){const E=_[S];let N,W;const V=E.vertexNormals,B=E.vertexColors,O=new Mg(E.a+u,E.b+u,E.c+u);O.normal.copy(E.normal),l!==void 0&&O.normal.applyMatrix3(l).normalize();for(let pe=0,ge=V.length;pe<ge;pe++)N=V[pe].clone(),l!==void 0&&N.applyMatrix3(l).normalize(),O.vertexNormals.push(N);O.color.copy(E.color);for(let pe=0,ge=B.length;pe<ge;pe++)W=B[pe],O.vertexColors.push(W.clone());O.materialIndex=E.materialIndex+n,g.push(O)}for(let S=0,R=r.faceVertexUvs.length;S<R;S++){const E=r.faceVertexUvs[S];this.faceVertexUvs[S]===void 0&&(this.faceVertexUvs[S]=[]);for(let N=0,W=E.length;N<W;N++){const V=E[N],B=[];for(let O=0,pe=V.length;O<pe;O++)B.push(V[O].clone());this.faceVertexUvs[S].push(B)}}},mergeMesh:function(r){if(!(r&&r.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",r);return}r.matrixAutoUpdate&&r.updateMatrix(),this.merge(r.geometry,r.matrix)},mergeVertices:function(){const r={},i=[],n=[],u=Math.pow(10,4);for(let g=0,_=this.vertices.length;g<_;g++){const b=this.vertices[g],A=Math.round(b.x*u)+"_"+Math.round(b.y*u)+"_"+Math.round(b.z*u);r[A]===void 0?(r[A]=g,i.push(this.vertices[g]),n[g]=i.length-1):n[g]=n[r[A]]}const h=[];for(let g=0,_=this.faces.length;g<_;g++){const b=this.faces[g];b.a=n[b.a],b.b=n[b.b],b.c=n[b.c];const A=[b.a,b.b,b.c];for(let S=0;S<3;S++)if(A[S]===A[(S+1)%3]){h.push(g);break}}for(let g=h.length-1;g>=0;g--){const _=h[g];this.faces.splice(_,1);for(let b=0,A=this.faceVertexUvs.length;b<A;b++)this.faceVertexUvs[b].splice(_,1)}const p=this.vertices.length-i.length;return this.vertices=i,p},setFromPoints:function(r){this.vertices=[];for(let i=0,n=r.length;i<n;i++){const l=r[i];this.vertices.push(new _e(l.x,l.y,l.z||0))}return this},sortFacesByMaterialIndex:function(){const r=this.faces,i=r.length;for(let g=0;g<i;g++)r[g]._id=g;function n(g,_){return g.materialIndex-_.materialIndex}r.sort(n);const l=this.faceVertexUvs[0],u=this.faceVertexUvs[1];let h,p;l&&l.length===i&&(h=[]),u&&u.length===i&&(p=[]);for(let g=0;g<i;g++){const _=r[g]._id;h&&h.push(l[_]),p&&p.push(u[_])}h&&(this.faceVertexUvs[0]=h),p&&(this.faceVertexUvs[1]=p)},toJSON:function(){const r={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.parameters!==void 0){const E=this.parameters;for(const N in E)E[N]!==void 0&&(r[N]=E[N]);return r}const i=[];for(let E=0;E<this.vertices.length;E++){const N=this.vertices[E];i.push(N.x,N.y,N.z)}const n=[],l=[],u={},h=[],p={},g=[],_={};for(let E=0;E<this.faces.length;E++){const N=this.faces[E],W=!0,V=!1,B=this.faceVertexUvs[0][E]!==void 0,O=N.normal.length()>0,pe=N.vertexNormals.length>0,ge=N.color.r!==1||N.color.g!==1||N.color.b!==1,ye=N.vertexColors.length>0;let Q=0;if(Q=b(Q,0,0),Q=b(Q,1,W),Q=b(Q,2,V),Q=b(Q,3,B),Q=b(Q,4,O),Q=b(Q,5,pe),Q=b(Q,6,ge),Q=b(Q,7,ye),n.push(Q),n.push(N.a,N.b,N.c),n.push(N.materialIndex),B){const Ie=this.faceVertexUvs[0][E];n.push(R(Ie[0]),R(Ie[1]),R(Ie[2]))}if(O&&n.push(A(N.normal)),pe){const Ie=N.vertexNormals;n.push(A(Ie[0]),A(Ie[1]),A(Ie[2]))}if(ge&&n.push(S(N.color)),ye){const Ie=N.vertexColors;n.push(S(Ie[0]),S(Ie[1]),S(Ie[2]))}}function b(E,N,W){return W?E|1<<N:E&~(1<<N)}function A(E){const N=E.x.toString()+E.y.toString()+E.z.toString();return u[N]!==void 0||(u[N]=l.length/3,l.push(E.x,E.y,E.z)),u[N]}function S(E){const N=E.r.toString()+E.g.toString()+E.b.toString();return p[N]!==void 0||(p[N]=h.length,h.push(E.getHex())),p[N]}function R(E){const N=E.x.toString()+E.y.toString();return _[N]!==void 0||(_[N]=g.length/2,g.push(E.x,E.y)),_[N]}return r.data={},r.data.vertices=i,r.data.normals=l,h.length>0&&(r.data.colors=h),g.length>0&&(r.data.uvs=[g]),r.data.faces=n,r},clone:function(){return new Us().copy(this)},copy:function(r){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=r.name;const i=r.vertices;for(let S=0,R=i.length;S<R;S++)this.vertices.push(i[S].clone());const n=r.colors;for(let S=0,R=n.length;S<R;S++)this.colors.push(n[S].clone());const l=r.faces;for(let S=0,R=l.length;S<R;S++)this.faces.push(l[S].clone());for(let S=0,R=r.faceVertexUvs.length;S<R;S++){const E=r.faceVertexUvs[S];this.faceVertexUvs[S]===void 0&&(this.faceVertexUvs[S]=[]);for(let N=0,W=E.length;N<W;N++){const V=E[N],B=[];for(let O=0,pe=V.length;O<pe;O++){const ge=V[O];B.push(ge.clone())}this.faceVertexUvs[S].push(B)}}const u=r.morphTargets;for(let S=0,R=u.length;S<R;S++){const E={};if(E.name=u[S].name,u[S].vertices!==void 0){E.vertices=[];for(let N=0,W=u[S].vertices.length;N<W;N++)E.vertices.push(u[S].vertices[N].clone())}if(u[S].normals!==void 0){E.normals=[];for(let N=0,W=u[S].normals.length;N<W;N++)E.normals.push(u[S].normals[N].clone())}this.morphTargets.push(E)}const h=r.morphNormals;for(let S=0,R=h.length;S<R;S++){const E={};if(h[S].vertexNormals!==void 0){E.vertexNormals=[];for(let N=0,W=h[S].vertexNormals.length;N<W;N++){const V=h[S].vertexNormals[N],B={};B.a=V.a.clone(),B.b=V.b.clone(),B.c=V.c.clone(),E.vertexNormals.push(B)}}if(h[S].faceNormals!==void 0){E.faceNormals=[];for(let N=0,W=h[S].faceNormals.length;N<W;N++)E.faceNormals.push(h[S].faceNormals[N].clone())}this.morphNormals.push(E)}const p=r.skinWeights;for(let S=0,R=p.length;S<R;S++)this.skinWeights.push(p[S].clone());const g=r.skinIndices;for(let S=0,R=g.length;S<R;S++)this.skinIndices.push(g[S].clone());const _=r.lineDistances;for(let S=0,R=_.length;S<R;S++)this.lineDistances.push(_[S]);const b=r.boundingBox;b!==null&&(this.boundingBox=b.clone());const A=r.boundingSphere;return A!==null&&(this.boundingSphere=A.clone()),this.elementsNeedUpdate=r.elementsNeedUpdate,this.verticesNeedUpdate=r.verticesNeedUpdate,this.uvsNeedUpdate=r.uvsNeedUpdate,this.normalsNeedUpdate=r.normalsNeedUpdate,this.colorsNeedUpdate=r.colorsNeedUpdate,this.lineDistancesNeedUpdate=r.lineDistancesNeedUpdate,this.groupsNeedUpdate=r.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),new _e,new _e,new _e,new sa;const i1={triangulate:function(r,i,n){n=n||2;const l=i&&i.length,u=l?i[0]*n:r.length;let h=e_(r,0,u,n,!0);const p=[];if(!h||h.next===h.prev)return p;let g,_,b,A,S,R,E;if(l&&(h=l1(r,i,h,n)),r.length>80*n){g=b=r[0],_=A=r[1];for(let N=n;N<u;N+=n)S=r[N],R=r[N+1],S<g&&(g=S),R<_&&(_=R),S>b&&(b=S),R>A&&(A=R);E=Math.max(b-g,A-_),E=E!==0?1/E:0}return Cf(h,p,n,g,_,E),p}};function e_(r,i,n,l,u){let h,p;if(u===_1(r,i,n,l)>0)for(h=i;h<n;h+=l)p=i_(h,r[h],r[h+1],p);else for(h=n-l;h>=i;h-=l)p=i_(h,r[h],r[h+1],p);return p&&Mp(p,p.next)&&(If(p),p=p.next),p}function tc(r,i){if(!r)return r;i||(i=r);let n=r,l;do if(l=!1,!n.steiner&&(Mp(n,n.next)||fr(n.prev,n,n.next)===0)){if(If(n),n=i=n.prev,n===n.next)break;l=!0}else n=n.next;while(l||n!==i);return i}function Cf(r,i,n,l,u,h,p){if(!r)return;!p&&h&&d1(r,l,u,h);let g=r,_,b;for(;r.prev!==r.next;){if(_=r.prev,b=r.next,h?a1(r,l,u,h):r1(r)){i.push(_.i/n),i.push(r.i/n),i.push(b.i/n),If(r),r=b.next,g=b.next;continue}if(r=b,r===g){p?p===1?(r=s1(tc(r),i,n),Cf(r,i,n,l,u,h,2)):p===2&&o1(r,i,n,l,u,h):Cf(tc(r),i,n,l,u,h,1);break}}}function r1(r){const i=r.prev,n=r,l=r.next;if(fr(i,n,l)>=0)return!1;let u=r.next.next;for(;u!==r.prev;){if(rh(i.x,i.y,n.x,n.y,l.x,l.y,u.x,u.y)&&fr(u.prev,u,u.next)>=0)return!1;u=u.next}return!0}function a1(r,i,n,l){const u=r.prev,h=r,p=r.next;if(fr(u,h,p)>=0)return!1;const g=u.x<h.x?u.x<p.x?u.x:p.x:h.x<p.x?h.x:p.x,_=u.y<h.y?u.y<p.y?u.y:p.y:h.y<p.y?h.y:p.y,b=u.x>h.x?u.x>p.x?u.x:p.x:h.x>p.x?h.x:p.x,A=u.y>h.y?u.y>p.y?u.y:p.y:h.y>p.y?h.y:p.y,S=Xg(g,_,i,n,l),R=Xg(b,A,i,n,l);let E=r.prevZ,N=r.nextZ;for(;E&&E.z>=S&&N&&N.z<=R;){if(E!==r.prev&&E!==r.next&&rh(u.x,u.y,h.x,h.y,p.x,p.y,E.x,E.y)&&fr(E.prev,E,E.next)>=0||(E=E.prevZ,N!==r.prev&&N!==r.next&&rh(u.x,u.y,h.x,h.y,p.x,p.y,N.x,N.y)&&fr(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;E&&E.z>=S;){if(E!==r.prev&&E!==r.next&&rh(u.x,u.y,h.x,h.y,p.x,p.y,E.x,E.y)&&fr(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;N&&N.z<=R;){if(N!==r.prev&&N!==r.next&&rh(u.x,u.y,h.x,h.y,p.x,p.y,N.x,N.y)&&fr(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function s1(r,i,n){let l=r;do{const u=l.prev,h=l.next.next;!Mp(u,h)&&t_(u,l,l.next,h)&&Pf(u,h)&&Pf(h,u)&&(i.push(u.i/n),i.push(l.i/n),i.push(h.i/n),If(l),If(l.next),l=r=h),l=l.next}while(l!==r);return tc(l)}function o1(r,i,n,l,u,h){let p=r;do{let g=p.next.next;for(;g!==p.prev;){if(p.i!==g.i&&g1(p,g)){let _=n_(p,g);p=tc(p,p.next),_=tc(_,_.next),Cf(p,i,n,l,u,h),Cf(_,i,n,l,u,h);return}g=g.next}p=p.next}while(p!==r)}function l1(r,i,n,l){const u=[];let h,p,g,_,b;for(h=0,p=i.length;h<p;h++)g=i[h]*l,_=h<p-1?i[h+1]*l:r.length,b=e_(r,g,_,l,!1),b===b.next&&(b.steiner=!0),u.push(m1(b));for(u.sort(c1),h=0;h<u.length;h++)u1(u[h],n),n=tc(n,n.next);return n}function c1(r,i){return r.x-i.x}function u1(r,i){if(i=h1(r,i),i){const n=n_(i,r);tc(i,i.next),tc(n,n.next)}}function h1(r,i){let n=i;const l=r.x,u=r.y;let h=-1/0,p;do{if(u<=n.y&&u>=n.next.y&&n.next.y!==n.y){const R=n.x+(u-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(R<=l&&R>h){if(h=R,R===l){if(u===n.y)return n;if(u===n.next.y)return n.next}p=n.x<n.next.x?n:n.next}}n=n.next}while(n!==i);if(!p)return null;if(l===h)return p;const g=p,_=p.x,b=p.y;let A=1/0,S;n=p;do l>=n.x&&n.x>=_&&l!==n.x&&rh(u<b?l:h,u,_,b,u<b?h:l,u,n.x,n.y)&&(S=Math.abs(u-n.y)/(l-n.x),Pf(n,r)&&(S<A||S===A&&(n.x>p.x||n.x===p.x&&f1(p,n)))&&(p=n,A=S)),n=n.next;while(n!==g);return p}function f1(r,i){return fr(r.prev,r,i.prev)<0&&fr(i.next,r,r.next)<0}function d1(r,i,n,l){let u=r;do u.z===null&&(u.z=Xg(u.x,u.y,i,n,l)),u.prevZ=u.prev,u.nextZ=u.next,u=u.next;while(u!==r);u.prevZ.nextZ=null,u.prevZ=null,p1(u)}function p1(r){let i,n,l,u,h,p,g,_,b=1;do{for(n=r,r=null,h=null,p=0;n;){for(p++,l=n,g=0,i=0;i<b&&(g++,l=l.nextZ,!!l);i++);for(_=b;g>0||_>0&&l;)g!==0&&(_===0||!l||n.z<=l.z)?(u=n,n=n.nextZ,g--):(u=l,l=l.nextZ,_--),h?h.nextZ=u:r=u,u.prevZ=h,h=u;n=l}h.nextZ=null,b*=2}while(p>1);return r}function Xg(r,i,n,l,u){return r=32767*(r-n)*u,i=32767*(i-l)*u,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,r|i<<1}function m1(r){let i=r,n=r;do(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),i=i.next;while(i!==r);return n}function rh(r,i,n,l,u,h,p,g){return(u-p)*(i-g)-(r-p)*(h-g)>=0&&(r-p)*(l-g)-(n-p)*(i-g)>=0&&(n-p)*(h-g)-(u-p)*(l-g)>=0}function g1(r,i){return r.next.i!==i.i&&r.prev.i!==i.i&&!v1(r,i)&&(Pf(r,i)&&Pf(i,r)&&y1(r,i)&&(fr(r.prev,r,i.prev)||fr(r,i.prev,i))||Mp(r,i)&&fr(r.prev,r,r.next)>0&&fr(i.prev,i,i.next)>0)}function fr(r,i,n){return(i.y-r.y)*(n.x-i.x)-(i.x-r.x)*(n.y-i.y)}function Mp(r,i){return r.x===i.x&&r.y===i.y}function t_(r,i,n,l){const u=Tp(fr(r,i,n)),h=Tp(fr(r,i,l)),p=Tp(fr(n,l,r)),g=Tp(fr(n,l,i));return!!(u!==h&&p!==g||u===0&&Sp(r,n,i)||h===0&&Sp(r,l,i)||p===0&&Sp(n,r,l)||g===0&&Sp(n,i,l))}function Sp(r,i,n){return i.x<=Math.max(r.x,n.x)&&i.x>=Math.min(r.x,n.x)&&i.y<=Math.max(r.y,n.y)&&i.y>=Math.min(r.y,n.y)}function Tp(r){return r>0?1:r<0?-1:0}function v1(r,i){let n=r;do{if(n.i!==r.i&&n.next.i!==r.i&&n.i!==i.i&&n.next.i!==i.i&&t_(n,n.next,r,i))return!0;n=n.next}while(n!==r);return!1}function Pf(r,i){return fr(r.prev,r,r.next)<0?fr(r,i,r.next)>=0&&fr(r,r.prev,i)>=0:fr(r,i,r.prev)<0||fr(r,r.next,i)<0}function y1(r,i){let n=r,l=!1;const u=(r.x+i.x)/2,h=(r.y+i.y)/2;do n.y>h!=n.next.y>h&&n.next.y!==n.y&&u<(n.next.x-n.x)*(h-n.y)/(n.next.y-n.y)+n.x&&(l=!l),n=n.next;while(n!==r);return l}function n_(r,i){const n=new Yg(r.i,r.x,r.y),l=new Yg(i.i,i.x,i.y),u=r.next,h=i.prev;return r.next=i,i.prev=r,n.next=u,u.prev=n,l.next=n,n.prev=l,h.next=l,l.prev=h,l}function i_(r,i,n,l){const u=new Yg(r,i,n);return l?(u.next=l.next,u.prev=l,l.next.prev=u,l.next=u):(u.prev=u,u.next=u),u}function If(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Yg(r,i,n){this.i=r,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _1(r,i,n,l){let u=0;for(let h=i,p=n-l;h<n;h+=l)u+=(r[p]-r[h])*(r[h+1]+r[p+1]),p=h;return u}const nc={area:function(r){const i=r.length;let n=0;for(let l=i-1,u=0;u<i;l=u++)n+=r[l].x*r[u].y-r[u].x*r[l].y;return n*.5},isClockWise:function(r){return nc.area(r)<0},triangulateShape:function(r,i){const n=[],l=[],u=[];r_(r),a_(n,r);let h=r.length;i.forEach(r_);for(let g=0;g<i.length;g++)l.push(h),h+=i[g].length,a_(n,i[g]);const p=i1.triangulate(n,l);for(let g=0;g<p.length;g+=3)u.push(p.slice(g,g+3));return u}};function r_(r){const i=r.length;i>2&&r[i-1].equals(r[0])&&r.pop()}function a_(r,i){for(let n=0;n<i.length;n++)r.push(i[n].x),r.push(i[n].y)}class s_ extends Oi{constructor(i,n){super(),this.type="ExtrudeBufferGeometry",this.parameters={shapes:i,options:n},i=Array.isArray(i)?i:[i];const l=this,u=[],h=[];for(let g=0,_=i.length;g<_;g++){const b=i[g];p(b)}this.setAttribute("position",new Mi(u,3)),this.setAttribute("uv",new Mi(h,2)),this.computeVertexNormals();function p(g){const _=[],b=n.curveSegments!==void 0?n.curveSegments:12,A=n.steps!==void 0?n.steps:1;let S=n.depth!==void 0?n.depth:100,R=n.bevelEnabled!==void 0?n.bevelEnabled:!0,E=n.bevelThickness!==void 0?n.bevelThickness:6,N=n.bevelSize!==void 0?n.bevelSize:E-2,W=n.bevelOffset!==void 0?n.bevelOffset:0,V=n.bevelSegments!==void 0?n.bevelSegments:3;const B=n.extrudePath,O=n.UVGenerator!==void 0?n.UVGenerator:x1;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),S=n.amount);let pe,ge=!1,ye,Q,Ie,tt;B&&(pe=B.getSpacedPoints(A),ge=!0,R=!1,ye=B.computeFrenetFrames(A,!1),Q=new _e,Ie=new _e,tt=new _e),R||(V=0,E=0,N=0,W=0);const qe=g.extractPoints(b);let ht=qe.shape;const Ye=qe.holes;if(!nc.isClockWise(ht)){ht=ht.reverse();for(let Se=0,Pe=Ye.length;Se<Pe;Se++){const ze=Ye[Se];nc.isClockWise(ze)&&(Ye[Se]=ze.reverse())}}const Ue=nc.triangulateShape(ht,Ye),Le=ht;for(let Se=0,Pe=Ye.length;Se<Pe;Se++){const ze=Ye[Se];ht=ht.concat(ze)}function Te(Se,Pe,ze){return Pe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().multiplyScalar(ze).add(Se)}const Ve=ht.length,We=Ue.length;function rt(Se,Pe,ze){let Ze,Xe,$;const j=Se.x-Pe.x,He=Se.y-Pe.y,Ge=ze.x-Se.x,ue=ze.y-Se.y,Je=j*j+He*He,lt=j*ue-He*Ge;if(Math.abs(lt)>Number.EPSILON){const Nt=Math.sqrt(Je),ct=Math.sqrt(Ge*Ge+ue*ue),me=Pe.x-He/Nt,it=Pe.y+j/Nt,Lt=ze.x-ue/ct,pt=ze.y+Ge/ct,Dt=((Lt-me)*ue-(pt-it)*Ge)/(j*ue-He*Ge);Ze=me+j*Dt-Se.x,Xe=it+He*Dt-Se.y;const cn=Ze*Ze+Xe*Xe;if(cn<=2)return new xt(Ze,Xe);$=Math.sqrt(cn/2)}else{let Nt=!1;j>Number.EPSILON?Ge>Number.EPSILON&&(Nt=!0):j<-Number.EPSILON?Ge<-Number.EPSILON&&(Nt=!0):Math.sign(He)===Math.sign(ue)&&(Nt=!0),Nt?(Ze=-He,Xe=j,$=Math.sqrt(Je)):(Ze=j,Xe=He,$=Math.sqrt(Je/2))}return new xt(Ze/$,Xe/$)}const Tt=[];for(let Se=0,Pe=Le.length,ze=Pe-1,Ze=Se+1;Se<Pe;Se++,ze++,Ze++)ze===Pe&&(ze=0),Ze===Pe&&(Ze=0),Tt[Se]=rt(Le[Se],Le[ze],Le[Ze]);const nt=[];let Et,$t=Tt.concat();for(let Se=0,Pe=Ye.length;Se<Pe;Se++){const ze=Ye[Se];Et=[];for(let Ze=0,Xe=ze.length,$=Xe-1,j=Ze+1;Ze<Xe;Ze++,$++,j++)$===Xe&&($=0),j===Xe&&(j=0),Et[Ze]=rt(ze[Ze],ze[$],ze[j]);nt.push(Et),$t=$t.concat(Et)}for(let Se=0;Se<V;Se++){const Pe=Se/V,ze=E*Math.cos(Pe*Math.PI/2),Ze=N*Math.sin(Pe*Math.PI/2)+W;for(let Xe=0,$=Le.length;Xe<$;Xe++){const j=Te(Le[Xe],Tt[Xe],Ze);te(j.x,j.y,-ze)}for(let Xe=0,$=Ye.length;Xe<$;Xe++){const j=Ye[Xe];Et=nt[Xe];for(let He=0,Ge=j.length;He<Ge;He++){const ue=Te(j[He],Et[He],Ze);te(ue.x,ue.y,-ze)}}}const Yt=N+W;for(let Se=0;Se<Ve;Se++){const Pe=R?Te(ht[Se],$t[Se],Yt):ht[Se];ge?(Ie.copy(ye.normals[0]).multiplyScalar(Pe.x),Q.copy(ye.binormals[0]).multiplyScalar(Pe.y),tt.copy(pe[0]).add(Ie).add(Q),te(tt.x,tt.y,tt.z)):te(Pe.x,Pe.y,0)}for(let Se=1;Se<=A;Se++)for(let Pe=0;Pe<Ve;Pe++){const ze=R?Te(ht[Pe],$t[Pe],Yt):ht[Pe];ge?(Ie.copy(ye.normals[Se]).multiplyScalar(ze.x),Q.copy(ye.binormals[Se]).multiplyScalar(ze.y),tt.copy(pe[Se]).add(Ie).add(Q),te(tt.x,tt.y,tt.z)):te(ze.x,ze.y,S/A*Se)}for(let Se=V-1;Se>=0;Se--){const Pe=Se/V,ze=E*Math.cos(Pe*Math.PI/2),Ze=N*Math.sin(Pe*Math.PI/2)+W;for(let Xe=0,$=Le.length;Xe<$;Xe++){const j=Te(Le[Xe],Tt[Xe],Ze);te(j.x,j.y,S+ze)}for(let Xe=0,$=Ye.length;Xe<$;Xe++){const j=Ye[Xe];Et=nt[Xe];for(let He=0,Ge=j.length;He<Ge;He++){const ue=Te(j[He],Et[He],Ze);ge?te(ue.x,ue.y+pe[A-1].y,pe[A-1].x+ze):te(ue.x,ue.y,S+ze)}}}K(),H();function K(){const Se=u.length/3;if(R){let Pe=0,ze=Ve*Pe;for(let Ze=0;Ze<We;Ze++){const Xe=Ue[Ze];de(Xe[2]+ze,Xe[1]+ze,Xe[0]+ze)}Pe=A+V*2,ze=Ve*Pe;for(let Ze=0;Ze<We;Ze++){const Xe=Ue[Ze];de(Xe[0]+ze,Xe[1]+ze,Xe[2]+ze)}}else{for(let Pe=0;Pe<We;Pe++){const ze=Ue[Pe];de(ze[2],ze[1],ze[0])}for(let Pe=0;Pe<We;Pe++){const ze=Ue[Pe];de(ze[0]+Ve*A,ze[1]+Ve*A,ze[2]+Ve*A)}}l.addGroup(Se,u.length/3-Se,0)}function H(){const Se=u.length/3;let Pe=0;xe(Le,Pe),Pe+=Le.length;for(let ze=0,Ze=Ye.length;ze<Ze;ze++){const Xe=Ye[ze];xe(Xe,Pe),Pe+=Xe.length}l.addGroup(Se,u.length/3-Se,1)}function xe(Se,Pe){let ze=Se.length;for(;--ze>=0;){const Ze=ze;let Xe=ze-1;Xe<0&&(Xe=Se.length-1);for(let $=0,j=A+V*2;$<j;$++){const He=Ve*$,Ge=Ve*($+1),ue=Pe+Ze+He,Je=Pe+Xe+He,lt=Pe+Xe+Ge,Nt=Pe+Ze+Ge;be(ue,Je,lt,Nt)}}}function te(Se,Pe,ze){_.push(Se),_.push(Pe),_.push(ze)}function de(Se,Pe,ze){Re(Se),Re(Pe),Re(ze);const Ze=u.length/3,Xe=O.generateTopUV(l,u,Ze-3,Ze-2,Ze-1);we(Xe[0]),we(Xe[1]),we(Xe[2])}function be(Se,Pe,ze,Ze){Re(Se),Re(Pe),Re(Ze),Re(Pe),Re(ze),Re(Ze);const Xe=u.length/3,$=O.generateSideWallUV(l,u,Xe-6,Xe-3,Xe-2,Xe-1);we($[0]),we($[1]),we($[3]),we($[1]),we($[2]),we($[3])}function Re(Se){u.push(_[Se*3+0]),u.push(_[Se*3+1]),u.push(_[Se*3+2])}function we(Se){h.push(Se.x),h.push(Se.y)}}}toJSON(){const i=Oi.prototype.toJSON.call(this),n=this.parameters.shapes,l=this.parameters.options;return b1(n,l,i)}}const x1={generateTopUV:function(r,i,n,l,u){const h=i[n*3],p=i[n*3+1],g=i[l*3],_=i[l*3+1],b=i[u*3],A=i[u*3+1];return[new xt(h,p),new xt(g,_),new xt(b,A)]},generateSideWallUV:function(r,i,n,l,u,h){const p=i[n*3],g=i[n*3+1],_=i[n*3+2],b=i[l*3],A=i[l*3+1],S=i[l*3+2],R=i[u*3],E=i[u*3+1],N=i[u*3+2],W=i[h*3],V=i[h*3+1],B=i[h*3+2];return Math.abs(g-A)<.01?[new xt(p,1-_),new xt(b,1-S),new xt(R,1-N),new xt(W,1-B)]:[new xt(g,1-_),new xt(A,1-S),new xt(E,1-N),new xt(V,1-B)]}};function b1(r,i,n){if(n.shapes=[],Array.isArray(r))for(let l=0,u=r.length;l<u;l++){const h=r[l];n.shapes.push(h.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}class w1 extends Us{constructor(i,n){super(),this.type="ExtrudeGeometry",this.parameters={shapes:i,options:n},this.fromBufferGeometry(new s_(i,n)),this.mergeVertices()}toJSON(){const i=super.toJSON(),n=this.parameters.shapes,l=this.parameters.options;return M1(n,l,i)}}function M1(r,i,n){if(n.shapes=[],Array.isArray(r))for(let l=0,u=r.length;l<u;l++){const h=r[l];n.shapes.push(h.uuid)}else n.shapes.push(r.uuid);return i.extrudePath!==void 0&&(n.options.extrudePath=i.extrudePath.toJSON()),n}function Ep(r,i,n){Oi.call(this),this.type="ParametricBufferGeometry",this.parameters={func:r,slices:i,stacks:n};const l=[],u=[],h=[],p=[],g=1e-5,_=new _e,b=new _e,A=new _e,S=new _e,R=new _e;r.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const E=i+1;for(let N=0;N<=n;N++){const W=N/n;for(let V=0;V<=i;V++){const B=V/i;r(B,W,b),u.push(b.x,b.y,b.z),B-g>=0?(r(B-g,W,A),S.subVectors(b,A)):(r(B+g,W,A),S.subVectors(A,b)),W-g>=0?(r(B,W-g,A),R.subVectors(b,A)):(r(B,W+g,A),R.subVectors(A,b)),_.crossVectors(S,R).normalize(),h.push(_.x,_.y,_.z),p.push(B,W)}}for(let N=0;N<n;N++)for(let W=0;W<i;W++){const V=N*E+W,B=N*E+W+1,O=(N+1)*E+W+1,pe=(N+1)*E+W;l.push(V,B,pe),l.push(B,O,pe)}this.setIndex(l),this.setAttribute("position",new Mi(u,3)),this.setAttribute("normal",new Mi(h,3)),this.setAttribute("uv",new Mi(p,2))}Ep.prototype=Object.create(Oi.prototype),Ep.prototype.constructor=Ep;function jg(r,i,n){Us.call(this),this.type="ParametricGeometry",this.parameters={func:r,slices:i,stacks:n},this.fromBufferGeometry(new Ep(r,i,n)),this.mergeVertices()}jg.prototype=Object.create(Us.prototype),jg.prototype.constructor=jg;class S1 extends Oi{constructor(i,n){super(),this.type="ShapeBufferGeometry",this.parameters={shapes:i,curveSegments:n},n=n||12;const l=[],u=[],h=[],p=[];let g=0,_=0;if(Array.isArray(i)===!1)b(i);else for(let A=0;A<i.length;A++)b(i[A]),this.addGroup(g,_,A),g+=_,_=0;this.setIndex(l),this.setAttribute("position",new Mi(u,3)),this.setAttribute("normal",new Mi(h,3)),this.setAttribute("uv",new Mi(p,2));function b(A){const S=u.length/3,R=A.extractPoints(n);let E=R.shape;const N=R.holes;nc.isClockWise(E)===!1&&(E=E.reverse());for(let V=0,B=N.length;V<B;V++){const O=N[V];nc.isClockWise(O)===!0&&(N[V]=O.reverse())}const W=nc.triangulateShape(E,N);for(let V=0,B=N.length;V<B;V++){const O=N[V];E=E.concat(O)}for(let V=0,B=E.length;V<B;V++){const O=E[V];u.push(O.x,O.y,0),h.push(0,0,1),p.push(O.x,O.y)}for(let V=0,B=W.length;V<B;V++){const O=W[V],pe=O[0]+S,ge=O[1]+S,ye=O[2]+S;l.push(pe,ge,ye),_+=3}}}toJSON(){const i=Oi.prototype.toJSON.call(this),n=this.parameters.shapes;return T1(n,i)}}function T1(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,l=r.length;n<l;n++){const u=r[n];i.shapes.push(u.uuid)}else i.shapes.push(r.uuid);return i}class E1 extends Us{constructor(i,n){super(),this.type="ShapeGeometry",typeof n=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),n=n.curveSegments),this.parameters={shapes:i,curveSegments:n},this.fromBufferGeometry(new S1(i,n)),this.mergeVertices()}toJSON(){const i=Us.prototype.toJSON.call(this),n=this.parameters.shapes;return A1(n,i)}}function A1(r,i){if(i.shapes=[],Array.isArray(r))for(let n=0,l=r.length;n<l;n++){const u=r[n];i.shapes.push(u.uuid)}else i.shapes.push(r.uuid);return i}function ah(r){bn.call(this),this.type="ShadowMaterial",this.color=new Kt(0),this.transparent=!0,this.setValues(r)}ah.prototype=Object.create(bn.prototype),ah.prototype.constructor=ah,ah.prototype.isShadowMaterial=!0,ah.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this};function Df(r){Ra.call(this,r),this.type="RawShaderMaterial"}Df.prototype=Object.create(Ra.prototype),Df.prototype.constructor=Df,Df.prototype.isRawShaderMaterial=!0;function Ca(r){bn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Kt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Uc,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(r)}Ca.prototype=Object.create(bn.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isMeshStandardMaterial=!0,Ca.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this.vertexTangents=r.vertexTangents,this};function ol(r){Ca.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new xt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(i){this.reflectivity=Gn.clamp(2.5*(i-1)/(i+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(r)}ol.prototype=Object.create(Ca.prototype),ol.prototype.constructor=ol,ol.prototype.isMeshPhysicalMaterial=!0,ol.prototype.copy=function(r){return Ca.prototype.copy.call(this,r),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.reflectivity=r.reflectivity,r.sheen?this.sheen=(this.sheen||new Kt).copy(r.sheen):this.sheen=null,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this};function jc(r){bn.call(this),this.type="MeshPhongMaterial",this.color=new Kt(16777215),this.specular=new Kt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Uc,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ps,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}jc.prototype=Object.create(bn.prototype),jc.prototype.constructor=jc,jc.prototype.isMeshPhongMaterial=!0,jc.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function sh(r){bn.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Kt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Uc,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}sh.prototype=Object.create(bn.prototype),sh.prototype.constructor=sh,sh.prototype.isMeshToonMaterial=!0,sh.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function oh(r){bn.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Uc,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}oh.prototype=Object.create(bn.prototype),oh.prototype.constructor=oh,oh.prototype.isMeshNormalMaterial=!0,oh.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function lh(r){bn.call(this),this.type="MeshLambertMaterial",this.color=new Kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ps,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}lh.prototype=Object.create(bn.prototype),lh.prototype.constructor=lh,lh.prototype.isMeshLambertMaterial=!0,lh.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function ch(r){bn.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Kt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Uc,this.normalScale=new xt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(r)}ch.prototype=Object.create(bn.prototype),ch.prototype.constructor=ch,ch.prototype.isMeshMatcapMaterial=!0,ch.prototype.copy=function(r){return bn.prototype.copy.call(this,r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.skinning=r.skinning,this.morphTargets=r.morphTargets,this.morphNormals=r.morphNormals,this};function uh(r){ja.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}uh.prototype=Object.create(ja.prototype),uh.prototype.constructor=uh,uh.prototype.isLineDashedMaterial=!0,uh.prototype.copy=function(r){return ja.prototype.copy.call(this,r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this};var L1=Object.freeze({__proto__:null,ShadowMaterial:ah,SpriteMaterial:Xc,RawShaderMaterial:Df,ShaderMaterial:Ra,PointsMaterial:ec,MeshPhysicalMaterial:ol,MeshStandardMaterial:Ca,MeshPhongMaterial:jc,MeshToonMaterial:sh,MeshNormalMaterial:oh,MeshLambertMaterial:lh,MeshDepthMaterial:Vc,MeshDistanceMaterial:Wc,MeshBasicMaterial:ds,MeshMatcapMaterial:ch,LineDashedMaterial:uh,LineBasicMaterial:ja,Material:bn});const sr={arraySlice:function(r,i,n){return sr.isTypedArray(r)?new r.constructor(r.subarray(i,n!==void 0?n:r.length)):r.slice(i,n)},convertArray:function(r,i,n){return!r||!n&&r.constructor===i?r:typeof i.BYTES_PER_ELEMENT=="number"?new i(r):Array.prototype.slice.call(r)},isTypedArray:function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},getKeyframeOrder:function(r){function i(u,h){return r[u]-r[h]}const n=r.length,l=new Array(n);for(let u=0;u!==n;++u)l[u]=u;return l.sort(i),l},sortedArray:function(r,i,n){const l=r.length,u=new r.constructor(l);for(let h=0,p=0;p!==l;++h){const g=n[h]*i;for(let _=0;_!==i;++_)u[p++]=r[g+_]}return u},flattenJSON:function(r,i,n,l){let u=1,h=r[0];for(;h!==void 0&&h[l]===void 0;)h=r[u++];if(h===void 0)return;let p=h[l];if(p!==void 0)if(Array.isArray(p))do p=h[l],p!==void 0&&(i.push(h.time),n.push.apply(n,p)),h=r[u++];while(h!==void 0);else if(p.toArray!==void 0)do p=h[l],p!==void 0&&(i.push(h.time),p.toArray(n,n.length)),h=r[u++];while(h!==void 0);else do p=h[l],p!==void 0&&(i.push(h.time),n.push(p)),h=r[u++];while(h!==void 0)},subclip:function(r,i,n,l,u){u=u||30;const h=r.clone();h.name=i;const p=[];for(let _=0;_<h.tracks.length;++_){const b=h.tracks[_],A=b.getValueSize(),S=[],R=[];for(let E=0;E<b.times.length;++E){const N=b.times[E]*u;if(!(N<n||N>=l)){S.push(b.times[E]);for(let W=0;W<A;++W)R.push(b.values[E*A+W])}}S.length!==0&&(b.times=sr.convertArray(S,b.times.constructor),b.values=sr.convertArray(R,b.values.constructor),p.push(b))}h.tracks=p;let g=1/0;for(let _=0;_<h.tracks.length;++_)g>h.tracks[_].times[0]&&(g=h.tracks[_].times[0]);for(let _=0;_<h.tracks.length;++_)h.tracks[_].shift(-1*g);return h.resetDuration(),h},makeClipAdditive:function(r,i,n,l){i===void 0&&(i=0),n===void 0&&(n=r),(l===void 0||l<=0)&&(l=30);const u=n.tracks.length,h=i/l;for(let p=0;p<u;++p){const g=n.tracks[p],_=g.ValueTypeName;if(_==="bool"||_==="string")continue;const b=r.tracks.find(function(B){return B.name===g.name&&B.ValueTypeName===_});if(b===void 0)continue;let A=0;const S=g.getValueSize();g.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(A=S/3);let R=0;const E=b.getValueSize();b.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(R=E/3);const N=g.times.length-1;let W;if(h<=g.times[0]){const B=A,O=S-A;W=sr.arraySlice(g.values,B,O)}else if(h>=g.times[N]){const B=N*S+A,O=B+S-A;W=sr.arraySlice(g.values,B,O)}else{const B=g.createInterpolant(),O=A,pe=S-A;B.evaluate(h),W=sr.arraySlice(B.resultBuffer,O,pe)}_==="quaternion"&&new xa().fromArray(W).normalize().conjugate().toArray(W);const V=b.times.length;for(let B=0;B<V;++B){const O=B*E+R;if(_==="quaternion")xa.multiplyQuaternionsFlat(b.values,O,W,0,b.values,O);else{const pe=E-R*2;for(let ge=0;ge<pe;++ge)b.values[O+ge]-=W[ge]}}}return r.blendMode=Jy,r}};function Pa(r,i,n,l){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=l!==void 0?l:new i.constructor(n),this.sampleValues=i,this.valueSize=n}Object.assign(Pa.prototype,{evaluate:function(r){const i=this.parameterPositions;let n=this._cachedIndex,l=i[n],u=i[n-1];e:{t:{let h;n:{i:if(!(r<l)){for(let p=n+2;;){if(l===void 0){if(r<u)break i;return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,r,u)}if(n===p)break;if(u=l,l=i[++n],r<l)break t}h=i.length;break n}if(!(r>=u)){const p=i[1];r<p&&(n=2,u=p);for(let g=n-2;;){if(u===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,l);if(n===g)break;if(l=u,u=i[--n-1],r>=u)break t}h=n,n=0;break n}break e}for(;n<h;){const p=n+h>>>1;r<i[p]?h=p:n=p+1}if(l=i[n],u=i[n-1],u===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,l);if(l===void 0)return n=i.length,this._cachedIndex=n,this.afterEnd_(n-1,u,r)}this._cachedIndex=n,this.intervalChanged_(n,u,l)}return this.interpolate_(n,u,r,l)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(r){const i=this.resultBuffer,n=this.sampleValues,l=this.valueSize,u=r*l;for(let h=0;h!==l;++h)i[h]=n[u+h];return i},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Pa.prototype,{beforeStart_:Pa.prototype.copySampleValue_,afterEnd_:Pa.prototype.copySampleValue_});function Zg(r,i,n,l){Pa.call(this,r,i,n,l),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}Zg.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Zg,DefaultSettings_:{endingStart:Du,endingEnd:Du},intervalChanged_:function(r,i,n){const l=this.parameterPositions;let u=r-2,h=r+1,p=l[u],g=l[h];if(p===void 0)switch(this.getSettings_().endingStart){case Ou:u=r,p=2*i-n;break;case kd:u=l.length-2,p=i+l[u]-l[u+1];break;default:u=r,p=n}if(g===void 0)switch(this.getSettings_().endingEnd){case Ou:h=r,g=2*n-i;break;case kd:h=1,g=n+l[1]-l[0];break;default:h=r-1,g=i}const _=(n-i)*.5,b=this.valueSize;this._weightPrev=_/(i-p),this._weightNext=_/(g-n),this._offsetPrev=u*b,this._offsetNext=h*b},interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=r*p,_=g-p,b=this._offsetPrev,A=this._offsetNext,S=this._weightPrev,R=this._weightNext,E=(n-i)/(l-i),N=E*E,W=N*E,V=-S*W+2*S*N-S*E,B=(1+S)*W+(-1.5-2*S)*N+(-.5+S)*E+1,O=(-1-R)*W+(1.5+R)*N+.5*E,pe=R*W-R*N;for(let ge=0;ge!==p;++ge)u[ge]=V*h[b+ge]+B*h[_+ge]+O*h[g+ge]+pe*h[A+ge];return u}});function Ap(r,i,n,l){Pa.call(this,r,i,n,l)}Ap.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Ap,interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=r*p,_=g-p,b=(n-i)/(l-i),A=1-b;for(let S=0;S!==p;++S)u[S]=h[_+S]*A+h[g+S]*b;return u}});function Jg(r,i,n,l){Pa.call(this,r,i,n,l)}Jg.prototype=Object.assign(Object.create(Pa.prototype),{constructor:Jg,interpolate_:function(r){return this.copySampleValue_(r-1)}});function la(r,i,n,l){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(i===void 0||i.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=sr.convertArray(i,this.TimeBufferType),this.values=sr.convertArray(n,this.ValueBufferType),this.setInterpolation(l||this.DefaultInterpolation)}Object.assign(la,{toJSON:function(r){const i=r.constructor;let n;if(i.toJSON!==void 0)n=i.toJSON(r);else{n={name:r.name,times:sr.convertArray(r.times,Array),values:sr.convertArray(r.values,Array)};const l=r.getInterpolation();l!==r.DefaultInterpolation&&(n.interpolation=l)}return n.type=r.ValueTypeName,n}}),Object.assign(la.prototype,{constructor:la,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Iu,InterpolantFactoryMethodDiscrete:function(r){return new Jg(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodLinear:function(r){return new Ap(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:function(r){return new Zg(this.times,this.values,this.getValueSize(),r)},setInterpolation:function(r){let i;switch(r){case sf:i=this.InterpolantFactoryMethodDiscrete;break;case Iu:i=this.InterpolantFactoryMethodLinear;break;case sg:i=this.InterpolantFactoryMethodSmooth;break}if(i===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=i,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return sf;case this.InterpolantFactoryMethodLinear:return Iu;case this.InterpolantFactoryMethodSmooth:return sg}},getValueSize:function(){return this.values.length/this.times.length},shift:function(r){if(r!==0){const i=this.times;for(let n=0,l=i.length;n!==l;++n)i[n]+=r}return this},scale:function(r){if(r!==1){const i=this.times;for(let n=0,l=i.length;n!==l;++n)i[n]*=r}return this},trim:function(r,i){const n=this.times,l=n.length;let u=0,h=l-1;for(;u!==l&&n[u]<r;)++u;for(;h!==-1&&n[h]>i;)--h;if(++h,u!==0||h!==l){u>=h&&(h=Math.max(h,1),u=h-1);const p=this.getValueSize();this.times=sr.arraySlice(n,u,h),this.values=sr.arraySlice(this.values,u*p,h*p)}return this},validate:function(){let r=!0;const i=this.getValueSize();i-Math.floor(i)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);const n=this.times,l=this.values,u=n.length;u===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let h=null;for(let p=0;p!==u;p++){const g=n[p];if(typeof g=="number"&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,p,g),r=!1;break}if(h!==null&&h>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,p,g,h),r=!1;break}h=g}if(l!==void 0&&sr.isTypedArray(l))for(let p=0,g=l.length;p!==g;++p){const _=l[p];if(isNaN(_)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,p,_),r=!1;break}}return r},optimize:function(){const r=sr.arraySlice(this.times),i=sr.arraySlice(this.values),n=this.getValueSize(),l=this.getInterpolation()===sg,u=r.length-1;let h=1;for(let p=1;p<u;++p){let g=!1;const _=r[p],b=r[p+1];if(_!==b&&(p!==1||_!==_[0]))if(l)g=!0;else{const A=p*n,S=A-n,R=A+n;for(let E=0;E!==n;++E){const N=i[A+E];if(N!==i[S+E]||N!==i[R+E]){g=!0;break}}}if(g){if(p!==h){r[h]=r[p];const A=p*n,S=h*n;for(let R=0;R!==n;++R)i[S+R]=i[A+R]}++h}}if(u>0){r[h]=r[u];for(let p=u*n,g=h*n,_=0;_!==n;++_)i[g+_]=i[p+_];++h}return h!==r.length?(this.times=sr.arraySlice(r,0,h),this.values=sr.arraySlice(i,0,h*n)):(this.times=r,this.values=i),this},clone:function(){const r=sr.arraySlice(this.times,0),i=sr.arraySlice(this.values,0),n=this.constructor,l=new n(this.name,r,i);return l.createInterpolant=this.createInterpolant,l}});function Kg(r,i,n){la.call(this,r,i,n)}Kg.prototype=Object.assign(Object.create(la.prototype),{constructor:Kg,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:sf,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function Qg(r,i,n,l){la.call(this,r,i,n,l)}Qg.prototype=Object.assign(Object.create(la.prototype),{constructor:Qg,ValueTypeName:"color"});function hh(r,i,n,l){la.call(this,r,i,n,l)}hh.prototype=Object.assign(Object.create(la.prototype),{constructor:hh,ValueTypeName:"number"});function $g(r,i,n,l){Pa.call(this,r,i,n,l)}$g.prototype=Object.assign(Object.create(Pa.prototype),{constructor:$g,interpolate_:function(r,i,n,l){const u=this.resultBuffer,h=this.sampleValues,p=this.valueSize,g=(n-i)/(l-i);let _=r*p;for(let b=_+p;_!==b;_+=4)xa.slerpFlat(u,0,h,_-p,h,_,g);return u}});function Of(r,i,n,l){la.call(this,r,i,n,l)}Of.prototype=Object.assign(Object.create(la.prototype),{constructor:Of,ValueTypeName:"quaternion",DefaultInterpolation:Iu,InterpolantFactoryMethodLinear:function(r){return new $g(this.times,this.values,this.getValueSize(),r)},InterpolantFactoryMethodSmooth:void 0});function ev(r,i,n,l){la.call(this,r,i,n,l)}ev.prototype=Object.assign(Object.create(la.prototype),{constructor:ev,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:sf,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function fh(r,i,n,l){la.call(this,r,i,n,l)}fh.prototype=Object.assign(Object.create(la.prototype),{constructor:fh,ValueTypeName:"vector"});function Gs(r,i,n,l){this.name=r,this.tracks=n,this.duration=i!==void 0?i:-1,this.blendMode=l!==void 0?l:og,this.uuid=Gn.generateUUID(),this.duration<0&&this.resetDuration()}function R1(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return hh;case"vector":case"vector2":case"vector3":case"vector4":return fh;case"color":return Qg;case"quaternion":return Of;case"bool":case"boolean":return Kg;case"string":return ev}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function C1(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const i=R1(r.type);if(r.times===void 0){const n=[],l=[];sr.flattenJSON(r.keys,n,l,"value"),r.times=n,r.values=l}return i.parse!==void 0?i.parse(r):new i(r.name,r.times,r.values,r.interpolation)}Object.assign(Gs,{parse:function(r){const i=[],n=r.tracks,l=1/(r.fps||1);for(let u=0,h=n.length;u!==h;++u)i.push(C1(n[u]).scale(l));return new Gs(r.name,r.duration,i,r.blendMode)},toJSON:function(r){const i=[],n=r.tracks,l={name:r.name,duration:r.duration,tracks:i,uuid:r.uuid,blendMode:r.blendMode};for(let u=0,h=n.length;u!==h;++u)i.push(la.toJSON(n[u]));return l},CreateFromMorphTargetSequence:function(r,i,n,l){const u=i.length,h=[];for(let p=0;p<u;p++){let g=[],_=[];g.push((p+u-1)%u,p,(p+1)%u),_.push(0,1,0);const b=sr.getKeyframeOrder(g);g=sr.sortedArray(g,1,b),_=sr.sortedArray(_,1,b),!l&&g[0]===0&&(g.push(u),_.push(_[0])),h.push(new hh(".morphTargetInfluences["+i[p].name+"]",g,_).scale(1/n))}return new Gs(r,-1,h)},findByName:function(r,i){let n=r;if(!Array.isArray(r)){const l=r;n=l.geometry&&l.geometry.animations||l.animations}for(let l=0;l<n.length;l++)if(n[l].name===i)return n[l];return null},CreateClipsFromMorphTargetSequences:function(r,i,n){const l={},u=/^([\w-]*?)([\d]+)$/;for(let p=0,g=r.length;p<g;p++){const _=r[p],b=_.name.match(u);if(b&&b.length>1){const A=b[1];let S=l[A];S||(l[A]=S=[]),S.push(_)}}const h=[];for(const p in l)h.push(Gs.CreateFromMorphTargetSequence(p,l[p],i,n));return h},parseAnimation:function(r,i){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const n=function(A,S,R,E,N){if(R.length!==0){const W=[],V=[];sr.flattenJSON(R,W,V,E),W.length!==0&&N.push(new A(S,W,V))}},l=[],u=r.name||"default",h=r.fps||30,p=r.blendMode;let g=r.length||-1;const _=r.hierarchy||[];for(let A=0;A<_.length;A++){const S=_[A].keys;if(!(!S||S.length===0))if(S[0].morphTargets){const R={};let E;for(E=0;E<S.length;E++)if(S[E].morphTargets)for(let N=0;N<S[E].morphTargets.length;N++)R[S[E].morphTargets[N]]=-1;for(const N in R){const W=[],V=[];for(let B=0;B!==S[E].morphTargets.length;++B){const O=S[E];W.push(O.time),V.push(O.morphTarget===N?1:0)}l.push(new hh(".morphTargetInfluence["+N+"]",W,V))}g=R.length*(h||1)}else{const R=".bones["+i[A].name+"]";n(fh,R+".position",S,"pos",l),n(Of,R+".quaternion",S,"rot",l),n(fh,R+".scale",S,"scl",l)}}return l.length===0?null:new Gs(u,g,l,p)}}),Object.assign(Gs.prototype,{resetDuration:function(){const r=this.tracks;let i=0;for(let n=0,l=r.length;n!==l;++n){const u=this.tracks[n];i=Math.max(i,u.times[u.times.length-1])}return this.duration=i,this},trim:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this},validate:function(){let r=!0;for(let i=0;i<this.tracks.length;i++)r=r&&this.tracks[i].validate();return r},optimize:function(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this},clone:function(){const r=[];for(let i=0;i<this.tracks.length;i++)r.push(this.tracks[i].clone());return new Gs(this.name,this.duration,r,this.blendMode)}});const dh={enabled:!1,files:{},add:function(r,i){this.enabled!==!1&&(this.files[r]=i)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};function P1(r,i,n){const l=this;let u=!1,h=0,p=0,g;const _=[];this.onStart=void 0,this.onLoad=r,this.onProgress=i,this.onError=n,this.itemStart=function(b){p++,u===!1&&l.onStart!==void 0&&l.onStart(b,h,p),u=!0},this.itemEnd=function(b){h++,l.onProgress!==void 0&&l.onProgress(b,h,p),h===p&&(u=!1,l.onLoad!==void 0&&l.onLoad())},this.itemError=function(b){l.onError!==void 0&&l.onError(b)},this.resolveURL=function(b){return g?g(b):b},this.setURLModifier=function(b){return g=b,this},this.addHandler=function(b,A){return _.push(b,A),this},this.removeHandler=function(b){const A=_.indexOf(b);return A!==-1&&_.splice(A,2),this},this.getHandler=function(b){for(let A=0,S=_.length;A<S;A+=2){const R=_[A],E=_[A+1];if(R.global&&(R.lastIndex=0),R.test(b))return E}return null}}const I1=new P1;function Li(r){this.manager=r!==void 0?r:I1,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Li.prototype,{load:function(){},loadAsync:function(r,i){const n=this;return new Promise(function(l,u){n.load(r,l,i,u)})},parse:function(){},setCrossOrigin:function(r){return this.crossOrigin=r,this},setWithCredentials:function(r){return this.withCredentials=r,this},setPath:function(r){return this.path=r,this},setResourcePath:function(r){return this.resourcePath=r,this},setRequestHeader:function(r){return this.requestHeader=r,this}});const zs={};function Hs(r){Li.call(this,r)}Hs.prototype=Object.assign(Object.create(Li.prototype),{constructor:Hs,load:function(r,i,n,l){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=dh.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;if(zs[r]!==void 0){zs[r].push({onLoad:i,onProgress:n,onError:l});return}const p=/^data:(.*?)(;base64)?,(.*)$/,g=r.match(p);let _;if(g){const b=g[1],A=!!g[2];let S=g[3];S=decodeURIComponent(S),A&&(S=atob(S));try{let R;const E=(this.responseType||"").toLowerCase();switch(E){case"arraybuffer":case"blob":const N=new Uint8Array(S.length);for(let V=0;V<S.length;V++)N[V]=S.charCodeAt(V);E==="blob"?R=new Blob([N.buffer],{type:b}):R=N.buffer;break;case"document":R=new DOMParser().parseFromString(S,b);break;case"json":R=JSON.parse(S);break;default:R=S;break}setTimeout(function(){i&&i(R),u.manager.itemEnd(r)},0)}catch(R){setTimeout(function(){l&&l(R),u.manager.itemError(r),u.manager.itemEnd(r)},0)}}else{zs[r]=[],zs[r].push({onLoad:i,onProgress:n,onError:l}),_=new XMLHttpRequest,_.open("GET",r,!0),_.addEventListener("load",function(b){const A=this.response,S=zs[r];if(delete zs[r],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),dh.add(r,A);for(let R=0,E=S.length;R<E;R++){const N=S[R];N.onLoad&&N.onLoad(A)}u.manager.itemEnd(r)}else{for(let R=0,E=S.length;R<E;R++){const N=S[R];N.onError&&N.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)}},!1),_.addEventListener("progress",function(b){const A=zs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onProgress&&E.onProgress(b)}},!1),_.addEventListener("error",function(b){const A=zs[r];delete zs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onError&&E.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)},!1),_.addEventListener("abort",function(b){const A=zs[r];delete zs[r];for(let S=0,R=A.length;S<R;S++){const E=A[S];E.onError&&E.onError(b)}u.manager.itemError(r),u.manager.itemEnd(r)},!1),this.responseType!==void 0&&(_.responseType=this.responseType),this.withCredentials!==void 0&&(_.withCredentials=this.withCredentials),_.overrideMimeType&&_.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const b in this.requestHeader)_.setRequestHeader(b,this.requestHeader[b]);_.send(null)}return u.manager.itemStart(r),_},setResponseType:function(r){return this.responseType=r,this},setMimeType:function(r){return this.mimeType=r,this}});function o_(r){Li.call(this,r)}o_.prototype=Object.assign(Object.create(Li.prototype),{constructor:o_,load:function(r,i,n,l){const u=this,h=new Hs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i=[];for(let n=0;n<r.length;n++){const l=Gs.parse(r[n]);i.push(l)}return i}});function l_(r){Li.call(this,r)}l_.prototype=Object.assign(Object.create(Li.prototype),{constructor:l_,load:function(r,i,n,l){const u=this,h=[],p=new Lf;p.image=h;const g=new Hs(this.manager);g.setPath(this.path),g.setResponseType("arraybuffer"),g.setRequestHeader(this.requestHeader),g.setWithCredentials(u.withCredentials);let _=0;function b(A){g.load(r[A],function(S){const R=u.parse(S,!0);h[A]={width:R.width,height:R.height,format:R.format,mipmaps:R.mipmaps},_+=1,_===6&&(R.mipmapCount===1&&(p.minFilter=Sn),p.format=R.format,p.needsUpdate=!0,i&&i(p))},n,l)}if(Array.isArray(r))for(let A=0,S=r.length;A<S;++A)b(A);else g.load(r,function(A){const S=u.parse(A,!0);if(S.isCubemap){const R=S.mipmaps.length/S.mipmapCount;for(let E=0;E<R;E++){h[E]={mipmaps:[]};for(let N=0;N<S.mipmapCount;N++)h[E].mipmaps.push(S.mipmaps[E*S.mipmapCount+N]),h[E].format=S.format,h[E].width=S.width,h[E].height=S.height}}else p.image.width=S.width,p.image.height=S.height,p.mipmaps=S.mipmaps;S.mipmapCount===1&&(p.minFilter=Sn),p.format=S.format,p.needsUpdate=!0,i&&i(p)},n,l);return p}});function Lp(r){Li.call(this,r)}Lp.prototype=Object.assign(Object.create(Li.prototype),{constructor:Lp,load:function(r,i,n,l){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=dh.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;const p=document.createElementNS("http://www.w3.org/1999/xhtml","img");function g(){p.removeEventListener("load",g,!1),p.removeEventListener("error",_,!1),dh.add(r,this),i&&i(this),u.manager.itemEnd(r)}function _(b){p.removeEventListener("load",g,!1),p.removeEventListener("error",_,!1),l&&l(b),u.manager.itemError(r),u.manager.itemEnd(r)}return p.addEventListener("load",g,!1),p.addEventListener("error",_,!1),r.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(p.crossOrigin=this.crossOrigin),u.manager.itemStart(r),p.src=r,p}});function tv(r){Li.call(this,r)}tv.prototype=Object.assign(Object.create(Li.prototype),{constructor:tv,load:function(r,i,n,l){const u=new Kl,h=new Lp(this.manager);h.setCrossOrigin(this.crossOrigin),h.setPath(this.path);let p=0;function g(_){h.load(r[_],function(b){u.images[_]=b,p++,p===6&&(u.needsUpdate=!0,i&&i(u))},void 0,l)}for(let _=0;_<r.length;++_)g(_);return u}});function Nf(r){Li.call(this,r)}Nf.prototype=Object.assign(Object.create(Li.prototype),{constructor:Nf,load:function(r,i,n,l){const u=this,h=new Ku,p=new Hs(this.manager);return p.setResponseType("arraybuffer"),p.setRequestHeader(this.requestHeader),p.setPath(this.path),p.setWithCredentials(u.withCredentials),p.load(r,function(g){const _=u.parse(g);!_||(_.image!==void 0?h.image=_.image:_.data!==void 0&&(h.image.width=_.width,h.image.height=_.height,h.image.data=_.data),h.wrapS=_.wrapS!==void 0?_.wrapS:Qr,h.wrapT=_.wrapT!==void 0?_.wrapT:Qr,h.magFilter=_.magFilter!==void 0?_.magFilter:Sn,h.minFilter=_.minFilter!==void 0?_.minFilter:Sn,h.anisotropy=_.anisotropy!==void 0?_.anisotropy:1,_.format!==void 0&&(h.format=_.format),_.type!==void 0&&(h.type=_.type),_.mipmaps!==void 0&&(h.mipmaps=_.mipmaps,h.minFilter=Cu),_.mipmapCount===1&&(h.minFilter=Sn),h.needsUpdate=!0,i&&i(h,_))},n,l),h}});function Rp(r){Li.call(this,r)}Rp.prototype=Object.assign(Object.create(Li.prototype),{constructor:Rp,load:function(r,i,n,l){const u=new Vi,h=new Lp(this.manager);return h.setCrossOrigin(this.crossOrigin),h.setPath(this.path),h.load(r,function(p){u.image=p;const g=r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0;u.format=g?yo:fs,u.needsUpdate=!0,i!==void 0&&i(u)},n,l),u}});function ln(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(ln.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(r,i){const n=this.getUtoTmapping(r);return this.getPoint(n,i)},getPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return i},getSpacedPoints:function(r){r===void 0&&(r=5);const i=[];for(let n=0;n<=r;n++)i.push(this.getPointAt(n/r));return i},getLength:function(){const r=this.getLengths();return r[r.length-1]},getLengths:function(r){if(r===void 0&&(r=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let n,l=this.getPoint(0),u=0;i.push(0);for(let h=1;h<=r;h++)n=this.getPoint(h/r),u+=n.distanceTo(l),i.push(u),l=n;return this.cacheArcLengths=i,i},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(r,i){const n=this.getLengths();let l=0;const u=n.length;let h;i?h=i:h=r*n[u-1];let p=0,g=u-1,_;for(;p<=g;)if(l=Math.floor(p+(g-p)/2),_=n[l]-h,_<0)p=l+1;else if(_>0)g=l-1;else{g=l;break}if(l=g,n[l]===h)return l/(u-1);const b=n[l],S=n[l+1]-b,R=(h-b)/S;return(l+R)/(u-1)},getTangent:function(r,i){let l=r-1e-4,u=r+1e-4;l<0&&(l=0),u>1&&(u=1);const h=this.getPoint(l),p=this.getPoint(u),g=i||(h.isVector2?new xt:new _e);return g.copy(p).sub(h).normalize(),g},getTangentAt:function(r,i){const n=this.getUtoTmapping(r);return this.getTangent(n,i)},computeFrenetFrames:function(r,i){const n=new _e,l=[],u=[],h=[],p=new _e,g=new zn;for(let R=0;R<=r;R++){const E=R/r;l[R]=this.getTangentAt(E,new _e),l[R].normalize()}u[0]=new _e,h[0]=new _e;let _=Number.MAX_VALUE;const b=Math.abs(l[0].x),A=Math.abs(l[0].y),S=Math.abs(l[0].z);b<=_&&(_=b,n.set(1,0,0)),A<=_&&(_=A,n.set(0,1,0)),S<=_&&n.set(0,0,1),p.crossVectors(l[0],n).normalize(),u[0].crossVectors(l[0],p),h[0].crossVectors(l[0],u[0]);for(let R=1;R<=r;R++){if(u[R]=u[R-1].clone(),h[R]=h[R-1].clone(),p.crossVectors(l[R-1],l[R]),p.length()>Number.EPSILON){p.normalize();const E=Math.acos(Gn.clamp(l[R-1].dot(l[R]),-1,1));u[R].applyMatrix4(g.makeRotationAxis(p,E))}h[R].crossVectors(l[R],u[R])}if(i===!0){let R=Math.acos(Gn.clamp(u[0].dot(u[r]),-1,1));R/=r,l[0].dot(p.crossVectors(u[0],u[r]))>0&&(R=-R);for(let E=1;E<=r;E++)u[E].applyMatrix4(g.makeRotationAxis(l[E],R*E)),h[E].crossVectors(l[E],u[E])}return{tangents:l,normals:u,binormals:h}},clone:function(){return new this.constructor().copy(this)},copy:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this},toJSON:function(){const r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r},fromJSON:function(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}});function ms(r,i,n,l,u,h,p,g){ln.call(this),this.type="EllipseCurve",this.aX=r||0,this.aY=i||0,this.xRadius=n||1,this.yRadius=l||1,this.aStartAngle=u||0,this.aEndAngle=h||2*Math.PI,this.aClockwise=p||!1,this.aRotation=g||0}ms.prototype=Object.create(ln.prototype),ms.prototype.constructor=ms,ms.prototype.isEllipseCurve=!0,ms.prototype.getPoint=function(r,i){const n=i||new xt,l=Math.PI*2;let u=this.aEndAngle-this.aStartAngle;const h=Math.abs(u)<Number.EPSILON;for(;u<0;)u+=l;for(;u>l;)u-=l;u<Number.EPSILON&&(h?u=0:u=l),this.aClockwise===!0&&!h&&(u===l?u=-l:u=u-l);const p=this.aStartAngle+r*u;let g=this.aX+this.xRadius*Math.cos(p),_=this.aY+this.yRadius*Math.sin(p);if(this.aRotation!==0){const b=Math.cos(this.aRotation),A=Math.sin(this.aRotation),S=g-this.aX,R=_-this.aY;g=S*b-R*A+this.aX,_=S*A+R*b+this.aY}return n.set(g,_)},ms.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this},ms.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r},ms.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this};function Ff(r,i,n,l,u,h){ms.call(this,r,i,n,n,l,u,h),this.type="ArcCurve"}Ff.prototype=Object.create(ms.prototype),Ff.prototype.constructor=Ff,Ff.prototype.isArcCurve=!0;function nv(){let r=0,i=0,n=0,l=0;function u(h,p,g,_){r=h,i=g,n=-3*h+3*p-2*g-_,l=2*h-2*p+g+_}return{initCatmullRom:function(h,p,g,_,b){u(p,g,b*(g-h),b*(_-p))},initNonuniformCatmullRom:function(h,p,g,_,b,A,S){let R=(p-h)/b-(g-h)/(b+A)+(g-p)/A,E=(g-p)/A-(_-p)/(A+S)+(_-g)/S;R*=A,E*=A,u(p,g,R,E)},calc:function(h){const p=h*h,g=p*h;return r+i*h+n*p+l*g}}}const Cp=new _e,iv=new nv,rv=new nv,av=new nv;function ks(r,i,n,l){ln.call(this),this.type="CatmullRomCurve3",this.points=r||[],this.closed=i||!1,this.curveType=n||"centripetal",this.tension=l!==void 0?l:.5}ks.prototype=Object.create(ln.prototype),ks.prototype.constructor=ks,ks.prototype.isCatmullRomCurve3=!0,ks.prototype.getPoint=function(r,i){const n=i||new _e,l=this.points,u=l.length,h=(u-(this.closed?0:1))*r;let p=Math.floor(h),g=h-p;this.closed?p+=p>0?0:(Math.floor(Math.abs(p)/u)+1)*u:g===0&&p===u-1&&(p=u-2,g=1);let _,b;this.closed||p>0?_=l[(p-1)%u]:(Cp.subVectors(l[0],l[1]).add(l[0]),_=Cp);const A=l[p%u],S=l[(p+1)%u];if(this.closed||p+2<u?b=l[(p+2)%u]:(Cp.subVectors(l[u-1],l[u-2]).add(l[u-1]),b=Cp),this.curveType==="centripetal"||this.curveType==="chordal"){const R=this.curveType==="chordal"?.5:.25;let E=Math.pow(_.distanceToSquared(A),R),N=Math.pow(A.distanceToSquared(S),R),W=Math.pow(S.distanceToSquared(b),R);N<1e-4&&(N=1),E<1e-4&&(E=N),W<1e-4&&(W=N),iv.initNonuniformCatmullRom(_.x,A.x,S.x,b.x,E,N,W),rv.initNonuniformCatmullRom(_.y,A.y,S.y,b.y,E,N,W),av.initNonuniformCatmullRom(_.z,A.z,S.z,b.z,E,N,W)}else this.curveType==="catmullrom"&&(iv.initCatmullRom(_.x,A.x,S.x,b.x,this.tension),rv.initCatmullRom(_.y,A.y,S.y,b.y,this.tension),av.initCatmullRom(_.z,A.z,S.z,b.z,this.tension));return n.set(iv.calc(g),rv.calc(g),av.calc(g)),n},ks.prototype.copy=function(r){ln.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(l.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this},ks.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const l=this.points[i];r.points.push(l.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r},ks.prototype.fromJSON=function(r){ln.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(new _e().fromArray(l))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this};function c_(r,i,n,l,u){const h=(l-i)*.5,p=(u-n)*.5,g=r*r,_=r*g;return(2*n-2*l+h+p)*_+(-3*n+3*l-2*h-p)*g+h*r+n}function D1(r,i){const n=1-r;return n*n*i}function O1(r,i){return 2*(1-r)*r*i}function N1(r,i){return r*r*i}function Bf(r,i,n,l){return D1(r,i)+O1(r,n)+N1(r,l)}function F1(r,i){const n=1-r;return n*n*n*i}function B1(r,i){const n=1-r;return 3*n*n*r*i}function U1(r,i){return 3*(1-r)*r*r*i}function G1(r,i){return r*r*r*i}function Uf(r,i,n,l,u){return F1(r,i)+B1(r,n)+U1(r,l)+G1(r,u)}function wo(r,i,n,l){ln.call(this),this.type="CubicBezierCurve",this.v0=r||new xt,this.v1=i||new xt,this.v2=n||new xt,this.v3=l||new xt}wo.prototype=Object.create(ln.prototype),wo.prototype.constructor=wo,wo.prototype.isCubicBezierCurve=!0,wo.prototype.getPoint=function(r,i){const n=i||new xt,l=this.v0,u=this.v1,h=this.v2,p=this.v3;return n.set(Uf(r,l.x,u.x,h.x,p.x),Uf(r,l.y,u.y,h.y,p.y)),n},wo.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},wo.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},wo.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function ll(r,i,n,l){ln.call(this),this.type="CubicBezierCurve3",this.v0=r||new _e,this.v1=i||new _e,this.v2=n||new _e,this.v3=l||new _e}ll.prototype=Object.create(ln.prototype),ll.prototype.constructor=ll,ll.prototype.isCubicBezierCurve3=!0,ll.prototype.getPoint=function(r,i){const n=i||new _e,l=this.v0,u=this.v1,h=this.v2,p=this.v3;return n.set(Uf(r,l.x,u.x,h.x,p.x),Uf(r,l.y,u.y,h.y,p.y),Uf(r,l.z,u.z,h.z,p.z)),n},ll.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this},ll.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r},ll.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this};function Za(r,i){ln.call(this),this.type="LineCurve",this.v1=r||new xt,this.v2=i||new xt}Za.prototype=Object.create(ln.prototype),Za.prototype.constructor=Za,Za.prototype.isLineCurve=!0,Za.prototype.getPoint=function(r,i){const n=i||new xt;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},Za.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},Za.prototype.getTangent=function(r,i){const n=i||new xt;return n.copy(this.v2).sub(this.v1).normalize(),n},Za.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Za.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Za.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function Mo(r,i){ln.call(this),this.type="LineCurve3",this.v1=r||new _e,this.v2=i||new _e}Mo.prototype=Object.create(ln.prototype),Mo.prototype.constructor=Mo,Mo.prototype.isLineCurve3=!0,Mo.prototype.getPoint=function(r,i){const n=i||new _e;return r===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(r).add(this.v1)),n},Mo.prototype.getPointAt=function(r,i){return this.getPoint(r,i)},Mo.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v1.copy(r.v1),this.v2.copy(r.v2),this},Mo.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},Mo.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function So(r,i,n){ln.call(this),this.type="QuadraticBezierCurve",this.v0=r||new xt,this.v1=i||new xt,this.v2=n||new xt}So.prototype=Object.create(ln.prototype),So.prototype.constructor=So,So.prototype.isQuadraticBezierCurve=!0,So.prototype.getPoint=function(r,i){const n=i||new xt,l=this.v0,u=this.v1,h=this.v2;return n.set(Bf(r,l.x,u.x,h.x),Bf(r,l.y,u.y,h.y)),n},So.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},So.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},So.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function cl(r,i,n){ln.call(this),this.type="QuadraticBezierCurve3",this.v0=r||new _e,this.v1=i||new _e,this.v2=n||new _e}cl.prototype=Object.create(ln.prototype),cl.prototype.constructor=cl,cl.prototype.isQuadraticBezierCurve3=!0,cl.prototype.getPoint=function(r,i){const n=i||new _e,l=this.v0,u=this.v1,h=this.v2;return n.set(Bf(r,l.x,u.x,h.x),Bf(r,l.y,u.y,h.y),Bf(r,l.z,u.z,h.z)),n},cl.prototype.copy=function(r){return ln.prototype.copy.call(this,r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this},cl.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r},cl.prototype.fromJSON=function(r){return ln.prototype.fromJSON.call(this,r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this};function To(r){ln.call(this),this.type="SplineCurve",this.points=r||[]}To.prototype=Object.create(ln.prototype),To.prototype.constructor=To,To.prototype.isSplineCurve=!0,To.prototype.getPoint=function(r,i){const n=i||new xt,l=this.points,u=(l.length-1)*r,h=Math.floor(u),p=u-h,g=l[h===0?h:h-1],_=l[h],b=l[h>l.length-2?l.length-1:h+1],A=l[h>l.length-3?l.length-1:h+2];return n.set(c_(p,g.x,_.x,b.x,A.x),c_(p,g.y,_.y,b.y,A.y)),n},To.prototype.copy=function(r){ln.prototype.copy.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(l.clone())}return this},To.prototype.toJSON=function(){const r=ln.prototype.toJSON.call(this);r.points=[];for(let i=0,n=this.points.length;i<n;i++){const l=this.points[i];r.points.push(l.toArray())}return r},To.prototype.fromJSON=function(r){ln.prototype.fromJSON.call(this,r),this.points=[];for(let i=0,n=r.points.length;i<n;i++){const l=r.points[i];this.points.push(new xt().fromArray(l))}return this};var z1=Object.freeze({__proto__:null,ArcCurve:Ff,CatmullRomCurve3:ks,CubicBezierCurve:wo,CubicBezierCurve3:ll,EllipseCurve:ms,LineCurve:Za,LineCurve3:Mo,QuadraticBezierCurve:So,QuadraticBezierCurve3:cl,SplineCurve:To});function ic(){ln.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}ic.prototype=Object.assign(Object.create(ln.prototype),{constructor:ic,add:function(r){this.curves.push(r)},closePath:function(){const r=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);r.equals(i)||this.curves.push(new Za(i,r))},getPoint:function(r){const i=r*this.getLength(),n=this.getCurveLengths();let l=0;for(;l<n.length;){if(n[l]>=i){const u=n[l]-i,h=this.curves[l],p=h.getLength(),g=p===0?0:1-u/p;return h.getPointAt(g)}l++}return null},getLength:function(){const r=this.getCurveLengths();return r[r.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const r=[];let i=0;for(let n=0,l=this.curves.length;n<l;n++)i+=this.curves[n].getLength(),r.push(i);return this.cacheLengths=r,r},getSpacedPoints:function(r){r===void 0&&(r=40);const i=[];for(let n=0;n<=r;n++)i.push(this.getPoint(n/r));return this.autoClose&&i.push(i[0]),i},getPoints:function(r){r=r||12;const i=[];let n;for(let l=0,u=this.curves;l<u.length;l++){const h=u[l],p=h&&h.isEllipseCurve?r*2:h&&(h.isLineCurve||h.isLineCurve3)?1:h&&h.isSplineCurve?r*h.points.length:r,g=h.getPoints(p);for(let _=0;_<g.length;_++){const b=g[_];n&&n.equals(b)||(i.push(b),n=b)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(r){ln.prototype.copy.call(this,r),this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const l=r.curves[i];this.curves.push(l.clone())}return this.autoClose=r.autoClose,this},toJSON:function(){const r=ln.prototype.toJSON.call(this);r.autoClose=this.autoClose,r.curves=[];for(let i=0,n=this.curves.length;i<n;i++){const l=this.curves[i];r.curves.push(l.toJSON())}return r},fromJSON:function(r){ln.prototype.fromJSON.call(this,r),this.autoClose=r.autoClose,this.curves=[];for(let i=0,n=r.curves.length;i<n;i++){const l=r.curves[i];this.curves.push(new z1[l.type]().fromJSON(l))}return this}});function Eo(r){ic.call(this),this.type="Path",this.currentPoint=new xt,r&&this.setFromPoints(r)}Eo.prototype=Object.assign(Object.create(ic.prototype),{constructor:Eo,setFromPoints:function(r){this.moveTo(r[0].x,r[0].y);for(let i=1,n=r.length;i<n;i++)this.lineTo(r[i].x,r[i].y);return this},moveTo:function(r,i){return this.currentPoint.set(r,i),this},lineTo:function(r,i){const n=new Za(this.currentPoint.clone(),new xt(r,i));return this.curves.push(n),this.currentPoint.set(r,i),this},quadraticCurveTo:function(r,i,n,l){const u=new So(this.currentPoint.clone(),new xt(r,i),new xt(n,l));return this.curves.push(u),this.currentPoint.set(n,l),this},bezierCurveTo:function(r,i,n,l,u,h){const p=new wo(this.currentPoint.clone(),new xt(r,i),new xt(n,l),new xt(u,h));return this.curves.push(p),this.currentPoint.set(u,h),this},splineThru:function(r){const i=[this.currentPoint.clone()].concat(r),n=new To(i);return this.curves.push(n),this.currentPoint.copy(r[r.length-1]),this},arc:function(r,i,n,l,u,h){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absarc(r+p,i+g,n,l,u,h),this},absarc:function(r,i,n,l,u,h){return this.absellipse(r,i,n,n,l,u,h),this},ellipse:function(r,i,n,l,u,h,p,g){const _=this.currentPoint.x,b=this.currentPoint.y;return this.absellipse(r+_,i+b,n,l,u,h,p,g),this},absellipse:function(r,i,n,l,u,h,p,g){const _=new ms(r,i,n,l,u,h,p,g);if(this.curves.length>0){const A=_.getPoint(0);A.equals(this.currentPoint)||this.lineTo(A.x,A.y)}this.curves.push(_);const b=_.getPoint(1);return this.currentPoint.copy(b),this},copy:function(r){return ic.prototype.copy.call(this,r),this.currentPoint.copy(r.currentPoint),this},toJSON:function(){const r=ic.prototype.toJSON.call(this);return r.currentPoint=this.currentPoint.toArray(),r},fromJSON:function(r){return ic.prototype.fromJSON.call(this,r),this.currentPoint.fromArray(r.currentPoint),this}});function ph(r){Eo.call(this,r),this.uuid=Gn.generateUUID(),this.type="Shape",this.holes=[]}ph.prototype=Object.assign(Object.create(Eo.prototype),{constructor:ph,getPointsHoles:function(r){const i=[];for(let n=0,l=this.holes.length;n<l;n++)i[n]=this.holes[n].getPoints(r);return i},extractPoints:function(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}},copy:function(r){Eo.prototype.copy.call(this,r),this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const l=r.holes[i];this.holes.push(l.clone())}return this},toJSON:function(){const r=Eo.prototype.toJSON.call(this);r.uuid=this.uuid,r.holes=[];for(let i=0,n=this.holes.length;i<n;i++){const l=this.holes[i];r.holes.push(l.toJSON())}return r},fromJSON:function(r){Eo.prototype.fromJSON.call(this,r),this.uuid=r.uuid,this.holes=[];for(let i=0,n=r.holes.length;i<n;i++){const l=r.holes[i];this.holes.push(new Eo().fromJSON(l))}return this}});function Qi(r,i){hn.call(this),this.type="Light",this.color=new Kt(r),this.intensity=i!==void 0?i:1}Qi.prototype=Object.assign(Object.create(hn.prototype),{constructor:Qi,isLight:!0,copy:function(r){return hn.prototype.copy.call(this,r),this.color.copy(r.color),this.intensity=r.intensity,this},toJSON:function(r){const i=hn.prototype.toJSON.call(this,r);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}});function u_(r,i,n){Qi.call(this,r,n),this.type="HemisphereLight",this.position.copy(hn.DefaultUp),this.updateMatrix(),this.groundColor=new Kt(i)}u_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:u_,isHemisphereLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.groundColor.copy(r.groundColor),this}});function ul(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new xt(512,512),this.map=null,this.mapPass=null,this.matrix=new zn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sp,this._frameExtents=new xt(1,1),this._viewportCount=1,this._viewports=[new Gi(0,0,1,1)]}Object.assign(ul.prototype,{_projScreenMatrix:new zn,_lightPositionWorld:new _e,_lookTarget:new _e,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(r){const i=this.camera,n=this.matrix,l=this._projScreenMatrix,u=this._lookTarget,h=this._lightPositionWorld;h.setFromMatrixPosition(r.matrixWorld),i.position.copy(h),u.setFromMatrixPosition(r.target.matrixWorld),i.lookAt(u),i.updateMatrixWorld(),l.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(i.projectionMatrix),n.multiply(i.matrixWorldInverse)},getViewport:function(r){return this._viewports[r]},getFrameExtents:function(){return this._frameExtents},copy:function(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}});function sv(){ul.call(this,new Vr(50,1,.5,500)),this.focus=1}sv.prototype=Object.assign(Object.create(ul.prototype),{constructor:sv,isSpotLightShadow:!0,updateMatrices:function(r){const i=this.camera,n=Gn.RAD2DEG*2*r.angle*this.focus,l=this.mapSize.width/this.mapSize.height,u=r.distance||i.far;(n!==i.fov||l!==i.aspect||u!==i.far)&&(i.fov=n,i.aspect=l,i.far=u,i.updateProjectionMatrix()),ul.prototype.updateMatrices.call(this,r)}});function ov(r,i,n,l,u,h){Qi.call(this,r,i),this.type="SpotLight",this.position.copy(hn.DefaultUp),this.updateMatrix(),this.target=new hn,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(p){this.intensity=p/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=l!==void 0?l:Math.PI/3,this.penumbra=u!==void 0?u:0,this.decay=h!==void 0?h:1,this.shadow=new sv}ov.prototype=Object.assign(Object.create(Qi.prototype),{constructor:ov,isSpotLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function lv(){ul.call(this,new Vr(90,1,.5,500)),this._frameExtents=new xt(4,2),this._viewportCount=6,this._viewports=[new Gi(2,1,1,1),new Gi(0,1,1,1),new Gi(3,1,1,1),new Gi(1,1,1,1),new Gi(3,0,1,1),new Gi(1,0,1,1)],this._cubeDirections=[new _e(1,0,0),new _e(-1,0,0),new _e(0,0,1),new _e(0,0,-1),new _e(0,1,0),new _e(0,-1,0)],this._cubeUps=[new _e(0,1,0),new _e(0,1,0),new _e(0,1,0),new _e(0,1,0),new _e(0,0,1),new _e(0,0,-1)]}lv.prototype=Object.assign(Object.create(ul.prototype),{constructor:lv,isPointLightShadow:!0,updateMatrices:function(r,i){i===void 0&&(i=0);const n=this.camera,l=this.matrix,u=this._lightPositionWorld,h=this._lookTarget,p=this._projScreenMatrix;u.setFromMatrixPosition(r.matrixWorld),n.position.copy(u),h.copy(n.position),h.add(this._cubeDirections[i]),n.up.copy(this._cubeUps[i]),n.lookAt(h),n.updateMatrixWorld(),l.makeTranslation(-u.x,-u.y,-u.z),p.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(p)}});function cv(r,i,n,l){Qi.call(this,r,i),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(u){this.intensity=u/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=l!==void 0?l:1,this.shadow=new lv}cv.prototype=Object.assign(Object.create(Qi.prototype),{constructor:cv,isPointLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}});function Pp(r,i,n,l,u,h){Jl.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r!==void 0?r:-1,this.right=i!==void 0?i:1,this.top=n!==void 0?n:1,this.bottom=l!==void 0?l:-1,this.near=u!==void 0?u:.1,this.far=h!==void 0?h:2e3,this.updateProjectionMatrix()}Pp.prototype=Object.assign(Object.create(Jl.prototype),{constructor:Pp,isOrthographicCamera:!0,copy:function(r,i){return Jl.prototype.copy.call(this,r,i),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this},setViewOffset:function(r,i,n,l,u,h){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=i,this.view.offsetX=n,this.view.offsetY=l,this.view.width=u,this.view.height=h,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const r=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,l=(this.top+this.bottom)/2;let u=n-r,h=n+r,p=l+i,g=l-i;if(this.view!==null&&this.view.enabled){const _=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u+=_*this.view.offsetX,h=u+_*this.view.width,p-=b*this.view.offsetY,g=p-b*this.view.height}this.projectionMatrix.makeOrthographic(u,h,p,g,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(r){const i=hn.prototype.toJSON.call(this,r);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}});function uv(){ul.call(this,new Pp(-5,5,5,-5,.5,500))}uv.prototype=Object.assign(Object.create(ul.prototype),{constructor:uv,isDirectionalLightShadow:!0,updateMatrices:function(r){ul.prototype.updateMatrices.call(this,r)}});function hv(r,i){Qi.call(this,r,i),this.type="DirectionalLight",this.position.copy(hn.DefaultUp),this.updateMatrix(),this.target=new hn,this.shadow=new uv}hv.prototype=Object.assign(Object.create(Qi.prototype),{constructor:hv,isDirectionalLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}});function h_(r,i){Qi.call(this,r,i),this.type="AmbientLight"}h_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:h_,isAmbientLight:!0});function f_(r,i,n,l){Qi.call(this,r,i),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=l!==void 0?l:10}f_.prototype=Object.assign(Object.create(Qi.prototype),{constructor:f_,isRectAreaLight:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.width=r.width,this.height=r.height,this},toJSON:function(r){const i=Qi.prototype.toJSON.call(this,r);return i.object.width=this.width,i.object.height=this.height,i}});class H1{constructor(){Object.defineProperty(this,"isSphericalHarmonics3",{value:!0}),this.coefficients=[];for(let i=0;i<9;i++)this.coefficients.push(new _e)}set(i){for(let n=0;n<9;n++)this.coefficients[n].copy(i[n]);return this}zero(){for(let i=0;i<9;i++)this.coefficients[i].set(0,0,0);return this}getAt(i,n){const l=i.x,u=i.y,h=i.z,p=this.coefficients;return n.copy(p[0]).multiplyScalar(.282095),n.addScaledVector(p[1],.488603*u),n.addScaledVector(p[2],.488603*h),n.addScaledVector(p[3],.488603*l),n.addScaledVector(p[4],1.092548*(l*u)),n.addScaledVector(p[5],1.092548*(u*h)),n.addScaledVector(p[6],.315392*(3*h*h-1)),n.addScaledVector(p[7],1.092548*(l*h)),n.addScaledVector(p[8],.546274*(l*l-u*u)),n}getIrradianceAt(i,n){const l=i.x,u=i.y,h=i.z,p=this.coefficients;return n.copy(p[0]).multiplyScalar(.886227),n.addScaledVector(p[1],2*.511664*u),n.addScaledVector(p[2],2*.511664*h),n.addScaledVector(p[3],2*.511664*l),n.addScaledVector(p[4],2*.429043*l*u),n.addScaledVector(p[5],2*.429043*u*h),n.addScaledVector(p[6],.743125*h*h-.247708),n.addScaledVector(p[7],2*.429043*l*h),n.addScaledVector(p[8],.429043*(l*l-u*u)),n}add(i){for(let n=0;n<9;n++)this.coefficients[n].add(i.coefficients[n]);return this}addScaledSH(i,n){for(let l=0;l<9;l++)this.coefficients[l].addScaledVector(i.coefficients[l],n);return this}scale(i){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(i);return this}lerp(i,n){for(let l=0;l<9;l++)this.coefficients[l].lerp(i.coefficients[l],n);return this}equals(i){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(i.coefficients[n]))return!1;return!0}copy(i){return this.set(i.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(i,n){n===void 0&&(n=0);const l=this.coefficients;for(let u=0;u<9;u++)l[u].fromArray(i,n+u*3);return this}toArray(i,n){i===void 0&&(i=[]),n===void 0&&(n=0);const l=this.coefficients;for(let u=0;u<9;u++)l[u].toArray(i,n+u*3);return i}static getBasisAt(i,n){const l=i.x,u=i.y,h=i.z;n[0]=.282095,n[1]=.488603*u,n[2]=.488603*h,n[3]=.488603*l,n[4]=1.092548*l*u,n[5]=1.092548*u*h,n[6]=.315392*(3*h*h-1),n[7]=1.092548*l*h,n[8]=.546274*(l*l-u*u)}}function Ao(r,i){Qi.call(this,void 0,i),this.type="LightProbe",this.sh=r!==void 0?r:new H1}Ao.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Ao,isLightProbe:!0,copy:function(r){return Qi.prototype.copy.call(this,r),this.sh.copy(r.sh),this},fromJSON:function(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this},toJSON:function(r){const i=Qi.prototype.toJSON.call(this,r);return i.object.sh=this.sh.toArray(),i}});function d_(r){Li.call(this,r),this.textures={}}d_.prototype=Object.assign(Object.create(Li.prototype),{constructor:d_,load:function(r,i,n,l){const u=this,h=new Hs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i=this.textures;function n(u){return i[u]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",u),i[u]}const l=new L1[r.type];if(r.uuid!==void 0&&(l.uuid=r.uuid),r.name!==void 0&&(l.name=r.name),r.color!==void 0&&l.color.setHex(r.color),r.roughness!==void 0&&(l.roughness=r.roughness),r.metalness!==void 0&&(l.metalness=r.metalness),r.sheen!==void 0&&(l.sheen=new Kt().setHex(r.sheen)),r.emissive!==void 0&&l.emissive.setHex(r.emissive),r.specular!==void 0&&l.specular.setHex(r.specular),r.shininess!==void 0&&(l.shininess=r.shininess),r.clearcoat!==void 0&&(l.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(l.clearcoatRoughness=r.clearcoatRoughness),r.fog!==void 0&&(l.fog=r.fog),r.flatShading!==void 0&&(l.flatShading=r.flatShading),r.blending!==void 0&&(l.blending=r.blending),r.combine!==void 0&&(l.combine=r.combine),r.side!==void 0&&(l.side=r.side),r.opacity!==void 0&&(l.opacity=r.opacity),r.transparent!==void 0&&(l.transparent=r.transparent),r.alphaTest!==void 0&&(l.alphaTest=r.alphaTest),r.depthTest!==void 0&&(l.depthTest=r.depthTest),r.depthWrite!==void 0&&(l.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(l.colorWrite=r.colorWrite),r.stencilWrite!==void 0&&(l.stencilWrite=r.stencilWrite),r.stencilWriteMask!==void 0&&(l.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(l.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(l.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(l.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(l.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(l.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(l.stencilZPass=r.stencilZPass),r.wireframe!==void 0&&(l.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(l.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(l.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(l.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(l.rotation=r.rotation),r.linewidth!==1&&(l.linewidth=r.linewidth),r.dashSize!==void 0&&(l.dashSize=r.dashSize),r.gapSize!==void 0&&(l.gapSize=r.gapSize),r.scale!==void 0&&(l.scale=r.scale),r.polygonOffset!==void 0&&(l.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(l.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(l.polygonOffsetUnits=r.polygonOffsetUnits),r.skinning!==void 0&&(l.skinning=r.skinning),r.morphTargets!==void 0&&(l.morphTargets=r.morphTargets),r.morphNormals!==void 0&&(l.morphNormals=r.morphNormals),r.dithering!==void 0&&(l.dithering=r.dithering),r.vertexTangents!==void 0&&(l.vertexTangents=r.vertexTangents),r.visible!==void 0&&(l.visible=r.visible),r.toneMapped!==void 0&&(l.toneMapped=r.toneMapped),r.userData!==void 0&&(l.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?l.vertexColors=r.vertexColors>0:l.vertexColors=r.vertexColors),r.uniforms!==void 0)for(const u in r.uniforms){const h=r.uniforms[u];switch(l.uniforms[u]={},h.type){case"t":l.uniforms[u].value=n(h.value);break;case"c":l.uniforms[u].value=new Kt().setHex(h.value);break;case"v2":l.uniforms[u].value=new xt().fromArray(h.value);break;case"v3":l.uniforms[u].value=new _e().fromArray(h.value);break;case"v4":l.uniforms[u].value=new Gi().fromArray(h.value);break;case"m3":l.uniforms[u].value=new La().fromArray(h.value);break;case"m4":l.uniforms[u].value=new zn().fromArray(h.value);break;default:l.uniforms[u].value=h.value}}if(r.defines!==void 0&&(l.defines=r.defines),r.vertexShader!==void 0&&(l.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(l.fragmentShader=r.fragmentShader),r.extensions!==void 0)for(const u in r.extensions)l.extensions[u]=r.extensions[u];if(r.shading!==void 0&&(l.flatShading=r.shading===1),r.size!==void 0&&(l.size=r.size),r.sizeAttenuation!==void 0&&(l.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(l.map=n(r.map)),r.matcap!==void 0&&(l.matcap=n(r.matcap)),r.alphaMap!==void 0&&(l.alphaMap=n(r.alphaMap)),r.bumpMap!==void 0&&(l.bumpMap=n(r.bumpMap)),r.bumpScale!==void 0&&(l.bumpScale=r.bumpScale),r.normalMap!==void 0&&(l.normalMap=n(r.normalMap)),r.normalMapType!==void 0&&(l.normalMapType=r.normalMapType),r.normalScale!==void 0){let u=r.normalScale;Array.isArray(u)===!1&&(u=[u,u]),l.normalScale=new xt().fromArray(u)}return r.displacementMap!==void 0&&(l.displacementMap=n(r.displacementMap)),r.displacementScale!==void 0&&(l.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(l.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(l.roughnessMap=n(r.roughnessMap)),r.metalnessMap!==void 0&&(l.metalnessMap=n(r.metalnessMap)),r.emissiveMap!==void 0&&(l.emissiveMap=n(r.emissiveMap)),r.emissiveIntensity!==void 0&&(l.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(l.specularMap=n(r.specularMap)),r.envMap!==void 0&&(l.envMap=n(r.envMap)),r.envMapIntensity!==void 0&&(l.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(l.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(l.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(l.lightMap=n(r.lightMap)),r.lightMapIntensity!==void 0&&(l.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(l.aoMap=n(r.aoMap)),r.aoMapIntensity!==void 0&&(l.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(l.gradientMap=n(r.gradientMap)),r.clearcoatMap!==void 0&&(l.clearcoatMap=n(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(l.clearcoatRoughnessMap=n(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(l.clearcoatNormalMap=n(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(l.clearcoatNormalScale=new xt().fromArray(r.clearcoatNormalScale)),r.transmission!==void 0&&(l.transmission=r.transmission),r.transmissionMap!==void 0&&(l.transmissionMap=n(r.transmissionMap)),l},setTextures:function(r){return this.textures=r,this}});const mh={decodeText:function(r){if(typeof TextDecoder<"u")return new TextDecoder().decode(r);let i="";for(let n=0,l=r.length;n<l;n++)i+=String.fromCharCode(r[n]);try{return decodeURIComponent(escape(i))}catch{return i}},extractUrlBase:function(r){const i=r.lastIndexOf("/");return i===-1?"./":r.substr(0,i+1)}};function Ip(){Oi.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}Ip.prototype=Object.assign(Object.create(Oi.prototype),{constructor:Ip,isInstancedBufferGeometry:!0,copy:function(r){return Oi.prototype.copy.call(this,r),this.instanceCount=r.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const r=Oi.prototype.toJSON.call(this);return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}});function fv(r,i,n,l){typeof n=="number"&&(l=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Nn.call(this,r,i,n),this.meshPerAttribute=l||1}fv.prototype=Object.assign(Object.create(Nn.prototype),{constructor:fv,isInstancedBufferAttribute:!0,copy:function(r){return Nn.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},toJSON:function(){const r=Nn.prototype.toJSON.call(this);return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}});function p_(r){Li.call(this,r)}p_.prototype=Object.assign(Object.create(Li.prototype),{constructor:p_,load:function(r,i,n,l){const u=this,h=new Hs(u.manager);h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{i(u.parse(JSON.parse(p)))}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)},parse:function(r){const i={},n={};function l(R,E){if(i[E]!==void 0)return i[E];const W=R.interleavedBuffers[E],V=u(R,W.buffer),B=new Dp[W.type](V),O=new Ya(B,W.stride);return O.uuid=W.uuid,i[E]=O,O}function u(R,E){if(n[E]!==void 0)return n[E];const W=R.arrayBuffers[E],V=new Uint32Array(W).buffer;return n[E]=V,V}const h=r.isInstancedBufferGeometry?new Ip:new Oi,p=r.data.index;if(p!==void 0){const R=new Dp[p.type](p.array);h.setIndex(new Nn(R,1))}const g=r.data.attributes;for(const R in g){const E=g[R];let N;if(E.isInterleavedBufferAttribute){const W=l(r.data,E.data);N=new $l(W,E.itemSize,E.offset,E.normalized)}else{const W=new Dp[E.type](E.array),V=E.isInstancedBufferAttribute?fv:Nn;N=new V(W,E.itemSize,E.normalized)}E.name!==void 0&&(N.name=E.name),h.setAttribute(R,N)}const _=r.data.morphAttributes;if(_)for(const R in _){const E=_[R],N=[];for(let W=0,V=E.length;W<V;W++){const B=E[W];let O;if(B.isInterleavedBufferAttribute){const pe=l(r.data,B.data);O=new $l(pe,B.itemSize,B.offset,B.normalized)}else{const pe=new Dp[B.type](B.array);O=new Nn(pe,B.itemSize,B.normalized)}B.name!==void 0&&(O.name=B.name),N.push(O)}h.morphAttributes[R]=N}r.data.morphTargetsRelative&&(h.morphTargetsRelative=!0);const A=r.data.groups||r.data.drawcalls||r.data.offsets;if(A!==void 0)for(let R=0,E=A.length;R!==E;++R){const N=A[R];h.addGroup(N.start,N.count,N.materialIndex)}const S=r.data.boundingSphere;if(S!==void 0){const R=new _e;S.center!==void 0&&R.fromArray(S.center),h.boundingSphere=new el(R,S.radius)}return r.name&&(h.name=r.name),r.userData&&(h.userData=r.userData),h}});const Dp={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dv(r){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Li.call(this,r),this.options={premultiplyAlpha:"none"}}dv.prototype=Object.assign(Object.create(Li.prototype),{constructor:dv,isImageBitmapLoader:!0,setOptions:function(i){return this.options=i,this},load:function(r,i,n,l){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const u=this,h=dh.get(r);if(h!==void 0)return u.manager.itemStart(r),setTimeout(function(){i&&i(h),u.manager.itemEnd(r)},0),h;const p={};p.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",fetch(r,p).then(function(g){return g.blob()}).then(function(g){return createImageBitmap(g,u.options)}).then(function(g){dh.add(r,g),i&&i(g),u.manager.itemEnd(r)}).catch(function(g){l&&l(g),u.manager.itemError(r),u.manager.itemEnd(r)}),u.manager.itemStart(r)}});function m_(){this.type="ShapePath",this.color=new Kt,this.subPaths=[],this.currentPath=null}Object.assign(m_.prototype,{moveTo:function(r,i){return this.currentPath=new Eo,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,i),this},lineTo:function(r,i){return this.currentPath.lineTo(r,i),this},quadraticCurveTo:function(r,i,n,l){return this.currentPath.quadraticCurveTo(r,i,n,l),this},bezierCurveTo:function(r,i,n,l,u,h){return this.currentPath.bezierCurveTo(r,i,n,l,u,h),this},splineThru:function(r){return this.currentPath.splineThru(r),this},toShapes:function(r,i){function n(B){const O=[];for(let pe=0,ge=B.length;pe<ge;pe++){const ye=B[pe],Q=new ph;Q.curves=ye.curves,O.push(Q)}return O}function l(B,O){const pe=O.length;let ge=!1;for(let ye=pe-1,Q=0;Q<pe;ye=Q++){let Ie=O[ye],tt=O[Q],qe=tt.x-Ie.x,ht=tt.y-Ie.y;if(Math.abs(ht)>Number.EPSILON){if(ht<0&&(Ie=O[Q],qe=-qe,tt=O[ye],ht=-ht),B.y<Ie.y||B.y>tt.y)continue;if(B.y===Ie.y){if(B.x===Ie.x)return!0}else{const Ye=ht*(B.x-Ie.x)-qe*(B.y-Ie.y);if(Ye===0)return!0;if(Ye<0)continue;ge=!ge}}else{if(B.y!==Ie.y)continue;if(tt.x<=B.x&&B.x<=Ie.x||Ie.x<=B.x&&B.x<=tt.x)return!0}}return ge}const u=nc.isClockWise,h=this.subPaths;if(h.length===0)return[];if(i===!0)return n(h);let p,g,_;const b=[];if(h.length===1)return g=h[0],_=new ph,_.curves=g.curves,b.push(_),b;let A=!u(h[0].getPoints());A=r?!A:A;const S=[],R=[];let E=[],N=0,W;R[N]=void 0,E[N]=[];for(let B=0,O=h.length;B<O;B++)g=h[B],W=g.getPoints(),p=u(W),p=r?!p:p,p?(!A&&R[N]&&N++,R[N]={s:new ph,p:W},R[N].s.curves=g.curves,A&&N++,E[N]=[]):E[N].push({h:g,p:W[0]});if(!R[0])return n(h);if(R.length>1){let B=!1;const O=[];for(let pe=0,ge=R.length;pe<ge;pe++)S[pe]=[];for(let pe=0,ge=R.length;pe<ge;pe++){const ye=E[pe];for(let Q=0;Q<ye.length;Q++){const Ie=ye[Q];let tt=!0;for(let qe=0;qe<R.length;qe++)l(Ie.p,R[qe].p)&&(pe!==qe&&O.push({froms:pe,tos:qe,hole:Q}),tt?(tt=!1,S[qe].push(Ie)):B=!0);tt&&S[pe].push(Ie)}}O.length>0&&(B||(E=S))}let V;for(let B=0,O=R.length;B<O;B++){_=R[B].s,b.push(_),V=E[B];for(let pe=0,ge=V.length;pe<ge;pe++)_.holes.push(V[pe].h)}return b}});function g_(r){this.type="Font",this.data=r}Object.assign(g_.prototype,{isFont:!0,generateShapes:function(r,i){i===void 0&&(i=100);const n=[],l=k1(r,i,this.data);for(let u=0,h=l.length;u<h;u++)Array.prototype.push.apply(n,l[u].toShapes());return n}});function k1(r,i,n){const l=Array.from?Array.from(r):String(r).split(""),u=i/n.resolution,h=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*u,p=[];let g=0,_=0;for(let b=0;b<l.length;b++){const A=l[b];if(A===`
`)g=0,_-=h;else{const S=V1(A,u,g,_,n);g+=S.offsetX,p.push(S.path)}}return p}function V1(r,i,n,l,u){const h=u.glyphs[r]||u.glyphs["?"];if(!h){console.error('THREE.Font: character "'+r+'" does not exists in font family '+u.familyName+".");return}const p=new m_;let g,_,b,A,S,R,E,N;if(h.o){const W=h._cachedOutline||(h._cachedOutline=h.o.split(" "));for(let V=0,B=W.length;V<B;)switch(W[V++]){case"m":g=W[V++]*i+n,_=W[V++]*i+l,p.moveTo(g,_);break;case"l":g=W[V++]*i+n,_=W[V++]*i+l,p.lineTo(g,_);break;case"q":b=W[V++]*i+n,A=W[V++]*i+l,S=W[V++]*i+n,R=W[V++]*i+l,p.quadraticCurveTo(S,R,b,A);break;case"b":b=W[V++]*i+n,A=W[V++]*i+l,S=W[V++]*i+n,R=W[V++]*i+l,E=W[V++]*i+n,N=W[V++]*i+l,p.bezierCurveTo(S,R,E,N,b,A);break}}return{offsetX:h.ha*i,path:p}}function v_(r){Li.call(this,r)}v_.prototype=Object.assign(Object.create(Li.prototype),{constructor:v_,load:function(r,i,n,l){const u=this,h=new Hs(this.manager);h.setPath(this.path),h.setRequestHeader(this.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){let g;try{g=JSON.parse(p)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),g=JSON.parse(p.substring(65,p.length-2))}const _=u.parse(g);i&&i(_)},n,l)},parse:function(r){return new g_(r)}});let Op;const W1={getContext:function(){return Op===void 0&&(Op=new(window.AudioContext||window.webkitAudioContext)),Op},setContext:function(r){Op=r}};function pv(r){Li.call(this,r)}pv.prototype=Object.assign(Object.create(Li.prototype),{constructor:pv,load:function(r,i,n,l){const u=this,h=new Hs(u.manager);h.setResponseType("arraybuffer"),h.setPath(u.path),h.setRequestHeader(u.requestHeader),h.setWithCredentials(u.withCredentials),h.load(r,function(p){try{const g=p.slice(0);W1.getContext().decodeAudioData(g,function(b){i(b)})}catch(g){l?l(g):console.error(g),u.manager.itemError(r)}},n,l)}});function y_(r,i,n){Ao.call(this,void 0,n);const l=new Kt().set(r),u=new Kt().set(i),h=new _e(l.r,l.g,l.b),p=new _e(u.r,u.g,u.b),g=Math.sqrt(Math.PI),_=g*Math.sqrt(.75);this.sh.coefficients[0].copy(h).add(p).multiplyScalar(g),this.sh.coefficients[1].copy(h).sub(p).multiplyScalar(_)}y_.prototype=Object.assign(Object.create(Ao.prototype),{constructor:y_,isHemisphereLightProbe:!0,copy:function(r){return Ao.prototype.copy.call(this,r),this},toJSON:function(r){return Ao.prototype.toJSON.call(this,r)}});function __(r,i){Ao.call(this,void 0,i);const n=new Kt().set(r);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}__.prototype=Object.assign(Object.create(Ao.prototype),{constructor:__,isAmbientLightProbe:!0,copy:function(r){return Ao.prototype.copy.call(this,r),this},toJSON:function(r){return Ao.prototype.toJSON.call(this,r)}});const x_=new zn,b_=new zn;function q1(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Vr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Vr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(q1.prototype,{update:function(r){const i=this._cache;if(i.focus!==r.focus||i.fov!==r.fov||i.aspect!==r.aspect*this.aspect||i.near!==r.near||i.far!==r.far||i.zoom!==r.zoom||i.eyeSep!==this.eyeSep){i.focus=r.focus,i.fov=r.fov,i.aspect=r.aspect*this.aspect,i.near=r.near,i.far=r.far,i.zoom=r.zoom,i.eyeSep=this.eyeSep;const l=r.projectionMatrix.clone(),u=i.eyeSep/2,h=u*i.near/i.focus,p=i.near*Math.tan(Gn.DEG2RAD*i.fov*.5)/i.zoom;let g,_;b_.elements[12]=-u,x_.elements[12]=u,g=-p*i.aspect+h,_=p*i.aspect+h,l.elements[0]=2*i.near/(_-g),l.elements[8]=(_+g)/(_-g),this.cameraL.projectionMatrix.copy(l),g=-p*i.aspect-h,_=p*i.aspect-h,l.elements[0]=2*i.near/(_-g),l.elements[8]=(_+g)/(_-g),this.cameraR.projectionMatrix.copy(l)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(b_),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(x_)}});class X1 extends hn{constructor(i){super(),this.type="Audio",this.listener=i,this.context=i.context,this.gain=this.context.createGain(),this.gain.connect(i.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(i){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=i,this.connect(),this}setMediaElementSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(i),this.connect(),this}setMediaStreamSource(i){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(i),this.connect(),this}setBuffer(i){return this.buffer=i,this.sourceType="buffer",this.autoplay&&this.play(),this}play(i){if(i===void 0&&(i=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+i;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].connect(this.filters[i]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let i=1,n=this.filters.length;i<n;i++)this.filters[i-1].disconnect(this.filters[i]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(i){return i||(i=[]),this._connected===!0?(this.disconnect(),this.filters=i,this.connect()):this.filters=i,this}setDetune(i){if(this.detune=i,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(i){return this.setFilters(i?[i]:[])}setPlaybackRate(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=i,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(i){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=i,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(i){return this.loopStart=i,this}setLoopEnd(i){return this.loopEnd=i,this}getVolume(){return this.gain.gain.value}setVolume(i){return this.gain.gain.setTargetAtTime(i,this.context.currentTime,.01),this}}function w_(r,i,n){this.binding=r,this.valueSize=n;let l,u,h;switch(i){case"quaternion":l=this._slerp,u=this._slerpAdditive,h=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":l=this._select,u=this._select,h=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:l=this._lerp,u=this._lerpAdditive,h=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=l,this._mixBufferRegionAdditive=u,this._setIdentity=h,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}Object.assign(w_.prototype,{accumulate:function(r,i){const n=this.buffer,l=this.valueSize,u=r*l+l;let h=this.cumulativeWeight;if(h===0){for(let p=0;p!==l;++p)n[u+p]=n[p];h=i}else{h+=i;const p=i/h;this._mixBufferRegion(n,u,0,p,l)}this.cumulativeWeight=h},accumulateAdditive:function(r){const i=this.buffer,n=this.valueSize,l=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(i,l,0,r,n),this.cumulativeWeightAdditive+=r},apply:function(r){const i=this.valueSize,n=this.buffer,l=r*i+i,u=this.cumulativeWeight,h=this.cumulativeWeightAdditive,p=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,u<1){const g=i*this._origIndex;this._mixBufferRegion(n,l,g,1-u,i)}h>0&&this._mixBufferRegionAdditive(n,l,this._addIndex*i,1,i);for(let g=i,_=i+i;g!==_;++g)if(n[g]!==n[g+i]){p.setValue(n,l);break}},saveOriginalState:function(){const r=this.binding,i=this.buffer,n=this.valueSize,l=n*this._origIndex;r.getValue(i,l);for(let u=n,h=l;u!==h;++u)i[u]=i[l+u%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){const r=this.valueSize*3;this.binding.setValue(this.buffer,r)},_setAdditiveIdentityNumeric:function(){const r=this._addIndex*this.valueSize,i=r+this.valueSize;for(let n=r;n<i;n++)this.buffer[n]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1},_setAdditiveIdentityOther:function(){const r=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[i+n]=this.buffer[r+n]},_select:function(r,i,n,l,u){if(l>=.5)for(let h=0;h!==u;++h)r[i+h]=r[n+h]},_slerp:function(r,i,n,l){xa.slerpFlat(r,i,r,i,r,n,l)},_slerpAdditive:function(r,i,n,l,u){const h=this._workIndex*u;xa.multiplyQuaternionsFlat(r,h,r,i,r,n),xa.slerpFlat(r,i,r,i,r,h,l)},_lerp:function(r,i,n,l,u){const h=1-l;for(let p=0;p!==u;++p){const g=i+p;r[g]=r[g]*h+r[n+p]*l}},_lerpAdditive:function(r,i,n,l,u){for(let h=0;h!==u;++h){const p=i+h;r[p]=r[p]+r[n+h]*l}}});const mv="\\[\\]\\.:\\/",Y1=new RegExp("["+mv+"]","g"),gv="[^"+mv+"]",j1="[^"+mv.replace("\\.","")+"]",Z1=/((?:WC+[\/:])*)/.source.replace("WC",gv),J1=/(WCOD+)?/.source.replace("WCOD",j1),K1=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",gv),Q1=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",gv),$1=new RegExp("^"+Z1+J1+K1+Q1+"$"),eA=["material","materials","bones"];function M_(r,i,n){const l=n||ca.parseTrackName(i);this._targetGroup=r,this._bindings=r.subscribe_(i,l)}Object.assign(M_.prototype,{getValue:function(r,i){this.bind();const n=this._targetGroup.nCachedObjects_,l=this._bindings[n];l!==void 0&&l.getValue(r,i)},setValue:function(r,i){const n=this._bindings;for(let l=this._targetGroup.nCachedObjects_,u=n.length;l!==u;++l)n[l].setValue(r,i)},bind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].bind()},unbind:function(){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,n=r.length;i!==n;++i)r[i].unbind()}});function ca(r,i,n){this.path=i,this.parsedPath=n||ca.parseTrackName(i),this.node=ca.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r}Object.assign(ca,{Composite:M_,create:function(r,i,n){return r&&r.isAnimationObjectGroup?new ca.Composite(r,i,n):new ca(r,i,n)},sanitizeNodeName:function(r){return r.replace(/\s/g,"_").replace(Y1,"")},parseTrackName:function(r){const i=$1.exec(r);if(!i)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const n={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},l=n.nodeName&&n.nodeName.lastIndexOf(".");if(l!==void 0&&l!==-1){const u=n.nodeName.substring(l+1);eA.indexOf(u)!==-1&&(n.nodeName=n.nodeName.substring(0,l),n.objectName=u)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return n},findNode:function(r,i){if(!i||i===""||i==="."||i===-1||i===r.name||i===r.uuid)return r;if(r.skeleton){const n=r.skeleton.getBoneByName(i);if(n!==void 0)return n}if(r.children){const n=function(u){for(let h=0;h<u.length;h++){const p=u[h];if(p.name===i||p.uuid===i)return p;const g=n(p.children);if(g)return g}return null},l=n(r.children);if(l)return l}return null}}),Object.assign(ca.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(i,n){i[n]=this.node[this.propertyName]},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)i[n++]=l[u]},function(i,n){i[n]=this.resolvedProperty[this.propertyIndex]},function(i,n){this.resolvedProperty.toArray(i,n)}],SetterByBindingTypeAndVersioning:[[function(i,n){this.targetObject[this.propertyName]=i[n]},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.targetObject[this.propertyName]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++]},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++];this.targetObject.needsUpdate=!0},function(i,n){const l=this.resolvedProperty;for(let u=0,h=l.length;u!==h;++u)l[u]=i[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty[this.propertyIndex]=i[n]},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty[this.propertyIndex]=i[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(i,n){this.resolvedProperty.fromArray(i,n)},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.needsUpdate=!0},function(i,n){this.resolvedProperty.fromArray(i,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(i,n){this.bind(),this.getValue(i,n)},setValue:function(i,n){this.bind(),this.setValue(i,n)},bind:function(){let r=this.node;const i=this.parsedPath,n=i.objectName,l=i.propertyName;let u=i.propertyIndex;if(r||(r=ca.findNode(this.rootNode,i.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){let _=i.objectIndex;switch(n){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(let b=0;b<r.length;b++)if(r[b].name===_){_=b;break}break;default:if(r[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[n]}if(_!==void 0){if(r[_]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[_]}}const h=r[l];if(h===void 0){const _=i.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+_+"."+l+" but it wasn't found.",r);return}let p=this.Versioning.None;this.targetObject=r,r.needsUpdate!==void 0?p=this.Versioning.NeedsUpdate:r.matrixWorldNeedsUpdate!==void 0&&(p=this.Versioning.MatrixWorldNeedsUpdate);let g=this.BindingType.Direct;if(u!==void 0){if(l==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(r.geometry.isBufferGeometry){if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}r.morphTargetDictionary[u]!==void 0&&(u=r.morphTargetDictionary[u])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}g=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=u}else h.fromArray!==void 0&&h.toArray!==void 0?(g=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(g=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=l;this.getValue=this.GetterByBindingType[g],this.setValue=this.SetterByBindingTypeAndVersioning[g][p]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(ca.prototype,{_getValue_unbound:ca.prototype.getValue,_setValue_unbound:ca.prototype.setValue});function tA(){this.uuid=Gn.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const r={};this._indicesByUUID=r;for(let n=0,l=arguments.length;n!==l;++n)r[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(tA.prototype,{isAnimationObjectGroup:!0,add:function(){const r=this._objects,i=this._indicesByUUID,n=this._paths,l=this._parsedPaths,u=this._bindings,h=u.length;let p,g=r.length,_=this.nCachedObjects_;for(let b=0,A=arguments.length;b!==A;++b){const S=arguments[b],R=S.uuid;let E=i[R];if(E===void 0){E=g++,i[R]=E,r.push(S);for(let N=0,W=h;N!==W;++N)u[N].push(new ca(S,n[N],l[N]))}else if(E<_){p=r[E];const N=--_,W=r[N];i[W.uuid]=E,r[E]=W,i[R]=N,r[N]=S;for(let V=0,B=h;V!==B;++V){const O=u[V],pe=O[N];let ge=O[E];O[E]=pe,ge===void 0&&(ge=new ca(S,n[V],l[V])),O[N]=ge}}else r[E]!==p&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=_},remove:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,l=n.length;let u=this.nCachedObjects_;for(let h=0,p=arguments.length;h!==p;++h){const g=arguments[h],_=g.uuid,b=i[_];if(b!==void 0&&b>=u){const A=u++,S=r[A];i[S.uuid]=b,r[b]=S,i[_]=A,r[A]=g;for(let R=0,E=l;R!==E;++R){const N=n[R],W=N[A],V=N[b];N[b]=W,N[A]=V}}}this.nCachedObjects_=u},uncache:function(){const r=this._objects,i=this._indicesByUUID,n=this._bindings,l=n.length;let u=this.nCachedObjects_,h=r.length;for(let p=0,g=arguments.length;p!==g;++p){const _=arguments[p],b=_.uuid,A=i[b];if(A!==void 0)if(delete i[b],A<u){const S=--u,R=r[S],E=--h,N=r[E];i[R.uuid]=A,r[A]=R,i[N.uuid]=S,r[S]=N,r.pop();for(let W=0,V=l;W!==V;++W){const B=n[W],O=B[S],pe=B[E];B[A]=O,B[S]=pe,B.pop()}}else{const S=--h,R=r[S];i[R.uuid]=A,r[A]=R,r.pop();for(let E=0,N=l;E!==N;++E){const W=n[E];W[A]=W[S],W.pop()}}}this.nCachedObjects_=u},subscribe_:function(r,i){const n=this._bindingsIndicesByPath;let l=n[r];const u=this._bindings;if(l!==void 0)return u[l];const h=this._paths,p=this._parsedPaths,g=this._objects,_=g.length,b=this.nCachedObjects_,A=new Array(_);l=u.length,n[r]=l,h.push(r),p.push(i),u.push(A);for(let S=b,R=g.length;S!==R;++S){const E=g[S];A[S]=new ca(E,r,i)}return A},unsubscribe_:function(r){const i=this._bindingsIndicesByPath,n=i[r];if(n!==void 0){const l=this._paths,u=this._parsedPaths,h=this._bindings,p=h.length-1,g=h[p],_=r[p];i[_]=n,h[n]=g,h.pop(),u[n]=u[p],u.pop(),l[n]=l[p],l.pop()}}});class nA{constructor(i,n,l,u){this._mixer=i,this._clip=n,this._localRoot=l||null,this.blendMode=u||n.blendMode;const h=n.tracks,p=h.length,g=new Array(p),_={endingStart:Du,endingEnd:Du};for(let b=0;b!==p;++b){const A=h[b].createInterpolant(null);g[b]=A,A.settings=_}this._interpolantSettings=_,this._interpolants=g,this._propertyBindings=new Array(p),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Ew,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(i){return this._startTime=i,this}setLoop(i,n){return this.loop=i,this.repetitions=n,this}setEffectiveWeight(i){return this.weight=i,this._effectiveWeight=this.enabled?i:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(i){return this._scheduleFading(i,0,1)}fadeOut(i){return this._scheduleFading(i,1,0)}crossFadeFrom(i,n,l){if(i.fadeOut(n),this.fadeIn(n),l){const u=this._clip.duration,h=i._clip.duration,p=h/u,g=u/h;i.warp(1,p,n),this.warp(g,1,n)}return this}crossFadeTo(i,n,l){return i.crossFadeFrom(this,n,l)}stopFading(){const i=this._weightInterpolant;return i!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}setEffectiveTimeScale(i){return this.timeScale=i,this._effectiveTimeScale=this.paused?0:i,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(i){return this.timeScale=this._clip.duration/i,this.stopWarping()}syncWith(i){return this.time=i.time,this.timeScale=i.timeScale,this.stopWarping()}halt(i){return this.warp(this._effectiveTimeScale,0,i)}warp(i,n,l){const u=this._mixer,h=u.time,p=this.timeScale;let g=this._timeScaleInterpolant;g===null&&(g=u._lendControlInterpolant(),this._timeScaleInterpolant=g);const _=g.parameterPositions,b=g.sampleValues;return _[0]=h,_[1]=h+l,b[0]=i/p,b[1]=n/p,this}stopWarping(){const i=this._timeScaleInterpolant;return i!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(i)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(i,n,l,u){if(!this.enabled){this._updateWeight(i);return}const h=this._startTime;if(h!==null){const _=(i-h)*l;if(_<0||l===0)return;this._startTime=null,n=l*_}n*=this._updateTimeScale(i);const p=this._updateTime(n),g=this._updateWeight(i);if(g>0){const _=this._interpolants,b=this._propertyBindings;switch(this.blendMode){case Jy:for(let A=0,S=_.length;A!==S;++A)_[A].evaluate(p),b[A].accumulateAdditive(g);break;case og:default:for(let A=0,S=_.length;A!==S;++A)_[A].evaluate(p),b[A].accumulate(u,g)}}}_updateWeight(i){let n=0;if(this.enabled){n=this.weight;const l=this._weightInterpolant;if(l!==null){const u=l.evaluate(i)[0];n*=u,i>l.parameterPositions[1]&&(this.stopFading(),u===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(i){let n=0;if(!this.paused){n=this.timeScale;const l=this._timeScaleInterpolant;l!==null&&(n*=l.evaluate(i)[0],i>l.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n}_updateTime(i){const n=this._clip.duration,l=this.loop;let u=this.time+i,h=this._loopCount;const p=l===Aw;if(i===0)return h===-1?u:p&&(h&1)===1?n-u:u;if(l===Tw){h===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(u>=n)u=n;else if(u<0)u=0;else{this.time=u;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:i<0?-1:1})}}else{if(h===-1&&(i>=0?(h=0,this._setEndings(!0,this.repetitions===0,p)):this._setEndings(this.repetitions===0,!0,p)),u>=n||u<0){const g=Math.floor(u/n);u-=n*g,h+=Math.abs(g);const _=this.repetitions-h;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,u=i>0?n:0,this.time=u,this._mixer.dispatchEvent({type:"finished",action:this,direction:i>0?1:-1});else{if(_===1){const b=i<0;this._setEndings(b,!b,p)}else this._setEndings(!1,!1,p);this._loopCount=h,this.time=u,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:g})}}else this.time=u;if(p&&(h&1)===1)return n-u}return u}_setEndings(i,n,l){const u=this._interpolantSettings;l?(u.endingStart=Ou,u.endingEnd=Ou):(i?u.endingStart=this.zeroSlopeAtStart?Ou:Du:u.endingStart=kd,n?u.endingEnd=this.zeroSlopeAtEnd?Ou:Du:u.endingEnd=kd)}_scheduleFading(i,n,l){const u=this._mixer,h=u.time;let p=this._weightInterpolant;p===null&&(p=u._lendControlInterpolant(),this._weightInterpolant=p);const g=p.parameterPositions,_=p.sampleValues;return g[0]=h,_[0]=n,g[1]=h+i,_[1]=l,this}}function S_(r){this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}S_.prototype=Object.assign(Object.create(Ds.prototype),{constructor:S_,_bindAction:function(r,i){const n=r._localRoot||this._root,l=r._clip.tracks,u=l.length,h=r._propertyBindings,p=r._interpolants,g=n.uuid,_=this._bindingsByRootAndName;let b=_[g];b===void 0&&(b={},_[g]=b);for(let A=0;A!==u;++A){const S=l[A],R=S.name;let E=b[R];if(E!==void 0)h[A]=E;else{if(E=h[A],E!==void 0){E._cacheIndex===null&&(++E.referenceCount,this._addInactiveBinding(E,g,R));continue}const N=i&&i._propertyBindings[A].binding.parsedPath;E=new w_(ca.create(n,R,N),S.ValueTypeName,S.getValueSize()),++E.referenceCount,this._addInactiveBinding(E,g,R),h[A]=E}p[A].resultBuffer=E.buffer}},_activateAction:function(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){const n=(r._localRoot||this._root).uuid,l=r._clip.uuid,u=this._actionsByClip[l];this._bindAction(r,u&&u.knownActions[0]),this._addInactiveAction(r,l,n)}const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];u.useCount++===0&&(this._lendBinding(u),u.saveOriginalState())}this._lendAction(r)}},_deactivateAction:function(r){if(this._isActiveAction(r)){const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];--u.useCount===0&&(u.restoreOriginalState(),this._takeBackBinding(u))}this._takeBackAction(r)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}},_isActiveAction:function(r){const i=r._cacheIndex;return i!==null&&i<this._nActiveActions},_addInactiveAction:function(r,i,n){const l=this._actions,u=this._actionsByClip;let h=u[i];if(h===void 0)h={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,u[i]=h;else{const p=h.knownActions;r._byClipCacheIndex=p.length,p.push(r)}r._cacheIndex=l.length,l.push(r),h.actionByRoot[n]=r},_removeInactiveAction:function(r){const i=this._actions,n=i[i.length-1],l=r._cacheIndex;n._cacheIndex=l,i[l]=n,i.pop(),r._cacheIndex=null;const u=r._clip.uuid,h=this._actionsByClip,p=h[u],g=p.knownActions,_=g[g.length-1],b=r._byClipCacheIndex;_._byClipCacheIndex=b,g[b]=_,g.pop(),r._byClipCacheIndex=null;const A=p.actionByRoot,S=(r._localRoot||this._root).uuid;delete A[S],g.length===0&&delete h[u],this._removeInactiveBindingsForAction(r)},_removeInactiveBindingsForAction:function(r){const i=r._propertyBindings;for(let n=0,l=i.length;n!==l;++n){const u=i[n];--u.referenceCount===0&&this._removeInactiveBinding(u)}},_lendAction:function(r){const i=this._actions,n=r._cacheIndex,l=this._nActiveActions++,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_takeBackAction:function(r){const i=this._actions,n=r._cacheIndex,l=--this._nActiveActions,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_addInactiveBinding:function(r,i,n){const l=this._bindingsByRootAndName,u=this._bindings;let h=l[i];h===void 0&&(h={},l[i]=h),h[n]=r,r._cacheIndex=u.length,u.push(r)},_removeInactiveBinding:function(r){const i=this._bindings,n=r.binding,l=n.rootNode.uuid,u=n.path,h=this._bindingsByRootAndName,p=h[l],g=i[i.length-1],_=r._cacheIndex;g._cacheIndex=_,i[_]=g,i.pop(),delete p[u],Object.keys(p).length===0&&delete h[l]},_lendBinding:function(r){const i=this._bindings,n=r._cacheIndex,l=this._nActiveBindings++,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_takeBackBinding:function(r){const i=this._bindings,n=r._cacheIndex,l=--this._nActiveBindings,u=i[l];r._cacheIndex=l,i[l]=r,u._cacheIndex=n,i[n]=u},_lendControlInterpolant:function(){const r=this._controlInterpolants,i=this._nActiveControlInterpolants++;let n=r[i];return n===void 0&&(n=new Ap(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=i,r[i]=n),n},_takeBackControlInterpolant:function(r){const i=this._controlInterpolants,n=r.__cacheIndex,l=--this._nActiveControlInterpolants,u=i[l];r.__cacheIndex=l,i[l]=r,u.__cacheIndex=n,i[n]=u},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(r,i,n){const l=i||this._root,u=l.uuid;let h=typeof r=="string"?Gs.findByName(l,r):r;const p=h!==null?h.uuid:r,g=this._actionsByClip[p];let _=null;if(n===void 0&&(h!==null?n=h.blendMode:n=og),g!==void 0){const A=g.actionByRoot[u];if(A!==void 0&&A.blendMode===n)return A;_=g.knownActions[0],h===null&&(h=_._clip)}if(h===null)return null;const b=new nA(this,h,i,n);return this._bindAction(b,_),this._addInactiveAction(b,p,u),b},existingAction:function(r,i){const n=i||this._root,l=n.uuid,u=typeof r=="string"?Gs.findByName(n,r):r,h=u?u.uuid:r,p=this._actionsByClip[h];return p!==void 0&&p.actionByRoot[l]||null},stopAllAction:function(){const r=this._actions,i=this._nActiveActions;for(let n=i-1;n>=0;--n)r[n].stop();return this},update:function(r){r*=this.timeScale;const i=this._actions,n=this._nActiveActions,l=this.time+=r,u=Math.sign(r),h=this._accuIndex^=1;for(let _=0;_!==n;++_)i[_]._update(l,r,u,h);const p=this._bindings,g=this._nActiveBindings;for(let _=0;_!==g;++_)p[_].apply(h);return this},setTime:function(r){this.time=0;for(let i=0;i<this._actions.length;i++)this._actions[i].time=0;return this.update(r)},getRoot:function(){return this._root},uncacheClip:function(r){const i=this._actions,n=r.uuid,l=this._actionsByClip,u=l[n];if(u!==void 0){const h=u.knownActions;for(let p=0,g=h.length;p!==g;++p){const _=h[p];this._deactivateAction(_);const b=_._cacheIndex,A=i[i.length-1];_._cacheIndex=null,_._byClipCacheIndex=null,A._cacheIndex=b,i[b]=A,i.pop(),this._removeInactiveBindingsForAction(_)}delete l[n]}},uncacheRoot:function(r){const i=r.uuid,n=this._actionsByClip;for(const h in n){const p=n[h].actionByRoot,g=p[i];g!==void 0&&(this._deactivateAction(g),this._removeInactiveAction(g))}const l=this._bindingsByRootAndName,u=l[i];if(u!==void 0)for(const h in u){const p=u[h];p.restoreOriginalState(),this._removeInactiveBinding(p)}},uncacheAction:function(r,i){const n=this.existingAction(r,i);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});class vv{constructor(i){typeof i=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),i=arguments[1]),this.value=i}clone(){return new vv(this.value.clone===void 0?this.value:this.value.clone())}}function T_(r,i,n){Ya.call(this,r,i),this.meshPerAttribute=n||1}T_.prototype=Object.assign(Object.create(Ya.prototype),{constructor:T_,isInstancedInterleavedBuffer:!0,copy:function(r){return Ya.prototype.copy.call(this,r),this.meshPerAttribute=r.meshPerAttribute,this},clone:function(r){const i=Ya.prototype.clone.call(this,r);return i.meshPerAttribute=this.meshPerAttribute,i},toJSON:function(r){const i=Ya.prototype.toJSON.call(this,r);return i.isInstancedInterleavedBuffer=!0,i.meshPerAttribute=this.meshPerAttribute,i}});function E_(r,i,n,l,u){this.buffer=r,this.type=i,this.itemSize=n,this.elementSize=l,this.count=u,this.version=0}Object.defineProperty(E_.prototype,"needsUpdate",{set:function(r){r===!0&&this.version++}}),Object.assign(E_.prototype,{isGLBufferAttribute:!0,setBuffer:function(r){return this.buffer=r,this},setType:function(r,i){return this.type=r,this.elementSize=i,this},setItemSize:function(r){return this.itemSize=r,this},setCount:function(r){return this.count=r,this}});function A_(r,i,n,l){this.ray=new uf(r,i),this.near=n||0,this.far=l||1/0,this.camera=null,this.layers=new r0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function L_(r,i){return r.distance-i.distance}function yv(r,i,n,l){if(r.layers.test(i.layers)&&r.raycast(i,n),l===!0){const u=r.children;for(let h=0,p=u.length;h<p;h++)yv(u[h],i,n,!0)}}Object.assign(A_.prototype,{set:function(r,i){this.ray.set(r,i)},setFromCamera:function(r,i){i&&i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i&&i.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(r,i,n){const l=n||[];return yv(r,this,l,i),l.sort(L_),l},intersectObjects:function(r,i,n){const l=n||[];if(Array.isArray(r)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),l;for(let u=0,h=r.length;u<h;u++)yv(r[u],this,l,i);return l.sort(L_),l}});class R_{constructor(i=1,n=0,l=0){return this.radius=i,this.phi=n,this.theta=l,this}set(i,n,l){return this.radius=i,this.phi=n,this.theta=l,this}clone(){return new this.constructor().copy(this)}copy(i){return this.radius=i.radius,this.phi=i.phi,this.theta=i.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(i){return this.setFromCartesianCoords(i.x,i.y,i.z)}setFromCartesianCoords(i,n,l){return this.radius=Math.sqrt(i*i+n*n+l*l),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(i,l),this.phi=Math.acos(Gn.clamp(n/this.radius,-1,1))),this}}const C_=new xt;class iA{constructor(i,n){Object.defineProperty(this,"isBox2",{value:!0}),this.min=i!==void 0?i:new xt(1/0,1/0),this.max=n!==void 0?n:new xt(-1/0,-1/0)}set(i,n){return this.min.copy(i),this.max.copy(n),this}setFromPoints(i){this.makeEmpty();for(let n=0,l=i.length;n<l;n++)this.expandByPoint(i[n]);return this}setFromCenterAndSize(i,n){const l=C_.copy(n).multiplyScalar(.5);return this.min.copy(i).sub(l),this.max.copy(i).add(l),this}clone(){return new this.constructor().copy(this)}copy(i){return this.min.copy(i.min),this.max.copy(i.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(i){return i===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),i=new xt),this.isEmpty()?i.set(0,0):i.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(i){return i===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),i=new xt),this.isEmpty()?i.set(0,0):i.subVectors(this.max,this.min)}expandByPoint(i){return this.min.min(i),this.max.max(i),this}expandByVector(i){return this.min.sub(i),this.max.add(i),this}expandByScalar(i){return this.min.addScalar(-i),this.max.addScalar(i),this}containsPoint(i){return!(i.x<this.min.x||i.x>this.max.x||i.y<this.min.y||i.y>this.max.y)}containsBox(i){return this.min.x<=i.min.x&&i.max.x<=this.max.x&&this.min.y<=i.min.y&&i.max.y<=this.max.y}getParameter(i,n){return n===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),n=new xt),n.set((i.x-this.min.x)/(this.max.x-this.min.x),(i.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(i){return!(i.max.x<this.min.x||i.min.x>this.max.x||i.max.y<this.min.y||i.min.y>this.max.y)}clampPoint(i,n){return n===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),n=new xt),n.copy(i).clamp(this.min,this.max)}distanceToPoint(i){return C_.copy(i).clamp(this.min,this.max).sub(i).length()}intersect(i){return this.min.max(i.min),this.max.min(i.max),this}union(i){return this.min.min(i.min),this.max.max(i.max),this}translate(i){return this.min.add(i),this.max.add(i),this}equals(i){return i.min.equals(this.min)&&i.max.equals(this.max)}}function Np(r){hn.call(this),this.material=r,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Np.prototype=Object.create(hn.prototype),Np.prototype.constructor=Np,Np.prototype.isImmediateRenderObject=!0;const rc=new _e,Fp=new zn,_v=new zn;class rA extends Af{constructor(i){const n=P_(i),l=new Oi,u=[],h=[],p=new Kt(0,0,1),g=new Kt(0,1,0);for(let b=0;b<n.length;b++){const A=n[b];A.parent&&A.parent.isBone&&(u.push(0,0,0),u.push(0,0,0),h.push(p.r,p.g,p.b),h.push(g.r,g.g,g.b))}l.setAttribute("position",new Mi(u,3)),l.setAttribute("color",new Mi(h,3));const _=new ja({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(l,_),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=i,this.bones=n,this.matrix=i.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(i){const n=this.bones,l=this.geometry,u=l.getAttribute("position");_v.getInverse(this.root.matrixWorld);for(let h=0,p=0;h<n.length;h++){const g=n[h];g.parent&&g.parent.isBone&&(Fp.multiplyMatrices(_v,g.matrixWorld),rc.setFromMatrixPosition(Fp),u.setXYZ(p,rc.x,rc.y,rc.z),Fp.multiplyMatrices(_v,g.parent.matrixWorld),rc.setFromMatrixPosition(Fp),u.setXYZ(p+1,rc.x,rc.y,rc.z),p+=2)}l.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(i)}}function P_(r){const i=[];r&&r.isBone&&i.push(r);for(let n=0;n<r.children.length;n++)i.push.apply(i,P_(r.children[n]));return i}class aA extends Af{constructor(i,n,l,u){i=i||10,n=n||10,l=new Kt(l!==void 0?l:4473924),u=new Kt(u!==void 0?u:8947848);const h=n/2,p=i/n,g=i/2,_=[],b=[];for(let R=0,E=0,N=-g;R<=n;R++,N+=p){_.push(-g,0,N,g,0,N),_.push(N,0,-g,N,0,g);const W=R===h?l:u;W.toArray(b,E),E+=3,W.toArray(b,E),E+=3,W.toArray(b,E),E+=3,W.toArray(b,E),E+=3}const A=new Oi;A.setAttribute("position",new Mi(_,3)),A.setAttribute("color",new Mi(b,3));const S=new ja({vertexColors:!0,toneMapped:!1});super(A,S),this.type="GridHelper"}}ln.create=function(r,i){return console.log("THREE.Curve.create() has been deprecated"),r.prototype=Object.create(ln.prototype),r.prototype.constructor=r,r.prototype.getPoint=i,r},Object.assign(ic.prototype,{createPointsGeometry:function(r){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getPoints(r);return this.createGeometry(i)},createSpacedPointsGeometry:function(r){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=this.getSpacedPoints(r);return this.createGeometry(i)},createGeometry:function(r){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const i=new Us;for(let n=0,l=r.length;n<l;n++){const u=r[n];i.vertices.push(new _e(u.x,u.y,u.z||0))}return i}}),Object.assign(Eo.prototype,{fromPoints:function(r){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(r)}});function I_(r){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),ks.call(this,r),this.type="catmullrom"}I_.prototype=Object.create(ks.prototype),Object.assign(I_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),aA.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},rA.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Li.prototype,{extractUrlBase:function(r){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),mh.extractUrlBase(r)}}),Li.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(iA.prototype,{center:function(r){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},size:function(r){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(Qo.prototype,{center:function(r){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(r)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(r){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionSphere:function(r){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)},size:function(r){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(r)}}),Object.assign(el.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),sp.prototype.setFromMatrix=function(r){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(r)},Object.assign(Gn,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(r){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Gn.floorPowerOfTwo(r)},nextPowerOfTwo:function(r){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Gn.ceilPowerOfTwo(r)}}),Object.assign(La.prototype,{flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},multiplyVector3:function(r){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),r.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(zn.prototype,{extractPosition:function(r){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(r)},flattenToArrayOffset:function(r,i){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(r,i)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new _e().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(r){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(r)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(r){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector4:function(r){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(r){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),r.transformDirection(this)},crossVector:function(r){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(r){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),r.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(r,i,n,l,u,h){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(r,i,l,n,u,h)}}),il.prototype.isIntersectionLine=function(r){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(r)},xa.prototype.multiplyVector3=function(r){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),r.applyQuaternion(this)},Object.assign(uf.prototype,{isIntersectionBox:function(r){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(r)},isIntersectionPlane:function(r){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(r)},isIntersectionSphere:function(r){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(r)}}),Object.assign(sa.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(r,i)},midpoint:function(r){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(r)},normal:function(r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(r)},plane:function(r){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(r)}}),Object.assign(sa,{barycoordFromPoint:function(r,i,n,l,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),sa.getBarycoord(r,i,n,l,u)},normal:function(r,i,n,l){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),sa.getNormal(r,i,n,l)}}),Object.assign(ph.prototype,{extractAllPoints:function(r){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(r)},extrude:function(r){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new w1(this,r)},makeGeometry:function(r){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new E1(this,r)}}),Object.assign(xt.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(_e.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(r){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(r)},getScaleFromMatrix:function(r){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(r)},getColumnFromMatrix:function(r,i){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(i,r)},applyProjection:function(r){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(r)},fromAttribute:function(r,i,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},distanceToManhattan:function(r){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(r)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Gi.prototype,{fromAttribute:function(r,i,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(r,i,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Us.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(r){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.assign(hn.prototype,{getChildByName:function(r){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(r)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(r,i){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(i,r)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(r){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(hn.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(r){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=r}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(ea.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(ea.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Lw},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(Gg.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(dp.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),fp.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(ln.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(r){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=r}}),Vr.prototype.setLens=function(r,i){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),i!==void 0&&(this.filmGauge=i),this.setFocalLength(r)},Object.defineProperties(Qi.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(r){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=r}},shadowCameraLeft:{set:function(r){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=r}},shadowCameraRight:{set:function(r){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=r}},shadowCameraTop:{set:function(r){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=r}},shadowCameraBottom:{set:function(r){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=r}},shadowCameraNear:{set:function(r){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=r}},shadowCameraFar:{set:function(r){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=r}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(r){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=r}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(r){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=r}},shadowMapHeight:{set:function(r){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=r}}}),Object.defineProperties(Nn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===of},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(of)}}}),Object.assign(Nn.prototype,{setDynamic:function(r){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?of:Wd),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(Oi.prototype,{addIndex:function(r){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(r)},addAttribute:function(r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(i&&i.isBufferAttribute)&&!(i&&i.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(r,new Nn(arguments[1],arguments[2]))):r==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(i),this):this.setAttribute(r,i)},addDrawCall:function(r,i,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(r,i)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(r){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(r)},applyMatrix:function(r){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(r)}}),Object.defineProperties(Oi.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Ip.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(r){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=r}}}),Object.defineProperties(A_.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(r){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=r}}}),Object.defineProperties(Ya.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===of},set:function(r){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(r)}}}),Object.assign(Ya.prototype,{setDynamic:function(r){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(r===!0?of:Wd),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(s_.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.assign(e1.prototype,{dispose:function(){console.error("THREE.Scene: .dispose() has been removed.")}}),Object.defineProperties(vv.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(bn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Kt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(r){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=r===Zr}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(r){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=r}}}),Object.defineProperties(jc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(ol.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(r){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=r}}}),Object.defineProperties(Ra.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(r){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=r}}}),Object.assign(op.prototype,{clearTarget:function(r,i,n,l){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(r),this.clear(i,n,l)},animate:function(r){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(r)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(r){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(r)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties(op.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=r}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(r){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=r}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(r){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=r===!0?Vd:Bc}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(B0.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Os.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=r}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(r){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=r}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=r}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(r){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=r}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(r){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=r}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(r){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=r}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(r){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=r}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(r){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=r}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(r){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=r}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(r){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=r}}}),Object.defineProperties(X1.prototype,{load:{value:function(r){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const i=this;return new pv().load(r,function(l){i.setBuffer(l)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),vf.prototype.updateCubeMap=function(r,i){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(r,i)},Gc.crossOrigin=void 0,Gc.loadTexture=function(r,i,n,l){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const u=new Rp;u.setCrossOrigin(this.crossOrigin);const h=u.load(r,n,void 0,l);return i&&(h.mapping=i),h},Gc.loadTextureCube=function(r,i,n,l){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const u=new tv;u.setCrossOrigin(this.crossOrigin);const h=u.load(r,n,void 0,l);return i&&(h.mapping=i),h},Gc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Gc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Nl}}));var Gf=function(r,i){i===void 0&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=r,this.domElement=i,this.enabled=!0,this.target=new _e,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:si.ROTATE,MIDDLE:si.DOLLY,RIGHT:si.PAN},this.touches={ONE:yn.ROTATE,TWO:yn.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return b.phi},this.getAzimuthalAngle=function(){return b.theta},this.saveState=function(){n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=function(){n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(l),n.update(),g=p.NONE},this.update=function(){var me=new _e,it=new xa().setFromUnitVectors(r.up,new _e(0,1,0)),Lt=it.clone().inverse(),pt=new _e,Dt=new xa,cn=2*Math.PI;return function(){var Rr=n.object.position;me.copy(Rr).sub(n.target),me.applyQuaternion(it),b.setFromVector3(me),n.autoRotate&&g===p.NONE&&qe(Ie()),n.enableDamping?(b.theta+=A.theta*n.dampingFactor,b.phi+=A.phi*n.dampingFactor):(b.theta+=A.theta,b.phi+=A.phi);var $i=n.minAzimuthAngle,Br=n.maxAzimuthAngle;return isFinite($i)&&isFinite(Br)&&($i<-Math.PI?$i+=cn:$i>Math.PI&&($i-=cn),Br<-Math.PI?Br+=cn:Br>Math.PI&&(Br-=cn),$i<Br?b.theta=Math.max($i,Math.min(Br,b.theta)):b.theta=b.theta>($i+Br)/2?Math.max($i,b.theta):Math.min(Br,b.theta)),b.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,b.phi)),b.makeSafe(),b.radius*=S,b.radius=Math.max(n.minDistance,Math.min(n.maxDistance,b.radius)),n.enableDamping===!0?n.target.addScaledVector(R,n.dampingFactor):n.target.add(R),me.setFromSpherical(b),me.applyQuaternion(Lt),Rr.copy(n.target).add(me),n.object.lookAt(n.target),n.enableDamping===!0?(A.theta*=1-n.dampingFactor,A.phi*=1-n.dampingFactor,R.multiplyScalar(1-n.dampingFactor)):(A.set(0,0,0),R.set(0,0,0)),S=1,E||pt.distanceToSquared(n.object.position)>_||8*(1-Dt.dot(n.object.quaternion))>_?(n.dispatchEvent(l),pt.copy(n.object.position),Dt.copy(n.object.quaternion),E=!1,!0):!1}}(),this.dispose=function(){n.domElement.removeEventListener("contextmenu",ct,!1),n.domElement.removeEventListener("pointerdown",ze,!1),n.domElement.removeEventListener("wheel",Ge,!1),n.domElement.removeEventListener("touchstart",Je,!1),n.domElement.removeEventListener("touchend",Nt,!1),n.domElement.removeEventListener("touchmove",lt,!1),n.domElement.ownerDocument.removeEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Xe,!1),n.domElement.removeEventListener("keydown",ue,!1)};var n=this,l={type:"change"},u={type:"start"},h={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},g=p.NONE,_=1e-6,b=new R_,A=new R_,S=1,R=new _e,E=!1,N=new xt,W=new xt,V=new xt,B=new xt,O=new xt,pe=new xt,ge=new xt,ye=new xt,Q=new xt;function Ie(){return 2*Math.PI/60/60*n.autoRotateSpeed}function tt(){return Math.pow(.95,n.zoomSpeed)}function qe(me){A.theta-=me}function ht(me){A.phi-=me}var Ye=function(){var me=new _e;return function(Lt,pt){me.setFromMatrixColumn(pt,0),me.multiplyScalar(-Lt),R.add(me)}}(),Ne=function(){var me=new _e;return function(Lt,pt){n.screenSpacePanning===!0?me.setFromMatrixColumn(pt,1):(me.setFromMatrixColumn(pt,0),me.crossVectors(n.object.up,me)),me.multiplyScalar(Lt),R.add(me)}}(),Ue=function(){var me=new _e;return function(Lt,pt){var Dt=n.domElement;if(n.object.isPerspectiveCamera){var cn=n.object.position;me.copy(cn).sub(n.target);var pi=me.length();pi*=Math.tan(n.object.fov/2*Math.PI/180),Ye(2*Lt*pi/Dt.clientHeight,n.object.matrix),Ne(2*pt*pi/Dt.clientHeight,n.object.matrix)}else n.object.isOrthographicCamera?(Ye(Lt*(n.object.right-n.object.left)/n.object.zoom/Dt.clientWidth,n.object.matrix),Ne(pt*(n.object.top-n.object.bottom)/n.object.zoom/Dt.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}}();function Le(me){n.object.isPerspectiveCamera?S/=me:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom*me)),n.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Te(me){n.object.isPerspectiveCamera?S*=me:n.object.isOrthographicCamera?(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/me)),n.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Ve(me){N.set(me.clientX,me.clientY)}function We(me){ge.set(me.clientX,me.clientY)}function rt(me){B.set(me.clientX,me.clientY)}function Tt(me){W.set(me.clientX,me.clientY),V.subVectors(W,N).multiplyScalar(n.rotateSpeed);var it=n.domElement;qe(2*Math.PI*V.x/it.clientHeight),ht(2*Math.PI*V.y/it.clientHeight),N.copy(W),n.update()}function nt(me){ye.set(me.clientX,me.clientY),Q.subVectors(ye,ge),Q.y>0?Le(tt()):Q.y<0&&Te(tt()),ge.copy(ye),n.update()}function Et(me){O.set(me.clientX,me.clientY),pe.subVectors(O,B).multiplyScalar(n.panSpeed),Ue(pe.x,pe.y),B.copy(O),n.update()}function $t(me){me.deltaY<0?Te(tt()):me.deltaY>0&&Le(tt()),n.update()}function Yt(me){var it=!1;switch(me.keyCode){case n.keys.UP:Ue(0,n.keyPanSpeed),it=!0;break;case n.keys.BOTTOM:Ue(0,-n.keyPanSpeed),it=!0;break;case n.keys.LEFT:Ue(n.keyPanSpeed,0),it=!0;break;case n.keys.RIGHT:Ue(-n.keyPanSpeed,0),it=!0;break}it&&(me.preventDefault(),n.update())}function K(me){if(me.touches.length==1)N.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Lt=.5*(me.touches[0].pageY+me.touches[1].pageY);N.set(it,Lt)}}function H(me){if(me.touches.length==1)B.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Lt=.5*(me.touches[0].pageY+me.touches[1].pageY);B.set(it,Lt)}}function xe(me){var it=me.touches[0].pageX-me.touches[1].pageX,Lt=me.touches[0].pageY-me.touches[1].pageY,pt=Math.sqrt(it*it+Lt*Lt);ge.set(0,pt)}function te(me){n.enableZoom&&xe(me),n.enablePan&&H(me)}function de(me){n.enableZoom&&xe(me),n.enableRotate&&K(me)}function be(me){if(me.touches.length==1)W.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Lt=.5*(me.touches[0].pageY+me.touches[1].pageY);W.set(it,Lt)}V.subVectors(W,N).multiplyScalar(n.rotateSpeed);var pt=n.domElement;qe(2*Math.PI*V.x/pt.clientHeight),ht(2*Math.PI*V.y/pt.clientHeight),N.copy(W)}function Re(me){if(me.touches.length==1)O.set(me.touches[0].pageX,me.touches[0].pageY);else{var it=.5*(me.touches[0].pageX+me.touches[1].pageX),Lt=.5*(me.touches[0].pageY+me.touches[1].pageY);O.set(it,Lt)}pe.subVectors(O,B).multiplyScalar(n.panSpeed),Ue(pe.x,pe.y),B.copy(O)}function we(me){var it=me.touches[0].pageX-me.touches[1].pageX,Lt=me.touches[0].pageY-me.touches[1].pageY,pt=Math.sqrt(it*it+Lt*Lt);ye.set(0,pt),Q.set(0,Math.pow(ye.y/ge.y,n.zoomSpeed)),Le(Q.y),ge.copy(ye)}function Se(me){n.enableZoom&&we(me),n.enablePan&&Re(me)}function Pe(me){n.enableZoom&&we(me),n.enableRotate&&be(me)}function ze(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":$(me);break}}function Ze(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":j(me);break}}function Xe(me){if(n.enabled!==!1)switch(me.pointerType){case"mouse":case"pen":He();break}}function $(me){me.preventDefault(),n.domElement.focus?n.domElement.focus():window.focus();var it;switch(me.button){case 0:it=n.mouseButtons.LEFT;break;case 1:it=n.mouseButtons.MIDDLE;break;case 2:it=n.mouseButtons.RIGHT;break;default:it=-1}switch(it){case si.DOLLY:if(n.enableZoom===!1)return;We(me),g=p.DOLLY;break;case si.ROTATE:if(me.ctrlKey||me.metaKey||me.shiftKey){if(n.enablePan===!1)return;rt(me),g=p.PAN}else{if(n.enableRotate===!1)return;Ve(me),g=p.ROTATE}break;case si.PAN:if(me.ctrlKey||me.metaKey||me.shiftKey){if(n.enableRotate===!1)return;Ve(me),g=p.ROTATE}else{if(n.enablePan===!1)return;rt(me),g=p.PAN}break;default:g=p.NONE}g!==p.NONE&&(n.domElement.ownerDocument.addEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.addEventListener("pointerup",Xe,!1),n.dispatchEvent(u))}function j(me){if(n.enabled!==!1)switch(me.preventDefault(),g){case p.ROTATE:if(n.enableRotate===!1)return;Tt(me);break;case p.DOLLY:if(n.enableZoom===!1)return;nt(me);break;case p.PAN:if(n.enablePan===!1)return;Et(me);break}}function He(me){n.enabled!==!1&&(n.domElement.ownerDocument.removeEventListener("pointermove",Ze,!1),n.domElement.ownerDocument.removeEventListener("pointerup",Xe,!1),n.dispatchEvent(h),g=p.NONE)}function Ge(me){n.enabled===!1||n.enableZoom===!1||g!==p.NONE&&g!==p.ROTATE||(me.preventDefault(),me.stopPropagation(),n.dispatchEvent(u),$t(me),n.dispatchEvent(h))}function ue(me){n.enabled===!1||n.enableKeys===!1||n.enablePan===!1||Yt(me)}function Je(me){if(n.enabled!==!1){switch(me.preventDefault(),me.touches.length){case 1:switch(n.touches.ONE){case yn.ROTATE:if(n.enableRotate===!1)return;K(me),g=p.TOUCH_ROTATE;break;case yn.PAN:if(n.enablePan===!1)return;H(me),g=p.TOUCH_PAN;break;default:g=p.NONE}break;case 2:switch(n.touches.TWO){case yn.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;te(me),g=p.TOUCH_DOLLY_PAN;break;case yn.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;de(me),g=p.TOUCH_DOLLY_ROTATE;break;default:g=p.NONE}break;default:g=p.NONE}g!==p.NONE&&n.dispatchEvent(u)}}function lt(me){if(n.enabled!==!1)switch(me.preventDefault(),me.stopPropagation(),g){case p.TOUCH_ROTATE:if(n.enableRotate===!1)return;be(me),n.update();break;case p.TOUCH_PAN:if(n.enablePan===!1)return;Re(me),n.update();break;case p.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Se(me),n.update();break;case p.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Pe(me),n.update();break;default:g=p.NONE}}function Nt(me){n.enabled!==!1&&(n.dispatchEvent(h),g=p.NONE)}function ct(me){n.enabled!==!1&&me.preventDefault()}n.domElement.addEventListener("contextmenu",ct,!1),n.domElement.addEventListener("pointerdown",ze,!1),n.domElement.addEventListener("wheel",Ge,!1),n.domElement.addEventListener("touchstart",Je,!1),n.domElement.addEventListener("touchend",Nt,!1),n.domElement.addEventListener("touchmove",lt,!1),n.domElement.addEventListener("keydown",ue,!1),n.domElement.tabIndex===-1&&(n.domElement.tabIndex=0),this.update()};Gf.prototype=Object.create(Ds.prototype),Gf.prototype.constructor=Gf;var xv=function(r,i){Gf.call(this,r,i),this.screenSpacePanning=!1,this.mouseButtons.LEFT=si.PAN,this.mouseButtons.RIGHT=si.ROTATE,this.touches.ONE=yn.PAN,this.touches.TWO=yn.DOLLY_ROTATE};xv.prototype=Object.create(Ds.prototype),xv.prototype.constructor=xv;var sA=function(){function r(K){Li.call(this,K),this.dracoLoader=null,this.ddsLoader=null,this.ktx2Loader=null,this.pluginCallbacks=[],this.register(function(H){return new p(H)}),this.register(function(H){return new _(H)}),this.register(function(H){return new g(H)}),this.register(function(H){return new u(H)})}r.prototype=Object.assign(Object.create(Li.prototype),{constructor:r,load:function(K,H,xe,te){var de=this,be;this.resourcePath!==""?be=this.resourcePath:this.path!==""?be=this.path:be=mh.extractUrlBase(K),this.manager.itemStart(K);var Re=function(Se){te?te(Se):console.error(Se),de.manager.itemError(K),de.manager.itemEnd(K)},we=new Hs(this.manager);we.setPath(this.path),we.setResponseType("arraybuffer"),we.setRequestHeader(this.requestHeader),we.setWithCredentials(this.withCredentials),we.load(K,function(Se){try{de.parse(Se,be,function(Pe){H(Pe),de.manager.itemEnd(K)},Re)}catch(Pe){Re(Pe)}},xe,Re)},setDRACOLoader:function(K){return this.dracoLoader=K,this},setDDSLoader:function(K){return this.ddsLoader=K,this},setKTX2Loader:function(K){return this.ktx2Loader=K,this},register:function(K){return this.pluginCallbacks.indexOf(K)===-1&&this.pluginCallbacks.push(K),this},unregister:function(K){return this.pluginCallbacks.indexOf(K)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(K),1),this},parse:function(K,H,xe,te){var de,be={},Re={};if(typeof K=="string")de=K;else{var we=mh.decodeText(new Uint8Array(K,0,4));if(we===b){try{be[n.KHR_BINARY_GLTF]=new R(K)}catch(j){te&&te(j);return}de=be[n.KHR_BINARY_GLTF].content}else de=mh.decodeText(new Uint8Array(K))}var Se=JSON.parse(de);if(Se.asset===void 0||Se.asset.version[0]<2){te&&te(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}var Pe=new nt(Se,{path:H||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager,ktx2Loader:this.ktx2Loader});Pe.fileLoader.setRequestHeader(this.requestHeader);for(var ze=0;ze<this.pluginCallbacks.length;ze++){var Ze=this.pluginCallbacks[ze](Pe);Re[Ze.name]=Ze,be[Ze.name]=!0}if(Se.extensionsUsed)for(var ze=0;ze<Se.extensionsUsed.length;++ze){var Xe=Se.extensionsUsed[ze],$=Se.extensionsRequired||[];switch(Xe){case n.KHR_MATERIALS_UNLIT:be[Xe]=new h;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:be[Xe]=new V;break;case n.KHR_DRACO_MESH_COMPRESSION:be[Xe]=new E(Se,this.dracoLoader);break;case n.MSFT_TEXTURE_DDS:be[Xe]=new l(this.ddsLoader);break;case n.KHR_TEXTURE_TRANSFORM:be[Xe]=new N;break;case n.KHR_MESH_QUANTIZATION:be[Xe]=new B;break;default:$.indexOf(Xe)>=0&&Re[Xe]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Xe+'".')}}Pe.setExtensions(be),Pe.setPlugins(Re),Pe.parse(xe,te)}});function i(){var K={};return{get:function(H){return K[H]},add:function(H,xe){K[H]=xe},remove:function(H){delete K[H]},removeAll:function(){K={}}}}var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function l(K){if(!K)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=n.MSFT_TEXTURE_DDS,this.ddsLoader=K}function u(K){this.parser=K,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}u.prototype._markDefs=function(){for(var K=this.parser,H=this.parser.json.nodes||[],xe=0,te=H.length;xe<te;xe++){var de=H[xe];de.extensions&&de.extensions[this.name]&&de.extensions[this.name].light!==void 0&&K._addNodeRef(this.cache,de.extensions[this.name].light)}},u.prototype._loadLight=function(K){var H=this.parser,xe="light:"+K,te=H.cache.get(xe);if(te)return te;var de=H.json,be=de.extensions&&de.extensions[this.name]||{},Re=be.lights||[],we=Re[K],Se,Pe=new Kt(16777215);we.color!==void 0&&Pe.fromArray(we.color);var ze=we.range!==void 0?we.range:0;switch(we.type){case"directional":Se=new hv(Pe),Se.target.position.set(0,0,-1),Se.add(Se.target);break;case"point":Se=new cv(Pe),Se.distance=ze;break;case"spot":Se=new ov(Pe),Se.distance=ze,we.spot=we.spot||{},we.spot.innerConeAngle=we.spot.innerConeAngle!==void 0?we.spot.innerConeAngle:0,we.spot.outerConeAngle=we.spot.outerConeAngle!==void 0?we.spot.outerConeAngle:Math.PI/4,Se.angle=we.spot.outerConeAngle,Se.penumbra=1-we.spot.innerConeAngle/we.spot.outerConeAngle,Se.target.position.set(0,0,-1),Se.add(Se.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+we.type+'".')}return Se.position.set(0,0,0),Se.decay=2,we.intensity!==void 0&&(Se.intensity=we.intensity),Se.name=H.createUniqueName(we.name||"light_"+K),te=Promise.resolve(Se),H.cache.add(xe,te),te},u.prototype.createNodeAttachment=function(K){var H=this,xe=this.parser,te=xe.json,de=te.nodes[K],be=de.extensions&&de.extensions[this.name]||{},Re=be.light;return Re===void 0?null:this._loadLight(Re).then(function(we){return xe._getNodeRef(H.cache,Re,we)})};function h(){this.name=n.KHR_MATERIALS_UNLIT}h.prototype.getMaterialType=function(){return ds},h.prototype.extendParams=function(K,H,xe){var te=[];K.color=new Kt(1,1,1),K.opacity=1;var de=H.pbrMetallicRoughness;if(de){if(Array.isArray(de.baseColorFactor)){var be=de.baseColorFactor;K.color.fromArray(be),K.opacity=be[3]}de.baseColorTexture!==void 0&&te.push(xe.assignTexture(K,"map",de.baseColorTexture))}return Promise.all(te)};function p(K){this.parser=K,this.name=n.KHR_MATERIALS_CLEARCOAT}p.prototype.getMaterialType=function(K){var H=this.parser,xe=H.json.materials[K];return!xe.extensions||!xe.extensions[this.name]?null:ol},p.prototype.extendMaterialParams=function(K,H){var xe=this.parser,te=xe.json.materials[K];if(!te.extensions||!te.extensions[this.name])return Promise.resolve();var de=[],be=te.extensions[this.name];if(be.clearcoatFactor!==void 0&&(H.clearcoat=be.clearcoatFactor),be.clearcoatTexture!==void 0&&de.push(xe.assignTexture(H,"clearcoatMap",be.clearcoatTexture)),be.clearcoatRoughnessFactor!==void 0&&(H.clearcoatRoughness=be.clearcoatRoughnessFactor),be.clearcoatRoughnessTexture!==void 0&&de.push(xe.assignTexture(H,"clearcoatRoughnessMap",be.clearcoatRoughnessTexture)),be.clearcoatNormalTexture!==void 0&&(de.push(xe.assignTexture(H,"clearcoatNormalMap",be.clearcoatNormalTexture)),be.clearcoatNormalTexture.scale!==void 0)){var Re=be.clearcoatNormalTexture.scale;H.clearcoatNormalScale=new xt(Re,Re)}return Promise.all(de)};function g(K){this.parser=K,this.name=n.KHR_MATERIALS_TRANSMISSION}g.prototype.getMaterialType=function(K){var H=this.parser,xe=H.json.materials[K];return!xe.extensions||!xe.extensions[this.name]?null:ol},g.prototype.extendMaterialParams=function(K,H){var xe=this.parser,te=xe.json.materials[K];if(!te.extensions||!te.extensions[this.name])return Promise.resolve();var de=[],be=te.extensions[this.name];return be.transmissionFactor!==void 0&&(H.transmission=be.transmissionFactor),be.transmissionTexture!==void 0&&de.push(xe.assignTexture(H,"transmissionMap",be.transmissionTexture)),Promise.all(de)};function _(K){this.parser=K,this.name=n.KHR_TEXTURE_BASISU}_.prototype.loadTexture=function(K){var H=this.parser,xe=H.json,te=xe.textures[K];if(!te.extensions||!te.extensions[this.name])return null;var de=te.extensions[this.name],be=xe.images[de.source],Re=H.options.ktx2Loader;if(!Re)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return H.loadTextureImage(K,be,Re)};var b="glTF",A=12,S={JSON:1313821514,BIN:5130562};function R(K){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var H=new DataView(K,0,A);if(this.header={magic:mh.decodeText(new Uint8Array(K.slice(0,4))),version:H.getUint32(4,!0),length:H.getUint32(8,!0)},this.header.magic!==b)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var xe=new DataView(K,A),te=0;te<xe.byteLength;){var de=xe.getUint32(te,!0);te+=4;var be=xe.getUint32(te,!0);if(te+=4,be===S.JSON){var Re=new Uint8Array(K,A+te,de);this.content=mh.decodeText(Re)}else if(be===S.BIN){var we=A+te;this.body=K.slice(we,we+de)}te+=de}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}function E(K,H){if(!H)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=K,this.dracoLoader=H,this.dracoLoader.preload()}E.prototype.decodePrimitive=function(K,H){var xe=this.json,te=this.dracoLoader,de=K.extensions[this.name].bufferView,be=K.extensions[this.name].attributes,Re={},we={},Se={};for(var Pe in be){var ze=tt[Pe]||Pe.toLowerCase();Re[ze]=be[Pe]}for(Pe in K.attributes){var ze=tt[Pe]||Pe.toLowerCase();if(be[Pe]!==void 0){var Ze=xe.accessors[K.attributes[Pe]],Xe=ge[Ze.componentType];Se[ze]=Xe,we[ze]=Ze.normalized===!0}}return H.getDependency("bufferView",de).then(function($){return new Promise(function(j){te.decodeDracoFile($,function(He){for(var Ge in He.attributes){var ue=He.attributes[Ge],Je=we[Ge];Je!==void 0&&(ue.normalized=Je)}j(He)},Re,Se)})})};function N(){this.name=n.KHR_TEXTURE_TRANSFORM}N.prototype.extendTexture=function(K,H){return K=K.clone(),H.offset!==void 0&&K.offset.fromArray(H.offset),H.rotation!==void 0&&(K.rotation=H.rotation),H.scale!==void 0&&K.repeat.fromArray(H.scale),H.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),K.needsUpdate=!0,K};function W(K){Ca.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var H=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),xe=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),te=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	texelSpecular = sRGBToLinear( texelSpecular );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),de=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),be=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),Re={specular:{value:new Kt().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=Re,this.onBeforeCompile=function(we){for(var Se in Re)we.uniforms[Se]=Re[Se];we.fragmentShader=we.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",H).replace("#include <metalnessmap_pars_fragment>",xe).replace("#include <roughnessmap_fragment>",te).replace("#include <metalnessmap_fragment>",de).replace("#include <lights_physical_fragment>",be)},Object.defineProperties(this,{specular:{get:function(){return Re.specular.value},set:function(we){Re.specular.value=we}},specularMap:{get:function(){return Re.specularMap.value},set:function(we){Re.specularMap.value=we,we?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return Re.glossiness.value},set:function(we){Re.glossiness.value=we}},glossinessMap:{get:function(){return Re.glossinessMap.value},set:function(we){Re.glossinessMap.value=we,we?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(K)}W.prototype=Object.create(Ca.prototype),W.prototype.constructor=W,W.prototype.copy=function(K){return Ca.prototype.copy.call(this,K),this.specularMap=K.specularMap,this.specular.copy(K.specular),this.glossinessMap=K.glossinessMap,this.glossiness=K.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this};function V(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return W},extendParams:function(K,H,xe){var te=H.extensions[this.name];K.color=new Kt(1,1,1),K.opacity=1;var de=[];if(Array.isArray(te.diffuseFactor)){var be=te.diffuseFactor;K.color.fromArray(be),K.opacity=be[3]}if(te.diffuseTexture!==void 0&&de.push(xe.assignTexture(K,"map",te.diffuseTexture)),K.emissive=new Kt(0,0,0),K.glossiness=te.glossinessFactor!==void 0?te.glossinessFactor:1,K.specular=new Kt(1,1,1),Array.isArray(te.specularFactor)&&K.specular.fromArray(te.specularFactor),te.specularGlossinessTexture!==void 0){var Re=te.specularGlossinessTexture;de.push(xe.assignTexture(K,"glossinessMap",Re)),de.push(xe.assignTexture(K,"specularMap",Re))}return Promise.all(de)},createMaterial:function(K){var H=new W(K);return H.fog=!0,H.color=K.color,H.map=K.map===void 0?null:K.map,H.lightMap=null,H.lightMapIntensity=1,H.aoMap=K.aoMap===void 0?null:K.aoMap,H.aoMapIntensity=1,H.emissive=K.emissive,H.emissiveIntensity=1,H.emissiveMap=K.emissiveMap===void 0?null:K.emissiveMap,H.bumpMap=K.bumpMap===void 0?null:K.bumpMap,H.bumpScale=1,H.normalMap=K.normalMap===void 0?null:K.normalMap,H.normalMapType=Uc,K.normalScale&&(H.normalScale=K.normalScale),H.displacementMap=null,H.displacementScale=1,H.displacementBias=0,H.specularMap=K.specularMap===void 0?null:K.specularMap,H.specular=K.specular,H.glossinessMap=K.glossinessMap===void 0?null:K.glossinessMap,H.glossiness=K.glossiness,H.alphaMap=null,H.envMap=K.envMap===void 0?null:K.envMap,H.envMapIntensity=1,H.refractionRatio=.98,H}}}function B(){this.name=n.KHR_MESH_QUANTIZATION}function O(K,H,xe,te){Pa.call(this,K,H,xe,te)}O.prototype=Object.create(Pa.prototype),O.prototype.constructor=O,O.prototype.copySampleValue_=function(K){for(var H=this.resultBuffer,xe=this.sampleValues,te=this.valueSize,de=K*te*3+te,be=0;be!==te;be++)H[be]=xe[de+be];return H},O.prototype.beforeStart_=O.prototype.copySampleValue_,O.prototype.afterEnd_=O.prototype.copySampleValue_,O.prototype.interpolate_=function(K,H,xe,te){for(var de=this.resultBuffer,be=this.sampleValues,Re=this.valueSize,we=Re*2,Se=Re*3,Pe=te-H,ze=(xe-H)/Pe,Ze=ze*ze,Xe=Ze*ze,$=K*Se,j=$-Se,He=-2*Xe+3*Ze,Ge=Xe-Ze,ue=1-He,Je=Ge-Ze+ze,lt=0;lt!==Re;lt++){var Nt=be[j+lt+Re],ct=be[j+lt+we]*Pe,me=be[$+lt+Re],it=be[$+lt]*Pe;de[lt]=ue*Nt+Je*ct+He*me+Ge*it}return de};var pe={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ge={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ye={9728:St,9729:Sn,9984:On,9985:Mr,9986:_i,9987:Cu},Q={33071:Qr,33648:bt,10497:kl},Ie={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},tt={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},qe={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ht={CUBICSPLINE:void 0,LINEAR:Iu,STEP:sf},Ye={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ne(K,H){return typeof K!="string"||K===""?"":(/^https?:\/\//i.test(H)&&/^\//.test(K)&&(H=H.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(K)||/^data:.*,.*$/i.test(K)||/^blob:.*$/i.test(K)?K:H+K)}function Ue(K){return K.DefaultMaterial===void 0&&(K.DefaultMaterial=new Ca({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ui})),K.DefaultMaterial}function Le(K,H,xe){for(var te in xe.extensions)K[te]===void 0&&(H.userData.gltfExtensions=H.userData.gltfExtensions||{},H.userData.gltfExtensions[te]=xe.extensions[te])}function Te(K,H){H.extras!==void 0&&(typeof H.extras=="object"?Object.assign(K.userData,H.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+H.extras))}function Ve(K,H,xe){for(var te=!1,de=!1,be=0,Re=H.length;be<Re;be++){var we=H[be];if(we.POSITION!==void 0&&(te=!0),we.NORMAL!==void 0&&(de=!0),te&&de)break}if(!te&&!de)return Promise.resolve(K);for(var Se=[],Pe=[],be=0,Re=H.length;be<Re;be++){var we=H[be];if(te){var ze=we.POSITION!==void 0?xe.getDependency("accessor",we.POSITION):K.attributes.position;Se.push(ze)}if(de){var ze=we.NORMAL!==void 0?xe.getDependency("accessor",we.NORMAL):K.attributes.normal;Pe.push(ze)}}return Promise.all([Promise.all(Se),Promise.all(Pe)]).then(function(Ze){var Xe=Ze[0],$=Ze[1];return te&&(K.morphAttributes.position=Xe),de&&(K.morphAttributes.normal=$),K.morphTargetsRelative=!0,K})}function We(K,H){if(K.updateMorphTargets(),H.weights!==void 0)for(var xe=0,te=H.weights.length;xe<te;xe++)K.morphTargetInfluences[xe]=H.weights[xe];if(H.extras&&Array.isArray(H.extras.targetNames)){var de=H.extras.targetNames;if(K.morphTargetInfluences.length===de.length){K.morphTargetDictionary={};for(var xe=0,te=de.length;xe<te;xe++)K.morphTargetDictionary[de[xe]]=xe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function rt(K){var H=K.extensions&&K.extensions[n.KHR_DRACO_MESH_COMPRESSION],xe;return H?xe="draco:"+H.bufferView+":"+H.indices+":"+Tt(H.attributes):xe=K.indices+":"+Tt(K.attributes)+":"+K.mode,xe}function Tt(K){for(var H="",xe=Object.keys(K).sort(),te=0,de=xe.length;te<de;te++)H+=xe[te]+":"+K[xe[te]]+";";return H}function nt(K,H){this.json=K||{},this.extensions={},this.plugins={},this.options=H||{},this.cache=new i,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox/.test(navigator.userAgent)===!1?this.textureLoader=new dv(this.options.manager):this.textureLoader=new Rp(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Hs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}nt.prototype.setExtensions=function(K){this.extensions=K},nt.prototype.setPlugins=function(K){this.plugins=K},nt.prototype.parse=function(K,H){var xe=this,te=this.json,de=this.extensions;this.cache.removeAll(),this._invokeAll(function(be){return be._markDefs&&be._markDefs()}),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(be){var Re={scene:be[0][te.scene||0],scenes:be[0],animations:be[1],cameras:be[2],asset:te.asset,parser:xe,userData:{}};Le(de,Re,te),Te(Re,te),K(Re)}).catch(H)},nt.prototype._markDefs=function(){for(var K=this.json.nodes||[],H=this.json.skins||[],xe=this.json.meshes||[],te=0,de=H.length;te<de;te++)for(var be=H[te].joints,Re=0,we=be.length;Re<we;Re++)K[be[Re]].isBone=!0;for(var Se=0,Pe=K.length;Se<Pe;Se++){var ze=K[Se];ze.mesh!==void 0&&(this._addNodeRef(this.meshCache,ze.mesh),ze.skin!==void 0&&(xe[ze.mesh].isSkinnedMesh=!0)),ze.camera!==void 0&&this._addNodeRef(this.cameraCache,ze.camera)}},nt.prototype._addNodeRef=function(K,H){H!==void 0&&(K.refs[H]===void 0&&(K.refs[H]=K.uses[H]=0),K.refs[H]++)},nt.prototype._getNodeRef=function(K,H,xe){if(K.refs[H]<=1)return xe;var te=xe.clone();return te.name+="_instance_"+K.uses[H]++,te},nt.prototype._invokeOne=function(K){var H=Object.values(this.plugins);H.push(this);for(var xe=0;xe<H.length;xe++){var te=K(H[xe]);if(te)return te}},nt.prototype._invokeAll=function(K){var H=Object.values(this.plugins);H.unshift(this);for(var xe=[],te=0;te<H.length;te++){var de=K(H[te]);de&&xe.push(de)}return xe},nt.prototype.getDependency=function(K,H){var xe=K+":"+H,te=this.cache.get(xe);if(!te){switch(K){case"scene":te=this.loadScene(H);break;case"node":te=this.loadNode(H);break;case"mesh":te=this._invokeOne(function(de){return de.loadMesh&&de.loadMesh(H)});break;case"accessor":te=this.loadAccessor(H);break;case"bufferView":te=this._invokeOne(function(de){return de.loadBufferView&&de.loadBufferView(H)});break;case"buffer":te=this.loadBuffer(H);break;case"material":te=this._invokeOne(function(de){return de.loadMaterial&&de.loadMaterial(H)});break;case"texture":te=this._invokeOne(function(de){return de.loadTexture&&de.loadTexture(H)});break;case"skin":te=this.loadSkin(H);break;case"animation":te=this.loadAnimation(H);break;case"camera":te=this.loadCamera(H);break;default:throw new Error("Unknown type: "+K)}this.cache.add(xe,te)}return te},nt.prototype.getDependencies=function(K){var H=this.cache.get(K);if(!H){var xe=this,te=this.json[K+(K==="mesh"?"es":"s")]||[];H=Promise.all(te.map(function(de,be){return xe.getDependency(K,be)})),this.cache.add(K,H)}return H},nt.prototype.loadBuffer=function(K){var H=this.json.buffers[K],xe=this.fileLoader;if(H.type&&H.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+H.type+" buffer type is not supported.");if(H.uri===void 0&&K===0)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var te=this.options;return new Promise(function(de,be){xe.load(Ne(H.uri,te.path),de,void 0,function(){be(new Error('THREE.GLTFLoader: Failed to load buffer "'+H.uri+'".'))})})},nt.prototype.loadBufferView=function(K){var H=this.json.bufferViews[K];return this.getDependency("buffer",H.buffer).then(function(xe){var te=H.byteLength||0,de=H.byteOffset||0;return xe.slice(de,de+te)})},nt.prototype.loadAccessor=function(K){var H=this,xe=this.json,te=this.json.accessors[K];if(te.bufferView===void 0&&te.sparse===void 0)return Promise.resolve(null);var de=[];return te.bufferView!==void 0?de.push(this.getDependency("bufferView",te.bufferView)):de.push(null),te.sparse!==void 0&&(de.push(this.getDependency("bufferView",te.sparse.indices.bufferView)),de.push(this.getDependency("bufferView",te.sparse.values.bufferView))),Promise.all(de).then(function(be){var Re=be[0],we=Ie[te.type],Se=ge[te.componentType],Pe=Se.BYTES_PER_ELEMENT,ze=Pe*we,Ze=te.byteOffset||0,Xe=te.bufferView!==void 0?xe.bufferViews[te.bufferView].byteStride:void 0,$=te.normalized===!0,j,He;if(Xe&&Xe!==ze){var Ge=Math.floor(Ze/Xe),ue="InterleavedBuffer:"+te.bufferView+":"+te.componentType+":"+Ge+":"+te.count,Je=H.cache.get(ue);Je||(j=new Se(Re,Ge*Xe,te.count*Xe/Pe),Je=new Ya(j,Xe/Pe),H.cache.add(ue,Je)),He=new $l(Je,we,Ze%Xe/Pe,$)}else Re===null?j=new Se(te.count*we):j=new Se(Re,Ze,te.count*we),He=new Nn(j,we,$);if(te.sparse!==void 0){var lt=Ie.SCALAR,Nt=ge[te.sparse.indices.componentType],ct=te.sparse.indices.byteOffset||0,me=te.sparse.values.byteOffset||0,it=new Nt(be[1],ct,te.sparse.count*lt),Lt=new Se(be[2],me,te.sparse.count*we);Re!==null&&(He=new Nn(He.array.slice(),He.itemSize,He.normalized));for(var pt=0,Dt=it.length;pt<Dt;pt++){var cn=it[pt];if(He.setX(cn,Lt[pt*we]),we>=2&&He.setY(cn,Lt[pt*we+1]),we>=3&&He.setZ(cn,Lt[pt*we+2]),we>=4&&He.setW(cn,Lt[pt*we+3]),we>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return He})},nt.prototype.loadTexture=function(K){var H=this,xe=this.json,te=this.options,de=xe.textures[K],be=de.extensions||{},Re;be[n.MSFT_TEXTURE_DDS]?Re=xe.images[be[n.MSFT_TEXTURE_DDS].source]:Re=xe.images[de.source];var we;return Re.uri&&(we=te.manager.getHandler(Re.uri)),we||(we=be[n.MSFT_TEXTURE_DDS]?H.extensions[n.MSFT_TEXTURE_DDS].ddsLoader:this.textureLoader),this.loadTextureImage(K,Re,we)},nt.prototype.loadTextureImage=function(K,H,xe){var te=this,de=this.json,be=this.options,Re=de.textures[K],we=self.URL||self.webkitURL,Se=H.uri,Pe=!1,ze=!0;return H.mimeType==="image/jpeg"&&(ze=!1),H.bufferView!==void 0&&(Se=te.getDependency("bufferView",H.bufferView).then(function(Ze){if(H.mimeType==="image/png"){var Xe=new DataView(Ze,25,1).getUint8(0,!1);ze=Xe===6||Xe===4||Xe===3}Pe=!0;var $=new Blob([Ze],{type:H.mimeType});return Se=we.createObjectURL($),Se})),Promise.resolve(Se).then(function(Ze){return new Promise(function(Xe,$){var j=Xe;xe.isImageBitmapLoader===!0&&(j=function(He){Xe(new Rf(He))}),xe.load(Ne(Ze,be.path),j,void 0,$)})}).then(function(Ze){Pe===!0&&we.revokeObjectURL(Se),Ze.flipY=!1,Re.name&&(Ze.name=Re.name),ze||(Ze.format=yo);var Xe=de.samplers||{},$=Xe[Re.sampler]||{};return Ze.magFilter=ye[$.magFilter]||Sn,Ze.minFilter=ye[$.minFilter]||Cu,Ze.wrapS=Q[$.wrapS]||kl,Ze.wrapT=Q[$.wrapT]||kl,te.associations.set(Ze,{type:"textures",index:K}),Ze})},nt.prototype.assignTexture=function(K,H,xe){var te=this;return this.getDependency("texture",xe.index).then(function(de){if(xe.texCoord!==void 0&&xe.texCoord!=0&&!(H==="aoMap"&&xe.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+xe.texCoord+" for texture "+H+" not yet supported."),te.extensions[n.KHR_TEXTURE_TRANSFORM]){var be=xe.extensions!==void 0?xe.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(be){var Re=te.associations.get(de);de=te.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(de,be),te.associations.set(de,Re)}}K[H]=de})},nt.prototype.assignFinalMaterial=function(K){var H=K.geometry,xe=K.material,te=H.attributes.tangent!==void 0,de=H.attributes.color!==void 0,be=H.attributes.normal===void 0,Re=K.isSkinnedMesh===!0,we=Object.keys(H.morphAttributes).length>0,Se=we&&H.morphAttributes.normal!==void 0;if(K.isPoints){var Pe="PointsMaterial:"+xe.uuid,ze=this.cache.get(Pe);ze||(ze=new ec,bn.prototype.copy.call(ze,xe),ze.color.copy(xe.color),ze.map=xe.map,ze.sizeAttenuation=!1,this.cache.add(Pe,ze)),xe=ze}else if(K.isLine){var Pe="LineBasicMaterial:"+xe.uuid,Ze=this.cache.get(Pe);Ze||(Ze=new ja,bn.prototype.copy.call(Ze,xe),Ze.color.copy(xe.color),this.cache.add(Pe,Ze)),xe=Ze}if(te||de||be||Re||we){var Pe="ClonedMaterial:"+xe.uuid+":";xe.isGLTFSpecularGlossinessMaterial&&(Pe+="specular-glossiness:"),Re&&(Pe+="skinning:"),te&&(Pe+="vertex-tangents:"),de&&(Pe+="vertex-colors:"),be&&(Pe+="flat-shading:"),we&&(Pe+="morph-targets:"),Se&&(Pe+="morph-normals:");var Xe=this.cache.get(Pe);Xe||(Xe=xe.clone(),Re&&(Xe.skinning=!0),te&&(Xe.vertexTangents=!0),de&&(Xe.vertexColors=!0),be&&(Xe.flatShading=!0),we&&(Xe.morphTargets=!0),Se&&(Xe.morphNormals=!0),this.cache.add(Pe,Xe),this.associations.set(Xe,this.associations.get(xe))),xe=Xe}xe.aoMap&&H.attributes.uv2===void 0&&H.attributes.uv!==void 0&&H.setAttribute("uv2",H.attributes.uv),xe.normalScale&&!te&&(xe.normalScale.y=-xe.normalScale.y),xe.clearcoatNormalScale&&!te&&(xe.clearcoatNormalScale.y=-xe.clearcoatNormalScale.y),K.material=xe},nt.prototype.getMaterialType=function(){return Ca},nt.prototype.loadMaterial=function(K){var H=this,xe=this.json,te=this.extensions,de=xe.materials[K],be,Re={},we=de.extensions||{},Se=[];if(we[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var Pe=te[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];be=Pe.getMaterialType(),Se.push(Pe.extendParams(Re,de,H))}else if(we[n.KHR_MATERIALS_UNLIT]){var ze=te[n.KHR_MATERIALS_UNLIT];be=ze.getMaterialType(),Se.push(ze.extendParams(Re,de,H))}else{var Ze=de.pbrMetallicRoughness||{};if(Re.color=new Kt(1,1,1),Re.opacity=1,Array.isArray(Ze.baseColorFactor)){var Xe=Ze.baseColorFactor;Re.color.fromArray(Xe),Re.opacity=Xe[3]}Ze.baseColorTexture!==void 0&&Se.push(H.assignTexture(Re,"map",Ze.baseColorTexture)),Re.metalness=Ze.metallicFactor!==void 0?Ze.metallicFactor:1,Re.roughness=Ze.roughnessFactor!==void 0?Ze.roughnessFactor:1,Ze.metallicRoughnessTexture!==void 0&&(Se.push(H.assignTexture(Re,"metalnessMap",Ze.metallicRoughnessTexture)),Se.push(H.assignTexture(Re,"roughnessMap",Ze.metallicRoughnessTexture))),be=this._invokeOne(function(j){return j.getMaterialType&&j.getMaterialType(K)}),Se.push(Promise.all(this._invokeAll(function(j){return j.extendMaterialParams&&j.extendMaterialParams(K,Re)})))}de.doubleSided===!0&&(Re.side=Dn);var $=de.alphaMode||Ye.OPAQUE;return $===Ye.BLEND?(Re.transparent=!0,Re.depthWrite=!1):(Re.transparent=!1,$===Ye.MASK&&(Re.alphaTest=de.alphaCutoff!==void 0?de.alphaCutoff:.5)),de.normalTexture!==void 0&&be!==ds&&(Se.push(H.assignTexture(Re,"normalMap",de.normalTexture)),Re.normalScale=new xt(1,1),de.normalTexture.scale!==void 0&&Re.normalScale.set(de.normalTexture.scale,de.normalTexture.scale)),de.occlusionTexture!==void 0&&be!==ds&&(Se.push(H.assignTexture(Re,"aoMap",de.occlusionTexture)),de.occlusionTexture.strength!==void 0&&(Re.aoMapIntensity=de.occlusionTexture.strength)),de.emissiveFactor!==void 0&&be!==ds&&(Re.emissive=new Kt().fromArray(de.emissiveFactor)),de.emissiveTexture!==void 0&&be!==ds&&Se.push(H.assignTexture(Re,"emissiveMap",de.emissiveTexture)),Promise.all(Se).then(function(){var j;return be===W?j=te[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(Re):j=new be(Re),de.name&&(j.name=de.name),j.map&&(j.map.encoding=Vd),j.emissiveMap&&(j.emissiveMap.encoding=Vd),Te(j,de),H.associations.set(j,{type:"materials",index:K}),de.extensions&&Le(te,j,de),j})},nt.prototype.createUniqueName=function(K){for(var H=ca.sanitizeNodeName(K||""),xe=1;this.nodeNamesUsed[H];++xe)H=K+"_"+xe;return this.nodeNamesUsed[H]=!0,H};function Et(K,H,xe){var te=H.attributes,de=new Qo;if(te.POSITION!==void 0){var be=xe.json.accessors[te.POSITION],Re=be.min,we=be.max;if(Re!==void 0&&we!==void 0)de.set(new _e(Re[0],Re[1],Re[2]),new _e(we[0],we[1],we[2]));else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;var Se=H.targets;if(Se!==void 0){for(var Pe=new _e,ze=new _e,Ze=0,Xe=Se.length;Ze<Xe;Ze++){var $=Se[Ze];if($.POSITION!==void 0){var be=xe.json.accessors[$.POSITION],Re=be.min,we=be.max;Re!==void 0&&we!==void 0?(ze.setX(Math.max(Math.abs(Re[0]),Math.abs(we[0]))),ze.setY(Math.max(Math.abs(Re[1]),Math.abs(we[1]))),ze.setZ(Math.max(Math.abs(Re[2]),Math.abs(we[2]))),Pe.max(ze)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}de.expandByVector(Pe)}K.boundingBox=de;var j=new el;de.getCenter(j.center),j.radius=de.min.distanceTo(de.max)/2,K.boundingSphere=j}function $t(K,H,xe){var te=H.attributes,de=[];function be(Pe,ze){return xe.getDependency("accessor",Pe).then(function(Ze){K.setAttribute(ze,Ze)})}for(var Re in te){var we=tt[Re]||Re.toLowerCase();we in K.attributes||de.push(be(te[Re],we))}if(H.indices!==void 0&&!K.index){var Se=xe.getDependency("accessor",H.indices).then(function(Pe){K.setIndex(Pe)});de.push(Se)}return Te(K,H),Et(K,H,xe),Promise.all(de).then(function(){return H.targets!==void 0?Ve(K,H.targets,xe):K})}function Yt(K,H){var xe=K.getIndex();if(xe===null){var te=[],de=K.getAttribute("position");if(de!==void 0){for(var be=0;be<de.count;be++)te.push(be);K.setIndex(te),xe=K.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),K}var Re=xe.count-2,we=[];if(H===Ky)for(var be=1;be<=Re;be++)we.push(xe.getX(0)),we.push(xe.getX(be)),we.push(xe.getX(be+1));else for(var be=0;be<Re;be++)be%2===0?(we.push(xe.getX(be)),we.push(xe.getX(be+1)),we.push(xe.getX(be+2))):(we.push(xe.getX(be+2)),we.push(xe.getX(be+1)),we.push(xe.getX(be)));we.length/3!==Re&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var Se=K.clone();return Se.setIndex(we),Se}return nt.prototype.loadGeometries=function(K){var H=this,xe=this.extensions,te=this.primitiveCache;function de(Xe){return xe[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(Xe,H).then(function($){return $t($,Xe,H)})}for(var be=[],Re=0,we=K.length;Re<we;Re++){var Se=K[Re],Pe=rt(Se),ze=te[Pe];if(ze)be.push(ze.promise);else{var Ze;Se.extensions&&Se.extensions[n.KHR_DRACO_MESH_COMPRESSION]?Ze=de(Se):Ze=$t(new Oi,Se,H),te[Pe]={primitive:Se,promise:Ze},be.push(Ze)}}return Promise.all(be)},nt.prototype.loadMesh=function(K){for(var H=this,xe=this.json,te=xe.meshes[K],de=te.primitives,be=[],Re=0,we=de.length;Re<we;Re++){var Se=de[Re].material===void 0?Ue(this.cache):this.getDependency("material",de[Re].material);be.push(Se)}return be.push(H.loadGeometries(de)),Promise.all(be).then(function(Pe){for(var ze=Pe.slice(0,Pe.length-1),Ze=Pe[Pe.length-1],Xe=[],$=0,j=Ze.length;$<j;$++){var He=Ze[$],Ge=de[$],ue,Je=ze[$];if(Ge.mode===pe.TRIANGLES||Ge.mode===pe.TRIANGLE_STRIP||Ge.mode===pe.TRIANGLE_FAN||Ge.mode===void 0)ue=te.isSkinnedMesh===!0?new fp(He,Je):new ea(He,Je),ue.isSkinnedMesh===!0&&!ue.geometry.attributes.skinWeight.normalized&&ue.normalizeSkinWeights(),Ge.mode===pe.TRIANGLE_STRIP?ue.geometry=Yt(ue.geometry,Rw):Ge.mode===pe.TRIANGLE_FAN&&(ue.geometry=Yt(ue.geometry,Ky));else if(Ge.mode===pe.LINES)ue=new Af(He,Je);else if(Ge.mode===pe.LINE_STRIP)ue=new Yc(He,Je);else if(Ge.mode===pe.LINE_LOOP)ue=new Hg(He,Je);else if(Ge.mode===pe.POINTS)ue=new Vg(He,Je);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+Ge.mode);Object.keys(ue.geometry.morphAttributes).length>0&&We(ue,te),ue.name=H.createUniqueName(te.name||"mesh_"+K),Ze.length>1&&(ue.name+="_"+$),Te(ue,te),H.assignFinalMaterial(ue),Xe.push(ue)}if(Xe.length===1)return Xe[0];for(var lt=new sl,$=0,j=Xe.length;$<j;$++)lt.add(Xe[$]);return lt})},nt.prototype.loadCamera=function(K){var H,xe=this.json.cameras[K],te=xe[xe.type];if(!te){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return xe.type==="perspective"?H=new Vr(Gn.radToDeg(te.yfov),te.aspectRatio||1,te.znear||1,te.zfar||2e6):xe.type==="orthographic"&&(H=new Pp(-te.xmag,te.xmag,te.ymag,-te.ymag,te.znear,te.zfar)),xe.name&&(H.name=this.createUniqueName(xe.name)),Te(H,xe),Promise.resolve(H)},nt.prototype.loadSkin=function(K){var H=this.json.skins[K],xe={joints:H.joints};return H.inverseBindMatrices===void 0?Promise.resolve(xe):this.getDependency("accessor",H.inverseBindMatrices).then(function(te){return xe.inverseBindMatrices=te,xe})},nt.prototype.loadAnimation=function(K){for(var H=this.json,xe=H.animations[K],te=[],de=[],be=[],Re=[],we=[],Se=0,Pe=xe.channels.length;Se<Pe;Se++){var ze=xe.channels[Se],Ze=xe.samplers[ze.sampler],Xe=ze.target,$=Xe.node!==void 0?Xe.node:Xe.id,j=xe.parameters!==void 0?xe.parameters[Ze.input]:Ze.input,He=xe.parameters!==void 0?xe.parameters[Ze.output]:Ze.output;te.push(this.getDependency("node",$)),de.push(this.getDependency("accessor",j)),be.push(this.getDependency("accessor",He)),Re.push(Ze),we.push(Xe)}return Promise.all([Promise.all(te),Promise.all(de),Promise.all(be),Promise.all(Re),Promise.all(we)]).then(function(Ge){for(var ue=Ge[0],Je=Ge[1],lt=Ge[2],Nt=Ge[3],ct=Ge[4],me=[],it=0,Lt=ue.length;it<Lt;it++){var pt=ue[it],Dt=Je[it],cn=lt[it],pi=Nt[it],Rr=ct[it];if(pt!==void 0){pt.updateMatrix(),pt.matrixAutoUpdate=!0;var $i;switch(qe[Rr.path]){case qe.weights:$i=hh;break;case qe.rotation:$i=Of;break;case qe.position:case qe.scale:default:$i=fh;break}var Br=pt.name?pt.name:pt.uuid,Vs=pi.interpolation!==void 0?ht[pi.interpolation]:Iu,ua=[];qe[Rr.path]===qe.weights?pt.traverse(function(ba){ba.isMesh===!0&&ba.morphTargetInfluences&&ua.push(ba.name?ba.name:ba.uuid)}):ua.push(Br);var qi=cn.array;if(cn.normalized){var Ri;if(qi.constructor===Int8Array)Ri=1/127;else if(qi.constructor===Uint8Array)Ri=1/255;else if(qi.constructor==Int16Array)Ri=1/32767;else if(qi.constructor===Uint16Array)Ri=1/65535;else throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");for(var Ja=new Float32Array(qi.length),ha=0,gs=qi.length;ha<gs;ha++)Ja[ha]=qi[ha]*Ri;qi=Ja}for(var ha=0,gs=ua.length;ha<gs;ha++){var dr=new $i(ua[ha]+"."+qe[Rr.path],Dt.array,qi,Vs);pi.interpolation==="CUBICSPLINE"&&(dr.createInterpolant=function(Qe){return new O(this.times,this.values,this.getValueSize()/3,Qe)},dr.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),me.push(dr)}}}var fa=xe.name?xe.name:"animation_"+K;return new Gs(fa,void 0,me)})},nt.prototype.loadNode=function(K){var H=this.json,xe=this.extensions,te=this,de=H.nodes[K],be=de.name?te.createUniqueName(de.name):"";return function(){var Re=[];return de.mesh!==void 0&&Re.push(te.getDependency("mesh",de.mesh).then(function(we){var Se=te._getNodeRef(te.meshCache,de.mesh,we);return de.weights!==void 0&&Se.traverse(function(Pe){if(!!Pe.isMesh)for(var ze=0,Ze=de.weights.length;ze<Ze;ze++)Pe.morphTargetInfluences[ze]=de.weights[ze]}),Se})),de.camera!==void 0&&Re.push(te.getDependency("camera",de.camera).then(function(we){return te._getNodeRef(te.cameraCache,de.camera,we)})),te._invokeAll(function(we){return we.createNodeAttachment&&we.createNodeAttachment(K)}).forEach(function(we){Re.push(we)}),Promise.all(Re)}().then(function(Re){var we;if(de.isBone===!0?we=new zg:Re.length>1?we=new sl:Re.length===1?we=Re[0]:we=new hn,we!==Re[0])for(var Se=0,Pe=Re.length;Se<Pe;Se++)we.add(Re[Se]);if(de.name&&(we.userData.name=de.name,we.name=be),Te(we,de),de.extensions&&Le(xe,we,de),de.matrix!==void 0){var ze=new zn;ze.fromArray(de.matrix),we.applyMatrix4(ze)}else de.translation!==void 0&&we.position.fromArray(de.translation),de.rotation!==void 0&&we.quaternion.fromArray(de.rotation),de.scale!==void 0&&we.scale.fromArray(de.scale);return te.associations.set(we,{type:"nodes",index:K}),we})},nt.prototype.loadScene=function(){function K(H,xe,te,de){var be=te.nodes[H];return de.getDependency("node",H).then(function(Re){if(be.skin===void 0)return Re;var we;return de.getDependency("skin",be.skin).then(function(Se){we=Se;for(var Pe=[],ze=0,Ze=we.joints.length;ze<Ze;ze++)Pe.push(de.getDependency("node",we.joints[ze]));return Promise.all(Pe)}).then(function(Se){return Re.traverse(function(Pe){if(!!Pe.isMesh){for(var ze=[],Ze=[],Xe=0,$=Se.length;Xe<$;Xe++){var j=Se[Xe];if(j){ze.push(j);var He=new zn;we.inverseBindMatrices!==void 0&&He.fromArray(we.inverseBindMatrices.array,Xe*16),Ze.push(He)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',we.joints[Xe])}Pe.bind(new dp(ze,Ze),Pe.matrixWorld)}}),Re})}).then(function(Re){xe.add(Re);var we=[];if(be.children)for(var Se=be.children,Pe=0,ze=Se.length;Pe<ze;Pe++){var Ze=Se[Pe];we.push(K(Ze,Re,te,de))}return Promise.all(we)})}return function(xe){var te=this.json,de=this.extensions,be=this.json.scenes[xe],Re=this,we=new sl;be.name&&(we.name=Re.createUniqueName(be.name)),Te(we,be),be.extensions&&Le(de,we,be);for(var Se=be.nodes||[],Pe=[],ze=0,Ze=Se.length;ze<Ze;ze++)Pe.push(K(Se[ze],we,te,Re));return Promise.all(Pe).then(function(){return we})}}(),r}(),bv=function(r){Nf.call(this,r),this.type=Nc};bv.prototype=Object.assign(Object.create(Nf.prototype),{constructor:bv,parse:function(r){var i=-1,n=1,l=2,u=3,h=4,p=function(Ne,Ue){switch(Ne){case n:console.error("RGBELoader Read Error: "+(Ue||""));break;case l:console.error("RGBELoader Write Error: "+(Ue||""));break;case u:console.error("RGBELoader Bad File Format: "+(Ue||""));break;default:case h:console.error("RGBELoader: Error: "+(Ue||""))}return i},g=1,_=2,b=4,A=`
`,S=function(Ne,Ue,Le){Ue=Ue||1024;for(var Te=Ne.pos,Ve=-1,We=0,rt="",Tt=128,nt=String.fromCharCode.apply(null,new Uint16Array(Ne.subarray(Te,Te+Tt)));0>(Ve=nt.indexOf(A))&&We<Ue&&Te<Ne.byteLength;)rt+=nt,We+=nt.length,Te+=Tt,nt+=String.fromCharCode.apply(null,new Uint16Array(Ne.subarray(Te,Te+Tt)));return-1<Ve?(Le!==!1&&(Ne.pos+=We+Ve+1),rt+nt.slice(0,Ve)):!1},R=function(Ne){var Ue,Le,Te=/^#\?(\S+)$/,Ve=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,We=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,rt=/^\s*FORMAT=(\S+)\s*$/,Tt=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,nt={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(Ne.pos>=Ne.byteLength||!(Ue=S(Ne)))return p(n,"no header found");if(!(Le=Ue.match(Te)))return p(u,"bad initial token");for(nt.valid|=g,nt.programtype=Le[1],nt.string+=Ue+`
`;Ue=S(Ne),Ue!==!1;){if(nt.string+=Ue+`
`,Ue.charAt(0)==="#"){nt.comments+=Ue+`
`;continue}if((Le=Ue.match(Ve))&&(nt.gamma=parseFloat(Le[1],10)),(Le=Ue.match(We))&&(nt.exposure=parseFloat(Le[1],10)),(Le=Ue.match(rt))&&(nt.valid|=_,nt.format=Le[1]),(Le=Ue.match(Tt))&&(nt.valid|=b,nt.height=parseInt(Le[1],10),nt.width=parseInt(Le[2],10)),nt.valid&_&&nt.valid&b)break}return nt.valid&_?nt.valid&b?nt:p(u,"missing image size specifier"):p(u,"missing format specifier")},E=function(Ne,Ue,Le){var Te,Ve,We,rt,Tt,nt,Et,$t,Yt,K,H,xe,te=Ue,de=Le,be;if(te<8||te>32767||Ne[0]!==2||Ne[1]!==2||Ne[2]&128)return new Uint8Array(Ne);if(te!==(Ne[2]<<8|Ne[3]))return p(u,"wrong scanline width");if(Te=new Uint8Array(4*Ue*Le),!Te.length)return p(h,"unable to allocate buffer space");for(Ve=0,We=0,$t=4*te,be=new Uint8Array(4),nt=new Uint8Array($t);de>0&&We<Ne.byteLength;){if(We+4>Ne.byteLength)return p(n);if(be[0]=Ne[We++],be[1]=Ne[We++],be[2]=Ne[We++],be[3]=Ne[We++],be[0]!=2||be[1]!=2||(be[2]<<8|be[3])!=te)return p(u,"bad rgbe scanline format");for(Et=0;Et<$t&&We<Ne.byteLength;){if(rt=Ne[We++],xe=rt>128,xe&&(rt-=128),rt===0||Et+rt>$t)return p(u,"bad scanline data");if(xe)for(Tt=Ne[We++],Yt=0;Yt<rt;Yt++)nt[Et++]=Tt;else nt.set(Ne.subarray(We,We+rt),Et),Et+=rt,We+=rt}for(K=te,Yt=0;Yt<K;Yt++)H=0,Te[Ve]=nt[Yt+H],H+=te,Te[Ve+1]=nt[Yt+H],H+=te,Te[Ve+2]=nt[Yt+H],H+=te,Te[Ve+3]=nt[Yt+H],Ve+=4;de--}return Te},N=function(Ne,Ue,Le,Te){var Ve=Ne[Ue+3],We=Math.pow(2,Ve-128)/255;Le[Te+0]=Ne[Ue+0]*We,Le[Te+1]=Ne[Ue+1]*We,Le[Te+2]=Ne[Ue+2]*We},W=function(){var Ne=new Float32Array(1),Ue=new Int32Array(Ne.buffer);function Le(Te){Ne[0]=Te;var Ve=Ue[0],We=Ve>>16&32768,rt=Ve>>12&2047,Tt=Ve>>23&255;return Tt<103?We:Tt>142?(We|=31744,We|=(Tt==255?0:1)&&Ve&8388607,We):Tt<113?(rt|=2048,We|=(rt>>114-Tt)+(rt>>113-Tt&1),We):(We|=Tt-112<<10|rt>>1,We+=rt&1,We)}return function(Te,Ve,We,rt){var Tt=Te[Ve+3],nt=Math.pow(2,Tt-128)/255;We[rt+0]=Le(Te[Ve+0]*nt),We[rt+1]=Le(Te[Ve+1]*nt),We[rt+2]=Le(Te[Ve+2]*nt)}}(),V=new Uint8Array(r);V.pos=0;var B=R(V);if(i!==B){var O=B.width,pe=B.height,ge=E(V.subarray(V.pos),O,pe);if(i!==ge){switch(this.type){case Nc:var qe=ge,ht=kb,Ye=Nc;break;case Is:for(var Ie=ge.length/4*3,ye=new Float32Array(Ie),Q=0;Q<Ie;Q++)N(ge,Q*4,ye,Q*3);var qe=ye,ht=yo,Ye=Is;break;case Fc:for(var Ie=ge.length/4*3,tt=new Uint16Array(Ie),Q=0;Q<Ie;Q++)W(ge,Q*4,tt,Q*3);var qe=tt,ht=yo,Ye=Fc;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type);break}return{width:O,height:pe,data:qe,header:B.string,gamma:B.gamma,exposure:B.exposure,format:ht,type:Ye}}}return null},setDataType:function(r){return this.type=r,this},load:function(r,i,n,l){function u(h,p){switch(h.type){case Nc:h.encoding=Qy,h.minFilter=St,h.magFilter=St,h.generateMipmaps=!1,h.flipY=!0;break;case Is:h.encoding=Bc,h.minFilter=Sn,h.magFilter=Sn,h.generateMipmaps=!1,h.flipY=!0;break;case Fc:h.encoding=Bc,h.minFilter=Sn,h.magFilter=Sn,h.generateMipmaps=!1,h.flipY=!0;break}i&&i(h,p)}return Nf.prototype.load.call(this,r,u,n,l)}});class wv extends ci.Object3D{constructor(i){super(),this.element=i,this.element.style.position="absolute",this.addEventListener("removed",function(){this.element.parentNode!==null&&this.element.parentNode.removeChild(this.element)})}}class oA{constructor(){this.domElement=document.createElement("div"),this.viewMatrix=new ci.Matrix4,this.viewProjectionMatrix=new ci.Matrix4,this.vector=new ci.Vector3,this.cache={objects:new WeakMap},this.getDistanceToSquaredA=new ci.Vector3,this.getDistanceToSquaredB=new ci.Vector3,this.domElement.style.overflow="hidden"}zOrder(i){const n=this.filterAndFlatten(i).sort((u,h)=>{const p=this.cache.objects.get(u).distanceToCameraSquared,g=this.cache.objects.get(h).distanceToCameraSquared;return p-g}),l=n.length;for(let u=0,h=n.length;u<h;u++)n[u].element.style.zIndex=String(l-u)}getDistanceToSquared(i,n){return this.getDistanceToSquaredA.setFromMatrixPosition(i.matrixWorld),this.getDistanceToSquaredB.setFromMatrixPosition(n.matrixWorld),this.getDistanceToSquaredA.distanceToSquared(this.getDistanceToSquaredB)}render(i,n){i.updateMatrixWorld(),n.parent===null&&n.updateMatrixWorld(!1),this.viewMatrix.copy(n.matrixWorldInverse),this.viewProjectionMatrix.multiplyMatrices(n.projectionMatrix,this.viewMatrix),this.renderObject(i,n),this.zOrder(i)}getSize(){return{width:this.width,height:this.height}}setSize(i,n){this.width=i,this.height=n,this.widthHalf=this.width/2,this.heightHalf=this.height/2,this.domElement.style.width=i+"px",this.domElement.style.height=n+"px"}filterAndFlatten(i){const n=[];return i.traverse(l=>{l instanceof wv&&n.push(l)}),n}renderObject(i,n){if(i instanceof wv){this.vector.setFromMatrixPosition(i.matrixWorld),this.vector.applyMatrix4(this.viewProjectionMatrix);const l=i.element,u="translate(-50%,-50%) translate("+(this.vector.x*this.widthHalf+this.widthHalf)+"px,"+(-this.vector.y*this.heightHalf+this.heightHalf)+"px)";l.style.transform=u,l.style.display=i.visible&&this.vector.z>=-1&&this.vector.z<=1?"":"none";const h={distanceToCameraSquared:this.getDistanceToSquared(n,i)};this.cache.objects.set(i,h),l.parentNode!==this.domElement&&this.domElement.appendChild(l)}for(let l=0,u=i.children.length;l<u;l++)this.renderObject(i.children[l],n)}}var Bp=null;function D_(r){if(r==null){Bp=null;return}else lA(),Bp=r}function lA(){Bp&&Bp.toggleVisibility()}class cA{constructor(i,n,l,u,h){this.overlayRef=null,this.widgetRef=null,this.visible=!1,this.id=i,this.position=n,this.normal_vector=l,this.labelObject=u,this.overlayRef=h}setWidgetRef(i){this.widgetRef=i}toggleVisibility(){!this.widgetRef||(this.visible=!this.visible,this.visible?(D_(this),this.widgetRef.style.display="grid"):(D_(null),this.widgetRef.style.display="none"))}setOpacity(i){this.labelObject.element.style.opacity=i}}let Mv;const Sv=45,uA=2,hA=.1,fA=100,O_={url:"https://devcdn.vev.design/private/IZ8anjrpLbNsil9YD4NOn6pLTsc2/ZtaWckY6KR_Astronaut.glb.glb"},dA="https://cdn.vev.design/private/Tr1z5E7fRfebmaI3Le2T8vQsHud2/c_W6ves3U_abandoned_factory_canteen_01_1k.hdr.hdr";function pA({hostRef:r,hotspots:i,hotspotColor:n,modelURL:l,posterURL:u,loader:h,enableMouseControl:p,autoRotate:g=!1,enablePan:_=!1,enableZoom:b=!1}){const{disabled:A}=Ga(),{width:S,height:R}=Pn(r),E=Hr(null),[N,W]=An(null),[V,B]=An(l||O_),[O,pe]=An(u),[ge,ye]=An(null),[Q,Ie]=An(null),[tt,qe]=An(null),[ht,Ye]=An(null),[Ne,Ue]=An(null),[Le,Te]=An(0),[Ve,We]=An(!1),[rt,Tt]=An(null),nt=Hr(null),[Et,$t]=An([]),Yt=Pn(r),K=Hr(null);qn(()=>{we(),Xe()},[]),qn(()=>{Ve&&rt.render(Ne,ht)},[Ve]),qn(()=>{if(!N||!i)return;H();let j=xe();$t(j),Xe(),rt.render(Ne,ht)},[i,N,n]);function H(){for(let j=N.children.length-1;j>=0;j--)N.children[j]&&N.children[j].name=="hotspot"&&N.remove(N.children[j]);Xe()}function xe(){let j=[];for(let Ge=0;Ge<i.length;Ge++){let ue=new cA(i[Ge].id,i[Ge].position,i[Ge].normal_vector,Re(N,i[Ge].position),K);if(i[Ge].widget)var He=document.getElementById(i[Ge].widget.value);He&&ue.setWidgetRef(He),te(ue,"click"),te(ue,"touchend"),j.push(ue)}return j}function te(j,He){j.labelObject.element.addEventListener(He,()=>{var Ge=ht.position.length();let ue=new ci.Vector3(j.position.x,j.position.y,j.position.z).normalize().multiplyScalar(Ge);Ol.to(ht.position,1,{x:ue.x,y:ue.y,z:ue.z,onUpdate:()=>{Q.update()}}),j.toggleVisibility()})}qn(()=>{rt&&(rt.setSize(Yt.width,Yt.height),rt.render(Ne,ht))},[Yt]),qn(()=>{if(!(A||!ge||!Q))return tt&&tt.setAnimationLoop(ze),()=>{tt&&tt.setAnimationLoop(null)}},[A,tt,ge,Q,Et]),qn(()=>{!Q||(Q.enabled=p,Q.enablePan=_,Q.enableZoom=b,Q.removeEventListener("start",de),Q.removeEventListener("end",be),g&&(Q.addEventListener("start",de),Q.addEventListener("end",be)),clearTimeout(Mv),Q.autoRotate=g,Q.update())},[Q,g,p,_,b]);const de=jr(()=>{clearTimeout(Mv),Q.autoRotate=!1},[Q]),be=jr(()=>{Mv=setTimeout(function(){Q.autoRotate=!0},3e3)},[Q]);qn(()=>{if(l){if(l.url==V.url)return;B(l)}else{B(O_);return}},[l]),qn(()=>{if(!Ne||!ht||!tt)return;ge&&($(ge),H(),We(!1),Te(0));let j=V.url;Se(j,Ne,N,ht,tt,Q)},[V]);function Re(j,He){var Ge=document.createElement("div");Ge.className="dot",Ge.style.backgroundColor=n||"blue",Ge.style.width="20px",Ge.style.height="20px",Ge.style.borderRadius="10px",Ge.style.cursor="pointer";var ue=new wv(Ge);return ue.position.set(He.x,He.y,He.z),ue.name="hotspot",ue.parent=ge,j.add(ue),ue}function we(){const j=E.current;let He=new ci.WebGLRenderer({canvas:j,alpha:!0});He.setSize(S,R),He.toneMapping=ci.ACESFilmicToneMapping,He.toneMappingExposure=1,He.outputEncoding=ci.sRGBEncoding,He.shadowMap.type=ci.PCFShadowMap;let Ge=new ci.Scene,ue=new ci.PerspectiveCamera(Sv,uA,hA,fA);Ge.add(ue);var Je=new ci.DirectionalLight(16777215,.8);Je.position.set(0,1,0),Je.castShadow=!0,Ge.add(Je);var lt=new ci.AmbientLight(16777215,.88);lt.castShadow=!0,Ge.add(lt);var Nt=new ci.SpotLight(16777215,.25);Nt.position.set(70,50,20),Ge.add(Nt);let ct=new oA;ct.setSize(Yt.width,Yt.height),ct.domElement.style.position="absolute",ct.domElement.style.top="0",ct.domElement.style.outline="none",nt.current.appendChild(ct.domElement),Tt(ct);let me=new Gf(ue,ct.domElement);me.autoRotate=g,me.enableDamping=!0,me.enableZoom=b,me.dampingFactor=.1,me.update();var it=new ci.Mesh;W(it),Ge.add(it);let Lt=V.url;Se(Lt,Ge,it,ue,He,me),qe(He),Ue(Ge),Ye(ue),Ie(me)}function Se(j,He,Ge,ue,Je,lt){var Nt=new ci.PMREMGenerator(Je);Nt.compileEquirectangularShader(),new bv().setDataType(ci.UnsignedByteType).load(dA,function(ct){const me=Nt.fromEquirectangular(ct).texture;He.environment=me,ct.dispose(),Nt.dispose(),new sA().load(j,function(it){let Lt=it.scene;Lt.castShadow=!0,Lt.receiveShadow=!0,Ge.add(Lt),ye(Lt);const pt=new ci.Box3().setFromObject(Lt),Dt=pt.getSize(new ci.Vector3),cn=pt.getCenter(new ci.Vector3);Lt.position.x=Lt.position.x-cn.x,Lt.position.y=Lt.position.y-cn.y,Lt.position.z=Lt.position.z-cn.z,Pe(Dt,cn,ue),lt.maxDistance=Dt.length()*5,lt.update(),We(!0)},function(it){let Lt=it.loaded/it.total*100;Te(Lt)},function(it){console.log("GLTF loading error: ",it)})})}function Pe(j,He,Ge){const ue=j.length()*.5,Je=ci.MathUtils.degToRad(Sv*.5),lt=ue/Math.tan(Je),Nt=new ci.Vector3().subVectors(Ge.position,He).multiply(new ci.Vector3(1,0,1)).normalize();Ge.position.copy(Nt.multiplyScalar(lt).add(He)),Ge.near=j.length()/100,Ge.far=j.length()*100,Ge.rotation.set(0,0,0);const ct=Math.max(j.x,j.y);Ge.position.set(0,0,Math.abs(ct/Math.sin(Sv/2))),Ge.updateProjectionMatrix(),Ge.lookAt(He.x,He.y,He.z),Xe()}function ze(){for(let j=0;j<Et.length;j++)Ze(Et[j],ht);Q&&Q.update(),rt.render(Ne,ht),Xe()}function Ze(j,He){let Ge=new ci.Vector3(j.position.x,j.position.y,j.position.z),ue=new ci.Vector3(0,0,-1).applyQuaternion(He.quaternion);Ge.angleTo(ue)>Math.PI/2?j.setOpacity("1"):j.setOpacity("0.1")}qn(()=>{tt&&ht&&(ht.aspect=S/R,ht.updateProjectionMatrix(),tt.setSize(S,R-10),Xe())},[S,R,ge]);function Xe(){tt&&Ne&&ht&&tt.render(Ne,ht)}function $(j){for(var He of N.children)He===j&&N.remove(He);Xe()}return Ji.createElement(hr,null,!Ve&&Ji.createElement("div",{className:"loadingWrapper"},h=="bar"||Ji.createElement("div",{className:"loadingBar"},Ji.createElement("div",{className:"progressFill",style:{width:`${Le}%`,backgroundColor:n||"blue"}}))),!Ve&&O&&Ji.createElement("div",{className:"posterImage",style:{backgroundImage:`url(${O.url})`}}),Ji.createElement("div",{ref:K,className:"overlay",style:{width:window.innerWidth,height:window.innerHeight}}),Ji.createElement("div",{ref:nt,className:"modelContainer"},Ji.createElement("canvas",{ref:E,id:"scene"})))}}}}),Ud.register("p77ya0hd",["react","animejs","vev"],function(Ls){"use strict";var Hr,An,qn,jr,hr,Ga;return{setters:[function(Pn){Hr=Pn.useRef,An=Pn.useState,qn=Pn.useEffect,jr=Pn.useMemo},function(Pn){hr=Pn.default},function(Pn){Ga=Pn.useVisible}],execute:function(){Ls({"w1c5oka1gh-1sbm":Pn,w2xkRVSdQS:Ol,w77ya1ds:fo,wg1jCVsk4q:ci,wtaXRnCbPjA:Nl});function Pn({before:si,after:yn,timer:In,loops:Xn,words:_n}){const[Ot,ki,di,Ui]=[0,1,2,3],ui=Hr(null),[Dn,Zr]=An(0),[Kn,wr]=An(Ot),[Ar,yi]=An(0),[Ii,Jr]=An(""),[rr,aa]=An(0),[pn,En]=An(0);qn(()=>{ui.current=Fr},[Fr]),qn(()=>{let Lr=setInterval(function(){ui.current()},In);return()=>{clearInterval(Lr)}},[In]);function Fr(){const Lr=_n[rr];if(Kn===Ot){if(Dn%5===0&&yi(Ar+1),Ar>Lr.length){Di();return}}else if(Kn===ki){if(Dn===50){Di();return}}else if(Kn===di){if(Xn&&pn>=Xn-1)return;if(Dn%3===0&&yi(Ar-2),Ar<0){Di();return}}else if(Kn===Ui){if(yi(0),Dn===1){const Ha=(rr+1)%_n.length;aa(Ha)}if(Dn===50){Di();return}}Jr(Lr.substring(0,Ar)),Zr(Dn+1)}function Di(){Zr(0),wr((Kn+1)%4),Kn===di&&En(pn+1)}return Ji.createElement("div",null,Ji.createElement("p",null,si,Ii,yn))}const fi=(si,yn,In,Xn=0,_n=1)=>{let Ot={targets:si,delay:Ki(yn.delayPreset,yn.delay||Xn,yn.modifier||_n)};yn.easing?Ot.easing=yn.easing:Ot.easing="linear";const{opacity:ki,scale:di}=yn;yn.fade&&typeof ki<"u"&&(Ot.opacity=[typeof ki.from=="number"?ki.from:0,typeof ki.to=="number"?ki.to:1]),yn.scaleText&&typeof di<"u"&&(Ot.scale=[typeof di.from=="number"?di.from:1,typeof di.to=="number"?di.to:1]);const Ui=["translateX","translateY","translateZ","rotateX","rotateY","rotateZ"];for(let ui in Ui){const Dn=Ui[ui];In?((!In[Dn]||!In[Dn].to)&&(In[Dn]={to:0}),yn[Dn]&&typeof In[Dn].to<"u"&&typeof yn[Dn].to<"u"&&(Ot[Dn]=[In[Dn].to,yn[Dn].to])):yn[Dn]&&typeof yn[Dn].from<"u"&&typeof yn[Dn].to<"u"&&(Ot[Dn]=[yn[Dn].from,yn[Dn].to])}return Ot},ls=(si,yn,In=0,Xn="linear",_n=3)=>{let Ot={};switch(yn){case 0:Ot={translateY:["1.1em",0],easing:Xn||"easeInOutQuad",opacity:[0,1],translateZ:0,duration:700,delay:Ki(5,In,_n)};break;case 1:Ot={opacity:[0,1],translateZ:0,easing:Xn||"easeInOutQuad",duration:2250,delay:Ki(1,In,_n)};break;case 2:Ot={scale:[.3,1],opacity:[0,1],translateZ:0,easing:Xn||"easeOutExpo",duration:600,delay:Ki(2,In,_n)};break;case 3:Ot={translateX:[40,0],translateZ:0,opacity:[0,1],easing:"easeOutExpo",duration:1200,delay:Ki(3,In,_n)};break;case 4:Ot={translateY:["6.1em",0],translateX:["6.55em",0],translateZ:0,rotateZ:[180,0],duration:750,easing:Xn||"easeOutExpo",delay:Ki(4,In,_n)};break;case 5:Ot={scale:[4,1],opacity:[0,1],translateZ:0,easing:Xn||"easeOutExpo",duration:950,delay:Ki(4,In,_n)};break;default:Ot={translateY:["1.1em",0],opacity:[0,1],translateZ:0,duration:750,delay:Ki(0,In,_n)};break}return Ot.targets=si,Ot},Ki=(si,yn=0,In=1,Xn=!1)=>{switch(si){case!0:return(_n,Ot)=>yn+50*Ot*In;case 1:return(_n,Ot)=>yn+150*(Ot+1)*In;case 2:return(_n,Ot)=>yn+70*(Ot+10)*In;case 3:return(_n,Ot)=>yn+(50+30*Ot)*In;case 4:return(_n,Ot)=>yn+70*Ot*In;case 5:return(_n,Ot)=>yn+80*Ot*In;default:return(_n,Ot)=>yn+50*Ot*In}},za=(si,yn,In=0,Xn="linear",_n=1)=>{let Ot={};switch(yn){case 0:Ot={translateY:["1.1em",0],opacity:[0,1],translateZ:0,duration:750,delay:Ki(0,In,_n)},Xn&&(Ot.easing=Xn);break;case 1:Ot={opacity:[0,1],translateZ:0,easing:Xn||"easeInOutQuad",duration:2250,delay:Ki(1,In,_n)};break;case 2:Ot={scale:[.3,1],opacity:[0,1],translateZ:0,easing:Xn||"easeOutExpo",duration:600,delay:Ki(2,In,_n)};break;case 3:Ot={translateX:[40,0],translateZ:0,opacity:[0,1],easing:Xn||"easeOutExpo",duration:1200,delay:Ki(3,In,_n)};break;case 4:Ot={translateY:["6.1em",0],translateX:["6.55em",0],translateZ:0,rotateZ:[180,0],duration:750,easing:Xn||"easeOutExpo",delay:Ki(4,In,_n)};break;case 5:Ot={scale:[4,1],opacity:[0,1],translateZ:0,easing:Xn||"easeOutExpo",duration:950,delay:Ki(4,In,_n)}}return Ot.targets=si,Ot};function Ol({text:si,easing:yn,hostRef:In,iterations:Xn,startDelay:_n,endDelay:Ot,loop:ki,runOnce:di}){const[Ui,ui]=An(!1),Dn=Hr(null),Zr=Ga(Dn);return qn(()=>{if(Ui&&di||di&&!Zr&&!Ui)return;const Kn=Dn.current;Kn.innerHTML=Kn.textContent.replace(/\S/g,"<span class='letter'>$&</span>"),Dn.current.innerHTML=Kn.textContent.replace(/(\S+)/g,'<div class="word">$&</div>');const wr=Dn.current.querySelectorAll(".word");hr.remove([wr]),Dn.current.setAttribute("style",null);for(let yi in wr){const Ii=wr[yi];Ii&&Ii.setAttribute&&Ii.setAttribute("style",null)}const Ar=hr.timeline({loop:ki});Xn.forEach((yi,Ii)=>{Ar.add(fi(wr,yi,Ii>0?Xn[Ii-1]:null))}),ui(!0)},[Dn.current,si,Xn,_n,Ot,ki,Zr,yn,di,Ui]),Ji.createElement("div",{className:"fill animation-wrapper"},Ji.createElement("span",{className:"animate-text",ref:Dn},si||"Great Thinkers"))}function fo({text:si,easing:yn,hostRef:In,fadeOutElement:Xn,animationPreset:_n,startDelay:Ot,endDelay:ki,loop:di}){const[Ui,ui]=An(!1),[Dn,Zr]=An(null),Kn=Hr(null),wr=Ga(Kn),Ar=jr(()=>Array.from(si).map(yi=>yi===" "?" ":'<span class="letter"> '+yi+"</span>").join(""),[si]);return qn(()=>{if(!di&&!wr&&!Ui||Ui&&!di)return;const yi=Kn.current;yi.innerHTML=Ar;const Ii=Kn.current.querySelectorAll(".letter");hr.remove(Dn),Kn.current.setAttribute("style",null);for(let rr in Ii){const aa=Ii[rr];aa&&aa.setAttribute&&aa.setAttribute("style",null)}Zr([Kn.current,Ii]);const Jr=hr.timeline({loop:di});Jr.add(za(Ii,_n,Ot,yn)),di&&(Xn==="word"?Jr.add({targets:Kn.current,opacity:0,duration:1e3,easing:"easeOutExpo",delay:ki}):Jr.add({targets:Ii,opacity:0,duration:1e3,easing:"easeOutExpo",delay:(rr,aa)=>ki+150*(aa+1)})),ui(!0)},[Kn.current,si,Xn,_n,Ot,ki,di,wr,yn,Ui,Ar]),Ji.createElement("div",{className:"fill animation-wrapper"},Ji.createElement("span",{className:"animate-text",ref:Kn},si||"Great Thinkers"))}function ci({text:si,easing:yn,hostRef:In,iterations:Xn,startDelay:_n,endDelay:Ot,loop:ki,runOnce:di}){const[Ui,ui]=An(!1),[Dn,Zr]=An(null),Kn=Hr(null),wr=Ga(Kn);return qn(()=>{if(Ui&&di||di&&!wr&&!Ui)return;const Ar=Kn.current;Ar.innerHTML=Ar.textContent.replace(/\S/g,"<span class='letter'>$&</span>");const yi=Kn.current.querySelectorAll(".letter");hr.remove(Dn),Kn.current.setAttribute("style",null);for(let Jr in yi){const rr=yi[Jr];rr&&rr.setAttribute&&rr.setAttribute("style",null)}Zr([Kn.current,yi]);const Ii=hr.timeline({loop:ki});Xn.forEach((Jr,rr)=>{Ii.add(fi(yi,Jr,rr>0?Xn[rr-1]:null),_n)}),ui(!0)},[Kn.current,si,Xn,_n,Ot,ki,wr,yn,Ui,di]),Ji.createElement("div",{className:"fill animation-wrapper"},Ji.createElement("span",{className:"animate-text",ref:Kn},si||"Great Thinkers"))}function Nl({text:si,hostRef:yn,animationPreset:In,startDelay:Xn=0,endDelay:_n=0,loop:Ot,runOnce:ki,easing:di,fadeOutElement:Ui}){const[ui,Dn]=An(!1),[Zr,Kn]=An(!1),[wr,Ar]=An(null),yi=Hr(null),Ii=Ga(yi);return qn(()=>Kn(!0),[]),qn(()=>{if(!Zr||ui&&ki||ki&&!Ii&&!ui)return;const Jr=yi.current;yi.current.innerHTML=Jr.textContent.replace(/(\S+)/g,'<div class="word">$&</div>');const rr=yi.current.querySelectorAll(".word");hr.remove(wr),Ar([yi.current,rr]);const aa=hr.timeline({loop:Ot}),pn=ls(rr,In,Xn,di,3);if(aa.add(pn),Ot)if(Ui==="word")aa.add({targets:yi.current,opacity:0,duration:1e3,easing:"easeOutExpo",delay:_n});else{Jr.innerHTML=Jr.textContent.replace(/\S/g,"<span class='letter'>$&</span>");const En=yi.current.querySelectorAll(".letter");aa.add({targets:En,opacity:0,duration:1e3,easing:"easeOutExpo",delay:(Fr,Di)=>_n+150*(Di+1)})}Dn(!0)},[Zr,si,In,Xn,_n,Ot,Ii,di,Ui,ki,ui]),Zr?Ji.createElement("div",{className:"fill animation-wrapper"},Ji.createElement("span",{className:"animate-text",ref:yi},si||"Great Thinkers")):null}}}}),Ud.register("basic",["react","vev","animejs"],function(Ls){"use strict";var Hr,An,qn,jr,hr,Ga,Pn,fi,ls,Ki,za,Ol,fo,ci,Nl,si,yn,In,Xn,_n;return{setters:[function(Ot){Hr=Ot.useCallback,An=Ot.useRef,qn=Ot.useEffect,jr=Ot.default,hr=Ot.Fragment,Ga=Ot.useState},function(Ot){Pn=Ot.useGlobalStore,fi=Ot.Tracking,ls=Ot.Link,Ki=Ot.Image,za=Ot.Icon,Ol=Ot.useHover,fo=Ot.useVisible,ci=Ot.useEditorState,Nl=Ot.View,si=Ot.useRoute,yn=Ot.useScrollTop,In=Ot.useViewport,Xn=Ot.useDevice},function(Ot){_n=Ot.default}],execute:function(){Ls({"external-link":di,frame:Ui,image:ui,shape:Kn,w74dqar7:yi,w75y8u1c:rr});var Ot=Ls("circle",()=>!1);function ki(pn){var Fr,Di,Lr;let En="";switch(pn.mode){case 0:pn.page!==""?En=((Fr=pn==null?void 0:pn.page)==null?void 0:Fr.title)||pn.page:En="Unlinked page";break;case 1:if(pn.widget){const{key:Ha,name:Rs,page:Yo,pageName:ka}=pn.widget;En=Rs+", "+ka}else En="Unlinked page";break;case 2:En=(pn==null?void 0:pn.href)||"empty link";break;case 3:pn.email!==""?En=pn.email+"?subject"+pn.subject:En="empty email: ";break;case 4:En=pn.phone||"empty phone";break;case 5:((Di=pn==null?void 0:pn.file)==null?void 0:Di.url)!==""?En=(Lr=pn==null?void 0:pn.file)==null?void 0:Lr.url:En="empty phone: ";break}return En}function di({link:pn,children:En,className:Fr}){const Di=Pn(Ha=>Ha.pages),Lr=Hr(Ha=>{fi.send("vev","link-button","click",ki(pn))},[pn,Di]);return Ji.createElement(ls,{onClick:Lr,className:Fr,to:pn},En)}function Ui(){return null}function ui(pn){return pn.section&&(pn.className="section"),Ji.createElement(Ki,Object.assign({},pn))}var Dn=Ls("rectangle",()=>null),Zr=Ls("section",()=>Ji.createElement("div",{className:"children __sc"}));function Kn({shapeId:pn,stretch:En}){return Ji.createElement(za,{d:pn,stretch:En})}var wr=Ls("text",({text:pn})=>Ji.createElement("div",{className:"__stagger",id:"",dangerouslySetInnerHTML:{__html:pn}}));function Ar(pn){const En=pn.split("/");return En[En.length-1].split(".")[0]}function yi({hostRef:pn,video:En,loop:Fr,infiniteLoop:Di,loopAmount:Lr,mute:Ha,controls:Rs,fill:Yo,playOnHover:ka=!1,startVisible:Fl,noContextMenu:po,noTracking:jo,thumbnail:Bl,preload:Ul,section:Kr}){const ar=An(),Cs=An({current:0,maxProgress:0}),[Va,Zo]=Ol(),xn=fo(ar),{disabled:wi}=ci(),mo=An(1);let Ps=1;qn(()=>{const kn=ar.current;if(console.log("visible: ",xn),jo||!kn||!En)return;const Lu=["play","pause","ended","timeupdate"],Gl=hs=>{const go=ar.current;if(!go)return;const Jo=(En==null?void 0:En.name)||Ar(En.sources[0].url)||"";switch(hs.type){case"timeupdate":const zl=Math.round(100*go.currentTime/go.duration),vo={current:zl,maxProgress:Math.max(zl,Cs.current.maxProgress)};zl>Cs.current.maxProgress&&Ii("Video Progress",Jo,Cs.current.maxProgress),go.currentTime>Ps*go.duration/5&&(Ii(`Video Progress ${Ps*20}`,Jo),Ps++),Cs.current.current=vo.current,Cs.current.maxProgress=vo.maxProgress;break;case"play":return Ii("Play",Jo);case"pause":return Ii("Pause",Jo,Cs.current.current);case"ended":return Ii("Finished",Jo)}};return Lu.forEach(hs=>kn&&kn.addEventListener(hs,Gl,!1)),()=>Lu.forEach(hs=>kn&&kn.removeEventListener(hs,Gl))},[En,jo,xn]),qn(()=>{const kn=ar.current;!kn||(wi?(mo.current=1,kn.load(),kn.pause()):kn.readyState>=3&&(xn?xn&&Fl&&(kn.muted=!0,kn.play(),setTimeout(()=>kn.play(),100)):(kn.pause(),mo.current=1)))},[xn,Fl,wi,En]);const cs={};Di&&Fr&&(cs.loop=!0),Fl&&(cs.autoPlay=!0),Ha&&(cs.muted=!0),Rs&&(cs.controls=!0),Nl.isIE&&(cs.className="ie"),qn(()=>{const kn=ar.current;ka&&kn&&(Va?kn.play():kn.pause())},[ka,Va]),qn(()=>{const kn=ar.current;!kn||(kn.style.objectFit=Yo?"cover":"contain")},[Yo,ar.current]);const us=()=>{mo.current<Lr&&(ar.current.currentTime=0,ar.current.play(),mo.current++)};return qn(()=>{if(ar.current)return ar.current.addEventListener("ended",us),()=>{ar.current&&ar.current.removeEventListener("ended",us)}},[ar.current,Lr]),Kr&&(cs.className=(cs.className||"")+" section"),jr.createElement(hr,null,!En&&jr.createElement("div",{className:"fill row v-center h-center",style:{color:"white"}},jr.createElement("h3",null,"Double-click to select video")),jr.createElement("video",Object.assign({},Zo,{ref:ar,onContextMenu:kn=>po&&kn.preventDefault(),"aria-label":(En==null?void 0:En.name)||"",full:!0,playsInline:!0,disableRemotePlayback:!0,poster:Bl&&Bl.url?Bl.url:En&&En.thumbnail,preload:Ul},cs),En&&En.sources&&En.sources.sort(kn=>kn.format==="video/webm"?-1:1).map(kn=>jr.createElement("source",{key:kn.url,src:kn.url,type:kn.format||"video/mp4"})),"Your browser does not support this video"),jr.createElement("div",{className:"overlay"}))}function Ii(pn,En,Fr,Di){fi.send("video","HTML5 Video",pn,En,Fr,Di)}const Jr={opacity:0};function rr({className:pn,children:En,cont:Fr,hostRef:Di}){const Lr=fo(Di),Ha=An(null),Rs=An(null),Yo=An(null),ka=An(null),[Fl,po]=Ol(),[jo,Bl]=Ga(!1),{pageKey:Ul}=si(),{disabled:Kr,selected:ar}=ci(),Cs=yn(),{height:Va}=In(),Zo=Xn(),xn=Fr&&Fr[Zo]&&Fr[Zo].params||{},wi=An({ClickAnimation:null,HoverAnimation:null,ScrollAnimation:null,LoadAnimation:null}),mo=An(null),Ps=An(Ul);qn(()=>{Ha.current&&(Ha.current.style.opacity=null)}),qn(()=>{Kr||vo(),wi.current.ScrollAnimation&&xn.ScrollAnimation&&Gl(xn.ScrollAnimation);const bt=Hl();return()=>{bt.widget&&_n.remove(bt.widget),bt.stagger&&_n.remove(bt.stagger),bt.animation&&_n.remove(bt.animation)}},[]),qn(()=>{!xn||mo&&xn.updated&&mo.current===xn.updated||(mo.current=xn.updated,Object.keys(wi.current).forEach(bt=>kn(bt)),vo(),Kr&&ar?us(xn.trigger+"Animation"):Yo.current!==Zo&&(us(xn.trigger+"Animation"),Yo.current=Zo))},[xn]),qn(()=>{!xn||(Object.keys(wi.current).forEach(bt=>kn(bt)),Kr||vo(),wi.current.LoadAnimation&&Lr&&us("LoadAnimation"),wi.current.ScrollAnimation&&Lr&&!Kr&&Gl(xn.ScrollAnimation),Kr&&jo&&Bl(!1))},[Kr,Zo]),qn(()=>{!xn||(Kr&&ar?us(xn.trigger+["Animation"]):Kr&&!ar&&kn(xn.trigger+["Animation"]))},[ar]),qn(()=>{!xn||!wi.current.LoadAnimation||(Lr?us("LoadAnimation"):xn.LoadAnimation.once||kn("LoadAnimation"))},[Lr]),qn(()=>{!xn||!wi.current.HoverAnimation||us("HoverAnimation",!Fl)},[Fl]),qn(()=>{!xn||!wi.current.ScrollAnimation||Kr||Gl(xn.ScrollAnimation)},[Cs]),qn(()=>{!xn||!wi.current.ClickAnimation||us("ClickAnimation",!jo)},[jo]),qn(()=>{var bt;((bt=xn==null?void 0:xn.HoverAnimation)==null?void 0:bt.triggers)&&Ul!==Ps.current&&(hs("HoverAnimation",xn.HoverAnimation.triggers),Ps.current=Ul)},[Ul,xn]);const cs=bt=>{if(!xn[bt])return;const St=xn[bt],On=_n.timeline({autoplay:!1,delay:Gd(xn[bt])}),_i=Hl();let Sn={targets:St.stagger?_i.stagger:_i==null?void 0:_i.animation,easing:St.easing||"linear"},Mr={targets:St.stagger?_i.stagger:_i==null?void 0:_i.widget,easing:St.easing||"linear"};Mr.duration=Sn.duration=St.duration?Math.max(St.duration,1e-4)*1e3:1e3,St.opacity&&(Sn.opacity=St.opacity),St.scale&&(Sn.scale=St.scale),St.move&&St.move[0]!=="0px"&&(Sn.translateY=St.move[0]),St.move&&St.move[1]!=="0px"&&(Sn.translateX=St.move[1]),St.translateX&&(Sn.translateX=[St.translateX[0],St.translateX[1]]),St.translateY&&(Sn.translateY=[St.translateY[0],St.translateY[1]]),St.rotate&&(Sn.rotate=[0,St.rotate]),Sn.rotate3d=[],St.color&&(Mr.color=aa(St.color)),St.background&&(Mr.backgroundColor=aa(St.background)),St.border&&(Mr["border-radius"]=[St.border[0],St.border[1]]),(St.color||St.background||St.border)&&On.add({...Mr}),On.add({...Sn}),wi.current[bt]=On,St.triggers&&Object.keys(St.triggers).length&&setTimeout(()=>hs(bt,St.triggers),100),Kr&&!ar&&Ru()},us=(bt,St)=>{const On=wi.current[bt];Kr&&!ar||!On||On.began&&!On.complete&&St===void 0||(xn[bt]&&xn[bt].loop&&(On.complete=()=>{On.reverse(),On.completed=!1,On.play()}),kl(On,St)&&(On.began&&On.pause(),St!==void 0&&On.reversed!==St&&(On.reverse(),On.completed=!1),On.play()))},kn=bt=>{if(!!wi.current[bt]){if(!xn[bt])return Lu(bt);wi.current[bt].pause(),wi.current[bt].reversed&&wi.current[bt].reverse(),wi.current[bt].seek(0),wi.current[bt].complete=null,wi.current[bt].began=!1,bt==="HoverAnimation"&&(Rs.current&&Jo(),Ko(bt)&&hs(bt,xn[bt].triggers)),bt==="ClickAnimation"&&(ka.current&&zl(),Ko(bt)&&hs(bt,xn[bt].triggers)),Kr&&Ru()}},Lu=bt=>{wi.current[bt].pause(),wi.current[bt].seek(0),wi.current[bt]=null;const St=Hl();St!=null&&St.widget&&_n.remove(St==null?void 0:St.widget),St!=null&&St.stagger&&_n.remove(St==null?void 0:St.stagger),St!=null&&St.animation&&_n.remove(St==null?void 0:St.animation),Ru()},Gl=bt=>{if(!bt)return;const St=wi.current.ScrollAnimation,On=bt.scrollOffsetStart?bt.scrollOffsetStart:0,_i=bt.scrollOffsetEnd?bt.scrollOffsetEnd:0;let Sn;Di.current.classList.contains("__f")||Di.current.classList.contains("__pp")?Sn=(Cs+On)/(Va-_i+On):(Sn=nf(bt.event,On,_i),Sn=St.duration/1e3-Sn);let Mr=St.duration*Sn;Mr<0&&Lr&&(Mr=.01),St.seek(Mr)},hs=Hr((bt,St)=>{const On=[],_i=[];Object.values(St).forEach(Sn=>{const Mr=Di.current.getRootNode().getElementById((Sn==null?void 0:Sn.key)||Sn);Mr&&(bt==="ClickAnimation"?(Mr.addEventListener("click",go),Mr.style.cursor="pointer",_i.push(Mr)):bt==="HoverAnimation"&&(Mr.addEventListener("mouseenter",po.onMouseEnter),Mr.addEventListener("mouseleave",po.onMouseLeave),On.push(Mr)))}),Rs.current=On,ka.current=_i},[Di,Rs,ka]),go=()=>{const bt=wi.current.ClickAnimation;if(!bt.began)return bt.play();bt.reverse(),bt.completed=!1,bt.began=!1,bt.play()},Jo=()=>{Rs.current&&Rs.current.forEach(bt=>{bt.removeEventListener("mouseleave",po.onMouseLeave),bt.removeEventListener("mouseenter",po.onMouseEnter)})},zl=()=>{ka.current&&ka.current.forEach(bt=>{bt.removeEventListener("click",go),bt.style.cursor=null})},vo=()=>{!xn||Object.keys(wi.current).forEach(bt=>xn[bt]&&cs(bt))},Ko=bt=>!(!xn||!xn[bt]||!xn[bt].triggers||!Object.keys(xn[bt].triggers).length),Ru=()=>{if(!Di.current)return;const bt=Hl();bt.animation&&bt.animation.removeAttribute("style"),bt.widget&&bt.widget.removeAttribute("style"),bt.stagger&&[].forEach.call(bt.stagger,St=>St&&St.removeAttribute("style"))},Gd=bt=>{const St=Math.max(bt.delay,0);return bt.stagger?_n.stagger(bt.stagger[0]*1e3,{start:St*1e3,from:bt.stagger[1]}):St*1e3},nf=(bt,St,On)=>{const _i=Di.current.getBoundingClientRect(),Sn=Math.abs(Va-On<_i.height?On+(Va-On-_i.height):On);if(_i.height>Va*.8)return wi.current.ScrollAnimation.duration/1e3+(_i.top-On)/(_i.height/2+St-On);if(bt==="bot")return(_i.bottom-_i.height-Sn)/(Va-_i.height+St-Sn);if(bt==="top")return(_i.top-On)/(_i.height+St-On);if(bt==="mid")return(_i.top-On)/((Va-_i.height)/2+St-On)},Hl=()=>{if(!Di.current)return;let bt,St,On;if(bt=Di.current.querySelector(".__wc"),!!bt)return St=bt&&bt.querySelector("w"),On=Di.current.classList.contains("__text")?bt.querySelectorAll("w div > *"):bt.querySelectorAll(".__c vev .__wc w:not(.frame)"),{animation:bt,widget:St,stagger:On}},kl=(bt,St)=>!(St&&bt.currentTime===0||St===!1&&bt.currentTime===bt.duration);let Qr;return!Kr&&xn&&(xn.LoadAnimation||xn.ScrollAnimation)&&(Qr=Jr),Ji.createElement("div",{className:pn,style:Qr,onClick:!Ko("ClickAnimation")&&(()=>Bl(!jo)),onMouseEnter:!Ko("HoverAnimation")&&po.onMouseEnter,onMouseLeave:!Ko("HoverAnimation")&&po.onMouseLeave,ref:Ha},En)}const aa=pn=>`rgba(${[pn.r,pn.g,pn.b,pn.a].toString()}`}}}),Ud.register("pMdFOsZW1t",["react","vev"],function(Ls){"use strict";var Hr,An,qn,jr;return{setters:[function(hr){Hr=hr.useCallback},function(hr){An=hr.useGlobalStore,qn=hr.Tracking,jr=hr.Link}],execute:function(){Ls("w3tbowgsq-",Ga);function hr(Pn){var ls,Ki,za;let fi="";switch(Pn.mode){case 0:Pn.page!==""?fi=((ls=Pn==null?void 0:Pn.page)==null?void 0:ls.title)||Pn.page:fi="Unlinked page";break;case 1:if(Pn.widget){const{key:Ol,name:fo,page:ci,pageName:Nl}=Pn.widget;fi=fo+", "+Nl}else fi="Unlinked page";break;case 2:fi=(Pn==null?void 0:Pn.href)||"empty link";break;case 3:Pn.email!==""?fi=Pn.email+"?subject"+Pn.subject:fi="empty email: ";break;case 4:fi=Pn.phone||"empty phone";break;case 5:((Ki=Pn==null?void 0:Pn.file)==null?void 0:Ki.url)!==""?fi=(za=Pn==null?void 0:Pn.file)==null?void 0:za.url:fi="empty file: ";break}return fi}function Ga({link:Pn,linkText:fi}){const ls=An(za=>za.pages),Ki=Hr(za=>{qn.send("vev","link-button","click",hr(Pn))},[Pn,fi,ls]);return Ji.createElement(jr,{to:Pn,onClick:Ki,className:"fill"},fi||"Open link")}}}})});})();
